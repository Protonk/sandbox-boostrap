# Book Tree Audit

## Overview

`book/` holds the textbook scaffold, experiments, graph/mapping IR, CARTON-facing API/tools, examples, profiles, tests, and world baselines for the fixed Sonoma host. At a structural level it implements the substrate → concept inventory → mappings → CARTON → experiments/testing story described in the root README/AGENTS: theory and vocabulary live under `book/substrate/`, the concept inventory and validation harness live in `book/graph/`, stable mappings and CARTON sit on top of that, and experiments, examples, profiles, and tests consume those layers.

This audit treats that layering as given and focuses on how the current files are arranged, how guidance and status are surfaced, and where similar roles are implemented in noticeably different ways. It does not judge correctness or completeness of mappings or narratives; instead it records where layout and narration feel coherent, where they mix roles, and where there are obvious seams or pockets of entropy. Directories `book/evidence/experiments/op-coverage-and-runtime-signatures` and `book/evidence/experiments/runtime-final-final/suites/graph-shape-vs-semantics` were excluded per request.

## Inventory
- book — subdirs api/ chapters/ examples/ experiments/ graph/ out/ profiles/ substrate/ tests/ world/; md `AGENTS.md`, `Outline.md`; code `ci.py`; guidance present.
- book/out — subdir ci-stamps/; data `python-harness.json`, `swift-build.json`.
- book/chapters — subdirs chapter01-Introduction/ (md `README.md`), chapter03-TextEdit/ (md `README.md`, subdir content/ with md `02.1-02.5-final-pack.md`), chapter06-Example.app/ (md `Plan.md`); no local AGENTS.
- book/evidence/experiments — md `AGENTS.md`, `Experiments.md`; subdirs (excluding the two in-flux dirs):
  - anchor-filter-map/ — md `Notes.md`, `Report.md`; out/ `anchor_filter_candidates.json`.
  - bedrock-followups/ — out/ anchor-runtime-attest/, extension-lifecycle/ (empty placeholders).
  - entitlement-diff/ — md `Notes.md`, `Report.md`; code `entitlement_sample.c`; entitlements/ `network_server.plist`, `none.plist`; out/ entitlement manifests (`entitlement_manifest.json`, signed/unsigned plists).
  - field2-filters/ — md `Manual-Ghidra.md`, `Notes.md`, `Report.md`; code `harvest_field2.py`, `unknown_focus.py`; sb/ with numerous `v0`–`v7` sb profiles plus build/ sb.bin variants; out/ `field2_inventory.json`, `unknown_nodes.json`.
  - kernel-symbols/ — md `Notes.md`, `Report.md`; out/14.4.1-23E224/ containing kernel-symbols/ (`strings.json`, `symbols.json`, `targets.json`) and kernel-string-refs/ (`string_references.json`), plus `op_table_candidates.json`.
  - libsandbox-encoder/ — md `Plan.md`, `Notes.md`, `Report.md`; code `build_tag_field_summary.py`, `dump_raw_nodes.py`, `run_phase_a.py`; sb/ matrix and single-file profiles (with .inspect/.bin files); out/ encoder/tag layout JSONs.
  - node-layout/ — md `Notes.md`, `Report.md`; code `analyze.py`; sb/ variants `v0`–`v32` with build/ sb.bin counterparts; out/ `summary.json`.
  - op-table-operation/ — md `Notes.md`, `Report.md`; code `analyze.py`, `build_catalog.py`, `runtime_probe.c`; sb/ variants `v0`–`v16` and build/ sb.bin; out/ `op_table_catalog_v1.json`, `op_table_map.json`, `op_table_signatures.json`, `runtime_signatures.json`, `summary.json`.
  - op-table-vocab-alignment/ — md `Notes.md`, `Report.md`; code `update_alignment.py`; out/ `op_table_vocab_alignment.json`.
  - probe-op-structure/ — md `Notes.md`, `Report.md`; code `analyze_profiles.py`, `anchor_scan.py`, `map_literal_refs.py`, `tag_inventory.py`, `tag_layout_hypotheses.py`; sb/ variants `v0`–`v8` with build/ sb.bin; data `anchor_map.json`; out/ analysis/anchor/tag inventory JSONs.
  - runtime-adversarial/ — md `Plan.md`, `Notes.md`, `Report.md`; code `run_adversarial.py`; sb/ variants with build/ sb.bin; out/ runtime_profiles/ sb runtime blobs and JSON summaries (`expected_matrix.json`, `impact_map.json`, `mismatch_summary.json`, `runtime_results.json`).
  - runtime-checks/ — md `Notes.md`, `Report.md`; code `mach_probe.c`, `run_probes.py`, `sandbox_reader.c`, `sandbox_runner.c`, `sandbox_writer.c`; data `runtime_log_schema.v0.1.json`, `strict_1.sb`; out/ decoded_blobs/, runtime_profiles/ (runtime sb blobs), recompiled/, plus `expected_matrix.json`, `golden_decodes.json`, `runtime_results.json`.
  - sandbox-init-params/ — md `Report.md`.
  - sbpl-graph-runtime/ — md `Notes.md`, `Report.md`; profiles/ SBPL sources; out/ compiled sb.bin plus `ingested.json`, `static_expectations.json`, `triples_manifest.json`.
  - symbol-search/ — md `Notes.md`, `Report.md`.
  - system-profile-digest/ — md `Notes.md`, `Report.md`; out/ `digests.json`.
  - tag-layout-decode/ — md `Notes.md`, `Report.md`; out/ `tag_histogram.json`, `tag_literal_nodes.json`.
  - vocab-from-cache/ — md `Notes.md`, `Report.md`; code `check_vocab.py`, `extract_dsc.swift`, `harvest_filters.py`, `harvest_ops.py`; out/ `filter_names.json`, `operation_names.json`.
- book/graph — md `AGENTS.md`, `README.md`; code `Package.swift`, `swift_build.py`; subdirs api/ (empty), concepts/, mappings/, sources/, book/graph/substrate/ (empty), .build/ (Swift build artifacts), book/ (generated copies).
  - graph/.build/ — build outputs with artifacts/, checkouts/, repositories/, arm64-apple-macosx/debug/ (BookGraph product, ModuleCache, index/ store/db, dSYM) and associated metadata files.
  - graph/book/ — generated JSON mirrors: graph/concepts/ {concepts.json, concept_map.json, concept_text_map.json}; graph/concepts/validation/strategies.json; graph/validation/validation_report.json.
  - graph/concepts/ — md `AGENTS.md`, `CONCEPT_INVENTORY.md`, `EXAMPLES.md`; data `BEDROCK_SURFACES.json`, `concept_map.json`, `concept_text_map.json`, `concepts.json`; subdir validation/.
    - graph/concepts/validation/ — md `Concept_map.md`, `README.md`; code `__main__.py`, `decode_blob.py`, `field2_experiment_job.py`, `fixtures_job.py`, `ingest_blob.py`, `node_decoder.py`, `profile_ingestion.py`, `registry.py`, `runtime_checks_experiment_job.py`, `schema_meta_job.py`, `system_profile_experiment_job.py`, `tasks.py`, `vocab_extraction.py`, `vocab_harvest_job.py`; data `strategies.json`, `validation_report.json`; subdirs fixtures/, out/.
      - fixtures/ — md `FORMAT_NOTES.md`, `INVARIANTS.md`, `README.md`; data `VOCAB_CONTRACT_SAMPLE.json`, `fixtures.json`; code `generate_hexdumps.py`, `run_fixture_harness.py`; subdir hexdumps/ with sample hexdump txt files.
      - out/ — md `README.md`; data `fixtures_status.json`, `index.json`, `metadata.json`, `validation_status.json`, `vocab_status.json`; subdirs experiments/ (field2/ with `field2_ir.json`, `status.json`; runtime-checks/ with `runtime_results.normalized.json`, `status.json`; system-profile-digest/ with `digests_ir.json`, `status.json`), lifecycle/ (`extensions_dynamic.md`, `entitlements.json`), semantic/ (`mach_services.md`, `mach_services.jsonl`, `metafilter.jsonl`, `network.jsonl`, `runtime_results.json`, `sbpl_params.jsonl`), static/ (`mappings.json`, `sample.sb.json`, `system_profiles.json`), vocab/ (md `README.md`; data `filter_names.json`, `filters.json`, `operation_names.json`, `ops.json`, `runtime_usage.json`).
  - graph/mappings/ — md `AGENTS.md`, `README.md`; code `run_promotion.py`; subdirs anchors/ (md `README.md`; data `anchor_field2_map.json`, `anchor_filter_map.json`), carton/ (code `generate_coverage_from_carton.py`, `generate_filter_index.py`, `generate_operation_index.py`, `generate_profile_layer_index.py`; data `concept_index.json`, `filter_index.json`, `operation_coverage.json`, `operation_index.json`, `profile_layer_index.json`), dyld-libs/ (md `README.md`; code `check_manifest.py`; data `manifest.json`; subdir usr/lib/system/), op_table/ (md `README.md`; data `metadata.json`, `op_table_catalog_v1.json`, `op_table_map.json`, `op_table_operation_summary.json`, `op_table_signatures.json`, `op_table_vocab_alignment.json`), runtime/ (md `README.md`; code `generate_lifecycle.py`, `generate_runtime_signatures.py`; data `adversarial_summary.json`, `expectations.json`, `golden_decodes.json`, `golden_expectations.json`, `lifecycle.json`, `runtime_signatures.json`; subdirs decoded_blobs/, lifecycle_traces/ (`entitlements-evolution.jsonl`, `extensions-dynamic.jsonl`), traces/ (runtime trace jsonl files)), system_profiles/ (md `README.md`; code `generate_attestations.py`, `generate_digests_from_ir.py`, `generate_static_checks.py`; data `attestations.json`, `digests.json`, `static_checks.json`; subdir attestations/ with runtime/profile jsonl attestations), tag_layouts/ (md `README.md`; code `annotate_metadata.py`; data `tag_layouts.json`), vocab/ (md `README.md`; code `generate_attestations.py`, `generate_ops_coverage.py`; data `attestations.json`, `filter_names.json`, `filters.json`, `operation_names.json`, `ops.json`, `ops_coverage.json`).
  - graph/sources/ — md `AGENTS.md`; code `main.swift`.
  - book/graph/substrate/ — empty placeholder.
- book/tests — md `AGENTS.md`, `README.md`; code `conftest.py`, `run_all.py`, numerous pytest files (`test_anchor_outputs.py`, `test_anchor_scan.py`, `test_bedrock_registry.py`, `test_book_api_ghidra_connector.py`, `test_canonical_drift_scenario.py`, `test_carton_api_discovery.py`, `test_carton_api_facade.py`, `test_carton_coverage_mapping.py`, `test_carton_indices.py`, `test_carton_manifest.py`, `test_carton_query.py`, `test_carton_rebuild.py`, `test_carton_scenario.py`, `test_concept_index_alignment.py`, `test_decoder_headers.py`, `test_decoder_validation.py`, `test_dyld_libs_manifest.py`, `test_entitlement_diff_assets.py`, `test_examples.py`, `test_experiments.py`, `test_ghidra_scaffold.py`, `test_golden_decodes.py`, `test_kernel_string_refs.py`, `test_mappings_guardrail.py`, `test_op_table_api.py`, `test_ops_coverage.py`, `test_regex_tools.py`, `test_runtime_adversarial.py`, `test_runtime_golden.py`, `test_runtime_matrix_shape.py`, `test_runtime_results_metafilter.py`, `test_runtime_results_outcomes.py`, `test_runtime_results_structure.py`, `test_runtime_results_system_profiles.py`, `test_runtime_signatures_mapping.py`, `test_sbpl_compile_api.py`, `test_sbpl_graph_runtime_assets.py`, `test_sbpl_wrapper_exists.py`, `test_smoke.py`, `test_system_profiles_mapping.py`, `test_tag_layout_hash.py`, `test_validation.py`, `test_vocab_harvest.py`); subdir vibes/ with md `README.md`, `agent_layering.md`.
- book/world — md `README.md`; subdirs example-world/ (data `dyld/manifest.json`, `world.json`) and sonoma-14.4.1-23E224-arm64/ (data `dyld/manifest.json`, `world.json`).
- book/api — md `AGENTS.md`, `README.md`; subdirs:
  - book/tools/sbpl/wrapper/ — md `Plan.md`, `README.md`; code `extract_cache.sh`, `wrapper.c`.
  - carton/ — md `AGENTS.md`, `API.md`, `README.md`; code `__init__.py`, `carton_query.py`, `create_manifest.py`; data `CARTON.json`.
  - decoder/ — md `README.md`; code `__init__.py`, `__main__.py`.
  - file_probe/ — md `README.md`; code `file_probe.c`.
  - ghidra/ — md `README.md`; code `__init__.py`, `connector.py`, `run_data_define.py`, `run_task.py`, `scaffold.py`; subdir ghidra_lib/ (md `README.md`; code `__init__.py`, `node_scan_utils.py`); subdir scripts/ with numerous Python kernel/Ghidra helpers (e.g., `disable_x86_analyzers.py`, `find_field2_evaluator.py`, `kernel_addr_lookup.py`, `kernel_adrp_add_scan.py`, `kernel_arm_const_base_scan.py`, `kernel_data_define_and_refs.py`, `kernel_field2_mask_scan.py`, `kernel_function_dump.py`, `kernel_function_info.py`, `kernel_imm_search.py`, `kernel_node_layout_probe.py`, `kernel_node_layout_walk.py`, `kernel_node_struct_scan.py`, `kernel_op_table.py`, `kernel_page_ref_scan.py`, `kernel_string_refs.py`, `kernel_symbols.py`, `kernel_tag_switch.py`, `kernel_x86_page_scan.py`).
  - golden_runner/ — code `__init__.py`, `cli.py`, `test_golden_runner.py`.
  - inspect_profile/ — md `README.md`; code `__init__.py`, `cli.py`.
  - op_table/ — md `README.md`; code `__init__.py`, `cli.py`.
  - regex_tools/ — md `README.md`; code `__init__.py`, `extract_legacy.py`, `re_to_dot.py`.
  - runtime_golden/ — code `__init__.py`, `generate.py`.
  - sbpl_compile/ — md `README.md`; code `__init__.py`, `cli.py`; subdir c/ (build/; code `compile_profile.c`).
- book/profiles — md `AGENTS.md`; subdirs:
  - golden-triple/ — md `CaseStudy_bucket4.md`, `README.md`; data `allow_all.sb.bin`, `bucket4_v1_read.sb`, `.sb.bin`, `bucket5_v11_read_subpath.sb`, `.sb.bin`, `expected_matrix.json`, `ingested.json`, `metafilter_any.sb`, `.sb.bin`, `runtime_results.json`, `static_expectations.json`, `strict_1.sb`, `.sb.bin`, `triples_manifest.json`; runtime_profiles/ (`allow_all.runtime_allow_all.runtime.sb`, `metafilter_any.runtime_metafilter_any.runtime.sb`, `v11_read_subpath.bucket5_v11_read_subpath.runtime.sb`, `v1_read.bucket4_v1_read.runtime.sb`).
  - textedit/ — md `README.md`, `container-notes.md`; data `application.sb`, `textedit-entitlements.plist`, `textedit-specialized.sb`; notes/ `02.1-capability-survey.md`, `02.2-profiles-containers-entitlements.md`, `02.3-tracing-real-operations.md`, `02.4-broader-system-lessons.md`; output/ `02.5_code_examples.md`, JSON summaries (`02.1_capability_summary.json`, `02.2_profiles_and_containers.json`, `02.4_pattern_extraction.json`); tools/ scripts (`02.1_capability_checklist.py`, `02.1_capability_survey.py`, `02.2_profiles_and_containers.py`, `02.3_trace_annotate.py`, `02.3_trace_operations.sh`, `02.4_pattern_extraction.py`); traces/ (empty).
- book/out/ci-stamps — data `python-harness.json`, `swift-build.json`.
- book/ci.py — code helper at book root.

## Organizational Map

- **Chapters** — Draft prose and plan stubs under `book/chapters/` (intro outline, TextEdit content, example-app plan). Sparse guidance and no local AGENTS suggest this region is still in narrative-flux: the Outline at `book/Outline.md` sketches where chapters will go, but the per-chapter directories mostly hold early drafts and scaffolding rather than finalized text. The TextEdit content already references concrete artifacts (profiles, entitlements) and so sits closest to the rest of the repo’s evidence web.
- **Experiments** — `book/evidence/experiments/` holds per-question labs with Notes/Report/Plan plus SBPL probes and JSON outputs. Most subdirectories follow the Report/Notes scaffold described in `book/evidence/experiments/AGENTS.md`, but some (for example, `bedrock-followups`, `sandbox-init-params`) are thin or placeholder-like, with minimal artifacts or narrative. As a whole this region feels intentionally in flux: it is where new probes and tensions are explored before anything is promoted to mappings or CARTON.
- **Graph layer** — `book/graph/` is the concept inventory + validation tooling + stable mappings backbone that sits between substrate theory and the rest of the book. Concept inventory and validation code live under `concepts/` with explicit validation outputs and status files; `mappings/` collects promoted vocab/op-table/runtime/system-profile/tag-layout/anchor JSONs, each paired with a generator script. Presence of `AGENTS.md`, `README.md`, and validation reports gives this region a relatively settled, “bedrock-adjacent” feel; changes here are described and status-tagged rather than ad hoc.
- **API/tooling** — `book/api/` packages CARTON, decoder, op-table helpers, Ghidra scripts, SBPL wrapper/compile utilities, and runtime-golden helpers. Each subdir has a local README and, where appropriate, an AGENTS file that frames the intended use (`carton` in particular is tightly specified). This region reads as stable but evolving infrastructure: code is central to many tests, and the CARTON documentation makes clear that its surface is meant to be frozen relative to upstream validation/mapping changes.
- **Profiles** — `book/profiles/` contains reusable SBPL/profile assets: `golden-triple` is a carefully curated runtime/static “golden” set with manifests and runtime profiles, while `textedit` is a case study with notes, outputs, and helper scripts. Both subtrees mix docs, data, and tool scripts, but with a clear story: these are shared, named profiles that other regions (experiments, mappings, CARTON) point at when they need canonical examples.
- **Tests** — `book/tests/` is the central guardrail suite with many pytest files plus vibes/ documents on agent layering. It encodes the expected shape of mappings, CARTON, decoder outputs, and experiment artifacts, and so is where the current project “invests” most of its automated checks. A single additional test sits in `book/api/golden_runner/`, mirroring the fact that that API has its own small harness layer.
- **World/CI** — `book/world/` records world baselines (example + Sonoma host) and world_id metadata; `book/out/ci-stamps/` keeps simple stamps for Python harness and Swift build status. These directories form the bridge between the fixed external host and the repo: they rarely change, but other regions (mappings, CARTON, experiments) depend on them as the reference world.

## Structural Smells

This section records layout patterns that may increase cognitive load or make it harder to see where a particular role “really” lives. None of these are correctness problems; they are observations about how similar responsibilities are currently spread across the tree.

- **Location variance for mapping-like JSONs** — Several JSONs that function as mappings or catalogs appear both in experiment-specific `out/` directories and in promoted form under `book/graph/mappings/`. For example, `book/evidence/experiments/op-table-operation/out/op_table_map.json` sits next to `book/evidence/graph/mappings/op_table/op_table_map.json`, and runtime probe results are stored both in `book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/runtime_results.json` and in normalized form under `book/graph/mappings/runtime/`. CARTON coverage/index JSONs live under `book/graph/mappings/carton/`, while concept-index/mapping copies are also available under `book/graph/book/`. The pattern makes it easy to see provenance but also means that, for any given concept (op-table map, runtime expectations), there are multiple JSONs with similar names in different places, and the “authoritative” one is not always visually obvious without reading AGENTS/README text.
- **Documentation scaffold inconsistency** — Most experiments follow the Plan/Notes/Report scaffold spelled out in `book/evidence/experiments/AGENTS.md`, but a few directories diverge: `bedrock-followups` exposes only an `out/` tree with no narrative, and `sandbox-init-params` has a `Report.md` without local scripts or `out/`. Conversely, experiments such as `libsandbox-encoder` and `runtime-adversarial` have Plans as well as Notes/Reports. Chapters under `book/chapters/` have their own pattern (README plus content files) but lack AGENTS-level framing. The net effect is that some subtrees immediately tell an agent how to read them, while others require inference from filenames alone.
- **Mixed code/data directories** — Several directories mix code that generates or validates artifacts with the artifacts themselves: mapping folders such as `book/graph/mappings/runtime/`, `book/graph/mappings/system_profiles/`, and `book/graph/mappings/carton/` contain both generator scripts (`generate_*`) and the resulting JSONs; `book/graph/concepts/validation/` combines Python harness code, fixtures, and generated `out/` status files; `book/profiles/textedit/` keeps scripts, notes, outputs, and profile blobs in a single layer. Some regions keep a clearer separation between scripts and derived blobs. The mixed layout is traceable but makes it easy to run tools directly “next to” their outputs, blurring source vs generated status.
- **Structural duplication** — Some artifacts exist in structurally duplicated forms. The Swift build leaves a full `.build/` tree under `book/graph/`, including a module index and DWARF dSYM bundle, while a second copy of selected concept/mapping JSONs lives under `book/graph/book/` alongside the canonical versions in `book/graph/concepts/`. This is expected from the build tooling but means there are multiple parallel hierarchies that look similar (especially under `graph/book/graph/concepts/`), and agents need to know from AGENTS/README that only one branch is meant to be edited.
- **Test placement variance** — Nearly all pytest files live centrally in `book/tests/`, but `book/api/golden_runner/test_golden_runner.py` lives alongside its code. There are no corresponding local tests under other api subdirectories. This is not inherently wrong, but it is a different test-placement convention within one region, and it can make it less obvious whether new tests should live near the API or in the shared `book/tests/` suite.
- **“out/” naming reused for different roles** — The name `out/` is used in several places with different meanings: experiment artifacts (`book/evidence/experiments/*/out/`), validation outputs (`book/evidence/graph/concepts/validation/out/`), TextEdit chapter outputs (`book/profiles/textedit/output/`), and CI stamps (`book/out/ci-stamps/`). In context the paths are clear, but the repeated pattern means that “out” does not have a single consistent role across the tree; it may mean “experiment scratch”, “validated IR”, “chapter outputs”, or “build stamps” depending on location.

## Terminology and Narrative Variants

Here the focus is on how a small set of core concepts are described in different parts of `book/`. The variants below are framed as “narrative clusters” rather than contradictions: they highlight where explanations emphasize different facets or abstraction levels.

- **Operation / Filter** — `book/evidence/graph/concepts/CONCEPT_INVENTORY.md` treats Operations and Filters as part of the “Semantic Graph and Evaluation” and “Vocabulary and Mapping” clusters, explicitly tying them to static vocab tables and selected runtime probes; `book/graph/mappings/README.md` then describes them as shared IR—the Operation and Filter Vocabulary Maps that tie PolicyGraphs and system profiles to stable IDs; `book/api/carton/README.md` shifts into an API-centric view where Operations and Filters are primarily entries in CARTON coverage and index mappings; legacy sbdis tooling introduces terms like “operation handler” and “filter decision tree” for early formats. Across these, Operations/Filters are consistently about “named behaviors and predicates”, but the story moves from concept cluster → mapping IR → runtime/coverage API → legacy disassembler language without explicitly flagging the level each description is working at.
- **PolicyGraph / compiled profile** — The concept inventory and mappings README present PolicyGraphs and compiled profiles as a strong static-format cluster with bedrock-oriented evidence (tag layouts, op-table, system profile digests). The decoder docs under `book/api/profile_tools/README.md` and `book/api/profile_tools/decoder.py` adopt a more cautious, heuristic stance, emphasizing tag-aware snapshots and unknown tags with fallback strides. The `sbdis` README describes an older “decision tree” layout focused on filter opcodes and result bits. These narratives all point at the same underlying compiled artifacts but tell different stories: one emphasizes structural bedrock, one emphasizes partial/heuristic decoding, and one uses a legacy mental model. Readers need to track which profile format and evidence tier each description refers to.
- **Profile layer / stack** — Profile layers appear in the concept inventory as part of the “Runtime Lifecycle and Extension” cluster with status explicitly marked as partial/blocked; CARTON’s README and API present profile layers through `profile_layer_index.json`, which, today, mostly distinguishes “system” profiles and links them to operations and runtime signatures; the textbook outline (Chapter 4) and TextEdit notes talk about stacking platform, app, helper, and extension profiles more narratively without reusing the status vocabulary. The concept across these is consistent (“policy arrives in layers”), but the precision and validation emphasis vary by region.
- **CARTON** — The root README describes CARTON as an intermediate representation between artifacts, concepts, and code; `book/graph/README.md` positions it downstream of validation and mappings as the frozen IR/mapping set for this host; `book/api/carton/README.md` and `API.md` focus on the manifest (`CARTON.json`), hash checking, and concrete helper functions like `operation_story`. The same object is being described as “IR web,” “promotion target,” and “API surface,” with different audiences in mind. None of these disagree, but they use different metaphors and emphasis.
- **Evidence tiers / bedrock** — Root-level AGENTS and `book/evidence/graph/concepts/CONCEPT_INVENTORY.md` explicitly talk about bedrock/mapped/hypothesis evidence tiers and record the current bedrock surfaces for this world. Many mapping JSONs carry `status`-like health/progress fields (for example `ok|partial|brittle|blocked`) and provenance metadata, and validation outputs encode `status` in normalization files. By contrast, some API docs (for example, the decoder README) talk about being “heuristic” without explicitly mapping that language back to the tier model, and older examples like `sbdis` do not reference the project-wide tier vocabulary at all. The result is that tier language is prominent in concept/validation/mapping layers but more implicit in examples and some tools.
- **world_id / baseline** — The world baseline is described formally in `book/world/README.md` and `world.json` files, where `world_id` is derived from the dyld manifest hash and treated as immutable once established. Other regions (experiments, CARTON docs, `book/AGENTS.md`) reference `world_id sonoma-14.4.1-23E224-arm64-dyld-2c0602c5` as a short-hand for “this host,” and some example READMEs simply mention the world_id in passing. The core idea—a single, fixed world—is stable, but the level of detail about how that world_id is constructed varies from “fully specified derivation” to “opaque identifier embedded in text.”

## Comment and Test Coverage Notes

This section inventories places where code appears to be doing non-trivial work with relatively little commentary, and how tests/fixtures are distributed around those regions. The intent is to point out where context lives primarily in external docs or tests rather than in the code files themselves.

- **Comment-thin regions (non-tests)** — Several files combine orchestrating or mapping behavior with almost no docstrings or inline commentary. Examples include `book/api/profile_tools/op_table.py` (op-table parsing and alignment helpers), `book/api/profile_tools/cli.py` (unified profile tooling CLI), `book/api/carton/carton_query.py` (CARTON query helpers), and `book/api/regex_tools/__init__.py` / `book/api/ghidra/__init__.py` (wrappers around more complex tooling). On the graph side, `book/graph/mappings/run_promotion.py`, `book/graph/concepts/validation/tasks.py`, the various `*_experiment_job.py` modules, and `book/graph/mappings/system_profiles/generate_attestations.py` coordinate validation jobs and mapping generation but rely heavily on naming and external READMEs rather than in-file commentary. Experiments such as `book/evidence/experiments/op-table-operation/analyze.py` and `book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/run_adversarial.py`, and the TextEdit helper scripts under `book/profiles/textedit/tools/`, also have low comment density despite performing multi-step analysis. In all of these, behavior is inferable from function and variable names, but a reader often has to cross-reference AGENTS/README/mapping docs to understand intent, inputs, and expected outputs.
- **Coverage clusters** — The project’s heaviest testing investment sits in `book/tests/`. That suite exercises CARTON indices and coverage mappings, vocab and op-table JSONs, system profile digests and tag layouts, runtime expectations/signatures, experiment artifacts (for example, `runtime-adversarial`, `kernel-symbols`, `entitlement-diff`), and core APIs like the decoder and profile_tools op-table/compile surfaces, plus the Ghidra scaffold. Validation fixtures under `book/evidence/graph/concepts/validation/fixtures/` and normalized outputs under `book/evidence/graph/concepts/validation/out/` act as additional guardrails: their shapes and contents are referenced directly by tests and by mapping generators. `book/profiles/golden-triple` is also heavily referenced as a golden source of profiles and runtime results.
- **Coverage deserts** — Some regions that are conceptually central have little or no direct test coverage visible in `book/tests/`. Narrative/text regions under `book/chapters/` and the TextEdit notes/output markdowns are not directly exercised; they instead rely on their referenced artifacts being correct. Several experiments (`bedrock-followups`, `sandbox-init-params`, `symbol-search`, `tag-layout-decode`) appear only indirectly in tests via generic checks in `test_experiments.py`, not via dedicated, per-experiment assertions. API subdirectories other than `golden_runner` do not have local tests next to their code and rely on the central test suite for coverage. World baselines and CI stamp files (`book/world/*/world.json`, `book/out/ci-stamps/*`) also lack obvious test coverage beyond being consumed by other tools. None of this is necessarily problematic, but it shows where automated guardrails are currently sparse.

## Future Attention Targets (optional)

If future work focuses on reducing entropy or aligning patterns rather than adding new capabilities, the following regions look like relatively “high-variance” areas:

- High-entropy or mixed-role areas under `book/graph/.build/`, `book/graph/book/`, and mapping folders that co-locate generators with canonical JSONs. These are structurally dense and contain multiple copies or layers of similar-looking artifacts.
- Experiments with minimal scaffolding, such as `bedrock-followups`, `sandbox-init-params`, and `symbol-search`, and the currently empty `book/profiles/textedit/traces/` directory, which all read as “hooks” for future evidence or narrative that have not yet been filled in.
- Repeated `out/` usage across unrelated regions (experiments, validation, chapter outputs, CI) where the same directory name encodes different roles; any future attempts to standardize or clarify “what out/ means” would likely start by mapping these current usages.
