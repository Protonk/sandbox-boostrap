{"world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5", "profile_id": "hardened:signal_self_allow", "scenario_id": "hardened:signal_self_allow:signal-same-sandbox", "run_id": "62456e46-0901-4345-b02d-f96becc33310", "expectation_id": "hardened:signal_self_allow:signal-same-sandbox", "operation": "signal", "target": "same-sandbox", "probe_name": "signal-same-sandbox", "expected": "allow", "actual": "allow", "match": true, "runtime_status": "success", "apply_report": {"api": "sandbox_init", "err_class": "ok", "err_class_source": "none", "errbuf": null, "errno": 0, "rc": 0}, "preflight": {"classification": "no_known_apply_gate_signature", "findings": [], "input_kind": "sbpl_path", "input_ref": "book/evidence/experiments/runtime-final-final/suites/hardened-runtime/out/62456e46-0901-4345-b02d-f96becc33310/runtime_profiles/signal_self_allow.hardened_signal_self_allow.runtime.sb", "preflight_schema_version": 1, "signature": null, "tool": "book/tools/preflight", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "runner_info": {"apply_model": "exec_wrapper", "apply_timing": "pre_exec", "entrypoint": "sandbox_runner", "entrypoint_path": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/sandbox_runner", "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e", "preexisting_sandbox_suspected": false, "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"}, "probe_details": {"child_exit_code": 0, "child_pid": 21382, "child_received_signal": true, "child_spawn_method": "subprocess.Popen", "child_status": "exited", "handshake_ok": true, "probe_schema_version": "hardened-runtime.signal-probe.v0.2", "signal_sent": true}, "command": ["book/evidence/experiments/runtime-final-final/suites/runtime-checks/sandbox_runner", "book/evidence/experiments/runtime-final-final/suites/hardened-runtime/out/62456e46-0901-4345-b02d-f96becc33310/runtime_profiles/signal_self_allow.hardened_signal_self_allow.runtime.sb", "--", "/usr/bin/python3", "-c", "import json, os, signal, subprocess, sys\nready_r, ready_w = os.pipe()\nresult_r, result_w = os.pipe()\nchild_env = os.environ.copy()\nchild_env['SBL_READY_FD'] = str(ready_w)\nchild_env['SBL_RESULT_FD'] = str(result_w)\nchild_code = (\n    \"import os, signal, sys\\n\"\n    \"ready_fd = int(os.environ.get('SBL_READY_FD', '-1'))\\n\"\n    \"result_fd = int(os.environ.get('SBL_RESULT_FD', '-1'))\\n\"\n    \"def handler(signum, frame):\\n\"\n    \"    try: os.write(result_fd, b'signal')\\n\"\n    \"    except Exception: pass\\n\"\n    \"    sys.exit(0)\\n\"\n    \"signal.signal(signal.SIGUSR1, handler)\\n\"\n    \"try: os.write(ready_fd, b'ready')\\n\"\n    \"except Exception: pass\\n\"\n    \"signal.pause()\\n\"\n    \"sys.exit(2)\\n\"\n)\nchild = subprocess.Popen([sys.executable, '-c', child_code], pass_fds=(ready_w, result_w), env=child_env)\nos.close(ready_w)\nos.close(result_w)\ndetails = {\n    'probe_schema_version': 'hardened-runtime.signal-probe.v0.2',\n    'child_pid': child.pid,\n    'child_spawn_method': 'subprocess.Popen',\n    'handshake_ok': False,\n    'signal_sent': False,\n    'child_received_signal': False,\n}\ntry:\n    data = os.read(ready_r, 5)\n    details['handshake_ok'] = data == b'ready'\nexcept Exception as exc:\n    details['handshake_error'] = str(exc)\nif details['handshake_ok']:\n    try:\n        os.kill(child.pid, signal.SIGUSR1)\n        details['signal_sent'] = True\n    except Exception as exc:\n        details['signal_error'] = str(exc)\ntry:\n    import select\n    rlist, _, _ = select.select([result_r], [], [], 1.0)\n    if rlist:\n        data = os.read(result_r, 16)\n        if data.startswith(b'signal'):\n            details['child_received_signal'] = True\nexcept Exception as exc:\n    details['result_error'] = str(exc)\ntry:\n    child.wait(timeout=1.0)\n    details['child_exit_code'] = child.returncode\n    details['child_status'] = 'exited'\nexcept Exception:\n    child.kill()\n    child.wait()\n    details['child_exit_code'] = child.returncode\n    details['child_status'] = 'killed'\nprint('SBL_PROBE_DETAILS ' + json.dumps(details))\nsys.exit(0 if details['signal_sent'] and details['child_received_signal'] else 1)\n"], "stdout": "", "stderr": ""}
