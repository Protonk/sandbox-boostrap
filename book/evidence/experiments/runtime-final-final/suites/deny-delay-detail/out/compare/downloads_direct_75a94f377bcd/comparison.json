{
  "action_id": "downloads_direct_75a94f377bcd",
  "limits": [
    "entitlements: PolicyWitness XPC run (observer-only deny evidence)",
    "sbpl: wrapper apply failures are apply-stage gates, not policy decisions",
    "none: unsandboxed baseline (no policy apply)"
  ],
  "results": {
    "entitlements": {
      "bundle": null,
      "capture_sandbox_logs": false,
      "command": [
        "book/tools/witness/PolicyWitness.app/Contents/MacOS/policy-witness",
        "xpc",
        "run",
        "--profile",
        "minimal",
        "--plan-id",
        "deny-delay-detail:compare:75a94f37-7bcd-4b2b-8cf1-315c8a41c849",
        "--row-id",
        "entitlements.fs_op_create_direct",
        "fs_op",
        "--op",
        "create",
        "--path",
        "/Users/achyland/Downloads/atlas_compare_75a94f377bcd.txt",
        "--allow-unsafe-path"
      ],
      "correlation_id": null,
      "duration_s": 0.015454769134521484,
      "entrypoint": "book/tools/witness/PolicyWitness.app/Contents/MacOS/policy-witness",
      "exit_code": 1,
      "finished_at_unix_s": 1767246721.5794969,
      "lifecycle": {
        "correlation_id": null,
        "file_path": null,
        "plan_id": "deny-delay-detail:compare:75a94f37-7bcd-4b2b-8cf1-315c8a41c849",
        "process_name": null,
        "profile_id": "minimal",
        "row_id": "entitlements.fs_op_create_direct",
        "service_id": null,
        "service_pid": null,
        "tmp_dir": null
      },
      "log_path": "book/evidence/experiments/deny-delay-detail/out/compare/downloads_direct_75a94f377bcd/logs/downloads_direct_75a94f377bcd.entitlements.json",
      "log_write_error": null,
      "observer": {
        "skipped": "missing_pid_or_process_name"
      },
      "observer_log_path": "book/evidence/experiments/deny-delay-detail/out/compare/downloads_direct_75a94f377bcd/logs/observer/downloads_direct_75a94f377bcd.entitlements.json.observer.json",
      "observer_status": "skipped:missing_pid_or_process_name",
      "plan_id": "deny-delay-detail:compare:75a94f37-7bcd-4b2b-8cf1-315c8a41c849",
      "probe_args": [
        "--op",
        "create",
        "--path",
        "/Users/achyland/Downloads/atlas_compare_75a94f377bcd.txt",
        "--allow-unsafe-path"
      ],
      "probe_error": null,
      "probe_id": "fs_op",
      "probe_timeout_s": 25.0,
      "profile_id": "minimal",
      "record_write_error": null,
      "row_id": "entitlements.fs_op_create_direct",
      "runner_info": {
        "entrypoint": "policy-witness",
        "entrypoint_path": "book/tools/witness/PolicyWitness.app/Contents/MacOS/policy-witness",
        "entrypoint_sha256": "70932a56ecb32fc5e87b70ee3c144c200c3377d2bbdc288739ea385177aa4b24",
        "tool_build_id": "70932a56ecb32fc5e87b70ee3c144c200c3377d2bbdc288739ea385177aa4b24"
      },
      "service_id": null,
      "started_at_unix_s": 1767246721.564042,
      "stderr": "",
      "stdout": "{\"data\":{\"details\":{\"service_bundle_id\":\"com.yourteam.policy-witness.ProbeService_minimal\"},\"error\":\"xpc error: Error Domain=NSCocoaErrorDomain Code=4099 \\\"The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.\\\" UserInfo={NSDebugDescription=The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.}\",\"layer_attribution\":{\"other\":\"xpc:openSession_failed\"},\"normalized_outcome\":\"xpc_error\",\"rc\":1,\"schema_version\":1,\"stderr\":\"xpc error: Error Domain=NSCocoaErrorDomain Code=4099 \\\"The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.\\\" UserInfo={NSDebugDescription=The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.}\",\"stdout\":\"\"},\"generated_at_unix_ms\":1767246721574,\"kind\":\"probe_response\",\"result\":{\"error\":\"xpc error: Error Domain=NSCocoaErrorDomain Code=4099 \\\"The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.\\\" UserInfo={NSDebugDescription=The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.}\",\"exit_code\":1,\"normalized_outcome\":\"xpc_error\",\"ok\":false,\"rc\":1,\"stderr\":\"xpc error: Error Domain=NSCocoaErrorDomain Code=4099 \\\"The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.\\\" UserInfo={NSDebugDescription=The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.}\"},\"schema_version\":1}\n",
      "stdout_json": {
        "data": {
          "details": {
            "service_bundle_id": "com.yourteam.policy-witness.ProbeService_minimal"
          },
          "error": "xpc error: Error Domain=NSCocoaErrorDomain Code=4099 \"The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.\" UserInfo={NSDebugDescription=The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.}",
          "layer_attribution": {
            "other": "xpc:openSession_failed"
          },
          "normalized_outcome": "xpc_error",
          "rc": 1,
          "schema_version": 1,
          "stderr": "xpc error: Error Domain=NSCocoaErrorDomain Code=4099 \"The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.\" UserInfo={NSDebugDescription=The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.}",
          "stdout": ""
        },
        "generated_at_unix_ms": 1767246721574,
        "kind": "probe_response",
        "result": {
          "error": "xpc error: Error Domain=NSCocoaErrorDomain Code=4099 \"The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.\" UserInfo={NSDebugDescription=The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.}",
          "exit_code": 1,
          "normalized_outcome": "xpc_error",
          "ok": false,
          "rc": 1,
          "stderr": "xpc error: Error Domain=NSCocoaErrorDomain Code=4099 \"The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.\" UserInfo={NSDebugDescription=The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.}"
        },
        "schema_version": 1
      },
      "stdout_json_error": null,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"
    },
    "none": {
      "command": [
        "/bin/sh",
        "-c",
        "echo test > \"$HOME/Downloads/atlas_compare_75a94f377bcd.txt\"; rm -f \"$HOME/Downloads/atlas_compare_75a94f377bcd.txt\""
      ],
      "duration_s": 0.0062711238861083984,
      "error": null,
      "exit_code": 0,
      "finished_at_unix_s": 1767246721.699021,
      "preflight": null,
      "runner_info": null,
      "started_at_unix_s": 1767246721.69275,
      "stderr": "/bin/sh: /Users/achyland/Downloads/atlas_compare_75a94f377bcd.txt: Operation not permitted\n",
      "stdout": "",
      "tool_markers": null
    },
    "sbpl": {
      "command": [
        "book/tools/sbpl/wrapper/wrapper",
        "--preflight",
        "enforce",
        "--sbpl",
        "book/evidence/experiments/runtime-final-final/suites/sbpl-graph-runtime/profiles/allow_all.sb",
        "--",
        "/bin/sh",
        "-c",
        "echo test > \"$HOME/Downloads/atlas_compare_75a94f377bcd.txt\"; rm -f \"$HOME/Downloads/atlas_compare_75a94f377bcd.txt\""
      ],
      "duration_s": 0.10227298736572266,
      "error": null,
      "exit_code": 1,
      "finished_at_unix_s": 1767246721.684062,
      "preflight": {
        "apply_marker_pid": 57309,
        "apply_ok": false,
        "apply_report": {
          "api": "sandbox_init",
          "err_class": "errno_eperm",
          "err_class_source": "errno_only",
          "errbuf": "Operation not permitted",
          "errno": 1,
          "rc": -1
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_runner",
          "book/evidence/experiments/runtime-final-final/suites/sbpl-graph-runtime/profiles/allow_all.sb",
          "--",
          "/usr/bin/true"
        ],
        "exit_code": 1,
        "failure_stage": "apply",
        "profile": "book/evidence/experiments/runtime-final-final/suites/sbpl-graph-runtime/profiles/allow_all.sb",
        "run_id": null,
        "runner": "book/api/runtime/native/sandbox_runner/sandbox_runner",
        "sandbox_check_self": {
          "error": "libsystem_sandbox not found",
          "source": "sandbox_check"
        },
        "status": "ok",
        "stderr": "sandbox initialization failed: Operation not permitted\nsandbox_init failed: Operation not permitted\n",
        "stdout": "",
        "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"
      },
      "runner_info": {
        "entrypoint": "sbpl-wrapper",
        "entrypoint_path": "book/tools/sbpl/wrapper/wrapper",
        "entrypoint_sha256": "2a4ead954fcceb103a5409d6057ab6803f206a11fc94554638c1b6a2aa065bb3",
        "tool_build_id": "2a4ead954fcceb103a5409d6057ab6803f206a11fc94554638c1b6a2aa065bb3"
      },
      "started_at_unix_s": 1767246721.581789,
      "stderr": "{\"tool\":\"sbpl-preflight\",\"marker_schema_version\":1,\"stage\":\"preflight\",\"mode\":\"sbpl\",\"policy\":\"enforce\",\"profile\":\"/Users/achyland/Desktop/VM-BRIDGE/SANDBOX_LORE/book/evidence/experiments/runtime-final-final/suites/sbpl-graph-runtime/profiles/allow_all.sb\",\"rc\":0,\"record_json\":\"{\\\"classification\\\": \\\"no_known_apply_gate_signature\\\", \\\"findings\\\": [], \\\"input_kind\\\": \\\"sbpl_path\\\", \\\"input_ref\\\": \\\"book/evidence/experiments/runtime-final-final/suites/sbpl-graph-runtime/profiles/allow_all.sb\\\", \\\"preflight_schema_version\\\": 1, \\\"signature\\\": null, \\\"tool\\\": \\\"book/tools/preflight\\\", \\\"world_id\\\": \\\"sonoma-14.4.1-23E224-arm64-dyld-a3a840f9\\\"}\",\"pid\":57307}\n{\"tool\":\"entitlement-check\",\"marker_schema_version\":1,\"stage\":\"pre_apply\",\"entitlement\":\"com.apple.private.security.message-filter\",\"pid\":57307,\"rc\":0,\"present\":false,\"value_type\":\"absent\"}\nsandbox initialization failed: Operation not permitted\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":-1,\"errno\":1,\"errbuf\":\"Operation not permitted\",\"err_class\":\"errno_eperm\",\"err_class_source\":\"errno_only\",\"profile\":\"/Users/achyland/Desktop/VM-BRIDGE/SANDBOX_LORE/book/evidence/experiments/runtime-final-final/suites/sbpl-graph-runtime/profiles/allow_all.sb\",\"pid\":57307}\nsandbox_init failed: Operation not permitted\n",
      "stdout": "",
      "tool_markers": {
        "sbpl_apply": [
          {
            "api": "sandbox_init",
            "err_class": "errno_eperm",
            "err_class_source": "errno_only",
            "errbuf": "Operation not permitted",
            "errno": 1,
            "marker_schema_version": 1,
            "mode": "sbpl",
            "pid": 57307,
            "profile": "/Users/achyland/Desktop/VM-BRIDGE/SANDBOX_LORE/book/evidence/experiments/runtime-final-final/suites/sbpl-graph-runtime/profiles/allow_all.sb",
            "rc": -1,
            "stage": "apply",
            "tool": "sbpl-apply"
          }
        ],
        "sbpl_preflight": [
          {
            "marker_schema_version": 1,
            "mode": "sbpl",
            "pid": 57307,
            "policy": "enforce",
            "profile": "/Users/achyland/Desktop/VM-BRIDGE/SANDBOX_LORE/book/evidence/experiments/runtime-final-final/suites/sbpl-graph-runtime/profiles/allow_all.sb",
            "rc": 0,
            "record_json": "{\"classification\": \"no_known_apply_gate_signature\", \"findings\": [], \"input_kind\": \"sbpl_path\", \"input_ref\": \"book/evidence/experiments/runtime-final-final/suites/sbpl-graph-runtime/profiles/allow_all.sb\", \"preflight_schema_version\": 1, \"signature\": null, \"tool\": \"book/tools/preflight\", \"world_id\": \"sonoma-14.4.1-23E224-arm64-dyld-a3a840f9\"}",
            "stage": "preflight",
            "tool": "sbpl-preflight"
          }
        ]
      }
    }
  },
  "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"
}
