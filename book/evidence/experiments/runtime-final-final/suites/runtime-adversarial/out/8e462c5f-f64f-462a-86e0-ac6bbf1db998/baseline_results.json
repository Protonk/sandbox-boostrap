{
  "schema_version": "runtime-tools.baseline_results.v0.1",
  "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
  "run_id": "8e462c5f-f64f-462a-86e0-ac6bbf1db998",
  "results": [
    {
      "name": "baseline:adv:ipc_posix_shm:allow-shm",
      "profile_id": "adv:ipc_posix_shm",
      "probe_name": "allow-shm",
      "operation": "ipc-posix-shm-write-create",
      "target": "sbl.ipc.shm.allow",
      "primary_intent": {
        "operation": "ipc-posix-shm-write-create",
        "target": "sbl.ipc.shm.allow",
        "profile_id": "adv:ipc_posix_shm",
        "probe_name": "allow-shm"
      },
      "command": [
        "/usr/bin/python3",
        "-c",
        "import ctypes, ctypes.util, json, os, sys\nname = sys.argv[1]\nif not name.startswith('/'):\n    name = '/' + name\ndetails = {'operation': 'ipc-posix-shm-write-create', 'name': name}\ntry:\n    lib_path = ctypes.util.find_library('c')\n    if not lib_path:\n        raise RuntimeError('libc not found')\n    lib = ctypes.CDLL(lib_path, use_errno=True)\n    lib.shm_open.argtypes = [ctypes.c_char_p, ctypes.c_int, ctypes.c_int]\n    lib.shm_open.restype = ctypes.c_int\n    lib.shm_unlink.argtypes = [ctypes.c_char_p]\n    lib.shm_unlink.restype = ctypes.c_int\n    fd = lib.shm_open(name.encode(), os.O_CREAT | os.O_RDWR, 0o600)\n    err = ctypes.get_errno()\n    details['fd'] = int(fd)\n    if fd == -1:\n        details['errno'] = int(err)\n        details['decision'] = 'deny'\n        print('SBL_PROBE_DETAILS ' + json.dumps(details))\n        sys.exit(1)\n    os.close(fd)\n    unlink_rc = lib.shm_unlink(name.encode())\n    if unlink_rc != 0:\n        details['unlink_errno'] = int(ctypes.get_errno())\n    details['decision'] = 'allow'\nexcept Exception as exc:\n    details['decision'] = 'deny'\n    details['error'] = str(exc)\nprint('SBL_PROBE_DETAILS ' + json.dumps(details))\nsys.exit(0 if details.get('decision') == 'allow' else 1)\n",
        "sbl.ipc.shm.allow"
      ],
      "status": "allow",
      "exit_code": 0,
      "stdout": "",
      "stderr": "",
      "reached_primary_op": true,
      "decision_path": "baseline",
      "probe_details": {
        "operation": "ipc-posix-shm-write-create",
        "name": "/sbl.ipc.shm.allow",
        "fd": 3,
        "decision": "allow"
      }
    },
    {
      "name": "baseline:adv:ipc_posix_shm:deny-shm",
      "profile_id": "adv:ipc_posix_shm",
      "probe_name": "deny-shm",
      "operation": "ipc-posix-shm-write-create",
      "target": "sbl.ipc.shm.deny",
      "primary_intent": {
        "operation": "ipc-posix-shm-write-create",
        "target": "sbl.ipc.shm.deny",
        "profile_id": "adv:ipc_posix_shm",
        "probe_name": "deny-shm"
      },
      "command": [
        "/usr/bin/python3",
        "-c",
        "import ctypes, ctypes.util, json, os, sys\nname = sys.argv[1]\nif not name.startswith('/'):\n    name = '/' + name\ndetails = {'operation': 'ipc-posix-shm-write-create', 'name': name}\ntry:\n    lib_path = ctypes.util.find_library('c')\n    if not lib_path:\n        raise RuntimeError('libc not found')\n    lib = ctypes.CDLL(lib_path, use_errno=True)\n    lib.shm_open.argtypes = [ctypes.c_char_p, ctypes.c_int, ctypes.c_int]\n    lib.shm_open.restype = ctypes.c_int\n    lib.shm_unlink.argtypes = [ctypes.c_char_p]\n    lib.shm_unlink.restype = ctypes.c_int\n    fd = lib.shm_open(name.encode(), os.O_CREAT | os.O_RDWR, 0o600)\n    err = ctypes.get_errno()\n    details['fd'] = int(fd)\n    if fd == -1:\n        details['errno'] = int(err)\n        details['decision'] = 'deny'\n        print('SBL_PROBE_DETAILS ' + json.dumps(details))\n        sys.exit(1)\n    os.close(fd)\n    unlink_rc = lib.shm_unlink(name.encode())\n    if unlink_rc != 0:\n        details['unlink_errno'] = int(ctypes.get_errno())\n    details['decision'] = 'allow'\nexcept Exception as exc:\n    details['decision'] = 'deny'\n    details['error'] = str(exc)\nprint('SBL_PROBE_DETAILS ' + json.dumps(details))\nsys.exit(0 if details.get('decision') == 'allow' else 1)\n",
        "sbl.ipc.shm.deny"
      ],
      "status": "allow",
      "exit_code": 0,
      "stdout": "",
      "stderr": "",
      "reached_primary_op": true,
      "decision_path": "baseline",
      "probe_details": {
        "operation": "ipc-posix-shm-write-create",
        "name": "/sbl.ipc.shm.deny",
        "fd": 3,
        "decision": "allow"
      }
    },
    {
      "name": "baseline:adv:authorization_right:allow-right",
      "profile_id": "adv:authorization_right",
      "probe_name": "allow-right",
      "operation": "authorization-right-obtain",
      "target": "system.preferences",
      "primary_intent": {
        "operation": "authorization-right-obtain",
        "target": "system.preferences",
        "profile_id": "adv:authorization_right",
        "probe_name": "allow-right"
      },
      "command": [
        "true"
      ],
      "status": "allow",
      "exit_code": 0,
      "stdout": "",
      "stderr": "",
      "reached_primary_op": true,
      "decision_path": "baseline"
    },
    {
      "name": "baseline:adv:authorization_right:deny-right",
      "profile_id": "adv:authorization_right",
      "probe_name": "deny-right",
      "operation": "authorization-right-obtain",
      "target": "system.preferences.privacy",
      "primary_intent": {
        "operation": "authorization-right-obtain",
        "target": "system.preferences.privacy",
        "profile_id": "adv:authorization_right",
        "probe_name": "deny-right"
      },
      "command": [
        "true"
      ],
      "status": "allow",
      "exit_code": 0,
      "stdout": "",
      "stderr": "",
      "reached_primary_op": true,
      "decision_path": "baseline"
    },
    {
      "name": "baseline:adv:preference_domain:allow-domain",
      "profile_id": "adv:preference_domain",
      "probe_name": "allow-domain",
      "operation": "user-preference-read",
      "target": "com.apple.TimeMachine",
      "primary_intent": {
        "operation": "user-preference-read",
        "target": "com.apple.TimeMachine",
        "profile_id": "adv:preference_domain",
        "probe_name": "allow-domain"
      },
      "command": [
        "true"
      ],
      "status": "allow",
      "exit_code": 0,
      "stdout": "",
      "stderr": "",
      "reached_primary_op": true,
      "decision_path": "baseline"
    },
    {
      "name": "baseline:adv:preference_domain:deny-domain",
      "profile_id": "adv:preference_domain",
      "probe_name": "deny-domain",
      "operation": "user-preference-read",
      "target": "com.apple.sandboxadversarial.fake",
      "primary_intent": {
        "operation": "user-preference-read",
        "target": "com.apple.sandboxadversarial.fake",
        "profile_id": "adv:preference_domain",
        "probe_name": "deny-domain"
      },
      "command": [
        "true"
      ],
      "status": "allow",
      "exit_code": 0,
      "stdout": "",
      "stderr": "",
      "reached_primary_op": true,
      "decision_path": "baseline"
    },
    {
      "name": "baseline:adv:xpc_service_name:allow-cfprefsd-xpc",
      "profile_id": "adv:xpc_service_name",
      "probe_name": "allow-cfprefsd-xpc",
      "operation": "mach-lookup",
      "target": "com.apple.cfprefsd.xpc",
      "primary_intent": {
        "operation": "mach-lookup",
        "target": "com.apple.cfprefsd.xpc",
        "profile_id": "adv:xpc_service_name",
        "probe_name": "allow-cfprefsd-xpc"
      },
      "command": [
        "book/api/runtime/native/probes/mach_probe",
        "com.apple.cfprefsd.xpc"
      ],
      "status": "deny",
      "exit_code": 1,
      "stdout": "{\"kr\":1102}\n",
      "stderr": "",
      "reached_primary_op": true,
      "decision_path": "baseline",
      "probe_details": {
        "operation": "mach-lookup",
        "kr": 1102,
        "service_present": false
      }
    },
    {
      "name": "baseline:adv:xpc_service_name:deny-bogus-xpc",
      "profile_id": "adv:xpc_service_name",
      "probe_name": "deny-bogus-xpc",
      "operation": "mach-lookup",
      "target": "com.apple.sandboxadversarial.fake.xpc",
      "primary_intent": {
        "operation": "mach-lookup",
        "target": "com.apple.sandboxadversarial.fake.xpc",
        "profile_id": "adv:xpc_service_name",
        "probe_name": "deny-bogus-xpc"
      },
      "command": [
        "book/api/runtime/native/probes/mach_probe",
        "com.apple.sandboxadversarial.fake.xpc"
      ],
      "status": "deny",
      "exit_code": 1,
      "stdout": "{\"kr\":1102}\n",
      "stderr": "",
      "reached_primary_op": true,
      "decision_path": "baseline",
      "probe_details": {
        "operation": "mach-lookup",
        "kr": 1102,
        "service_present": false
      }
    }
  ]
}