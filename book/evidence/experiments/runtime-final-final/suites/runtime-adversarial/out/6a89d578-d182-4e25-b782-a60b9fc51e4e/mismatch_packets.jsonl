{"baseline": {"command": ["/bin/cat", "/tmp/runtime-adv/edges/a"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:adv:path_edges:allow-tmp", "observed_path": "/private/tmp/runtime-adv/edges/a", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "allow-tmp", "profile_id": "adv:path_edges", "target": "/tmp/runtime-adv/edges/a"}, "probe_name": "allow-tmp", "profile_id": "adv:path_edges", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "runtime-adv fixture for /tmp/runtime-adv/edges/a\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-che", "target": "/tmp/runtime-adv/edges/a"}, "canonicalization": {"witness": {"lane": "baseline", "normalized_path": "/private/tmp/runtime-adv/edges/a", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/runtime-adv/edges/a", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/runtime-adv/edges/a", "scenario_id": "baseline:adv:path_edges:allow-tmp"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/path_witnesses.json"}, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/edges/a", "observed_path": "/private/tmp/runtime-adv/edges/a", "operation": "file-read*", "probe_name": "allow-tmp", "profile_id": "adv:path_edges", "requested_path": "/tmp/runtime-adv/edges/a", "runtime_status": "errno", "scenario_id": "adv:path_edges:allow-tmp", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_events.normalized.json", "target": "/tmp/runtime-adv/edges/a"}, "expectation_id": "adv:path_edges:allow-tmp", "expected": {"expectation_id": "adv:path_edges:allow-tmp", "expected_decision": "allow", "target": "/tmp/runtime-adv/edges/a"}, "mismatch_reason": "canonicalization_boundary", "oracle_check": {"argument": "/tmp/runtime-adv/edges/a", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.6a89d578-d182-4e25-b782-a60b9fc51e4e", "run_id": "6a89d578-d182-4e25-b782-a60b9fc51e4e", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/tmp/runtime-adv/edges/okdir/item.txt"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:adv:path_edges:allow-subpath", "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "allow-subpath", "profile_id": "adv:path_edges", "target": "/tmp/runtime-adv/edges/okdir/item.txt"}, "probe_name": "allow-subpath", "profile_id": "adv:path_edges", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "runtime-adv fixture for /tmp/runtime-adv/edges/okdir/item.txt\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-chec", "target": "/tmp/runtime-adv/edges/okdir/item.txt"}, "canonicalization": {"witness": {"lane": "baseline", "normalized_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/runtime-adv/edges/okdir/item.txt", "scenario_id": "baseline:adv:path_edges:allow-subpath"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/path_witnesses.json"}, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "operation": "file-read*", "probe_name": "allow-subpath", "profile_id": "adv:path_edges", "requested_path": "/tmp/runtime-adv/edges/okdir/item.txt", "runtime_status": "errno", "scenario_id": "adv:path_edges:allow-subpath", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_events.normalized.json", "target": "/tmp/runtime-adv/edges/okdir/item.txt"}, "expectation_id": "adv:path_edges:allow-subpath", "expected": {"expectation_id": "adv:path_edges:allow-subpath", "expected_decision": "allow", "target": "/tmp/runtime-adv/edges/okdir/item.txt"}, "mismatch_reason": "canonicalization_boundary", "oracle_check": {"argument": "/tmp/runtime-adv/edges/okdir/item.txt", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.6a89d578-d182-4e25-b782-a60b9fc51e4e", "run_id": "6a89d578-d182-4e25-b782-a60b9fc51e4e", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/tmp/runtime-adv/edges/a'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:adv:path_edges:write-tmp", "observed_path": "/private/tmp/runtime-adv/edges/a", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write-tmp", "profile_id": "adv:path_edges", "target": "/tmp/runtime-adv/edges/a"}, "probe_name": "write-tmp", "profile_id": "adv:path_edges", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/tmp/runtime-adv/edges/a"}, "canonicalization": {"witness": {"lane": "baseline", "normalized_path": "/private/tmp/runtime-adv/edges/a", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/runtime-adv/edges/a", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/runtime-adv/edges/a", "scenario_id": "baseline:adv:path_edges:write-tmp"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/path_witnesses.json"}, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/edges/a", "observed_path": "/private/tmp/runtime-adv/edges/a", "operation": "file-write*", "probe_name": "write-tmp", "profile_id": "adv:path_edges", "requested_path": "/tmp/runtime-adv/edges/a", "runtime_status": "errno", "scenario_id": "adv:path_edges:write-tmp", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_events.normalized.json", "target": "/tmp/runtime-adv/edges/a"}, "expectation_id": "adv:path_edges:write-tmp", "expected": {"expectation_id": "adv:path_edges:write-tmp", "expected_decision": "allow", "target": "/tmp/runtime-adv/edges/a"}, "mismatch_reason": "canonicalization_boundary", "oracle_check": {"argument": "/tmp/runtime-adv/edges/a", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.6a89d578-d182-4e25-b782-a60b9fc51e4e", "run_id": "6a89d578-d182-4e25-b782-a60b9fc51e4e", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/tmp/runtime-adv/edges/okdir/item.txt'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:adv:path_edges:write-subpath", "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write-subpath", "profile_id": "adv:path_edges", "target": "/tmp/runtime-adv/edges/okdir/item.txt"}, "probe_name": "write-subpath", "profile_id": "adv:path_edges", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/tmp/runtime-adv/edges/okdir/item.txt"}, "canonicalization": {"witness": {"lane": "baseline", "normalized_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/runtime-adv/edges/okdir/item.txt", "scenario_id": "baseline:adv:path_edges:write-subpath"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/path_witnesses.json"}, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "operation": "file-write*", "probe_name": "write-subpath", "profile_id": "adv:path_edges", "requested_path": "/tmp/runtime-adv/edges/okdir/item.txt", "runtime_status": "errno", "scenario_id": "adv:path_edges:write-subpath", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_events.normalized.json", "target": "/tmp/runtime-adv/edges/okdir/item.txt"}, "expectation_id": "adv:path_edges:write-subpath", "expected": {"expectation_id": "adv:path_edges:write-subpath", "expected_decision": "allow", "target": "/tmp/runtime-adv/edges/okdir/item.txt"}, "mismatch_reason": "canonicalization_boundary", "oracle_check": {"argument": "/tmp/runtime-adv/edges/okdir/item.txt", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.6a89d578-d182-4e25-b782-a60b9fc51e4e", "run_id": "6a89d578-d182-4e25-b782-a60b9fc51e4e", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/usr/bin/xattr", "-p", "user.sandbox_lore", "/private/tmp/foo"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:adv:xattr:allow-foo-read", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read-xattr", "primary_intent": {"operation": "file-read-xattr", "probe_name": "allow-foo-read", "profile_id": "adv:xattr", "target": "/private/tmp/foo"}, "probe_name": "allow-foo-read", "profile_id": "adv:xattr", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "1\n", "target": "/private/tmp/foo"}, "canonicalization": null, "decision_event": {"decision": "deny", "errno": -6, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-read-xattr", "probe_name": "allow-foo-read", "profile_id": "adv:xattr", "requested_path": "/private/tmp/foo", "runtime_status": "errno", "scenario_id": "adv:xattr:allow-foo-read", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_events.normalized.json", "target": "/private/tmp/foo"}, "expectation_id": "adv:xattr:allow-foo-read", "expected": {"expectation_id": "adv:xattr:allow-foo-read", "expected_decision": "allow", "target": "/private/tmp/foo"}, "mismatch_reason": "expectation_too_strong", "oracle_check": {"argument": "/private/tmp/foo", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "preflight"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.6a89d578-d182-4e25-b782-a60b9fc51e4e", "run_id": "6a89d578-d182-4e25-b782-a60b9fc51e4e", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/usr/bin/xattr", "-w", "user.sandbox_lore", "probe", "/private/tmp/foo"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:adv:xattr:allow-foo-write", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write-xattr", "primary_intent": {"operation": "file-write-xattr", "probe_name": "allow-foo-write", "profile_id": "adv:xattr", "target": "/private/tmp/foo"}, "probe_name": "allow-foo-write", "profile_id": "adv:xattr", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/private/tmp/foo"}, "canonicalization": null, "decision_event": {"decision": "deny", "errno": -6, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-write-xattr", "probe_name": "allow-foo-write", "profile_id": "adv:xattr", "requested_path": "/private/tmp/foo", "runtime_status": "errno", "scenario_id": "adv:xattr:allow-foo-write", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_events.normalized.json", "target": "/private/tmp/foo"}, "expectation_id": "adv:xattr:allow-foo-write", "expected": {"expectation_id": "adv:xattr:allow-foo-write", "expected_decision": "allow", "target": "/private/tmp/foo"}, "mismatch_reason": "expectation_too_strong", "oracle_check": {"argument": "/private/tmp/foo", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "preflight"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.6a89d578-d182-4e25-b782-a60b9fc51e4e", "run_id": "6a89d578-d182-4e25-b782-a60b9fc51e4e", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
