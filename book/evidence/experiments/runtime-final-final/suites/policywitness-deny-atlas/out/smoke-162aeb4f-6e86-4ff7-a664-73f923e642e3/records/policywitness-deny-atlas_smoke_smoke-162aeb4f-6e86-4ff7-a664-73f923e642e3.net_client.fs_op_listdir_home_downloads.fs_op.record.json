{
  "bundle": null,
  "capture_sandbox_logs": false,
  "command": [
    "book/tools/witness/PolicyWitness.app/Contents/MacOS/policy-witness",
    "xpc",
    "run",
    "--profile",
    "net_client",
    "--plan-id",
    "policywitness-deny-atlas:smoke:smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3",
    "--row-id",
    "net_client.fs_op_listdir_home_downloads",
    "fs_op",
    "--op",
    "listdir",
    "--path",
    "/Users/achyland/Downloads",
    "--allow-unsafe-path"
  ],
  "correlation_id": null,
  "duration_s": 0.04469013214111328,
  "entrypoint": "book/tools/witness/PolicyWitness.app/Contents/MacOS/policy-witness",
  "exit_code": 1,
  "finished_at_unix_s": 1767228284.3400052,
  "lifecycle": {
    "correlation_id": "4B908B89-A372-41AC-927A-7C9DE0558D6E",
    "file_path": "/Users/achyland/Downloads",
    "plan_id": "policywitness-deny-atlas:smoke:smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3",
    "process_name": "ProbeService_net_client",
    "profile_id": "net_client",
    "row_id": "net_client.fs_op_listdir_home_downloads",
    "service_id": "com.yourteam.policy-witness.ProbeService_net_client",
    "service_pid": "78083",
    "tmp_dir": "/Users/achyland/Library/Containers/com.yourteam.policy-witness.ProbeService_net_client/Data/tmp/"
  },
  "log_path": "book/evidence/experiments/policywitness-deny-atlas/out/smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3/logs/policywitness-deny-atlas_smoke_smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3.net_client.fs_op_listdir_home_downloads.fs_op.json",
  "log_write_error": null,
  "observer": {
    "command": [
      "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
      "--pid",
      "78083",
      "--process-name",
      "ProbeService_net_client",
      "--format",
      "json",
      "--start",
      "2025-12-31 16:44:42",
      "--end",
      "2025-12-31 16:44:46",
      "--plan-id",
      "policywitness-deny-atlas:smoke:smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3",
      "--row-id",
      "net_client.fs_op_listdir_home_downloads",
      "--correlation-id",
      "4B908B89-A372-41AC-927A-7C9DE0558D6E"
    ],
    "correlation_id": "4B908B89-A372-41AC-927A-7C9DE0558D6E",
    "exit_code": 0,
    "last": "10s",
    "log_path": "book/evidence/experiments/policywitness-deny-atlas/out/smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3/logs/observer/policywitness-deny-atlas_smoke_smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3.net_client.fs_op_listdir_home_downloads.fs_op.json.observer.json",
    "log_write_error": null,
    "observer_window_end": "2025-12-31 16:44:46",
    "observer_window_mode": "range",
    "observer_window_pad_s": 2.0,
    "observer_window_start": "2025-12-31 16:44:42",
    "pid": "78083",
    "plan_id": "policywitness-deny-atlas:smoke:smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3",
    "process_name": "ProbeService_net_client",
    "report": {
      "data": {
        "correlation_id": "4B908B89-A372-41AC-927A-7C9DE0558D6E",
        "deny_lines": [
          "2025-12-31 16:44:44.362141-0800  localhost kernel[0]: (Sandbox) Sandbox: ProbeService_net_client(78083) deny(1) file-read-data /Users/achyland/Downloads"
        ],
        "duration_ms": null,
        "end": "2025-12-31 16:44:46",
        "last": null,
        "layer_attribution": {
          "seatbelt": "observer_only"
        },
        "log_error": null,
        "log_rc": 0,
        "log_stderr": "",
        "log_stdout": "Timestamp                       (process)[PID]    \n2025-12-31 16:44:44.362141-0800  localhost kernel[0]: (Sandbox) Sandbox: ProbeService_net_client(78083) deny(1) file-read-data /Users/achyland/Downloads",
        "log_truncated": false,
        "mode": "show",
        "observed_deny": true,
        "observed_lines": 2,
        "observer_schema_version": 1,
        "pid": 78083,
        "plan_id": "policywitness-deny-atlas:smoke:smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3",
        "predicate": "((eventMessage CONTAINS[c] \"Sandbox: ProbeService_net_client(78083)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"78083\")))",
        "process_name": "ProbeService_net_client",
        "row_id": "net_client.fs_op_listdir_home_downloads",
        "start": "2025-12-31 16:44:42",
        "stop_on_pid_exit": false
      },
      "generated_at_unix_ms": 1767228284551,
      "kind": "sandbox_log_observer_report",
      "result": {
        "errno": null,
        "error": null,
        "exit_code": 0,
        "normalized_outcome": null,
        "ok": true,
        "rc": null,
        "stderr": null,
        "stdout": null
      },
      "schema_version": 1
    },
    "report_error": null,
    "row_id": "net_client.fs_op_listdir_home_downloads",
    "stderr": "",
    "stdout_bytes": 1577
  },
  "observer_log_path": "book/evidence/experiments/policywitness-deny-atlas/out/smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3/logs/observer/policywitness-deny-atlas_smoke_smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3.net_client.fs_op_listdir_home_downloads.fs_op.json.observer.json",
  "observer_status": "ok",
  "plan_id": "policywitness-deny-atlas:smoke:smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3",
  "probe_args": [
    "--op",
    "listdir",
    "--path",
    "/Users/achyland/Downloads",
    "--allow-unsafe-path"
  ],
  "probe_error": null,
  "probe_id": "fs_op",
  "probe_timeout_s": 25.0,
  "profile_id": "net_client",
  "record_write_error": null,
  "row_id": "net_client.fs_op_listdir_home_downloads",
  "runner_info": {
    "entrypoint": "policy-witness",
    "entrypoint_path": "book/tools/witness/PolicyWitness.app/Contents/MacOS/policy-witness",
    "entrypoint_sha256": "70932a56ecb32fc5e87b70ee3c144c200c3377d2bbdc288739ea385177aa4b24",
    "tool_build_id": "70932a56ecb32fc5e87b70ee3c144c200c3377d2bbdc288739ea385177aa4b24"
  },
  "service_id": null,
  "started_at_unix_s": 1767228284.295315,
  "stderr": "",
  "stdout": "{\"data\":{\"argv\":[\"--op\",\"listdir\",\"--path\",\"\\/Users\\/achyland\\/Downloads\",\"--allow-unsafe-path\"],\"correlation_id\":\"4B908B89-A372-41AC-927A-7C9DE0558D6E\",\"details\":{\"base_dir\":\"\",\"bundle_id\":\"com.yourteam.policy-witness.ProbeService_net_client\",\"cleanup_mode\":\"default\",\"correlation_id\":\"4B908B89-A372-41AC-927A-7C9DE0558D6E\",\"cwd\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.policy-witness.ProbeService_net_client\\/Data\",\"duration_ms\":\"4\",\"file_path\":\"\\/Users\\/achyland\\/Downloads\",\"harness_dir\":\"\",\"home_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.policy-witness.ProbeService_net_client\\/Data\",\"op\":\"listdir\",\"path_class\":\"\",\"path_mode\":\"direct_path\",\"pid\":\"78083\",\"probe_family\":\"fs_op\",\"probe_pid\":\"78083\",\"process_name\":\"ProbeService_net_client\",\"run_dir\":\"\",\"service_pid\":\"78083\",\"session_token\":\"2D07206A-7513-400F-9E1E-F320F7687A9D\",\"target\":\"base\",\"tmp_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.policy-witness.ProbeService_net_client\\/Data\\/tmp\\/\"},\"ended_at_iso8601\":\"2026-01-01T00:44:44.335Z\",\"errno\":1,\"error\":\"Error Domain=NSCocoaErrorDomain Code=257 \\\"The file “Downloads” couldn’t be opened because you don’t have permission to view it.\\\" UserInfo={NSUserStringVariant=(\\n    Folder\\n), NSURL=file:\\/\\/\\/Users\\/achyland\\/Downloads, NSFilePath=\\/Users\\/achyland\\/Downloads, NSUnderlyingError=0x600003320870 {Error Domain=NSPOSIXErrorDomain Code=1 \\\"Operation not permitted\\\"}}\",\"normalized_outcome\":\"permission_error\",\"plan_id\":\"policywitness-deny-atlas:smoke:smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3\",\"probe_id\":\"fs_op\",\"rc\":1,\"row_id\":\"net_client.fs_op_listdir_home_downloads\",\"schema_version\":1,\"service_build\":\"2\",\"service_bundle_id\":\"com.yourteam.policy-witness.ProbeService_net_client\",\"service_name\":\"ProbeService_net_client\",\"service_version\":\"2.0.0\",\"started_at_iso8601\":\"2026-01-01T00:44:44.331Z\",\"stderr\":\"\",\"stdout\":\"\",\"thread_id\":\"4099\"},\"generated_at_unix_ms\":1767228284337,\"kind\":\"probe_response\",\"result\":{\"errno\":1,\"error\":\"Error Domain=NSCocoaErrorDomain Code=257 \\\"The file “Downloads” couldn’t be opened because you don’t have permission to view it.\\\" UserInfo={NSUserStringVariant=(\\n    Folder\\n), NSURL=file:\\/\\/\\/Users\\/achyland\\/Downloads, NSFilePath=\\/Users\\/achyland\\/Downloads, NSUnderlyingError=0x600003320870 {Error Domain=NSPOSIXErrorDomain Code=1 \\\"Operation not permitted\\\"}}\",\"exit_code\":1,\"normalized_outcome\":\"permission_error\",\"ok\":false,\"rc\":1},\"schema_version\":1}\n",
  "stdout_json": {
    "data": {
      "argv": [
        "--op",
        "listdir",
        "--path",
        "/Users/achyland/Downloads",
        "--allow-unsafe-path"
      ],
      "correlation_id": "4B908B89-A372-41AC-927A-7C9DE0558D6E",
      "details": {
        "base_dir": "",
        "bundle_id": "com.yourteam.policy-witness.ProbeService_net_client",
        "cleanup_mode": "default",
        "correlation_id": "4B908B89-A372-41AC-927A-7C9DE0558D6E",
        "cwd": "/Users/achyland/Library/Containers/com.yourteam.policy-witness.ProbeService_net_client/Data",
        "duration_ms": "4",
        "file_path": "/Users/achyland/Downloads",
        "harness_dir": "",
        "home_dir": "/Users/achyland/Library/Containers/com.yourteam.policy-witness.ProbeService_net_client/Data",
        "op": "listdir",
        "path_class": "",
        "path_mode": "direct_path",
        "pid": "78083",
        "probe_family": "fs_op",
        "probe_pid": "78083",
        "process_name": "ProbeService_net_client",
        "run_dir": "",
        "service_pid": "78083",
        "session_token": "2D07206A-7513-400F-9E1E-F320F7687A9D",
        "target": "base",
        "tmp_dir": "/Users/achyland/Library/Containers/com.yourteam.policy-witness.ProbeService_net_client/Data/tmp/"
      },
      "ended_at_iso8601": "2026-01-01T00:44:44.335Z",
      "errno": 1,
      "error": "Error Domain=NSCocoaErrorDomain Code=257 \"The file “Downloads” couldn’t be opened because you don’t have permission to view it.\" UserInfo={NSUserStringVariant=(\n    Folder\n), NSURL=file:///Users/achyland/Downloads, NSFilePath=/Users/achyland/Downloads, NSUnderlyingError=0x600003320870 {Error Domain=NSPOSIXErrorDomain Code=1 \"Operation not permitted\"}}",
      "normalized_outcome": "permission_error",
      "plan_id": "policywitness-deny-atlas:smoke:smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3",
      "probe_id": "fs_op",
      "rc": 1,
      "row_id": "net_client.fs_op_listdir_home_downloads",
      "schema_version": 1,
      "service_build": "2",
      "service_bundle_id": "com.yourteam.policy-witness.ProbeService_net_client",
      "service_name": "ProbeService_net_client",
      "service_version": "2.0.0",
      "started_at_iso8601": "2026-01-01T00:44:44.331Z",
      "stderr": "",
      "stdout": "",
      "thread_id": "4099"
    },
    "generated_at_unix_ms": 1767228284337,
    "kind": "probe_response",
    "result": {
      "errno": 1,
      "error": "Error Domain=NSCocoaErrorDomain Code=257 \"The file “Downloads” couldn’t be opened because you don’t have permission to view it.\" UserInfo={NSUserStringVariant=(\n    Folder\n), NSURL=file:///Users/achyland/Downloads, NSFilePath=/Users/achyland/Downloads, NSUnderlyingError=0x600003320870 {Error Domain=NSPOSIXErrorDomain Code=1 \"Operation not permitted\"}}",
      "exit_code": 1,
      "normalized_outcome": "permission_error",
      "ok": false,
      "rc": 1
    },
    "schema_version": 1
  },
  "stdout_json_error": null,
  "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"
}
