{"baseline": {"command": ["/bin/cat", "/etc/hosts"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:bucket4:v1_read:read_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/etc/hosts", "profile_id": "bucket4:v1_read", "target": "/etc/hosts"}, "probe_name": "read_/etc/hosts", "profile_id": "bucket4:v1_read", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1          ", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_/etc/hosts", "profile_id": "bucket4:v1_read", "requested_path": "/etc/hosts", "runtime_status": "errno", "scenario_id": "bucket4:v1_read:read_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "bucket4:v1_read:read_/etc/hosts", "expected": {"expectation_id": "bucket4:v1_read:read_/etc/hosts", "expected_decision": "allow", "target": "/etc/hosts"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/etc/hosts'"], "decision_path": "baseline", "exit_code": 1, "name": "baseline:bucket4:v1_read:write_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/etc/hosts", "profile_id": "bucket4:v1_read", "target": "/etc/hosts"}, "probe_name": "write_/etc/hosts", "profile_id": "bucket4:v1_read", "reached_primary_op": true, "status": "deny", "stderr": "/bin/sh: /etc/hosts: Operation not permitted\n", "stdout": "", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-write*", "policy_layers": {"attribution": "platform_policy", "effective_decision": "deny", "platform_policy": {"decision": "deny", "error": null, "exit_code": 1, "source": "baseline", "status": "deny"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "write_/etc/hosts", "profile_id": "bucket4:v1_read", "requested_path": "/etc/hosts", "runtime_status": "errno", "scenario_id": "bucket4:v1_read:write_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "bucket4:v1_read:write_/etc/hosts", "expected": {"expectation_id": "bucket4:v1_read:write_/etc/hosts", "expected_decision": "deny", "target": "/etc/hosts"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/tmp/foo"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:bucket4:v1_read:read_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/tmp/foo", "profile_id": "bucket4:v1_read", "target": "/tmp/foo"}, "probe_name": "read_/tmp/foo", "profile_id": "bucket4:v1_read", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "runtime-checks foo\n", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:bucket4:v1_read:read_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_/tmp/foo", "profile_id": "bucket4:v1_read", "requested_path": "/tmp/foo", "runtime_status": "errno", "scenario_id": "bucket4:v1_read:read_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "bucket4:v1_read:read_/tmp/foo", "expected": {"expectation_id": "bucket4:v1_read:read_/tmp/foo", "expected_decision": "allow", "target": "/tmp/foo"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/tmp/foo"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:bucket5:v11_read_subpath:read_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/tmp/foo", "profile_id": "bucket5:v11_read_subpath", "target": "/tmp/foo"}, "probe_name": "read_/tmp/foo", "profile_id": "bucket5:v11_read_subpath", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "runtime-checks foo\n", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:bucket5:v11_read_subpath:read_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_/tmp/foo", "profile_id": "bucket5:v11_read_subpath", "requested_path": "/tmp/foo", "runtime_status": "errno", "scenario_id": "bucket5:v11_read_subpath:read_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "bucket5:v11_read_subpath:read_/tmp/foo", "expected": {"expectation_id": "bucket5:v11_read_subpath:read_/tmp/foo", "expected_decision": "allow", "target": "/tmp/foo"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/tmp/bar"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:bucket5:v11_read_subpath:read_/tmp/bar", "observed_path": "/private/tmp/bar", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/tmp/bar", "profile_id": "bucket5:v11_read_subpath", "target": "/tmp/bar"}, "probe_name": "read_/tmp/bar", "profile_id": "bucket5:v11_read_subpath", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "runtime-checks bar\n", "target": "/tmp/bar"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/bar", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/bar", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/bar", "scenario_id": "baseline:bucket5:v11_read_subpath:read_/tmp/bar"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/bar", "observed_path": "/private/tmp/bar", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_/tmp/bar", "profile_id": "bucket5:v11_read_subpath", "requested_path": "/tmp/bar", "runtime_status": "errno", "scenario_id": "bucket5:v11_read_subpath:read_/tmp/bar", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/bar"}, "expectation_id": "bucket5:v11_read_subpath:read_/tmp/bar", "expected": {"expectation_id": "bucket5:v11_read_subpath:read_/tmp/bar", "expected_decision": "deny", "target": "/tmp/bar"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/tmp/foo'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:bucket5:v11_read_subpath:write_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/tmp/foo", "profile_id": "bucket5:v11_read_subpath", "target": "/tmp/foo"}, "probe_name": "write_/tmp/foo", "profile_id": "bucket5:v11_read_subpath", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:bucket5:v11_read_subpath:write_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-write*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "write_/tmp/foo", "profile_id": "bucket5:v11_read_subpath", "requested_path": "/tmp/foo", "runtime_status": "errno", "scenario_id": "bucket5:v11_read_subpath:write_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "bucket5:v11_read_subpath:write_/tmp/foo", "expected": {"expectation_id": "bucket5:v11_read_subpath:write_/tmp/foo", "expected_decision": "deny", "target": "/tmp/foo"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/etc/hosts"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:runtime:allow_all:read_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/etc/hosts", "profile_id": "runtime:allow_all", "target": "/etc/hosts"}, "probe_name": "read_/etc/hosts", "profile_id": "runtime:allow_all", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1          ", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_apply_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_apply_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_/etc/hosts", "profile_id": "runtime:allow_all", "requested_path": "/etc/hosts", "runtime_status": "errno", "scenario_id": "allow_all|file-read*|/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "allow_all|file-read*|/etc/hosts", "expected": {"expectation_id": "allow_all|file-read*|/etc/hosts", "expected_decision": "allow", "target": "/etc/hosts"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/tmp/sbpl_rt/read.txt"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:runtime:allow_all:read_/tmp/sbpl_rt/read.txt", "observed_path": "/private/tmp/sbpl_rt/read.txt", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/tmp/sbpl_rt/read.txt", "profile_id": "runtime:allow_all", "target": "/tmp/sbpl_rt/read.txt"}, "probe_name": "read_/tmp/sbpl_rt/read.txt", "profile_id": "runtime:allow_all", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "runtime-checks read\n", "target": "/tmp/sbpl_rt/read.txt"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/sbpl_rt/read.txt", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/sbpl_rt/read.txt", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/sbpl_rt/read.txt", "scenario_id": "baseline:runtime:allow_all:read_/tmp/sbpl_rt/read.txt"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_apply_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/sbpl_rt/read.txt", "observed_path": "/private/tmp/sbpl_rt/read.txt", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_apply_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_/tmp/sbpl_rt/read.txt", "profile_id": "runtime:allow_all", "requested_path": "/tmp/sbpl_rt/read.txt", "runtime_status": "errno", "scenario_id": "allow_all|file-read*|/tmp/sbpl_rt/read.txt", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/sbpl_rt/read.txt"}, "expectation_id": "allow_all|file-read*|/tmp/sbpl_rt/read.txt", "expected": {"expectation_id": "allow_all|file-read*|/tmp/sbpl_rt/read.txt", "expected_decision": "allow", "target": "/tmp/sbpl_rt/read.txt"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/tmp/sbpl_rt/write.txt'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:runtime:allow_all:write_/tmp/sbpl_rt/write.txt", "observed_path": "/private/tmp/sbpl_rt/write.txt", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/tmp/sbpl_rt/write.txt", "profile_id": "runtime:allow_all", "target": "/tmp/sbpl_rt/write.txt"}, "probe_name": "write_/tmp/sbpl_rt/write.txt", "profile_id": "runtime:allow_all", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/tmp/sbpl_rt/write.txt"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/sbpl_rt/write.txt", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/sbpl_rt/write.txt", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/sbpl_rt/write.txt", "scenario_id": "baseline:runtime:allow_all:write_/tmp/sbpl_rt/write.txt"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_apply_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/sbpl_rt/write.txt", "observed_path": "/private/tmp/sbpl_rt/write.txt", "operation": "file-write*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_apply_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "write_/tmp/sbpl_rt/write.txt", "profile_id": "runtime:allow_all", "requested_path": "/tmp/sbpl_rt/write.txt", "runtime_status": "errno", "scenario_id": "allow_all|file-write*|/tmp/sbpl_rt/write.txt", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/sbpl_rt/write.txt"}, "expectation_id": "allow_all|file-write*|/tmp/sbpl_rt/write.txt", "expected": {"expectation_id": "allow_all|file-write*|/tmp/sbpl_rt/write.txt", "expected_decision": "allow", "target": "/tmp/sbpl_rt/write.txt"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/tmp/foo.txt"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:runtime:metafilter_any:read_foo", "observed_path": "/private/tmp/foo.txt", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_foo", "profile_id": "runtime:metafilter_any", "target": "/tmp/foo.txt"}, "probe_name": "read_foo", "profile_id": "runtime:metafilter_any", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "foo\n", "target": "/tmp/foo.txt"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo.txt", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo.txt", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo.txt", "scenario_id": "baseline:runtime:metafilter_any:read_foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/foo.txt", "observed_path": "/private/tmp/foo.txt", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_foo", "profile_id": "runtime:metafilter_any", "requested_path": "/tmp/foo.txt", "runtime_status": "errno", "scenario_id": "metafilter_any|file-read*|/tmp/foo.txt", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo.txt"}, "expectation_id": "metafilter_any|file-read*|/tmp/foo.txt", "expected": {"expectation_id": "metafilter_any|file-read*|/tmp/foo.txt", "expected_decision": "allow", "target": "/tmp/foo.txt"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/tmp/bar.txt"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:runtime:metafilter_any:read_bar", "observed_path": "/private/tmp/bar.txt", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_bar", "profile_id": "runtime:metafilter_any", "target": "/tmp/bar.txt"}, "probe_name": "read_bar", "profile_id": "runtime:metafilter_any", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "bar\n", "target": "/tmp/bar.txt"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/bar.txt", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/bar.txt", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/bar.txt", "scenario_id": "baseline:runtime:metafilter_any:read_bar"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/bar.txt", "observed_path": "/private/tmp/bar.txt", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_bar", "profile_id": "runtime:metafilter_any", "requested_path": "/tmp/bar.txt", "runtime_status": "errno", "scenario_id": "metafilter_any|file-read*|/tmp/bar.txt", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/bar.txt"}, "expectation_id": "metafilter_any|file-read*|/tmp/bar.txt", "expected": {"expectation_id": "metafilter_any|file-read*|/tmp/bar.txt", "expected_decision": "allow", "target": "/tmp/bar.txt"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/tmp/qux.txt"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:runtime:metafilter_any:read_other", "observed_path": "/private/tmp/qux.txt", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_other", "profile_id": "runtime:metafilter_any", "target": "/tmp/qux.txt"}, "probe_name": "read_other", "profile_id": "runtime:metafilter_any", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "qux\n", "target": "/tmp/qux.txt"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/qux.txt", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/qux.txt", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/qux.txt", "scenario_id": "baseline:runtime:metafilter_any:read_other"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/qux.txt", "observed_path": "/private/tmp/qux.txt", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_other", "profile_id": "runtime:metafilter_any", "requested_path": "/tmp/qux.txt", "runtime_status": "errno", "scenario_id": "metafilter_any|file-read*|/tmp/qux.txt", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/qux.txt"}, "expectation_id": "metafilter_any|file-read*|/tmp/qux.txt", "expected": {"expectation_id": "metafilter_any|file-read*|/tmp/qux.txt", "expected_decision": "allow", "target": "/tmp/qux.txt"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/tmp/baz.txt"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:runtime:metafilter_any:read_baz", "observed_path": "/private/tmp/baz.txt", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_baz", "profile_id": "runtime:metafilter_any", "target": "/tmp/baz.txt"}, "probe_name": "read_baz", "profile_id": "runtime:metafilter_any", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "baz\n", "target": "/tmp/baz.txt"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/baz.txt", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/baz.txt", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/baz.txt", "scenario_id": "baseline:runtime:metafilter_any:read_baz"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/baz.txt", "observed_path": "/private/tmp/baz.txt", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_baz", "profile_id": "runtime:metafilter_any", "requested_path": "/tmp/baz.txt", "runtime_status": "errno", "scenario_id": "metafilter_any|file-read*|/tmp/baz.txt", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/baz.txt"}, "expectation_id": "metafilter_any|file-read*|/tmp/baz.txt", "expected": {"expectation_id": "metafilter_any|file-read*|/tmp/baz.txt", "expected_decision": "deny", "target": "/tmp/baz.txt"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/tmp/baz.txt'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:runtime:metafilter_any:write_baz", "observed_path": "/private/tmp/baz.txt", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_baz", "profile_id": "runtime:metafilter_any", "target": "/tmp/baz.txt"}, "probe_name": "write_baz", "profile_id": "runtime:metafilter_any", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/tmp/baz.txt"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/baz.txt", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/baz.txt", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/baz.txt", "scenario_id": "baseline:runtime:metafilter_any:write_baz"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/baz.txt", "observed_path": "/private/tmp/baz.txt", "operation": "file-write*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "write_baz", "profile_id": "runtime:metafilter_any", "requested_path": "/tmp/baz.txt", "runtime_status": "errno", "scenario_id": "metafilter_any|file-write*|/tmp/baz.txt", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/baz.txt"}, "expectation_id": "metafilter_any|file-write*|/tmp/baz.txt", "expected": {"expectation_id": "metafilter_any|file-write*|/tmp/baz.txt", "expected_decision": "deny", "target": "/tmp/baz.txt"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/private/tmp/strict_ok/allow.txt"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:runtime:strict_1:read_ok", "observed_path": "/private/tmp/strict_ok/allow.txt", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_ok", "profile_id": "runtime:strict_1", "target": "/private/tmp/strict_ok/allow.txt"}, "probe_name": "read_ok", "profile_id": "runtime:strict_1", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "strict allow\n", "target": "/private/tmp/strict_ok/allow.txt"}, "canonicalization": null, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/strict_ok/allow.txt", "observed_path": "/private/tmp/strict_ok/allow.txt", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_ok", "profile_id": "runtime:strict_1", "requested_path": "/private/tmp/strict_ok/allow.txt", "runtime_status": "errno", "scenario_id": "runtime:strict_1:read_ok", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/private/tmp/strict_ok/allow.txt"}, "expectation_id": "runtime:strict_1:read_ok", "expected": {"expectation_id": "runtime:strict_1:read_ok", "expected_decision": "allow", "target": "/private/tmp/strict_ok/allow.txt"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/private/tmp/strict_ok/allow.txt'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:runtime:strict_1:write_ok", "observed_path": "/private/tmp/strict_ok/allow.txt", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_ok", "profile_id": "runtime:strict_1", "target": "/private/tmp/strict_ok/allow.txt"}, "probe_name": "write_ok", "profile_id": "runtime:strict_1", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/private/tmp/strict_ok/allow.txt"}, "canonicalization": null, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/strict_ok/allow.txt", "observed_path": "/private/tmp/strict_ok/allow.txt", "operation": "file-write*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "write_ok", "profile_id": "runtime:strict_1", "requested_path": "/private/tmp/strict_ok/allow.txt", "runtime_status": "errno", "scenario_id": "runtime:strict_1:write_ok", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/private/tmp/strict_ok/allow.txt"}, "expectation_id": "runtime:strict_1:write_ok", "expected": {"expectation_id": "runtime:strict_1:write_ok", "expected_decision": "allow", "target": "/private/tmp/strict_ok/allow.txt"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/etc/hosts"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:runtime:strict_1:read_hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_hosts", "profile_id": "runtime:strict_1", "target": "/etc/hosts"}, "probe_name": "read_hosts", "profile_id": "runtime:strict_1", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1          ", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_hosts", "profile_id": "runtime:strict_1", "requested_path": "/etc/hosts", "runtime_status": "errno", "scenario_id": "runtime:strict_1:read_hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "runtime:strict_1:read_hosts", "expected": {"expectation_id": "runtime:strict_1:read_hosts", "expected_decision": "deny", "target": "/etc/hosts"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/etc/hosts'"], "decision_path": "baseline", "exit_code": 1, "name": "baseline:runtime:strict_1:write_hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_hosts", "profile_id": "runtime:strict_1", "target": "/etc/hosts"}, "probe_name": "write_hosts", "profile_id": "runtime:strict_1", "reached_primary_op": true, "status": "deny", "stderr": "/bin/sh: /etc/hosts: Operation not permitted\n", "stdout": "", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-write*", "policy_layers": {"attribution": "platform_policy", "effective_decision": "deny", "platform_policy": {"decision": "deny", "error": null, "exit_code": 1, "source": "baseline", "status": "deny"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "write_hosts", "profile_id": "runtime:strict_1", "requested_path": "/etc/hosts", "runtime_status": "errno", "scenario_id": "runtime:strict_1:write_hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "runtime:strict_1:write_hosts", "expected": {"expectation_id": "runtime:strict_1:write_hosts", "expected_decision": "deny", "target": "/etc/hosts"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/etc/hosts"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:sys:airlock:read_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/etc/hosts", "profile_id": "sys:airlock", "target": "/etc/hosts"}, "probe_name": "read_/etc/hosts", "profile_id": "sys:airlock", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1          ", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "read_/etc/hosts", "profile_id": "sys:airlock", "requested_path": "/etc/hosts", "runtime_status": "blocked", "scenario_id": "sys:airlock:read_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "sys:airlock:read_/etc/hosts", "expected": {"expectation_id": "sys:airlock:read_/etc/hosts", "expected_decision": "deny", "target": "/etc/hosts"}, "mismatch_reason": "expectation_too_strong", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/etc/hosts'"], "decision_path": "baseline", "exit_code": 1, "name": "baseline:sys:airlock:write_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/etc/hosts", "profile_id": "sys:airlock", "target": "/etc/hosts"}, "probe_name": "write_/etc/hosts", "profile_id": "sys:airlock", "reached_primary_op": true, "status": "deny", "stderr": "/bin/sh: /etc/hosts: Operation not permitted\n", "stdout": "", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-write*", "policy_layers": {"attribution": "platform_policy", "effective_decision": "deny", "platform_policy": {"decision": "deny", "error": null, "exit_code": 1, "source": "baseline", "status": "deny"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "write_/etc/hosts", "profile_id": "sys:airlock", "requested_path": "/etc/hosts", "runtime_status": "blocked", "scenario_id": "sys:airlock:write_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "sys:airlock:write_/etc/hosts", "expected": {"expectation_id": "sys:airlock:write_/etc/hosts", "expected_decision": "deny", "target": "/etc/hosts"}, "mismatch_reason": "ambient_platform_restriction", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/tmp/foo"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:sys:airlock:read_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/tmp/foo", "profile_id": "sys:airlock", "target": "/tmp/foo"}, "probe_name": "read_/tmp/foo", "profile_id": "sys:airlock", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "runtime-checks foo\nruntime-check\n", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:sys:airlock:read_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "read_/tmp/foo", "profile_id": "sys:airlock", "requested_path": "/tmp/foo", "runtime_status": "blocked", "scenario_id": "sys:airlock:read_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "sys:airlock:read_/tmp/foo", "expected": {"expectation_id": "sys:airlock:read_/tmp/foo", "expected_decision": "deny", "target": "/tmp/foo"}, "mismatch_reason": "canonicalization_boundary", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/tmp/foo'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:sys:airlock:write_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/tmp/foo", "profile_id": "sys:airlock", "target": "/tmp/foo"}, "probe_name": "write_/tmp/foo", "profile_id": "sys:airlock", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:sys:airlock:write_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-write*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "write_/tmp/foo", "profile_id": "sys:airlock", "requested_path": "/tmp/foo", "runtime_status": "blocked", "scenario_id": "sys:airlock:write_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "sys:airlock:write_/tmp/foo", "expected": {"expectation_id": "sys:airlock:write_/tmp/foo", "expected_decision": "deny", "target": "/tmp/foo"}, "mismatch_reason": "canonicalization_boundary", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/etc/hosts"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:sys:bsd:read_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/etc/hosts", "profile_id": "sys:bsd", "target": "/etc/hosts"}, "probe_name": "read_/etc/hosts", "profile_id": "sys:bsd", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1          ", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_/etc/hosts", "profile_id": "sys:bsd", "requested_path": "/etc/hosts", "runtime_status": "errno", "scenario_id": "sys:bsd:read_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "sys:bsd:read_/etc/hosts", "expected": {"expectation_id": "sys:bsd:read_/etc/hosts", "expected_decision": "deny", "target": "/etc/hosts"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/etc/hosts'"], "decision_path": "baseline", "exit_code": 1, "name": "baseline:sys:bsd:write_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/etc/hosts", "profile_id": "sys:bsd", "target": "/etc/hosts"}, "probe_name": "write_/etc/hosts", "profile_id": "sys:bsd", "reached_primary_op": true, "status": "deny", "stderr": "/bin/sh: /etc/hosts: Operation not permitted\n", "stdout": "", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-write*", "policy_layers": {"attribution": "platform_policy", "effective_decision": "deny", "platform_policy": {"decision": "deny", "error": null, "exit_code": 1, "source": "baseline", "status": "deny"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "write_/etc/hosts", "profile_id": "sys:bsd", "requested_path": "/etc/hosts", "runtime_status": "errno", "scenario_id": "sys:bsd:write_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "sys:bsd:write_/etc/hosts", "expected": {"expectation_id": "sys:bsd:write_/etc/hosts", "expected_decision": "deny", "target": "/etc/hosts"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/tmp/foo"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:sys:bsd:read_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/tmp/foo", "profile_id": "sys:bsd", "target": "/tmp/foo"}, "probe_name": "read_/tmp/foo", "profile_id": "sys:bsd", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "runtime-checks foo\nruntime-check\nruntime-check\n", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:sys:bsd:read_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_/tmp/foo", "profile_id": "sys:bsd", "requested_path": "/tmp/foo", "runtime_status": "errno", "scenario_id": "sys:bsd:read_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "sys:bsd:read_/tmp/foo", "expected": {"expectation_id": "sys:bsd:read_/tmp/foo", "expected_decision": "deny", "target": "/tmp/foo"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/tmp/foo'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:sys:bsd:write_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/tmp/foo", "profile_id": "sys:bsd", "target": "/tmp/foo"}, "probe_name": "write_/tmp/foo", "profile_id": "sys:bsd", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:sys:bsd:write_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-write*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "write_/tmp/foo", "profile_id": "sys:bsd", "requested_path": "/tmp/foo", "runtime_status": "errno", "scenario_id": "sys:bsd:write_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "sys:bsd:write_/tmp/foo", "expected": {"expectation_id": "sys:bsd:write_/tmp/foo", "expected_decision": "deny", "target": "/tmp/foo"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/etc/hosts"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:sys:blastdoor:read_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/etc/hosts", "profile_id": "sys:blastdoor", "target": "/etc/hosts"}, "probe_name": "read_/etc/hosts", "profile_id": "sys:blastdoor", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1          ", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "read_/etc/hosts", "profile_id": "sys:blastdoor", "requested_path": "/etc/hosts", "runtime_status": "blocked", "scenario_id": "sys:blastdoor:read_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "sys:blastdoor:read_/etc/hosts", "expected": {"expectation_id": "sys:blastdoor:read_/etc/hosts", "expected_decision": "allow", "target": "/etc/hosts"}, "mismatch_reason": "expectation_too_strong", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/etc/hosts'"], "decision_path": "baseline", "exit_code": 1, "name": "baseline:sys:blastdoor:write_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/etc/hosts", "profile_id": "sys:blastdoor", "target": "/etc/hosts"}, "probe_name": "write_/etc/hosts", "profile_id": "sys:blastdoor", "reached_primary_op": true, "status": "deny", "stderr": "/bin/sh: /etc/hosts: Operation not permitted\n", "stdout": "", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-write*", "policy_layers": {"attribution": "platform_policy", "effective_decision": "deny", "platform_policy": {"decision": "deny", "error": null, "exit_code": 1, "source": "baseline", "status": "deny"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "write_/etc/hosts", "profile_id": "sys:blastdoor", "requested_path": "/etc/hosts", "runtime_status": "blocked", "scenario_id": "sys:blastdoor:write_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "sys:blastdoor:write_/etc/hosts", "expected": {"expectation_id": "sys:blastdoor:write_/etc/hosts", "expected_decision": "deny", "target": "/etc/hosts"}, "mismatch_reason": "ambient_platform_restriction", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/tmp/foo"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:sys:blastdoor:read_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/tmp/foo", "profile_id": "sys:blastdoor", "target": "/tmp/foo"}, "probe_name": "read_/tmp/foo", "profile_id": "sys:blastdoor", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\n", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:sys:blastdoor:read_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "read_/tmp/foo", "profile_id": "sys:blastdoor", "requested_path": "/tmp/foo", "runtime_status": "blocked", "scenario_id": "sys:blastdoor:read_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "sys:blastdoor:read_/tmp/foo", "expected": {"expectation_id": "sys:blastdoor:read_/tmp/foo", "expected_decision": "allow", "target": "/tmp/foo"}, "mismatch_reason": "canonicalization_boundary", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/tmp/foo'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:sys:blastdoor:write_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/tmp/foo", "profile_id": "sys:blastdoor", "target": "/tmp/foo"}, "probe_name": "write_/tmp/foo", "profile_id": "sys:blastdoor", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:sys:blastdoor:write_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-write*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "write_/tmp/foo", "profile_id": "sys:blastdoor", "requested_path": "/tmp/foo", "runtime_status": "blocked", "scenario_id": "sys:blastdoor:write_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "sys:blastdoor:write_/tmp/foo", "expected": {"expectation_id": "sys:blastdoor:write_/tmp/foo", "expected_decision": "deny", "target": "/tmp/foo"}, "mismatch_reason": "canonicalization_boundary", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["book/api/runtime/native/probes/mach_probe", "com.apple.logd"], "decision_path": "baseline", "exit_code": 1, "name": "baseline:sys:blastdoor:mach_allow_logd", "operation": "mach-lookup", "primary_intent": {"operation": "mach-lookup", "probe_name": "mach_allow_logd", "profile_id": "sys:blastdoor", "target": "com.apple.logd"}, "probe_details": {"kr": 1100, "operation": "mach-lookup", "service_present": null}, "probe_name": "mach_allow_logd", "profile_id": "sys:blastdoor", "reached_primary_op": true, "status": "deny", "stderr": "", "stdout": "{\"kr\":1100}\n", "target": "com.apple.logd"}, "canonicalization": null, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": null, "observed_path": null, "operation": "mach-lookup", "policy_layers": {"attribution": "platform_policy", "effective_decision": "deny", "platform_policy": {"decision": "deny", "error": null, "exit_code": 1, "source": "baseline", "status": "deny"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "mach_allow_logd", "profile_id": "sys:blastdoor", "requested_path": null, "runtime_status": "blocked", "scenario_id": "sys:blastdoor:mach_allow_logd", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "com.apple.logd"}, "expectation_id": "sys:blastdoor:mach_allow_logd", "expected": {"expectation_id": "sys:blastdoor:mach_allow_logd", "expected_decision": "allow", "target": "com.apple.logd"}, "mismatch_reason": "ambient_platform_restriction", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["book/api/runtime/native/probes/mach_probe", "com.apple.trustd.agent"], "decision_path": "baseline", "exit_code": 1, "name": "baseline:sys:blastdoor:mach_allow_trustd", "operation": "mach-lookup", "primary_intent": {"operation": "mach-lookup", "probe_name": "mach_allow_trustd", "profile_id": "sys:blastdoor", "target": "com.apple.trustd.agent"}, "probe_details": {"kr": 1100, "operation": "mach-lookup", "service_present": null}, "probe_name": "mach_allow_trustd", "profile_id": "sys:blastdoor", "reached_primary_op": true, "status": "deny", "stderr": "", "stdout": "{\"kr\":1100}\n", "target": "com.apple.trustd.agent"}, "canonicalization": null, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": null, "observed_path": null, "operation": "mach-lookup", "policy_layers": {"attribution": "platform_policy", "effective_decision": "deny", "platform_policy": {"decision": "deny", "error": null, "exit_code": 1, "source": "baseline", "status": "deny"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "mach_allow_trustd", "profile_id": "sys:blastdoor", "requested_path": null, "runtime_status": "blocked", "scenario_id": "sys:blastdoor:mach_allow_trustd", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "com.apple.trustd.agent"}, "expectation_id": "sys:blastdoor:mach_allow_trustd", "expected": {"expectation_id": "sys:blastdoor:mach_allow_trustd", "expected_decision": "allow", "target": "com.apple.trustd.agent"}, "mismatch_reason": "ambient_platform_restriction", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["book/api/runtime/native/probes/mach_probe", "com.apple.cfprefsd.agent"], "decision_path": "baseline", "exit_code": 1, "name": "baseline:sys:blastdoor:mach_deny_cfprefsd", "operation": "mach-lookup", "primary_intent": {"operation": "mach-lookup", "probe_name": "mach_deny_cfprefsd", "profile_id": "sys:blastdoor", "target": "com.apple.cfprefsd.agent"}, "probe_details": {"kr": 1100, "operation": "mach-lookup", "service_present": null}, "probe_name": "mach_deny_cfprefsd", "profile_id": "sys:blastdoor", "reached_primary_op": true, "status": "deny", "stderr": "", "stdout": "{\"kr\":1100}\n", "target": "com.apple.cfprefsd.agent"}, "canonicalization": null, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": null, "observed_path": null, "operation": "mach-lookup", "policy_layers": {"attribution": "platform_policy", "effective_decision": "deny", "platform_policy": {"decision": "deny", "error": null, "exit_code": 1, "source": "baseline", "status": "deny"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "mach_deny_cfprefsd", "profile_id": "sys:blastdoor", "requested_path": null, "runtime_status": "blocked", "scenario_id": "sys:blastdoor:mach_deny_cfprefsd", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "com.apple.cfprefsd.agent"}, "expectation_id": "sys:blastdoor:mach_deny_cfprefsd", "expected": {"expectation_id": "sys:blastdoor:mach_deny_cfprefsd", "expected_decision": "deny", "target": "com.apple.cfprefsd.agent"}, "mismatch_reason": "ambient_platform_restriction", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["book/api/runtime/native/probes/mach_probe", "com.apple.trustd.agent"], "decision_path": "baseline", "exit_code": 1, "name": "baseline:sys:blastdoor:xpc_deny_trustd", "operation": "mach-lookup", "primary_intent": {"operation": "mach-lookup", "probe_name": "xpc_deny_trustd", "profile_id": "sys:blastdoor", "target": "com.apple.trustd.agent"}, "probe_details": {"kr": 1100, "operation": "mach-lookup", "service_present": null}, "probe_name": "xpc_deny_trustd", "profile_id": "sys:blastdoor", "reached_primary_op": true, "status": "deny", "stderr": "", "stdout": "{\"kr\":1100}\n", "target": "com.apple.trustd.agent"}, "canonicalization": null, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": null, "observed_path": null, "operation": "mach-lookup", "policy_layers": {"attribution": "platform_policy", "effective_decision": "deny", "platform_policy": {"decision": "deny", "error": null, "exit_code": 1, "source": "baseline", "status": "deny"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "xpc_deny_trustd", "profile_id": "sys:blastdoor", "requested_path": null, "runtime_status": "blocked", "scenario_id": "sys:blastdoor:xpc_deny_trustd", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "com.apple.trustd.agent"}, "expectation_id": "sys:blastdoor:xpc_deny_trustd", "expected": {"expectation_id": "sys:blastdoor:xpc_deny_trustd", "expected_decision": "deny", "target": "com.apple.trustd.agent"}, "mismatch_reason": "ambient_platform_restriction", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/etc/hosts"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:sys:cgpdfservice:read_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/etc/hosts", "profile_id": "sys:cgpdfservice", "target": "/etc/hosts"}, "probe_name": "read_/etc/hosts", "profile_id": "sys:cgpdfservice", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1          ", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "read_/etc/hosts", "profile_id": "sys:cgpdfservice", "requested_path": "/etc/hosts", "runtime_status": "blocked", "scenario_id": "sys:cgpdfservice:read_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "sys:cgpdfservice:read_/etc/hosts", "expected": {"expectation_id": "sys:cgpdfservice:read_/etc/hosts", "expected_decision": "allow", "target": "/etc/hosts"}, "mismatch_reason": "expectation_too_strong", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/etc/hosts'"], "decision_path": "baseline", "exit_code": 1, "name": "baseline:sys:cgpdfservice:write_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/etc/hosts", "profile_id": "sys:cgpdfservice", "target": "/etc/hosts"}, "probe_name": "write_/etc/hosts", "profile_id": "sys:cgpdfservice", "reached_primary_op": true, "status": "deny", "stderr": "/bin/sh: /etc/hosts: Operation not permitted\n", "stdout": "", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-write*", "policy_layers": {"attribution": "platform_policy", "effective_decision": "deny", "platform_policy": {"decision": "deny", "error": null, "exit_code": 1, "source": "baseline", "status": "deny"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "write_/etc/hosts", "profile_id": "sys:cgpdfservice", "requested_path": "/etc/hosts", "runtime_status": "blocked", "scenario_id": "sys:cgpdfservice:write_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "sys:cgpdfservice:write_/etc/hosts", "expected": {"expectation_id": "sys:cgpdfservice:write_/etc/hosts", "expected_decision": "deny", "target": "/etc/hosts"}, "mismatch_reason": "ambient_platform_restriction", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/tmp/foo"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:sys:cgpdfservice:read_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/tmp/foo", "profile_id": "sys:cgpdfservice", "target": "/tmp/foo"}, "probe_name": "read_/tmp/foo", "profile_id": "sys:cgpdfservice", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:sys:cgpdfservice:read_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "read_/tmp/foo", "profile_id": "sys:cgpdfservice", "requested_path": "/tmp/foo", "runtime_status": "blocked", "scenario_id": "sys:cgpdfservice:read_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "sys:cgpdfservice:read_/tmp/foo", "expected": {"expectation_id": "sys:cgpdfservice:read_/tmp/foo", "expected_decision": "allow", "target": "/tmp/foo"}, "mismatch_reason": "canonicalization_boundary", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/tmp/foo'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:sys:cgpdfservice:write_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/tmp/foo", "profile_id": "sys:cgpdfservice", "target": "/tmp/foo"}, "probe_name": "write_/tmp/foo", "profile_id": "sys:cgpdfservice", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:sys:cgpdfservice:write_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-write*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "write_/tmp/foo", "profile_id": "sys:cgpdfservice", "requested_path": "/tmp/foo", "runtime_status": "blocked", "scenario_id": "sys:cgpdfservice:write_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "sys:cgpdfservice:write_/tmp/foo", "expected": {"expectation_id": "sys:cgpdfservice:write_/tmp/foo", "expected_decision": "deny", "target": "/tmp/foo"}, "mismatch_reason": "canonicalization_boundary", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/Library/Preferences/com.apple.timezone.auto.plist"], "error": "'utf-8' codec can't decode byte 0xd1 in position 8: invalid continuation byte", "name": "baseline:sys:cgpdfservice:read_/Library/Preferences/com.apple.timezone.auto.plist", "observed_path": "/Library/Preferences/com.apple.timezone.auto.plist", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/Library/Preferences/com.apple.timezone.auto.plist", "profile_id": "sys:cgpdfservice", "target": "/Library/Preferences/com.apple.timezone.auto.plist"}, "probe_name": "read_/Library/Preferences/com.apple.timezone.auto.plist", "profile_id": "sys:cgpdfservice", "status": "deny", "target": "/Library/Preferences/com.apple.timezone.auto.plist"}, "canonicalization": null, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": "/Library/Preferences/com.apple.timezone.auto.plist", "observed_path": "/Library/Preferences/com.apple.timezone.auto.plist", "operation": "file-read*", "policy_layers": {"attribution": "platform_policy", "effective_decision": "deny", "platform_policy": {"decision": "deny", "error": "'utf-8' codec can't decode byte 0xd1 in position 8: invalid continuation byte", "exit_code": null, "source": "baseline", "status": "deny"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "read_/Library/Preferences/com.apple.timezone.auto.plist", "profile_id": "sys:cgpdfservice", "requested_path": "/Library/Preferences/com.apple.timezone.auto.plist", "runtime_status": "blocked", "scenario_id": "sys:cgpdfservice:read_/Library/Preferences/com.apple.timezone.auto.plist", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/Library/Preferences/com.apple.timezone.auto.plist"}, "expectation_id": "sys:cgpdfservice:read_/Library/Preferences/com.apple.timezone.auto.plist", "expected": {"expectation_id": "sys:cgpdfservice:read_/Library/Preferences/com.apple.timezone.auto.plist", "expected_decision": "deny", "target": "/Library/Preferences/com.apple.timezone.auto.plist"}, "mismatch_reason": "ambient_platform_restriction", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/var/db/timezone/zoneinfo/Etc/UTC"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:sys:cgpdfservice:read_/var/db/timezone/zoneinfo/Etc/UTC", "observed_path": "/private/var/db/timezone/tz/2025b.1.0/zoneinfo/Etc/UTC", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/var/db/timezone/zoneinfo/Etc/UTC", "profile_id": "sys:cgpdfservice", "target": "/var/db/timezone/zoneinfo/Etc/UTC"}, "probe_name": "read_/var/db/timezone/zoneinfo/Etc/UTC", "profile_id": "sys:cgpdfservice", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "TZif2\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0001\u0000\u0000\u0000\u0004\u0000\u0000\u0000\u0000\u0000\u0000UTC\u0000TZif2\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0001\u0000\u0000\u0000\u0004\u0000\u0000\u0000\u0000\u0000\u0000UTC\u0000\nUTC0\n", "target": "/var/db/timezone/zoneinfo/Etc/UTC"}, "canonicalization": null, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": "/private/var/db/timezone/tz/2025b.1.0/zoneinfo/Etc/UTC", "observed_path": "/private/var/db/timezone/tz/2025b.1.0/zoneinfo/Etc/UTC", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "read_/var/db/timezone/zoneinfo/Etc/UTC", "profile_id": "sys:cgpdfservice", "requested_path": "/var/db/timezone/zoneinfo/Etc/UTC", "runtime_status": "blocked", "scenario_id": "sys:cgpdfservice:read_/var/db/timezone/zoneinfo/Etc/UTC", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/var/db/timezone/zoneinfo/Etc/UTC"}, "expectation_id": "sys:cgpdfservice:read_/var/db/timezone/zoneinfo/Etc/UTC", "expected": {"expectation_id": "sys:cgpdfservice:read_/var/db/timezone/zoneinfo/Etc/UTC", "expected_decision": "deny", "target": "/var/db/timezone/zoneinfo/Etc/UTC"}, "mismatch_reason": "expectation_too_strong", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/private/etc/localtime"], "error": "'utf-8' codec can't decode byte 0xba in position 35: invalid start byte", "name": "baseline:sys:cgpdfservice:read_/private/etc/localtime", "observed_path": "/private/var/db/timezone/tz/2025b.1.0/zoneinfo/America/Los_Angeles", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/private/etc/localtime", "profile_id": "sys:cgpdfservice", "target": "/private/etc/localtime"}, "probe_name": "read_/private/etc/localtime", "profile_id": "sys:cgpdfservice", "status": "deny", "target": "/private/etc/localtime"}, "canonicalization": null, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": null, "normalized_path": "/private/var/db/timezone/tz/2025b.1.0/zoneinfo/America/Los_Angeles", "observed_path": "/private/var/db/timezone/tz/2025b.1.0/zoneinfo/America/Los_Angeles", "operation": "file-read*", "policy_layers": {"attribution": "platform_policy", "effective_decision": "deny", "platform_policy": {"decision": "deny", "error": "'utf-8' codec can't decode byte 0xba in position 35: invalid start byte", "exit_code": null, "source": "baseline", "status": "deny"}, "process_policy": {"decision": "unknown", "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "status": "blocked"}}, "probe_name": "read_/private/etc/localtime", "profile_id": "sys:cgpdfservice", "requested_path": "/private/etc/localtime", "runtime_status": "blocked", "scenario_id": "sys:cgpdfservice:read_/private/etc/localtime", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/private/etc/localtime"}, "expectation_id": "sys:cgpdfservice:read_/private/etc/localtime", "expected": {"expectation_id": "sys:cgpdfservice:read_/private/etc/localtime", "expected_decision": "deny", "target": "/private/etc/localtime"}, "mismatch_reason": "ambient_platform_restriction", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/etc/hosts"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:appsandbox:baseline:read_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/etc/hosts", "profile_id": "appsandbox:baseline", "target": "/etc/hosts"}, "probe_name": "read_/etc/hosts", "profile_id": "appsandbox:baseline", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1          ", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_/etc/hosts", "profile_id": "appsandbox:baseline", "requested_path": "/etc/hosts", "runtime_status": "errno", "scenario_id": "appsandbox:baseline:read_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "appsandbox:baseline:read_/etc/hosts", "expected": {"expectation_id": "appsandbox:baseline:read_/etc/hosts", "expected_decision": "allow", "target": "/etc/hosts"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/etc/hosts'"], "decision_path": "baseline", "exit_code": 1, "name": "baseline:appsandbox:baseline:write_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/etc/hosts", "profile_id": "appsandbox:baseline", "target": "/etc/hosts"}, "probe_name": "write_/etc/hosts", "profile_id": "appsandbox:baseline", "reached_primary_op": true, "status": "deny", "stderr": "/bin/sh: /etc/hosts: Operation not permitted\n", "stdout": "", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-write*", "policy_layers": {"attribution": "platform_policy", "effective_decision": "deny", "platform_policy": {"decision": "deny", "error": null, "exit_code": 1, "source": "baseline", "status": "deny"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "write_/etc/hosts", "profile_id": "appsandbox:baseline", "requested_path": "/etc/hosts", "runtime_status": "errno", "scenario_id": "appsandbox:baseline:write_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "appsandbox:baseline:write_/etc/hosts", "expected": {"expectation_id": "appsandbox:baseline:write_/etc/hosts", "expected_decision": "deny", "target": "/etc/hosts"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/tmp/foo"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:appsandbox:baseline:read_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/tmp/foo", "profile_id": "appsandbox:baseline", "target": "/tmp/foo"}, "probe_name": "read_/tmp/foo", "profile_id": "appsandbox:baseline", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:appsandbox:baseline:read_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_/tmp/foo", "profile_id": "appsandbox:baseline", "requested_path": "/tmp/foo", "runtime_status": "errno", "scenario_id": "appsandbox:baseline:read_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "appsandbox:baseline:read_/tmp/foo", "expected": {"expectation_id": "appsandbox:baseline:read_/tmp/foo", "expected_decision": "allow", "target": "/tmp/foo"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/tmp/foo'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:appsandbox:baseline:write_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/tmp/foo", "profile_id": "appsandbox:baseline", "target": "/tmp/foo"}, "probe_name": "write_/tmp/foo", "profile_id": "appsandbox:baseline", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:appsandbox:baseline:write_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-write*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "write_/tmp/foo", "profile_id": "appsandbox:baseline", "requested_path": "/tmp/foo", "runtime_status": "errno", "scenario_id": "appsandbox:baseline:write_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "appsandbox:baseline:write_/tmp/foo", "expected": {"expectation_id": "appsandbox:baseline:write_/tmp/foo", "expected_decision": "deny", "target": "/tmp/foo"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/etc/hosts"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:appsandbox:net-client:read_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/etc/hosts", "profile_id": "appsandbox:net-client", "target": "/etc/hosts"}, "probe_name": "read_/etc/hosts", "profile_id": "appsandbox:net-client", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1          ", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_/etc/hosts", "profile_id": "appsandbox:net-client", "requested_path": "/etc/hosts", "runtime_status": "errno", "scenario_id": "appsandbox:net-client:read_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "appsandbox:net-client:read_/etc/hosts", "expected": {"expectation_id": "appsandbox:net-client:read_/etc/hosts", "expected_decision": "allow", "target": "/etc/hosts"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/etc/hosts'"], "decision_path": "baseline", "exit_code": 1, "name": "baseline:appsandbox:net-client:write_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/etc/hosts", "profile_id": "appsandbox:net-client", "target": "/etc/hosts"}, "probe_name": "write_/etc/hosts", "profile_id": "appsandbox:net-client", "reached_primary_op": true, "status": "deny", "stderr": "/bin/sh: /etc/hosts: Operation not permitted\n", "stdout": "", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-write*", "policy_layers": {"attribution": "platform_policy", "effective_decision": "deny", "platform_policy": {"decision": "deny", "error": null, "exit_code": 1, "source": "baseline", "status": "deny"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "write_/etc/hosts", "profile_id": "appsandbox:net-client", "requested_path": "/etc/hosts", "runtime_status": "errno", "scenario_id": "appsandbox:net-client:write_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "appsandbox:net-client:write_/etc/hosts", "expected": {"expectation_id": "appsandbox:net-client:write_/etc/hosts", "expected_decision": "deny", "target": "/etc/hosts"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/tmp/foo"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:appsandbox:net-client:read_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/tmp/foo", "profile_id": "appsandbox:net-client", "target": "/tmp/foo"}, "probe_name": "read_/tmp/foo", "profile_id": "appsandbox:net-client", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:appsandbox:net-client:read_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_/tmp/foo", "profile_id": "appsandbox:net-client", "requested_path": "/tmp/foo", "runtime_status": "errno", "scenario_id": "appsandbox:net-client:read_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "appsandbox:net-client:read_/tmp/foo", "expected": {"expectation_id": "appsandbox:net-client:read_/tmp/foo", "expected_decision": "allow", "target": "/tmp/foo"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/tmp/foo'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:appsandbox:net-client:write_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/tmp/foo", "profile_id": "appsandbox:net-client", "target": "/tmp/foo"}, "probe_name": "write_/tmp/foo", "profile_id": "appsandbox:net-client", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:appsandbox:net-client:write_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-write*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "write_/tmp/foo", "profile_id": "appsandbox:net-client", "requested_path": "/tmp/foo", "runtime_status": "errno", "scenario_id": "appsandbox:net-client:write_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "appsandbox:net-client:write_/tmp/foo", "expected": {"expectation_id": "appsandbox:net-client:write_/tmp/foo", "expected_decision": "deny", "target": "/tmp/foo"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/etc/hosts"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:appsandbox:downloads-rw:read_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/etc/hosts", "profile_id": "appsandbox:downloads-rw", "target": "/etc/hosts"}, "probe_name": "read_/etc/hosts", "profile_id": "appsandbox:downloads-rw", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1          ", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_/etc/hosts", "profile_id": "appsandbox:downloads-rw", "requested_path": "/etc/hosts", "runtime_status": "errno", "scenario_id": "appsandbox:downloads-rw:read_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "appsandbox:downloads-rw:read_/etc/hosts", "expected": {"expectation_id": "appsandbox:downloads-rw:read_/etc/hosts", "expected_decision": "allow", "target": "/etc/hosts"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/etc/hosts'"], "decision_path": "baseline", "exit_code": 1, "name": "baseline:appsandbox:downloads-rw:write_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/etc/hosts", "profile_id": "appsandbox:downloads-rw", "target": "/etc/hosts"}, "probe_name": "write_/etc/hosts", "profile_id": "appsandbox:downloads-rw", "reached_primary_op": true, "status": "deny", "stderr": "/bin/sh: /etc/hosts: Operation not permitted\n", "stdout": "", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-write*", "policy_layers": {"attribution": "platform_policy", "effective_decision": "deny", "platform_policy": {"decision": "deny", "error": null, "exit_code": 1, "source": "baseline", "status": "deny"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "write_/etc/hosts", "profile_id": "appsandbox:downloads-rw", "requested_path": "/etc/hosts", "runtime_status": "errno", "scenario_id": "appsandbox:downloads-rw:write_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "appsandbox:downloads-rw:write_/etc/hosts", "expected": {"expectation_id": "appsandbox:downloads-rw:write_/etc/hosts", "expected_decision": "deny", "target": "/etc/hosts"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/tmp/foo"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:appsandbox:downloads-rw:read_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/tmp/foo", "profile_id": "appsandbox:downloads-rw", "target": "/tmp/foo"}, "probe_name": "read_/tmp/foo", "profile_id": "appsandbox:downloads-rw", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:appsandbox:downloads-rw:read_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-read*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "read_/tmp/foo", "profile_id": "appsandbox:downloads-rw", "requested_path": "/tmp/foo", "runtime_status": "errno", "scenario_id": "appsandbox:downloads-rw:read_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "appsandbox:downloads-rw:read_/tmp/foo", "expected": {"expectation_id": "appsandbox:downloads-rw:read_/tmp/foo", "expected_decision": "allow", "target": "/tmp/foo"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/tmp/foo'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:appsandbox:downloads-rw:write_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/tmp/foo", "profile_id": "appsandbox:downloads-rw", "target": "/tmp/foo"}, "probe_name": "write_/tmp/foo", "profile_id": "appsandbox:downloads-rw", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:appsandbox:downloads-rw:write_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/path_witnesses.json"}, "decision_event": {"decision": null, "errno": 1, "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "filter_type": null, "filter_type_name": null, "intended_op_witnessed": false, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-write*", "policy_layers": {"attribution": "unknown", "effective_decision": "unknown", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "unknown", "failure_kind": "sandbox_init_failed", "failure_stage": "apply", "status": "errno"}}, "probe_name": "write_/tmp/foo", "profile_id": "appsandbox:downloads-rw", "requested_path": "/tmp/foo", "runtime_status": "errno", "scenario_id": "appsandbox:downloads-rw:write_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "appsandbox:downloads-rw:write_/tmp/foo", "expected": {"expectation_id": "appsandbox:downloads-rw:write_/tmp/foo", "expected_decision": "deny", "target": "/tmp/foo"}, "mismatch_reason": "op_not_witnessed", "oracle_check": null, "run_context": {"channel": "direct", "repo_root_context": ".", "run_id": "aa97e290-1aeb-4fef-b599-081dffd63750", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/out/aa97e290-1aeb-4fef-b599-081dffd63750/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
