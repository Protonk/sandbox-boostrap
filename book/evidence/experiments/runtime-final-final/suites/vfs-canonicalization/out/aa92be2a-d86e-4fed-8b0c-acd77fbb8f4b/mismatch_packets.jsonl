{"baseline": {"command": ["/bin/cat", "/tmp/foo"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_private_tmp_only_openat:read_openat_/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_openat_/tmp/foo", "profile_id": "vfs_private_tmp_only_openat", "target": "/tmp/foo"}, "probe_name": "read_openat_/tmp/foo", "profile_id": "vfs_private_tmp_only_openat", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n", "target": "/tmp/foo"}, "canonicalization": {"witness": {"alias_pair": true, "lane": "baseline", "nofirmlink_differs": false, "normalized_path": "/private/tmp/foo", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/foo", "observed_path_source": "unsandboxed_fd_path", "requested_path": "/tmp/foo", "scenario_id": "baseline:vfs_private_tmp_only_openat:read_openat_/tmp/foo"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/path_witnesses.json"}, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-read*", "policy_layers": {"attribution": "process_policy", "effective_decision": "deny", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "deny", "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "status": "errno"}}, "probe_name": "read_openat_/tmp/foo", "profile_id": "vfs_private_tmp_only_openat", "requested_path": "/tmp/foo", "runtime_status": "errno", "scenario_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/tmp/foo"}, "expectation_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo", "expected": {"expectation_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo", "expected_decision": "allow", "target": "/tmp/foo"}, "mismatch_reason": "canonicalization_boundary", "oracle_check": {"argument": "/tmp/foo", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/private/tmp/foo"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_private_tmp_only_openat:read_openat_/private/tmp/foo", "observed_path": "/private/tmp/foo", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_openat_/private/tmp/foo", "profile_id": "vfs_private_tmp_only_openat", "target": "/private/tmp/foo"}, "probe_name": "read_openat_/private/tmp/foo", "profile_id": "vfs_private_tmp_only_openat", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n", "target": "/private/tmp/foo"}, "canonicalization": null, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-read*", "policy_layers": {"attribution": "process_policy", "effective_decision": "deny", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "deny", "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "status": "errno"}}, "probe_name": "read_openat_/private/tmp/foo", "profile_id": "vfs_private_tmp_only_openat", "requested_path": "/private/tmp/foo", "runtime_status": "errno", "scenario_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/private/tmp/foo"}, "expectation_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo", "expected": {"expectation_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo", "expected_decision": "allow", "target": "/private/tmp/foo"}, "mismatch_reason": "expectation_too_strong", "oracle_check": {"argument": "/private/tmp/foo", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/var/tmp/vfs_canon_probe"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_alias_only", "target": "/var/tmp/vfs_canon_probe"}, "probe_name": "read_/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_alias_only", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n", "target": "/var/tmp/vfs_canon_probe"}, "canonicalization": null, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "operation": "file-read*", "policy_layers": {"attribution": "process_policy", "effective_decision": "deny", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "deny", "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "status": "errno"}}, "probe_name": "read_/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_alias_only", "requested_path": "/var/tmp/vfs_canon_probe", "runtime_status": "errno", "scenario_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/var/tmp/vfs_canon_probe"}, "expectation_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe", "expected": {"expectation_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe", "expected_decision": "allow", "target": "/var/tmp/vfs_canon_probe"}, "mismatch_reason": "expectation_too_strong", "oracle_check": {"argument": "/var/tmp/vfs_canon_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/var/tmp/vfs_canon_probe'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_alias_only", "target": "/var/tmp/vfs_canon_probe"}, "probe_name": "write_/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_alias_only", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/var/tmp/vfs_canon_probe"}, "canonicalization": null, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "operation": "file-write*", "policy_layers": {"attribution": "process_policy", "effective_decision": "deny", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "deny", "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "status": "errno"}}, "probe_name": "write_/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_alias_only", "requested_path": "/var/tmp/vfs_canon_probe", "runtime_status": "errno", "scenario_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/var/tmp/vfs_canon_probe"}, "expectation_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe", "expected": {"expectation_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe", "expected_decision": "allow", "target": "/var/tmp/vfs_canon_probe"}, "mismatch_reason": "expectation_too_strong", "oracle_check": {"argument": "/var/tmp/vfs_canon_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_private_only", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "probe_name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_private_only", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "canonicalization": {"witness": {"alias_pair": false, "lane": "scenario", "nofirmlink_differs": true, "normalized_path": "/private/var/tmp/vfs_canon_probe", "normalized_path_source": "observed_path", "observed_path": "/private/var/tmp/vfs_canon_probe", "observed_path_source": "probe_fgetpath:present", "requested_path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "scenario_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/path_witnesses.json"}, "decision_event": {"decision": "allow", "errno": null, "failure_kind": null, "failure_stage": null, "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "operation": "file-read*", "policy_layers": {"attribution": "allow", "effective_decision": "allow", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "allow", "failure_kind": null, "failure_stage": null, "status": "success"}}, "probe_name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_private_only", "requested_path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "runtime_status": "success", "scenario_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "expectation_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "expected": {"expectation_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "expected_decision": "deny", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "mismatch_reason": "canonicalization_boundary", "oracle_check": {"argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/System/Volumes/Data/private/var/tmp/vfs_canon_probe'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_private_only", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "probe_name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_private_only", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "canonicalization": {"witness": {"alias_pair": false, "lane": "scenario", "nofirmlink_differs": true, "normalized_path": "/private/var/tmp/vfs_canon_probe", "normalized_path_source": "observed_path", "observed_path": "/private/var/tmp/vfs_canon_probe", "observed_path_source": "probe_fgetpath:present", "requested_path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "scenario_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/path_witnesses.json"}, "decision_event": {"decision": "allow", "errno": null, "failure_kind": null, "failure_stage": null, "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "operation": "file-write*", "policy_layers": {"attribution": "allow", "effective_decision": "allow", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "allow", "failure_kind": null, "failure_stage": null, "status": "success"}}, "probe_name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_private_only", "requested_path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "runtime_status": "success", "scenario_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "expectation_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "expected": {"expectation_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "expected_decision": "deny", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "mismatch_reason": "canonicalization_boundary", "oracle_check": {"argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/var/tmp/vfs_canon_probe"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_both", "target": "/var/tmp/vfs_canon_probe"}, "probe_name": "read_/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_both", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-c", "target": "/var/tmp/vfs_canon_probe"}, "canonicalization": null, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "operation": "file-read*", "policy_layers": {"attribution": "process_policy", "effective_decision": "deny", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "deny", "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "status": "errno"}}, "probe_name": "read_/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_both", "requested_path": "/var/tmp/vfs_canon_probe", "runtime_status": "errno", "scenario_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/var/tmp/vfs_canon_probe"}, "expectation_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe", "expected": {"expectation_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe", "expected_decision": "allow", "target": "/var/tmp/vfs_canon_probe"}, "mismatch_reason": "expectation_too_strong", "oracle_check": {"argument": "/var/tmp/vfs_canon_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/var/tmp/vfs_canon_probe'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_both", "target": "/var/tmp/vfs_canon_probe"}, "probe_name": "write_/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_both", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/var/tmp/vfs_canon_probe"}, "canonicalization": null, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "operation": "file-write*", "policy_layers": {"attribution": "process_policy", "effective_decision": "deny", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "deny", "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "status": "errno"}}, "probe_name": "write_/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_both", "requested_path": "/var/tmp/vfs_canon_probe", "runtime_status": "errno", "scenario_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/var/tmp/vfs_canon_probe"}, "expectation_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe", "expected": {"expectation_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe", "expected_decision": "allow", "target": "/var/tmp/vfs_canon_probe"}, "mismatch_reason": "expectation_too_strong", "oracle_check": {"argument": "/var/tmp/vfs_canon_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_both", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "probe_name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_both", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-c", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "canonicalization": {"witness": {"alias_pair": false, "lane": "scenario", "nofirmlink_differs": true, "normalized_path": "/private/var/tmp/vfs_canon_probe", "normalized_path_source": "observed_path", "observed_path": "/private/var/tmp/vfs_canon_probe", "observed_path_source": "probe_fgetpath:present", "requested_path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "scenario_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/path_witnesses.json"}, "decision_event": {"decision": "allow", "errno": null, "failure_kind": null, "failure_stage": null, "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "operation": "file-read*", "policy_layers": {"attribution": "allow", "effective_decision": "allow", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "allow", "failure_kind": null, "failure_stage": null, "status": "success"}}, "probe_name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_both", "requested_path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "runtime_status": "success", "scenario_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "expectation_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "expected": {"expectation_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "expected_decision": "deny", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "mismatch_reason": "canonicalization_boundary", "oracle_check": {"argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/System/Volumes/Data/private/var/tmp/vfs_canon_probe'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_both", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "probe_name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_both", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "canonicalization": {"witness": {"alias_pair": false, "lane": "scenario", "nofirmlink_differs": true, "normalized_path": "/private/var/tmp/vfs_canon_probe", "normalized_path_source": "observed_path", "observed_path": "/private/var/tmp/vfs_canon_probe", "observed_path_source": "probe_fgetpath:present", "requested_path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "scenario_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/path_witnesses.json"}, "decision_event": {"decision": "allow", "errno": null, "failure_kind": null, "failure_stage": null, "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "operation": "file-write*", "policy_layers": {"attribution": "allow", "effective_decision": "allow", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "allow", "failure_kind": null, "failure_stage": null, "status": "success"}}, "probe_name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_both", "requested_path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "runtime_status": "success", "scenario_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "expectation_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "expected": {"expectation_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "expected_decision": "deny", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "mismatch_reason": "canonicalization_boundary", "oracle_check": {"argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_data_only", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "probe_name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_data_only", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-c", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "canonicalization": null, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "operation": "file-read*", "policy_layers": {"attribution": "process_policy", "effective_decision": "deny", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "deny", "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "status": "errno"}}, "probe_name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_data_only", "requested_path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "runtime_status": "errno", "scenario_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "expectation_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "expected": {"expectation_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "expected_decision": "allow", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "mismatch_reason": "expectation_too_strong", "oracle_check": {"argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/System/Volumes/Data/private/var/tmp/vfs_canon_probe'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_data_only", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "probe_name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_data_only", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "canonicalization": null, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/var/tmp/vfs_canon_probe", "observed_path": "/private/var/tmp/vfs_canon_probe", "operation": "file-write*", "policy_layers": {"attribution": "process_policy", "effective_decision": "deny", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "deny", "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "status": "errno"}}, "probe_name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "profile_id": "vfs_var_tmp_data_only", "requested_path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "runtime_status": "errno", "scenario_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "expectation_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "expected": {"expectation_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "expected_decision": "allow", "target": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"}, "mismatch_reason": "expectation_too_strong", "oracle_check": {"argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/etc/hosts"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_etc_alias_only:read_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/etc/hosts", "profile_id": "vfs_etc_alias_only", "target": "/etc/hosts"}, "probe_name": "read_/etc/hosts", "profile_id": "vfs_etc_alias_only", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1          ", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-read*", "policy_layers": {"attribution": "process_policy", "effective_decision": "deny", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "deny", "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "status": "errno"}}, "probe_name": "read_/etc/hosts", "profile_id": "vfs_etc_alias_only", "requested_path": "/etc/hosts", "runtime_status": "errno", "scenario_id": "vfs_etc_alias_only:read_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "vfs_etc_alias_only:read_/etc/hosts", "expected": {"expectation_id": "vfs_etc_alias_only:read_/etc/hosts", "expected_decision": "allow", "target": "/etc/hosts"}, "mismatch_reason": "expectation_too_strong", "oracle_check": {"argument": "/etc/hosts", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/etc/hosts"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_etc_both:read_/etc/hosts", "observed_path": "/private/etc/hosts", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/etc/hosts", "profile_id": "vfs_etc_both", "target": "/etc/hosts"}, "probe_name": "read_/etc/hosts", "profile_id": "vfs_etc_both", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1          ", "target": "/etc/hosts"}, "canonicalization": null, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-read*", "policy_layers": {"attribution": "process_policy", "effective_decision": "deny", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "deny", "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "status": "errno"}}, "probe_name": "read_/etc/hosts", "profile_id": "vfs_etc_both", "requested_path": "/etc/hosts", "runtime_status": "errno", "scenario_id": "vfs_etc_both:read_/etc/hosts", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/etc/hosts"}, "expectation_id": "vfs_etc_both:read_/etc/hosts", "expected": {"expectation_id": "vfs_etc_both:read_/etc/hosts", "expected_decision": "allow", "target": "/etc/hosts"}, "mismatch_reason": "expectation_too_strong", "oracle_check": {"argument": "/etc/hosts", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "observed_path": "/private/tmp/vfs_firmlink_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "profile_id": "vfs_firmlink_private_only", "target": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "probe_name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "profile_id": "vfs_firmlink_private_only", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n", "target": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "canonicalization": {"witness": {"alias_pair": false, "lane": "scenario", "nofirmlink_differs": true, "normalized_path": "/private/tmp/vfs_firmlink_probe", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/vfs_firmlink_probe", "observed_path_source": "probe_fgetpath:present", "requested_path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "scenario_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/path_witnesses.json"}, "decision_event": {"decision": "allow", "errno": null, "failure_kind": null, "failure_stage": null, "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/tmp/vfs_firmlink_probe", "observed_path": "/private/tmp/vfs_firmlink_probe", "operation": "file-read*", "policy_layers": {"attribution": "allow", "effective_decision": "allow", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "allow", "failure_kind": null, "failure_stage": null, "status": "success"}}, "probe_name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "profile_id": "vfs_firmlink_private_only", "requested_path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "runtime_status": "success", "scenario_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "expectation_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "expected": {"expectation_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "expected_decision": "deny", "target": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "mismatch_reason": "canonicalization_boundary", "oracle_check": {"argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/System/Volumes/Data/private/tmp/vfs_firmlink_probe'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "observed_path": "/private/tmp/vfs_firmlink_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "profile_id": "vfs_firmlink_private_only", "target": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "probe_name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "profile_id": "vfs_firmlink_private_only", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "canonicalization": {"witness": {"alias_pair": false, "lane": "scenario", "nofirmlink_differs": true, "normalized_path": "/private/tmp/vfs_firmlink_probe", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/vfs_firmlink_probe", "observed_path_source": "probe_fgetpath:present", "requested_path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "scenario_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "witness_source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/path_witnesses.json"}, "decision_event": {"decision": "allow", "errno": null, "failure_kind": null, "failure_stage": null, "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/tmp/vfs_firmlink_probe", "observed_path": "/private/tmp/vfs_firmlink_probe", "operation": "file-write*", "policy_layers": {"attribution": "allow", "effective_decision": "allow", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "allow", "failure_kind": null, "failure_stage": null, "status": "success"}}, "probe_name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "profile_id": "vfs_firmlink_private_only", "requested_path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "runtime_status": "success", "scenario_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "expectation_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "expected": {"expectation_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "expected_decision": "deny", "target": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "mismatch_reason": "canonicalization_boundary", "oracle_check": {"argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "observed_path": "/private/tmp/vfs_firmlink_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "profile_id": "vfs_firmlink_data_only", "target": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "probe_name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "profile_id": "vfs_firmlink_data_only", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n", "target": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "canonicalization": null, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/tmp/vfs_firmlink_probe", "observed_path": "/private/tmp/vfs_firmlink_probe", "operation": "file-read*", "policy_layers": {"attribution": "process_policy", "effective_decision": "deny", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "deny", "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "status": "errno"}}, "probe_name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "profile_id": "vfs_firmlink_data_only", "requested_path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "runtime_status": "errno", "scenario_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "expectation_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "expected": {"expectation_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "expected_decision": "allow", "target": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "mismatch_reason": "expectation_too_strong", "oracle_check": {"argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/System/Volumes/Data/private/tmp/vfs_firmlink_probe'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "observed_path": "/private/tmp/vfs_firmlink_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "profile_id": "vfs_firmlink_data_only", "target": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "probe_name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "profile_id": "vfs_firmlink_data_only", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "canonicalization": null, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/tmp/vfs_firmlink_probe", "observed_path": "/private/tmp/vfs_firmlink_probe", "operation": "file-write*", "policy_layers": {"attribution": "process_policy", "effective_decision": "deny", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "deny", "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "status": "errno"}}, "probe_name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "profile_id": "vfs_firmlink_data_only", "requested_path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "runtime_status": "errno", "scenario_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "expectation_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "expected": {"expectation_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "expected_decision": "allow", "target": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"}, "mismatch_reason": "expectation_too_strong", "oracle_check": {"argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "observed_path": "/private/var/tmp/vfs_link_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "profile_id": "vfs_link_private_tmp_only", "target": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"}, "probe_name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "profile_id": "vfs_link_private_tmp_only", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n", "target": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"}, "canonicalization": null, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/var/tmp/vfs_link_probe", "observed_path": "/private/var/tmp/vfs_link_probe", "operation": "file-read*", "policy_layers": {"attribution": "process_policy", "effective_decision": "deny", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "deny", "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "status": "errno"}}, "probe_name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "profile_id": "vfs_link_private_tmp_only", "requested_path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "runtime_status": "errno", "scenario_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"}, "expectation_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "expected": {"expectation_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "expected_decision": "allow", "target": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"}, "mismatch_reason": "expectation_too_strong", "oracle_check": {"argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "observed_path": "/private/var/tmp/vfs_link_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "profile_id": "vfs_link_private_tmp_only", "target": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"}, "probe_name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "profile_id": "vfs_link_private_tmp_only", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"}, "canonicalization": null, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/var/tmp/vfs_link_probe", "observed_path": "/private/var/tmp/vfs_link_probe", "operation": "file-write*", "policy_layers": {"attribution": "process_policy", "effective_decision": "deny", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "deny", "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "status": "errno"}}, "probe_name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "profile_id": "vfs_link_private_tmp_only", "requested_path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "runtime_status": "errno", "scenario_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"}, "expectation_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "expected": {"expectation_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "expected_decision": "allow", "target": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"}, "mismatch_reason": "expectation_too_strong", "oracle_check": {"argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/cat", "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "observed_path": "/private/var/tmp/vfs_link_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "primary_intent": {"operation": "file-read*", "probe_name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "profile_id": "vfs_link_both", "target": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"}, "probe_name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "profile_id": "vfs_link_both", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n", "target": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"}, "canonicalization": null, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/var/tmp/vfs_link_probe", "observed_path": "/private/var/tmp/vfs_link_probe", "operation": "file-read*", "policy_layers": {"attribution": "process_policy", "effective_decision": "deny", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "deny", "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "status": "errno"}}, "probe_name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "profile_id": "vfs_link_both", "requested_path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "runtime_status": "errno", "scenario_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"}, "expectation_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "expected": {"expectation_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "expected_decision": "allow", "target": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"}, "mismatch_reason": "expectation_too_strong", "oracle_check": {"argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
{"baseline": {"command": ["/bin/sh", "-c", "echo runtime-check >> '/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe'"], "decision_path": "baseline", "exit_code": 0, "name": "baseline:vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "observed_path": "/private/var/tmp/vfs_link_probe", "observed_path_errno": null, "observed_path_nofirmlink": null, "observed_path_nofirmlink_errno": null, "observed_path_nofirmlink_source": "unsandboxed_unavailable", "observed_path_source": "unsandboxed_fd_path", "operation": "file-write*", "primary_intent": {"operation": "file-write*", "probe_name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "profile_id": "vfs_link_both", "target": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"}, "probe_name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "profile_id": "vfs_link_both", "reached_primary_op": true, "status": "allow", "stderr": "", "stdout": "", "target": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"}, "canonicalization": null, "decision_event": {"decision": "deny", "errno": 2, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "intended_op_witnessed": true, "normalized_path": "/private/var/tmp/vfs_link_probe", "observed_path": "/private/var/tmp/vfs_link_probe", "operation": "file-write*", "policy_layers": {"attribution": "process_policy", "effective_decision": "deny", "platform_policy": {"decision": "allow", "error": null, "exit_code": 0, "source": "baseline", "status": "allow"}, "process_policy": {"decision": "deny", "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "status": "errno"}}, "probe_name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "profile_id": "vfs_link_both", "requested_path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "runtime_status": "errno", "scenario_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "source": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_events.normalized.json", "target": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"}, "expectation_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "expected": {"expectation_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "expected_decision": "allow", "target": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"}, "mismatch_reason": "expectation_too_strong", "oracle_check": {"argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "pre_syscall"}, "run_context": {"channel": "launchd_clean", "repo_root_context": ".", "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b", "run_manifest": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-tools.mismatch_packet.v0.1"}
