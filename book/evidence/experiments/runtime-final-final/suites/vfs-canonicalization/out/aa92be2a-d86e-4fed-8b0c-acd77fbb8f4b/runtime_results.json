{
  "vfs_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_tmp_only:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34423}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34423}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459372.150635,
        "cmd_finished_at_unix_s": 1767459372.4095922,
        "cmd_duration_s": 0.2589571475982666,
        "cmd_pid": 34423,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34423",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:10",
            "--end",
            "2026-01-03 08:56:14",
            "--row-id",
            "vfs_tmp_only:read_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_tmp_only.read__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34423",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1122,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:14",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34423,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34423)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34423\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/tmp/foo",
              "start": "2026-01-03 08:56:10",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459373554,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:10",
          "observer_window_end": "2026-01-03 08:56:14",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34430}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34430}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459373.5561779,
        "cmd_finished_at_unix_s": 1767459373.563995,
        "cmd_duration_s": 0.00781702995300293,
        "cmd_pid": 34430,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34430",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:11",
            "--end",
            "2026-01-03 08:56:15",
            "--row-id",
            "vfs_tmp_only:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_tmp_only.read__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34430",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1130,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:15",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34430,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34430)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34430\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/tmp/foo",
              "start": "2026-01-03 08:56:11",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459373716,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:11",
          "observer_window_end": "2026-01-03 08:56:15",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_tmp_only:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34433}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34433}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459373.7180002,
        "cmd_finished_at_unix_s": 1767459374.1009998,
        "cmd_duration_s": 0.3829996585845947,
        "cmd_pid": 34433,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34433",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:11",
            "--end",
            "2026-01-03 08:56:16",
            "--row-id",
            "vfs_tmp_only:write_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_tmp_only.write__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34433",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1408,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:14.233588-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34433) deny(1) file-write-data /private/tmp/foo"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:16",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:14.233588-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34433) deny(1) file-write-data /private/tmp/foo",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34433,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34433)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34433\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/tmp/foo",
              "start": "2026-01-03 08:56:11",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459374304,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:11",
          "observer_window_end": "2026-01-03 08:56:16",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34436}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34436}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459374.3062358,
        "cmd_finished_at_unix_s": 1767459374.313468,
        "cmd_duration_s": 0.007232189178466797,
        "cmd_pid": 34436,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34436",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:12",
            "--end",
            "2026-01-03 08:56:16",
            "--row-id",
            "vfs_tmp_only:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_tmp_only.write__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34436",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1416,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:14.446958-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34436) deny(1) file-write-data /private/tmp/foo"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:16",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:14.446958-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34436) deny(1) file-write-data /private/tmp/foo",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34436,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34436)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34436\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/tmp/foo",
              "start": "2026-01-03 08:56:12",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459374454,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:12",
          "observer_window_end": "2026-01-03 08:56:16",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_tmp_only:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34439}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34439}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459374.456127,
        "cmd_finished_at_unix_s": 1767459374.463994,
        "cmd_duration_s": 0.007867097854614258,
        "cmd_pid": 34439,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34439",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:12",
            "--end",
            "2026-01-03 08:56:16",
            "--row-id",
            "vfs_tmp_only:read_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_tmp_only.read__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "34439",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1405,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:14.597468-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34439) deny(1) file-read-data /private/tmp/bar"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:16",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:14.597468-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34439) deny(1) file-read-data /private/tmp/bar",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34439,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34439)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34439\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/tmp/bar",
              "start": "2026-01-03 08:56:12",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459374605,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:12",
          "observer_window_end": "2026-01-03 08:56:16",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34442}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34442}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459374.6066802,
        "cmd_finished_at_unix_s": 1767459374.61394,
        "cmd_duration_s": 0.007259845733642578,
        "cmd_pid": 34442,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34442",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:12",
            "--end",
            "2026-01-03 08:56:16",
            "--row-id",
            "vfs_tmp_only:read_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_tmp_only.read__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "34442",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1413,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:14.747454-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34442) deny(1) file-read-data /private/tmp/bar"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:16",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:14.747454-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34442) deny(1) file-read-data /private/tmp/bar",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34442,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34442)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34442\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/tmp/bar",
              "start": "2026-01-03 08:56:12",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459374757,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:12",
          "observer_window_end": "2026-01-03 08:56:16",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_tmp_only:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34445}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34445}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459374.7586718,
        "cmd_finished_at_unix_s": 1767459374.765852,
        "cmd_duration_s": 0.007180213928222656,
        "cmd_pid": 34445,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34445",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:12",
            "--end",
            "2026-01-03 08:56:16",
            "--row-id",
            "vfs_tmp_only:write_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_tmp_only.write__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "34445",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1408,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:14.899373-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34445) deny(1) file-write-data /private/tmp/bar"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:16",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:14.899373-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34445) deny(1) file-write-data /private/tmp/bar",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34445,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34445)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34445\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/tmp/bar",
              "start": "2026-01-03 08:56:12",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459374909,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:12",
          "observer_window_end": "2026-01-03 08:56:16",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34448}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34448}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459374.9110348,
        "cmd_finished_at_unix_s": 1767459374.91822,
        "cmd_duration_s": 0.007185220718383789,
        "cmd_pid": 34448,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34448",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:12",
            "--end",
            "2026-01-03 08:56:16",
            "--row-id",
            "vfs_tmp_only:write_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_tmp_only.write__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "34448",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1416,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:15.051753-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34448) deny(1) file-write-data /private/tmp/bar"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:16",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:15.051753-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34448) deny(1) file-write-data /private/tmp/bar",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34448,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34448)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34448\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/tmp/bar",
              "start": "2026-01-03 08:56:12",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459375061,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:12",
          "observer_window_end": "2026-01-03 08:56:16",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34451}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34451}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459375.063298,
        "cmd_finished_at_unix_s": 1767459375.070566,
        "cmd_duration_s": 0.007267951965332031,
        "cmd_pid": 34451,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34451",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:13",
            "--end",
            "2026-01-03 08:56:17",
            "--row-id",
            "vfs_tmp_only:read_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_tmp_only.read__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "34451",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1131,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:17",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34451,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34451)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34451\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/tmp/nested/child",
              "start": "2026-01-03 08:56:13",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459375199,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:13",
          "observer_window_end": "2026-01-03 08:56:17",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34454}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34454}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459375.2012732,
        "cmd_finished_at_unix_s": 1767459375.2084758,
        "cmd_duration_s": 0.007202625274658203,
        "cmd_pid": 34454,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34454",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:13",
            "--end",
            "2026-01-03 08:56:17",
            "--row-id",
            "vfs_tmp_only:read_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_tmp_only.read__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "34454",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1440,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:15.342005-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34454) deny(1) file-read-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:17",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:15.342005-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34454) deny(1) file-read-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34454,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34454)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34454\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/tmp/nested/child",
              "start": "2026-01-03 08:56:13",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459375341,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:13",
          "observer_window_end": "2026-01-03 08:56:17",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34457}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34457}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459375.343147,
        "cmd_finished_at_unix_s": 1767459375.350306,
        "cmd_duration_s": 0.007158994674682617,
        "cmd_pid": 34457,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34457",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:13",
            "--end",
            "2026-01-03 08:56:17",
            "--row-id",
            "vfs_tmp_only:write_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_tmp_only.write__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "34457",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1435,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:15.483859-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34457) deny(1) file-write-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:17",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:15.483859-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34457) deny(1) file-write-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34457,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34457)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34457\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/tmp/nested/child",
              "start": "2026-01-03 08:56:13",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459375481,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:13",
          "observer_window_end": "2026-01-03 08:56:17",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34460}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34460}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459375.482702,
        "cmd_finished_at_unix_s": 1767459375.4899871,
        "cmd_duration_s": 0.007285118103027344,
        "cmd_pid": 34460,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34460",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:13",
            "--end",
            "2026-01-03 08:56:17",
            "--row-id",
            "vfs_tmp_only:write_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_tmp_only.write__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "34460",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1443,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:15.623516-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34460) deny(1) file-write-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:17",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:15.623516-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34460) deny(1) file-write-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34460,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34460)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34460\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/tmp/nested/child",
              "start": "2026-01-03 08:56:13",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459375621,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:13",
          "observer_window_end": "2026-01-03 08:56:17",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34463}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34463}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459375.622942,
        "cmd_finished_at_unix_s": 1767459375.630213,
        "cmd_duration_s": 0.0072710514068603516,
        "cmd_pid": 34463,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34463",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:13",
            "--end",
            "2026-01-03 08:56:17",
            "--row-id",
            "vfs_tmp_only:read_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_tmp_only.read__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "34463",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1395,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:15.763749-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34463) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:17",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:15.763749-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34463) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34463,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34463)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34463\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/var/tmp/canon",
              "start": "2026-01-03 08:56:13",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459375760,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:13",
          "observer_window_end": "2026-01-03 08:56:17",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34466}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34466}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459375.7620292,
        "cmd_finished_at_unix_s": 1767459375.7695382,
        "cmd_duration_s": 0.007508993148803711,
        "cmd_pid": 34466,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34466",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:13",
            "--end",
            "2026-01-03 08:56:17",
            "--row-id",
            "vfs_tmp_only:read_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_tmp_only.read__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "34466",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1431,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:15.903070-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34466) deny(1) file-read-data /private/var/tmp/canon"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:17",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:15.903070-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34466) deny(1) file-read-data /private/var/tmp/canon",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34466,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34466)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34466\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/var/tmp/canon",
              "start": "2026-01-03 08:56:13",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459375901,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:13",
          "observer_window_end": "2026-01-03 08:56:17",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34469}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34469}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459375.9025862,
        "cmd_finished_at_unix_s": 1767459375.9098299,
        "cmd_duration_s": 0.007243633270263672,
        "cmd_pid": 34469,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34469",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:13",
            "--end",
            "2026-01-03 08:56:17",
            "--row-id",
            "vfs_tmp_only:write_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_tmp_only.write__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "34469",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1396,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:16.043375-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34469) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:17",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:16.043375-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34469) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34469,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34469)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34469\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/var/tmp/canon",
              "start": "2026-01-03 08:56:13",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459376043,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:13",
          "observer_window_end": "2026-01-03 08:56:17",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34472}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":34472}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459376.044533,
        "cmd_finished_at_unix_s": 1767459376.051774,
        "cmd_duration_s": 0.007241010665893555,
        "cmd_pid": 34472,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34472",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:14",
            "--end",
            "2026-01-03 08:56:18",
            "--row-id",
            "vfs_tmp_only:write_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_tmp_only.write__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "34472",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1434,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:16.185315-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34472) deny(1) file-write-data /private/var/tmp/canon"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:18",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:16.185315-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34472) deny(1) file-write-data /private/var/tmp/canon",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34472,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34472)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34472\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/var/tmp/canon",
              "start": "2026-01-03 08:56:14",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459376154,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:14",
          "observer_window_end": "2026-01-03 08:56:18",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_private_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_private_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34475}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34475}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459376.156137,
        "cmd_finished_at_unix_s": 1767459376.163323,
        "cmd_duration_s": 0.007185935974121094,
        "cmd_pid": 34475,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34475",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:14",
            "--end",
            "2026-01-03 08:56:18",
            "--row-id",
            "vfs_private_tmp_only:read_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.read__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34475",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1130,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:18",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34475,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34475)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34475\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/tmp/foo",
              "start": "2026-01-03 08:56:14",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459376275,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:14",
          "observer_window_end": "2026-01-03 08:56:18",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34478}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34478}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459376.276983,
        "cmd_finished_at_unix_s": 1767459376.284255,
        "cmd_duration_s": 0.007272005081176758,
        "cmd_pid": 34478,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34478",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:14",
            "--end",
            "2026-01-03 08:56:18",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.read__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34478",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1138,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:18",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34478,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34478)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34478\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/foo",
              "start": "2026-01-03 08:56:14",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459376393,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:14",
          "observer_window_end": "2026-01-03 08:56:18",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34481}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34481}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459376.394838,
        "cmd_finished_at_unix_s": 1767459376.402133,
        "cmd_duration_s": 0.007294893264770508,
        "cmd_pid": 34481,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34481",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:14",
            "--end",
            "2026-01-03 08:56:18",
            "--row-id",
            "vfs_private_tmp_only:write_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.write__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34481",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1131,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:18",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34481,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34481)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34481\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/tmp/foo",
              "start": "2026-01-03 08:56:14",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459376508,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:14",
          "observer_window_end": "2026-01-03 08:56:18",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34484}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34484}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459376.509731,
        "cmd_finished_at_unix_s": 1767459376.516983,
        "cmd_duration_s": 0.0072519779205322266,
        "cmd_pid": 34484,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34484",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:14",
            "--end",
            "2026-01-03 08:56:18",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.write__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34484",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:18",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34484,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34484)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34484\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/foo",
              "start": "2026-01-03 08:56:14",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459376622,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:14",
          "observer_window_end": "2026-01-03 08:56:18",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34487}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34487}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459376.624005,
        "cmd_finished_at_unix_s": 1767459376.631062,
        "cmd_duration_s": 0.0070569515228271484,
        "cmd_pid": 34487,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34487",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:14",
            "--end",
            "2026-01-03 08:56:18",
            "--row-id",
            "vfs_private_tmp_only:read_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.read__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "34487",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1130,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:18",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34487,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34487)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34487\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/tmp/bar",
              "start": "2026-01-03 08:56:14",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459376746,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:14",
          "observer_window_end": "2026-01-03 08:56:18",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34490}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34490}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459376.747478,
        "cmd_finished_at_unix_s": 1767459376.754693,
        "cmd_duration_s": 0.007215023040771484,
        "cmd_pid": 34490,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34490",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:14",
            "--end",
            "2026-01-03 08:56:18",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.read__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "34490",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1138,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:18",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34490,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34490)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34490\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/bar",
              "start": "2026-01-03 08:56:14",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459376873,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:14",
          "observer_window_end": "2026-01-03 08:56:18",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34493}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34493}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459376.875093,
        "cmd_finished_at_unix_s": 1767459376.882258,
        "cmd_duration_s": 0.007164955139160156,
        "cmd_pid": 34493,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34493",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:14",
            "--end",
            "2026-01-03 08:56:18",
            "--row-id",
            "vfs_private_tmp_only:write_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.write__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "34493",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1131,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:18",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34493,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34493)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34493\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/tmp/bar",
              "start": "2026-01-03 08:56:14",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459377001,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:14",
          "observer_window_end": "2026-01-03 08:56:18",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34496}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34496}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459377.00245,
        "cmd_finished_at_unix_s": 1767459377.0096068,
        "cmd_duration_s": 0.007156848907470703,
        "cmd_pid": 34496,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34496",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:15",
            "--end",
            "2026-01-03 08:56:19",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.write__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "34496",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:19",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34496,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34496)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34496\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/bar",
              "start": "2026-01-03 08:56:15",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459377117,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:15",
          "observer_window_end": "2026-01-03 08:56:19",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34499}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34499}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459377.1191308,
        "cmd_finished_at_unix_s": 1767459377.126255,
        "cmd_duration_s": 0.007124185562133789,
        "cmd_pid": 34499,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34499",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:15",
            "--end",
            "2026-01-03 08:56:19",
            "--row-id",
            "vfs_private_tmp_only:read_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.read__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "34499",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:19",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34499,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34499)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34499\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/tmp/nested/child",
              "start": "2026-01-03 08:56:15",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459377242,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:15",
          "observer_window_end": "2026-01-03 08:56:19",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34502}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34502}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459377.2435231,
        "cmd_finished_at_unix_s": 1767459377.250766,
        "cmd_duration_s": 0.007242918014526367,
        "cmd_pid": 34502,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34502",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:15",
            "--end",
            "2026-01-03 08:56:19",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.read__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "34502",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1147,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:19",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34502,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34502)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34502\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/child",
              "start": "2026-01-03 08:56:15",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459377364,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:15",
          "observer_window_end": "2026-01-03 08:56:19",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34505}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34505}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459377.3661098,
        "cmd_finished_at_unix_s": 1767459377.3733,
        "cmd_duration_s": 0.007190227508544922,
        "cmd_pid": 34505,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34505",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:15",
            "--end",
            "2026-01-03 08:56:19",
            "--row-id",
            "vfs_private_tmp_only:write_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.write__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "34505",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1140,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:19",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34505,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34505)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34505\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/tmp/nested/child",
              "start": "2026-01-03 08:56:15",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459377485,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:15",
          "observer_window_end": "2026-01-03 08:56:19",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34508}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34508}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459377.4865248,
        "cmd_finished_at_unix_s": 1767459377.493803,
        "cmd_duration_s": 0.0072782039642333984,
        "cmd_pid": 34508,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34508",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:15",
            "--end",
            "2026-01-03 08:56:19",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.write__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "34508",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1148,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:19",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34508,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34508)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34508\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/child",
              "start": "2026-01-03 08:56:15",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459377609,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:15",
          "observer_window_end": "2026-01-03 08:56:19",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34511}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34511}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459377.610524,
        "cmd_finished_at_unix_s": 1767459377.6177258,
        "cmd_duration_s": 0.0072019100189208984,
        "cmd_pid": 34511,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34511",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:15",
            "--end",
            "2026-01-03 08:56:19",
            "--row-id",
            "vfs_private_tmp_only:read_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.read__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "34511",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1403,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:17.751327-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34511) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:19",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:17.751327-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34511) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34511,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34511)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34511\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/var/tmp/canon",
              "start": "2026-01-03 08:56:15",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459377728,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:15",
          "observer_window_end": "2026-01-03 08:56:19",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks var tmp canon\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34514}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34514}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:111259441\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459377.729698,
        "cmd_finished_at_unix_s": 1767459377.736922,
        "cmd_duration_s": 0.007224082946777344,
        "cmd_pid": 34514,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34514",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:15",
            "--end",
            "2026-01-03 08:56:19",
            "--row-id",
            "vfs_private_tmp_only:read_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.read__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "34514",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1144,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:19",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34514,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34514)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34514\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/var/tmp/canon",
              "start": "2026-01-03 08:56:15",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459377846,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:15",
          "observer_window_end": "2026-01-03 08:56:19",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34517}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34517}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459377.8480508,
        "cmd_finished_at_unix_s": 1767459377.855231,
        "cmd_duration_s": 0.007180213928222656,
        "cmd_pid": 34517,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34517",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:15",
            "--end",
            "2026-01-03 08:56:19",
            "--row-id",
            "vfs_private_tmp_only:write_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.write__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "34517",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1404,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:17.988819-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34517) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:19",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:17.988819-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34517) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34517,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34517)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34517\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/var/tmp/canon",
              "start": "2026-01-03 08:56:15",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459377967,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:15",
          "observer_window_end": "2026-01-03 08:56:19",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34520}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34520}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:111259441\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459377.9690812,
        "cmd_finished_at_unix_s": 1767459377.9762502,
        "cmd_duration_s": 0.007169008255004883,
        "cmd_pid": 34520,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34520",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:15",
            "--end",
            "2026-01-03 08:56:19",
            "--row-id",
            "vfs_private_tmp_only:write_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.write__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "34520",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1145,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:19",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34520,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34520)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34520\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/var/tmp/canon",
              "start": "2026-01-03 08:56:15",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459378092,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:15",
          "observer_window_end": "2026-01-03 08:56:19",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/../foo",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/nested/../foo",
        "operation": "file-read*",
        "path": "/private/tmp/nested/../foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/../foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/../foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34523}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34523}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459378.094323,
        "cmd_finished_at_unix_s": 1767459378.101624,
        "cmd_duration_s": 0.0073010921478271484,
        "cmd_pid": 34523,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/../foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34523",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:16",
            "--end",
            "2026-01-03 08:56:20",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.read__private_tmp_nested_.._foo.observer.json",
          "log_write_error": null,
          "pid": "34523",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/../foo",
          "correlation_id": null,
          "stdout_bytes": 1148,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:20",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34523,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34523)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34523\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/../foo",
              "start": "2026-01-03 08:56:16",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459378207,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:16",
          "observer_window_end": "2026-01-03 08:56:20",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/../foo",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/nested/../foo",
        "operation": "file-write*",
        "path": "/private/tmp/nested/../foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/../foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/../foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34526}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":34526}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459378.208559,
        "cmd_finished_at_unix_s": 1767459378.2158341,
        "cmd_duration_s": 0.007275104522705078,
        "cmd_pid": 34526,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/../foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34526",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:16",
            "--end",
            "2026-01-03 08:56:20",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only.write__private_tmp_nested_.._foo.observer.json",
          "log_write_error": null,
          "pid": "34526",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/../foo",
          "correlation_id": null,
          "stdout_bytes": 1149,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:20",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34526,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34526)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34526\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/../foo",
              "start": "2026-01-03 08:56:16",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459378317,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:16",
          "observer_window_end": "2026-01-03 08:56:20",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_both_paths": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_both_paths.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_both_paths:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34529}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34529}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459378.319938,
        "cmd_finished_at_unix_s": 1767459378.327212,
        "cmd_duration_s": 0.007274150848388672,
        "cmd_pid": 34529,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34529",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:16",
            "--end",
            "2026-01-03 08:56:20",
            "--row-id",
            "vfs_both_paths:read_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_both_paths.read__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34529",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1124,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:20",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34529,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34529)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34529\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/tmp/foo",
              "start": "2026-01-03 08:56:16",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459378434,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:16",
          "observer_window_end": "2026-01-03 08:56:20",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_both_paths:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34532}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34532}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459378.4358988,
        "cmd_finished_at_unix_s": 1767459378.443159,
        "cmd_duration_s": 0.007260322570800781,
        "cmd_pid": 34532,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34532",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:16",
            "--end",
            "2026-01-03 08:56:20",
            "--row-id",
            "vfs_both_paths:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_both_paths.read__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34532",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1132,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:20",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34532,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34532)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34532\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/tmp/foo",
              "start": "2026-01-03 08:56:16",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459378546,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:16",
          "observer_window_end": "2026-01-03 08:56:20",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_both_paths:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34535}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34535}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459378.548341,
        "cmd_finished_at_unix_s": 1767459378.555647,
        "cmd_duration_s": 0.00730586051940918,
        "cmd_pid": 34535,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34535",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:16",
            "--end",
            "2026-01-03 08:56:20",
            "--row-id",
            "vfs_both_paths:write_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_both_paths.write__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34535",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1125,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:20",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34535,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34535)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34535\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/tmp/foo",
              "start": "2026-01-03 08:56:16",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459378665,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:16",
          "observer_window_end": "2026-01-03 08:56:20",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_both_paths:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34538}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34538}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459378.667028,
        "cmd_finished_at_unix_s": 1767459378.6743271,
        "cmd_duration_s": 0.007299184799194336,
        "cmd_pid": 34538,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34538",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:16",
            "--end",
            "2026-01-03 08:56:20",
            "--row-id",
            "vfs_both_paths:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_both_paths.write__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34538",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1133,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:20",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34538,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34538)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34538\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/tmp/foo",
              "start": "2026-01-03 08:56:16",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459378784,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:16",
          "observer_window_end": "2026-01-03 08:56:20",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_both_paths:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34541}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34541}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459378.786401,
        "cmd_finished_at_unix_s": 1767459378.793684,
        "cmd_duration_s": 0.00728297233581543,
        "cmd_pid": 34541,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34541",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:16",
            "--end",
            "2026-01-03 08:56:20",
            "--row-id",
            "vfs_both_paths:read_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_both_paths.read__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "34541",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1124,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:20",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34541,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34541)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34541\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/tmp/bar",
              "start": "2026-01-03 08:56:16",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459378906,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:16",
          "observer_window_end": "2026-01-03 08:56:20",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_both_paths:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34544}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34544}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459378.907912,
        "cmd_finished_at_unix_s": 1767459378.915166,
        "cmd_duration_s": 0.007253885269165039,
        "cmd_pid": 34544,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34544",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:16",
            "--end",
            "2026-01-03 08:56:20",
            "--row-id",
            "vfs_both_paths:read_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_both_paths.read__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "34544",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1132,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:20",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34544,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34544)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34544\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/tmp/bar",
              "start": "2026-01-03 08:56:16",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459379021,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:16",
          "observer_window_end": "2026-01-03 08:56:20",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_both_paths:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34547}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34547}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459379.0230699,
        "cmd_finished_at_unix_s": 1767459379.030421,
        "cmd_duration_s": 0.0073511600494384766,
        "cmd_pid": 34547,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34547",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:17",
            "--end",
            "2026-01-03 08:56:21",
            "--row-id",
            "vfs_both_paths:write_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_both_paths.write__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "34547",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1125,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34547,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34547)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34547\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/tmp/bar",
              "start": "2026-01-03 08:56:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459379126,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:17",
          "observer_window_end": "2026-01-03 08:56:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_both_paths:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34550}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34550}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459379.128017,
        "cmd_finished_at_unix_s": 1767459379.1353211,
        "cmd_duration_s": 0.007304191589355469,
        "cmd_pid": 34550,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34550",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:17",
            "--end",
            "2026-01-03 08:56:21",
            "--row-id",
            "vfs_both_paths:write_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_both_paths.write__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "34550",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1133,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34550,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34550)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34550\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/tmp/bar",
              "start": "2026-01-03 08:56:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459379229,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:17",
          "observer_window_end": "2026-01-03 08:56:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_both_paths:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34553}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34553}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459379.23137,
        "cmd_finished_at_unix_s": 1767459379.238643,
        "cmd_duration_s": 0.007272958755493164,
        "cmd_pid": 34553,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34553",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:17",
            "--end",
            "2026-01-03 08:56:21",
            "--row-id",
            "vfs_both_paths:read_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_both_paths.read__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "34553",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1133,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34553,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34553)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34553\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/tmp/nested/child",
              "start": "2026-01-03 08:56:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459379333,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:17",
          "observer_window_end": "2026-01-03 08:56:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_both_paths:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34556}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34556}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459379.334646,
        "cmd_finished_at_unix_s": 1767459379.3419578,
        "cmd_duration_s": 0.007311820983886719,
        "cmd_pid": 34556,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34556",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:17",
            "--end",
            "2026-01-03 08:56:21",
            "--row-id",
            "vfs_both_paths:read_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_both_paths.read__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "34556",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1141,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34556,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34556)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34556\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/tmp/nested/child",
              "start": "2026-01-03 08:56:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459379439,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:17",
          "observer_window_end": "2026-01-03 08:56:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_both_paths:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34559}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34559}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459379.440436,
        "cmd_finished_at_unix_s": 1767459379.4477298,
        "cmd_duration_s": 0.0072939395904541016,
        "cmd_pid": 34559,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34559",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:17",
            "--end",
            "2026-01-03 08:56:21",
            "--row-id",
            "vfs_both_paths:write_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_both_paths.write__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "34559",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1134,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34559,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34559)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34559\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/tmp/nested/child",
              "start": "2026-01-03 08:56:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459379546,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:17",
          "observer_window_end": "2026-01-03 08:56:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_both_paths:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34562}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34562}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459379.547595,
        "cmd_finished_at_unix_s": 1767459379.554883,
        "cmd_duration_s": 0.0072879791259765625,
        "cmd_pid": 34562,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34562",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:17",
            "--end",
            "2026-01-03 08:56:21",
            "--row-id",
            "vfs_both_paths:write_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_both_paths.write__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "34562",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1142,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34562,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34562)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34562\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/tmp/nested/child",
              "start": "2026-01-03 08:56:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459379654,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:17",
          "observer_window_end": "2026-01-03 08:56:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_both_paths:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34565}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34565}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459379.655745,
        "cmd_finished_at_unix_s": 1767459379.663063,
        "cmd_duration_s": 0.007318019866943359,
        "cmd_pid": 34565,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34565",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:17",
            "--end",
            "2026-01-03 08:56:21",
            "--row-id",
            "vfs_both_paths:read_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_both_paths.read__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "34565",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1397,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:19.796718-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34565) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:19.796718-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34565) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34565,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34565)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34565\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/var/tmp/canon",
              "start": "2026-01-03 08:56:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459379757,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:17",
          "observer_window_end": "2026-01-03 08:56:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_both_paths:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks var tmp canon\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34568}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34568}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:111259441\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459379.75903,
        "cmd_finished_at_unix_s": 1767459379.7663438,
        "cmd_duration_s": 0.007313728332519531,
        "cmd_pid": 34568,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34568",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:17",
            "--end",
            "2026-01-03 08:56:21",
            "--row-id",
            "vfs_both_paths:read_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_both_paths.read__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "34568",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1138,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34568,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34568)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34568\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/var/tmp/canon",
              "start": "2026-01-03 08:56:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459379866,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:17",
          "observer_window_end": "2026-01-03 08:56:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_both_paths:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34571}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34571}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459379.8681788,
        "cmd_finished_at_unix_s": 1767459379.8754141,
        "cmd_duration_s": 0.007235288619995117,
        "cmd_pid": 34571,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34571",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:17",
            "--end",
            "2026-01-03 08:56:21",
            "--row-id",
            "vfs_both_paths:write_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_both_paths.write__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "34571",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1398,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:20.009045-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34571) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:20.009045-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34571) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34571,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34571)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34571\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/var/tmp/canon",
              "start": "2026-01-03 08:56:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459379978,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:17",
          "observer_window_end": "2026-01-03 08:56:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_both_paths:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34574}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":34574}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:111259441\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459379.979537,
        "cmd_finished_at_unix_s": 1767459379.986864,
        "cmd_duration_s": 0.007327079772949219,
        "cmd_pid": 34574,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34574",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:17",
            "--end",
            "2026-01-03 08:56:21",
            "--row-id",
            "vfs_both_paths:write_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_both_paths.write__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "34574",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34574,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34574)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34574\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/var/tmp/canon",
              "start": "2026-01-03 08:56:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459380090,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:17",
          "observer_window_end": "2026-01-03 08:56:21",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_private_tmp_only_openat": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_private_tmp_only_openat.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_open_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_open_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":34577}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":34577}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459380.092902,
        "cmd_finished_at_unix_s": 1767459380.10014,
        "cmd_duration_s": 0.007238149642944336,
        "cmd_pid": 34577,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34577",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:18",
            "--end",
            "2026-01-03 08:56:22",
            "--row-id",
            "vfs_private_tmp_only_openat:read_open_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only_openat.read_open__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34577",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_open_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1142,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:22",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34577,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34577)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34577\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat:read_open_/tmp/foo",
              "start": "2026-01-03 08:56:18",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459380202,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:18",
          "observer_window_end": "2026-01-03 08:56:22",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":34580}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":34580}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen dir: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459380.204397,
        "cmd_finished_at_unix_s": 1767459380.509036,
        "cmd_duration_s": 0.3046391010284424,
        "cmd_pid": 34580,
        "cmd_process_name": "sandbox_openat_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34580",
            "--process-name",
            "sandbox_openat_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:18",
            "--end",
            "2026-01-03 08:56:22",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only_openat.read_openat__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34580",
          "process_name": "sandbox_openat_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1447,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:20.641855-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_reader(34580) deny(1) file-read-data /private/tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:22",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:20.641855-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_reader(34580) deny(1) file-read-data /private/tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34580,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_reader(34580)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34580\")))",
              "process_name": "sandbox_openat_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo",
              "start": "2026-01-03 08:56:18",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459380667,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:18",
          "observer_window_end": "2026-01-03 08:56:22",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_open_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_open_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":34583}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":34583}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459380.6689339,
        "cmd_finished_at_unix_s": 1767459380.676139,
        "cmd_duration_s": 0.00720524787902832,
        "cmd_pid": 34583,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34583",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:18",
            "--end",
            "2026-01-03 08:56:22",
            "--row-id",
            "vfs_private_tmp_only_openat:read_open_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only_openat.read_open__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34583",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_open_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:22",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34583,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34583)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34583\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat:read_open_/private/tmp/foo",
              "start": "2026-01-03 08:56:18",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459380784,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:18",
          "observer_window_end": "2026-01-03 08:56:22",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":34586}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":34586}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen dir: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459380.7855449,
        "cmd_finished_at_unix_s": 1767459380.7927601,
        "cmd_duration_s": 0.007215261459350586,
        "cmd_pid": 34586,
        "cmd_process_name": "sandbox_openat_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34586",
            "--process-name",
            "sandbox_openat_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:18",
            "--end",
            "2026-01-03 08:56:22",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only_openat.read_openat__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34586",
          "process_name": "sandbox_openat_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1455,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:20.926443-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_reader(34586) deny(1) file-read-data /private/tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:22",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:20.926443-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_reader(34586) deny(1) file-read-data /private/tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34586,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_reader(34586)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34586\")))",
              "process_name": "sandbox_openat_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo",
              "start": "2026-01-03 08:56:18",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459380903,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:18",
          "observer_window_end": "2026-01-03 08:56:22",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_rootrel_tmp/foo",
        "operation": "file-read*",
        "path": "tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":34589}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":34589}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459380.904752,
        "cmd_finished_at_unix_s": 1767459381.2036512,
        "cmd_duration_s": 0.29889917373657227,
        "cmd_pid": 34589,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34589",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:18",
            "--end",
            "2026-01-03 08:56:23",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_rootrel_tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only_openat.read_openat_rootrel_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34589",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_rootrel_tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1181,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34589,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(34589)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34589\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_rootrel_tmp/foo",
              "start": "2026-01-03 08:56:18",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459381354,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:18",
          "observer_window_end": "2026-01-03 08:56:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_rootrel_private/tmp/foo",
        "operation": "file-read*",
        "path": "private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":34592}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":34592}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459381.356246,
        "cmd_finished_at_unix_s": 1767459381.363559,
        "cmd_duration_s": 0.0073130130767822266,
        "cmd_pid": 34592,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34592",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:19",
            "--end",
            "2026-01-03 08:56:23",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_rootrel_private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_private_tmp_only_openat.read_openat_rootrel_private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "34592",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_rootrel_private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1189,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34592,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(34592)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34592\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_rootrel_private/tmp/foo",
              "start": "2026-01-03 08:56:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459381466,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:19",
          "observer_window_end": "2026-01-03 08:56:23",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_var_tmp_alias_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_alias_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":34595}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":34595}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459381.4689212,
        "cmd_finished_at_unix_s": 1767459381.476188,
        "cmd_duration_s": 0.0072667598724365234,
        "cmd_pid": 34595,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34595",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:19",
            "--end",
            "2026-01-03 08:56:23",
            "--row-id",
            "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_alias_only.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34595",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1415,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:21.609859-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34595) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:21.609859-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34595) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34595,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34595)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34595\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459381579,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:19",
          "observer_window_end": "2026-01-03 08:56:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":34599}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":34599}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459381.581103,
        "cmd_finished_at_unix_s": 1767459381.588396,
        "cmd_duration_s": 0.007292985916137695,
        "cmd_pid": 34599,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34599",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:19",
            "--end",
            "2026-01-03 08:56:23",
            "--row-id",
            "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_alias_only.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34599",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1416,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:21.722072-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34599) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:21.722072-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34599) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34599,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34599)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34599\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459381702,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:19",
          "observer_window_end": "2026-01-03 08:56:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":34602}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":34602}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459381.704074,
        "cmd_finished_at_unix_s": 1767459381.711356,
        "cmd_duration_s": 0.0072820186614990234,
        "cmd_pid": 34602,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34602",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:19",
            "--end",
            "2026-01-03 08:56:23",
            "--row-id",
            "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_alias_only.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34602",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1471,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:21.845066-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34602) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:21.845066-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34602) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34602,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34602)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34602\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459381833,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:19",
          "observer_window_end": "2026-01-03 08:56:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":34605}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":34605}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459381.835084,
        "cmd_finished_at_unix_s": 1767459381.84237,
        "cmd_duration_s": 0.00728607177734375,
        "cmd_pid": 34605,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34605",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:19",
            "--end",
            "2026-01-03 08:56:23",
            "--row-id",
            "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_alias_only.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34605",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1474,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:21.976063-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34605) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:21.976063-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34605) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34605,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34605)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34605\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459381968,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:19",
          "observer_window_end": "2026-01-03 08:56:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":34608}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":34608}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459381.970123,
        "cmd_finished_at_unix_s": 1767459381.977485,
        "cmd_duration_s": 0.007361888885498047,
        "cmd_pid": 34608,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34608",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:19",
            "--end",
            "2026-01-03 08:56:23",
            "--row-id",
            "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_alias_only.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34608",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1491,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:22.111183-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34608) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:22.111183-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34608) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34608,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34608)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34608\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459382098,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:19",
          "observer_window_end": "2026-01-03 08:56:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":34611}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":34611}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459382.100121,
        "cmd_finished_at_unix_s": 1767459382.107372,
        "cmd_duration_s": 0.00725102424621582,
        "cmd_pid": 34611,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34611",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:20",
            "--end",
            "2026-01-03 08:56:24",
            "--row-id",
            "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_alias_only.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34611",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1494,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:22.241088-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34611) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:22.241088-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34611) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34611,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34611)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34611\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459382220,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:20",
          "observer_window_end": "2026-01-03 08:56:24",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_var_tmp_private_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":34614}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":34614}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459382.222633,
        "cmd_finished_at_unix_s": 1767459382.229902,
        "cmd_duration_s": 0.007269144058227539,
        "cmd_pid": 34614,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34614",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:20",
            "--end",
            "2026-01-03 08:56:24",
            "--row-id",
            "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_private_only.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34614",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1417,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:22.363607-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34614) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:22.363607-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34614) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34614,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34614)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34614\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459382345,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:20",
          "observer_window_end": "2026-01-03 08:56:24",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":34617}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":34617}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459382.347212,
        "cmd_finished_at_unix_s": 1767459382.354506,
        "cmd_duration_s": 0.0072939395904541016,
        "cmd_pid": 34617,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34617",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:20",
            "--end",
            "2026-01-03 08:56:24",
            "--row-id",
            "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_private_only.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34617",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1418,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:22.488227-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34617) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:22.488227-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34617) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34617,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34617)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34617\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459382471,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:20",
          "observer_window_end": "2026-01-03 08:56:24",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":34620}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":34620}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459382.472756,
        "cmd_finished_at_unix_s": 1767459382.479966,
        "cmd_duration_s": 0.0072100162506103516,
        "cmd_pid": 34620,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34620",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:20",
            "--end",
            "2026-01-03 08:56:24",
            "--row-id",
            "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_private_only.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34620",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1158,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34620,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34620)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34620\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459382597,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:20",
          "observer_window_end": "2026-01-03 08:56:24",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":34623}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":34623}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459382.5993931,
        "cmd_finished_at_unix_s": 1767459382.606731,
        "cmd_duration_s": 0.007337808609008789,
        "cmd_pid": 34623,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34623",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:20",
            "--end",
            "2026-01-03 08:56:24",
            "--row-id",
            "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_private_only.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34623",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1159,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34623,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34623)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34623\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459382723,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:20",
          "observer_window_end": "2026-01-03 08:56:24",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":34626}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":34626}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459382.7247329,
        "cmd_finished_at_unix_s": 1767459382.731982,
        "cmd_duration_s": 0.007249116897583008,
        "cmd_pid": 34626,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34626",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:20",
            "--end",
            "2026-01-03 08:56:24",
            "--row-id",
            "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_private_only.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34626",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1178,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34626,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34626)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34626\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459382858,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:20",
          "observer_window_end": "2026-01-03 08:56:24",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":34638}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":34638}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459382.860388,
        "cmd_finished_at_unix_s": 1767459382.86763,
        "cmd_duration_s": 0.007241964340209961,
        "cmd_pid": 34638,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34638",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:20",
            "--end",
            "2026-01-03 08:56:24",
            "--row-id",
            "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_private_only.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34638",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1179,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34638,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34638)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34638\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459383036,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:20",
          "observer_window_end": "2026-01-03 08:56:24",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_var_tmp_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":34641}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":34641}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459383.038829,
        "cmd_finished_at_unix_s": 1767459383.04607,
        "cmd_duration_s": 0.007241010665893555,
        "cmd_pid": 34641,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34641",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:21",
            "--end",
            "2026-01-03 08:56:25",
            "--row-id",
            "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_both.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34641",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1409,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:23.179798-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34641) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:23.179798-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34641) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34641,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34641)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34641\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459383174,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:21",
          "observer_window_end": "2026-01-03 08:56:25",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":34644}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":34644}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459383.175714,
        "cmd_finished_at_unix_s": 1767459383.1835148,
        "cmd_duration_s": 0.0078008174896240234,
        "cmd_pid": 34644,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34644",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:21",
            "--end",
            "2026-01-03 08:56:25",
            "--row-id",
            "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_both.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34644",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1410,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:23.317245-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34644) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:23.317245-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34644) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34644,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34644)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34644\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459383307,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:21",
          "observer_window_end": "2026-01-03 08:56:25",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":34647}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":34647}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459383.308898,
        "cmd_finished_at_unix_s": 1767459383.316235,
        "cmd_duration_s": 0.007337093353271484,
        "cmd_pid": 34647,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34647",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:21",
            "--end",
            "2026-01-03 08:56:25",
            "--row-id",
            "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_both.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34647",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34647,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34647)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34647\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459383439,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:21",
          "observer_window_end": "2026-01-03 08:56:25",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":34650}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":34650}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459383.4410508,
        "cmd_finished_at_unix_s": 1767459383.4483142,
        "cmd_duration_s": 0.0072634220123291016,
        "cmd_pid": 34650,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34650",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:21",
            "--end",
            "2026-01-03 08:56:25",
            "--row-id",
            "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_both.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34650",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1151,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34650,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34650)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34650\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459383575,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:21",
          "observer_window_end": "2026-01-03 08:56:25",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":34653}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":34653}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459383.576749,
        "cmd_finished_at_unix_s": 1767459383.58405,
        "cmd_duration_s": 0.007300853729248047,
        "cmd_pid": 34653,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34653",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:21",
            "--end",
            "2026-01-03 08:56:25",
            "--row-id",
            "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_both.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34653",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1170,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34653,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34653)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34653\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459383705,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:21",
          "observer_window_end": "2026-01-03 08:56:25",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":34656}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":34656}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459383.707357,
        "cmd_finished_at_unix_s": 1767459383.7146518,
        "cmd_duration_s": 0.007294893264770508,
        "cmd_pid": 34656,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34656",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:21",
            "--end",
            "2026-01-03 08:56:25",
            "--row-id",
            "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_both.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34656",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1171,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34656,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34656)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34656\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459383839,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:21",
          "observer_window_end": "2026-01-03 08:56:25",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_var_tmp_both_plus_metadata_var": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_both_plus_metadata_var.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/var",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:lstat_/var",
        "operation": "file-read-metadata",
        "path": "/var",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "canonical_flag_reason": "not_requested",
              "no_report_reason": null,
              "token_status": "ok",
              "varargs_count": 1,
              "filter_type_name": "path",
              "decision": "deny",
              "errno": 0,
              "marker_schema_version": 2,
              "check_type": 1073741824,
              "stage": "pre_syscall",
              "rc": 1,
              "filter_type": 0,
              "no_report": true,
              "token_mach_kr": 0,
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-metadata",
              "error": null,
              "argument": "/var",
              "tool": "seatbelt-callout",
              "canonicalization": "raw",
              "canonical_flag_used": false
            },
            {
              "canonical_flag_reason": null,
              "no_report_reason": null,
              "token_status": "ok",
              "varargs_count": 1,
              "filter_type_name": "path",
              "decision": "deny",
              "errno": 0,
              "marker_schema_version": 2,
              "check_type": 1610612736,
              "stage": "pre_syscall",
              "rc": 1,
              "filter_type": 0,
              "no_report": true,
              "token_mach_kr": 0,
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-metadata",
              "error": null,
              "argument": "/var",
              "tool": "seatbelt-callout",
              "canonicalization": "canonical",
              "canonical_flag_used": true
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/var",
          "--syscall",
          "lstat"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"mode\":\"sbpl\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b\\/runtime_profiles\\/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"errno\":0,\"rc\":0,\"err_class_source\":\"none\",\"stage\":\"apply\",\"pid\":34659,\"err_class\":\"ok\",\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"api\":\"sandbox_init\",\"errbuf\":null}\n{\"mode\":\"sbpl\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b\\/runtime_profiles\\/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"rc\":0,\"stage\":\"applied\",\"pid\":34659,\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"api\":\"sandbox_init\"}\n{\"canonical_flag_reason\":\"not_requested\",\"no_report_reason\":null,\"token_status\":\"ok\",\"varargs_count\":1,\"filter_type_name\":\"path\",\"decision\":\"deny\",\"errno\":0,\"marker_schema_version\":2,\"check_type\":1073741824,\"stage\":\"pre_syscall\",\"rc\":1,\"filter_type\":0,\"no_report\":true,\"token_mach_kr\":0,\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-metadata\",\"error\":null,\"argument\":\"\\/var\",\"tool\":\"seatbelt-callout\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false}\n{\"canonical_flag_reason\":null,\"no_report_reason\":null,\"token_status\":\"ok\",\"varargs_count\":1,\"filter_type_name\":\"path\",\"decision\":\"deny\",\"errno\":0,\"marker_schema_version\":2,\"check_type\":1610612736,\"stage\":\"pre_syscall\",\"rc\":1,\"filter_type\":0,\"no_report\":true,\"token_mach_kr\":0,\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-metadata\",\"error\":null,\"argument\":\"\\/var\",\"tool\":\"seatbelt-callout\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 0,
          "errno_name": "OK",
          "message": "stat-ok",
          "op": "file-read-metadata",
          "path": "/var",
          "status": "ok",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767459383.841982,
        "cmd_finished_at_unix_s": 1767459384.295072,
        "cmd_duration_s": 0.45309019088745117,
        "cmd_pid": 34659,
        "cmd_process_name": "metadata_runner",
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34659",
            "--process-name",
            "metadata_runner",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:21",
            "--end",
            "2026-01-03 08:56:26",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:lstat_/var"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_both_plus_metadata_var.lstat__var.observer.json",
          "log_write_error": null,
          "pid": "34659",
          "process_name": "metadata_runner",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:lstat_/var",
          "correlation_id": null,
          "stdout_bytes": 8499,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:24.422202-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) sysctl-read kern.maxfilesperproc",
                "2026-01-03 08:56:24.424363-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/api/runtime/native/metadata_runner",
                "2026-01-03 08:56:24.424413-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/api/runtime/native/metadata_runner",
                "2026-01-03 08:56:24.425296-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:24.425402-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:24.425449-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:24.425455-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-metadata /Users/achyland",
                "2026-01-03 08:56:24.425763-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:24.425856-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:24.426303-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:24.426309-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:24.426383-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:24.426460-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:24.426472-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:24.426544-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:24.426627-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:24.426631-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:24.426696-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:24.426765-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:24.426779-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:24.426843-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:24.427325-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:24.427330-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:24.422202-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) sysctl-read kern.maxfilesperproc\n2026-01-03 08:56:24.424363-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/api/runtime/native/metadata_runner\n2026-01-03 08:56:24.424413-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/api/runtime/native/metadata_runner\n2026-01-03 08:56:24.425296-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:24.425402-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc\n2026-01-03 08:56:24.425449-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc\n2026-01-03 08:56:24.425455-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-metadata /Users/achyland\n2026-01-03 08:56:24.425763-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:24.425856-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc\n2026-01-03 08:56:24.426303-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc\n2026-01-03 08:56:24.426309-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:24.426383-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc\n2026-01-03 08:56:24.426460-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc\n2026-01-03 08:56:24.426472-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:24.426544-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc\n2026-01-03 08:56:24.426627-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc\n2026-01-03 08:56:24.426631-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:24.426696-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc\n2026-01-03 08:56:24.426765-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc\n2026-01-03 08:56:24.426779-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:24.426843-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc\n2026-01-03 08:56:24.427325-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34659) deny(1) file-read-metadata /etc\n2026-01-03 08:56:24.427330-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34659) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 24,
              "observer_schema_version": 1,
              "pid": 34659,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: metadata_runner(34659)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34659\")))",
              "process_name": "metadata_runner",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:lstat_/var",
              "start": "2026-01-03 08:56:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459384463,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:21",
          "observer_window_end": "2026-01-03 08:56:26",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":34662}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":34662}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459384.465423,
        "cmd_finished_at_unix_s": 1767459384.472613,
        "cmd_duration_s": 0.00718998908996582,
        "cmd_pid": 34662,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34662",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:22",
            "--end",
            "2026-01-03 08:56:26",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_both_plus_metadata_var.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34662",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1160,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34662,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34662)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34662\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459384585,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:22",
          "observer_window_end": "2026-01-03 08:56:26",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":34665}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":34665}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459384.587241,
        "cmd_finished_at_unix_s": 1767459384.594402,
        "cmd_duration_s": 0.007161140441894531,
        "cmd_pid": 34665,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34665",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:22",
            "--end",
            "2026-01-03 08:56:26",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_both_plus_metadata_var.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34665",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1161,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34665,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34665)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34665\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459384708,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:22",
          "observer_window_end": "2026-01-03 08:56:26",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":34668}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":34668}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459384.709953,
        "cmd_finished_at_unix_s": 1767459384.717196,
        "cmd_duration_s": 0.007242918014526367,
        "cmd_pid": 34668,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34668",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:22",
            "--end",
            "2026-01-03 08:56:26",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_both_plus_metadata_var.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34668",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1168,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34668,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34668)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34668\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459384832,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:22",
          "observer_window_end": "2026-01-03 08:56:26",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":34671}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":34671}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459384.834226,
        "cmd_finished_at_unix_s": 1767459384.84154,
        "cmd_duration_s": 0.007314205169677734,
        "cmd_pid": 34671,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34671",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:22",
            "--end",
            "2026-01-03 08:56:26",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_both_plus_metadata_var.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34671",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1169,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34671,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34671)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34671\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459384954,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:22",
          "observer_window_end": "2026-01-03 08:56:26",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_var_tmp_data_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_data_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":34674}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":34674}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459384.9565172,
        "cmd_finished_at_unix_s": 1767459384.9636889,
        "cmd_duration_s": 0.007171630859375,
        "cmd_pid": 34674,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34674",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:22",
            "--end",
            "2026-01-03 08:56:26",
            "--row-id",
            "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_data_only.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34674",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1414,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:25.097474-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34674) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:25.097474-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34674) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34674,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34674)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34674\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459385082,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:22",
          "observer_window_end": "2026-01-03 08:56:26",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":34677}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":34677}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459385.0840042,
        "cmd_finished_at_unix_s": 1767459385.091249,
        "cmd_duration_s": 0.00724482536315918,
        "cmd_pid": 34677,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34677",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:23",
            "--end",
            "2026-01-03 08:56:27",
            "--row-id",
            "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_data_only.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34677",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1415,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:25.225046-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34677) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:25.225046-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34677) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34677,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34677)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34677\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459385202,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:23",
          "observer_window_end": "2026-01-03 08:56:27",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":34680}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":34680}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459385.203527,
        "cmd_finished_at_unix_s": 1767459385.210996,
        "cmd_duration_s": 0.0074689388275146484,
        "cmd_pid": 34680,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34680",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:23",
            "--end",
            "2026-01-03 08:56:27",
            "--row-id",
            "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_data_only.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34680",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1470,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:25.344737-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34680) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:25.344737-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34680) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34680,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34680)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34680\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459385319,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:23",
          "observer_window_end": "2026-01-03 08:56:27",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":34683}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":34683}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459385.321387,
        "cmd_finished_at_unix_s": 1767459385.328632,
        "cmd_duration_s": 0.007245063781738281,
        "cmd_pid": 34683,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34683",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:23",
            "--end",
            "2026-01-03 08:56:27",
            "--row-id",
            "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_data_only.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34683",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1473,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:25.462411-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34683) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:25.462411-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34683) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34683,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34683)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34683\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459385437,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:23",
          "observer_window_end": "2026-01-03 08:56:27",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":34686}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":34686}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459385.439374,
        "cmd_finished_at_unix_s": 1767459385.4466271,
        "cmd_duration_s": 0.007253170013427734,
        "cmd_pid": 34686,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34686",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:23",
            "--end",
            "2026-01-03 08:56:27",
            "--row-id",
            "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_data_only.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34686",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1490,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:25.580431-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34686) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:25.580431-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34686) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34686,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34686)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34686\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459385557,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:23",
          "observer_window_end": "2026-01-03 08:56:27",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":34689}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":34689}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459385.55869,
        "cmd_finished_at_unix_s": 1767459385.565991,
        "cmd_duration_s": 0.007300853729248047,
        "cmd_pid": 34689,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34689",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:23",
            "--end",
            "2026-01-03 08:56:27",
            "--row-id",
            "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_var_tmp_data_only.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "34689",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1176,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34689,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34689)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34689\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:56:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459385675,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:23",
          "observer_window_end": "2026-01-03 08:56:27",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_etc_alias_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_alias_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_alias_only:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":34692}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":34692}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459385.677578,
        "cmd_finished_at_unix_s": 1767459385.684831,
        "cmd_duration_s": 0.007252931594848633,
        "cmd_pid": 34692,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34692",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:23",
            "--end",
            "2026-01-03 08:56:27",
            "--row-id",
            "vfs_etc_alias_only:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_etc_alias_only.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "34692",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_alias_only:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1130,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34692,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34692)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34692\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_alias_only:read_/etc/hosts",
              "start": "2026-01-03 08:56:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459385797,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:23",
          "observer_window_end": "2026-01-03 08:56:27",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_alias_only:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":34695}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":34695}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459385.79858,
        "cmd_finished_at_unix_s": 1767459385.805717,
        "cmd_duration_s": 0.0071370601654052734,
        "cmd_pid": 34695,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34695",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:23",
            "--end",
            "2026-01-03 08:56:27",
            "--row-id",
            "vfs_etc_alias_only:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_etc_alias_only.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "34695",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_alias_only:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1138,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34695,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34695)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34695\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_alias_only:read_/private/etc/hosts",
              "start": "2026-01-03 08:56:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459385919,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:23",
          "observer_window_end": "2026-01-03 08:56:27",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_etc_private_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_private_only:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":34698}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":34698}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459385.92176,
        "cmd_finished_at_unix_s": 1767459385.929108,
        "cmd_duration_s": 0.007347822189331055,
        "cmd_pid": 34698,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34698",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:23",
            "--end",
            "2026-01-03 08:56:27",
            "--row-id",
            "vfs_etc_private_only:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_etc_private_only.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "34698",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_private_only:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1399,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:26.062880-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34698) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:26.062880-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34698) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34698,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34698)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34698\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_private_only:read_/etc/hosts",
              "start": "2026-01-03 08:56:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459386043,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:23",
          "observer_window_end": "2026-01-03 08:56:27",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_private_only:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":34701}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":34701}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459386.045025,
        "cmd_finished_at_unix_s": 1767459386.052248,
        "cmd_duration_s": 0.007222890853881836,
        "cmd_pid": 34701,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34701",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:24",
            "--end",
            "2026-01-03 08:56:28",
            "--row-id",
            "vfs_etc_private_only:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_etc_private_only.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "34701",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_private_only:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1140,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34701,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34701)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34701\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_private_only:read_/private/etc/hosts",
              "start": "2026-01-03 08:56:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459386157,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:24",
          "observer_window_end": "2026-01-03 08:56:28",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_etc_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_both:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":34704}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":34704}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459386.159539,
        "cmd_finished_at_unix_s": 1767459386.166657,
        "cmd_duration_s": 0.0071179866790771484,
        "cmd_pid": 34704,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34704",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:24",
            "--end",
            "2026-01-03 08:56:28",
            "--row-id",
            "vfs_etc_both:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_etc_both.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "34704",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1391,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:26.300457-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34704) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:26.300457-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34704) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34704,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34704)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34704\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both:read_/etc/hosts",
              "start": "2026-01-03 08:56:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459386266,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:24",
          "observer_window_end": "2026-01-03 08:56:28",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_both:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":34707}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":34707}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459386.267931,
        "cmd_finished_at_unix_s": 1767459386.275106,
        "cmd_duration_s": 0.007174968719482422,
        "cmd_pid": 34707,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34707",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:24",
            "--end",
            "2026-01-03 08:56:28",
            "--row-id",
            "vfs_etc_both:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_etc_both.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "34707",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1132,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34707,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34707)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34707\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both:read_/private/etc/hosts",
              "start": "2026-01-03 08:56:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459386380,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:24",
          "observer_window_end": "2026-01-03 08:56:28",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_etc/hosts",
        "expectation_id": "vfs_etc_both:read_openat_rootrel_etc/hosts",
        "operation": "file-read*",
        "path": "etc/hosts",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":34710}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":34710}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopenat(root) target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459386.3814862,
        "cmd_finished_at_unix_s": 1767459386.388705,
        "cmd_duration_s": 0.007218837738037109,
        "cmd_pid": 34710,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34710",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:24",
            "--end",
            "2026-01-03 08:56:28",
            "--row-id",
            "vfs_etc_both:read_openat_rootrel_etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_etc_both.read_openat_rootrel_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "34710",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_openat_rootrel_etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1465,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:26.522536-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_rootrel_reader(34710) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:26.522536-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_rootrel_reader(34710) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34710,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(34710)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34710\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_etc_both:read_openat_rootrel_etc/hosts",
              "start": "2026-01-03 08:56:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459386495,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:24",
          "observer_window_end": "2026-01-03 08:56:28",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_private/etc/hosts",
        "expectation_id": "vfs_etc_both:read_openat_rootrel_private/etc/hosts",
        "operation": "file-read*",
        "path": "private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":34713}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":34713}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459386.496636,
        "cmd_finished_at_unix_s": 1767459386.5037818,
        "cmd_duration_s": 0.007145881652832031,
        "cmd_pid": 34713,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34713",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:24",
            "--end",
            "2026-01-03 08:56:28",
            "--row-id",
            "vfs_etc_both:read_openat_rootrel_private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_etc_both.read_openat_rootrel_private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "34713",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_openat_rootrel_private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1176,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34713,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(34713)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34713\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_etc_both:read_openat_rootrel_private/etc/hosts",
              "start": "2026-01-03 08:56:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459386608,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:24",
          "observer_window_end": "2026-01-03 08:56:28",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_etc_both_plus_metadata_etc": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_both_plus_metadata_etc.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/etc",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:lstat_/etc",
        "operation": "file-read-metadata",
        "path": "/etc",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "check_type": 1073741824,
              "errno": 0,
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "canonicalization": "raw",
              "operation": "file-read-metadata",
              "canonical_flag_reason": "not_requested",
              "filter_type_name": "path",
              "argument": "/etc",
              "error": null,
              "rc": 1,
              "filter_type": 0,
              "no_report_reason": null,
              "canonical_flag_used": false,
              "varargs_count": 1,
              "no_report": true,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "token_status": "ok",
              "token_mach_kr": 0,
              "decision": "deny"
            },
            {
              "check_type": 1610612736,
              "errno": 0,
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "canonicalization": "canonical",
              "operation": "file-read-metadata",
              "canonical_flag_reason": null,
              "filter_type_name": "path",
              "argument": "/etc",
              "error": null,
              "rc": 1,
              "filter_type": 0,
              "no_report_reason": null,
              "canonical_flag_used": true,
              "varargs_count": 1,
              "no_report": true,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "token_status": "ok",
              "token_mach_kr": 0,
              "decision": "deny"
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/etc",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/etc",
          "--syscall",
          "lstat"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"errno\":0,\"mode\":\"sbpl\",\"tool\":\"sbpl-apply\",\"err_class_source\":\"none\",\"pid\":34716,\"marker_schema_version\":1,\"stage\":\"apply\",\"api\":\"sandbox_init\",\"rc\":0,\"errbuf\":null,\"err_class\":\"ok\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b\\/runtime_profiles\\/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\"}\n{\"rc\":0,\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b\\/runtime_profiles\\/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"tool\":\"sbpl-apply\",\"stage\":\"applied\",\"api\":\"sandbox_init\",\"mode\":\"sbpl\",\"marker_schema_version\":1,\"pid\":34716}\n{\"check_type\":1073741824,\"errno\":0,\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"canonicalization\":\"raw\",\"operation\":\"file-read-metadata\",\"canonical_flag_reason\":\"not_requested\",\"filter_type_name\":\"path\",\"argument\":\"\\/etc\",\"error\":null,\"rc\":1,\"filter_type\":0,\"no_report_reason\":null,\"canonical_flag_used\":false,\"varargs_count\":1,\"no_report\":true,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"token_status\":\"ok\",\"token_mach_kr\":0,\"decision\":\"deny\"}\n{\"check_type\":1610612736,\"errno\":0,\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"canonicalization\":\"canonical\",\"operation\":\"file-read-metadata\",\"canonical_flag_reason\":null,\"filter_type_name\":\"path\",\"argument\":\"\\/etc\",\"error\":null,\"rc\":1,\"filter_type\":0,\"no_report_reason\":null,\"canonical_flag_used\":true,\"varargs_count\":1,\"no_report\":true,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"token_status\":\"ok\",\"token_mach_kr\":0,\"decision\":\"deny\"}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 0,
          "errno_name": "OK",
          "message": "stat-ok",
          "op": "file-read-metadata",
          "path": "/etc",
          "status": "ok",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767459386.610081,
        "cmd_finished_at_unix_s": 1767459386.619602,
        "cmd_duration_s": 0.009521007537841797,
        "cmd_pid": 34716,
        "cmd_process_name": "metadata_runner",
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/etc",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34716",
            "--process-name",
            "metadata_runner",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:24",
            "--end",
            "2026-01-03 08:56:28",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:lstat_/etc"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_etc_both_plus_metadata_etc.lstat__etc.observer.json",
          "log_write_error": null,
          "pid": "34716",
          "process_name": "metadata_runner",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:lstat_/etc",
          "correlation_id": null,
          "stdout_bytes": 8531,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:26.751608-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) sysctl-read kern.maxfilesperproc",
                "2026-01-03 08:56:26.752199-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/api/runtime/native/metadata_runner",
                "2026-01-03 08:56:26.752208-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/api/runtime/native/metadata_runner",
                "2026-01-03 08:56:26.752441-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:26.752515-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 08:56:26.752523-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 08:56:26.752532-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-metadata /Users/achyland",
                "2026-01-03 08:56:26.752621-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:26.752656-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 08:56:26.752660-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 08:56:26.752781-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:26.752812-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 08:56:26.752816-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 08:56:26.752836-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:26.752864-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 08:56:26.752868-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 08:56:26.752888-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:26.752914-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 08:56:26.752918-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 08:56:26.752937-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:26.752962-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 08:56:26.752967-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 08:56:26.753089-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:26.751608-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) sysctl-read kern.maxfilesperproc\n2026-01-03 08:56:26.752199-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/api/runtime/native/metadata_runner\n2026-01-03 08:56:26.752208-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/api/runtime/native/metadata_runner\n2026-01-03 08:56:26.752441-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:26.752515-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-data /private/etc/passwd\n2026-01-03 08:56:26.752523-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 08:56:26.752532-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-metadata /Users/achyland\n2026-01-03 08:56:26.752621-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:26.752656-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-data /private/etc/passwd\n2026-01-03 08:56:26.752660-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 08:56:26.752781-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:26.752812-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-data /private/etc/passwd\n2026-01-03 08:56:26.752816-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 08:56:26.752836-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:26.752864-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-data /private/etc/passwd\n2026-01-03 08:56:26.752868-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 08:56:26.752888-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:26.752914-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-data /private/etc/passwd\n2026-01-03 08:56:26.752918-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 08:56:26.752937-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:26.752962-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-data /private/etc/passwd\n2026-01-03 08:56:26.752967-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 08:56:26.753089-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34716) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 24,
              "observer_schema_version": 1,
              "pid": 34716,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: metadata_runner(34716)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34716\")))",
              "process_name": "metadata_runner",
              "row_id": "vfs_etc_both_plus_metadata_etc:lstat_/etc",
              "start": "2026-01-03 08:56:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459386724,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:24",
          "observer_window_end": "2026-01-03 08:56:28",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_etc/hosts",
        "operation": "file-read*",
        "path": "etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":34719}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":34719}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459386.725952,
        "cmd_finished_at_unix_s": 1767459386.733143,
        "cmd_duration_s": 0.007191181182861328,
        "cmd_pid": 34719,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34719",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:24",
            "--end",
            "2026-01-03 08:56:28",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_etc_both_plus_metadata_etc.read_openat_rootrel_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "34719",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1186,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34719,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(34719)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34719\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_etc/hosts",
              "start": "2026-01-03 08:56:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459386841,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:24",
          "observer_window_end": "2026-01-03 08:56:28",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_private/etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_private/etc/hosts",
        "operation": "file-read*",
        "path": "private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":34722}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":34722}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459386.842842,
        "cmd_finished_at_unix_s": 1767459386.850528,
        "cmd_duration_s": 0.00768589973449707,
        "cmd_pid": 34722,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34722",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:24",
            "--end",
            "2026-01-03 08:56:28",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_etc_both_plus_metadata_etc.read_openat_rootrel_private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "34722",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1194,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34722,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(34722)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34722\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_private/etc/hosts",
              "start": "2026-01-03 08:56:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459386959,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:24",
          "observer_window_end": "2026-01-03 08:56:28",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":34725}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":34725}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459386.960979,
        "cmd_finished_at_unix_s": 1767459386.968159,
        "cmd_duration_s": 0.007179975509643555,
        "cmd_pid": 34725,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34725",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:24",
            "--end",
            "2026-01-03 08:56:28",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_etc_both_plus_metadata_etc.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "34725",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1142,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34725,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34725)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34725\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_/etc/hosts",
              "start": "2026-01-03 08:56:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459387080,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:24",
          "observer_window_end": "2026-01-03 08:56:28",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":34728}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":34728}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459387.082019,
        "cmd_finished_at_unix_s": 1767459387.089134,
        "cmd_duration_s": 0.007114887237548828,
        "cmd_pid": 34728,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34728",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:25",
            "--end",
            "2026-01-03 08:56:29",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_etc_both_plus_metadata_etc.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "34728",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34728,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34728)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34728\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts",
              "start": "2026-01-03 08:56:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459387194,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:25",
          "observer_window_end": "2026-01-03 08:56:29",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_firmlink_private_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":34731}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":34731}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459387.196091,
        "cmd_finished_at_unix_s": 1767459387.203341,
        "cmd_duration_s": 0.007250070571899414,
        "cmd_pid": 34731,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34731",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:25",
            "--end",
            "2026-01-03 08:56:29",
            "--row-id",
            "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_firmlink_private_only.read__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "34731",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1158,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34731,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34731)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34731\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:56:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459387309,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:25",
          "observer_window_end": "2026-01-03 08:56:29",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":34734}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":34734}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459387.3107278,
        "cmd_finished_at_unix_s": 1767459387.318072,
        "cmd_duration_s": 0.007344245910644531,
        "cmd_pid": 34734,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34734",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:25",
            "--end",
            "2026-01-03 08:56:29",
            "--row-id",
            "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_firmlink_private_only.write__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "34734",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1159,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34734,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34734)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34734\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:56:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459387419,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:25",
          "observer_window_end": "2026-01-03 08:56:29",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":34737}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":34737}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459387.420529,
        "cmd_finished_at_unix_s": 1767459387.427726,
        "cmd_duration_s": 0.007197141647338867,
        "cmd_pid": 34737,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34737",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:25",
            "--end",
            "2026-01-03 08:56:29",
            "--row-id",
            "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_firmlink_private_only.read__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "34737",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1178,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34737,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34737)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34737\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:56:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459387532,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:25",
          "observer_window_end": "2026-01-03 08:56:29",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":34740}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":34740}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459387.533601,
        "cmd_finished_at_unix_s": 1767459387.5408819,
        "cmd_duration_s": 0.007280826568603516,
        "cmd_pid": 34740,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34740",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:25",
            "--end",
            "2026-01-03 08:56:29",
            "--row-id",
            "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_firmlink_private_only.write__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "34740",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1179,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34740,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34740)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34740\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:56:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459387644,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:25",
          "observer_window_end": "2026-01-03 08:56:29",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_firmlink_data_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_data_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":34743}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":34743}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459387.6467671,
        "cmd_finished_at_unix_s": 1767459387.653963,
        "cmd_duration_s": 0.007195949554443359,
        "cmd_pid": 34743,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34743",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:25",
            "--end",
            "2026-01-03 08:56:29",
            "--row-id",
            "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_firmlink_data_only.read__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "34743",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1468,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:27.787798-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34743) deny(1) file-read-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:27.787798-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34743) deny(1) file-read-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34743,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34743)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34743\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:56:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459387758,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:25",
          "observer_window_end": "2026-01-03 08:56:29",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":34747}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":34747}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459387.7601652,
        "cmd_finished_at_unix_s": 1767459387.7672188,
        "cmd_duration_s": 0.0070536136627197266,
        "cmd_pid": 34747,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34747",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:25",
            "--end",
            "2026-01-03 08:56:29",
            "--row-id",
            "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_firmlink_data_only.write__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "34747",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1471,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:27.901095-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34747) deny(1) file-write-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:27.901095-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34747) deny(1) file-write-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34747,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34747)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34747\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:56:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459387877,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:25",
          "observer_window_end": "2026-01-03 08:56:29",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":34750}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":34750}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459387.879211,
        "cmd_finished_at_unix_s": 1767459387.886518,
        "cmd_duration_s": 0.0073070526123046875,
        "cmd_pid": 34750,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34750",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:25",
            "--end",
            "2026-01-03 08:56:29",
            "--row-id",
            "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_firmlink_data_only.read__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "34750",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1488,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:28.020375-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34750) deny(1) file-read-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:28.020375-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34750) deny(1) file-read-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34750,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34750)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34750\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:56:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459387997,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:25",
          "observer_window_end": "2026-01-03 08:56:29",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":34753}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":34753}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459387.999294,
        "cmd_finished_at_unix_s": 1767459388.006575,
        "cmd_duration_s": 0.007281064987182617,
        "cmd_pid": 34753,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34753",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:25",
            "--end",
            "2026-01-03 08:56:30",
            "--row-id",
            "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_firmlink_data_only.write__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "34753",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1491,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:28.140451-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34753) deny(1) file-write-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:28.140451-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34753) deny(1) file-write-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34753,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34753)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34753\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:56:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459388117,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:25",
          "observer_window_end": "2026-01-03 08:56:30",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_firmlink_both": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":34756}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":34756}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459388.119929,
        "cmd_finished_at_unix_s": 1767459388.127281,
        "cmd_duration_s": 0.007351875305175781,
        "cmd_pid": 34756,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34756",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:26",
            "--end",
            "2026-01-03 08:56:30",
            "--row-id",
            "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_firmlink_both.read__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "34756",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34756,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34756)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34756\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:56:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459388230,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:26",
          "observer_window_end": "2026-01-03 08:56:30",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":34759}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":34759}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459388.232304,
        "cmd_finished_at_unix_s": 1767459388.2396119,
        "cmd_duration_s": 0.007307767868041992,
        "cmd_pid": 34759,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34759",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:26",
            "--end",
            "2026-01-03 08:56:30",
            "--row-id",
            "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_firmlink_both.write__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "34759",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1151,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34759,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34759)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34759\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:56:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459388340,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:26",
          "observer_window_end": "2026-01-03 08:56:30",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":34762}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":34762}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459388.34226,
        "cmd_finished_at_unix_s": 1767459388.349483,
        "cmd_duration_s": 0.0072231292724609375,
        "cmd_pid": 34762,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34762",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:26",
            "--end",
            "2026-01-03 08:56:30",
            "--row-id",
            "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_firmlink_both.read__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "34762",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1170,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34762,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34762)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34762\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:56:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459388446,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:26",
          "observer_window_end": "2026-01-03 08:56:30",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":34765}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":34765}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459388.448118,
        "cmd_finished_at_unix_s": 1767459388.455337,
        "cmd_duration_s": 0.007219076156616211,
        "cmd_pid": 34765,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34765",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:26",
            "--end",
            "2026-01-03 08:56:30",
            "--row-id",
            "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_firmlink_both.write__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "34765",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1171,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34765,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34765)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34765\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:56:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459388558,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:26",
          "observer_window_end": "2026-01-03 08:56:30",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_link_var_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_var_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":34768}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":34768}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459388.560763,
        "cmd_finished_at_unix_s": 1767459388.56797,
        "cmd_duration_s": 0.007207155227661133,
        "cmd_pid": 34768,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34768",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:26",
            "--end",
            "2026-01-03 08:56:30",
            "--row-id",
            "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_link_var_tmp_only.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "34768",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1502,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:28.701860-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34768) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:28.701860-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34768) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34768,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34768)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34768\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 08:56:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459388668,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:26",
          "observer_window_end": "2026-01-03 08:56:30",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":34771}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":34771}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459388.670057,
        "cmd_finished_at_unix_s": 1767459388.6773,
        "cmd_duration_s": 0.007242918014526367,
        "cmd_pid": 34771,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34771",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:26",
            "--end",
            "2026-01-03 08:56:30",
            "--row-id",
            "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_link_var_tmp_only.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "34771",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1503,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:28.811183-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34771) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:28.811183-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34771) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34771,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34771)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34771\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 08:56:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459388779,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:26",
          "observer_window_end": "2026-01-03 08:56:30",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":34774}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":34774}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459388.7810261,
        "cmd_finished_at_unix_s": 1767459388.788221,
        "cmd_duration_s": 0.0071947574615478516,
        "cmd_pid": 34774,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34774",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:26",
            "--end",
            "2026-01-03 08:56:30",
            "--row-id",
            "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_link_var_tmp_only.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "34774",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1154,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34774,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34774)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34774\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 08:56:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459388889,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:26",
          "observer_window_end": "2026-01-03 08:56:30",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":34777}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":34777}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459388.891178,
        "cmd_finished_at_unix_s": 1767459388.898397,
        "cmd_duration_s": 0.007219076156616211,
        "cmd_pid": 34777,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34777",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:26",
            "--end",
            "2026-01-03 08:56:30",
            "--row-id",
            "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_link_var_tmp_only.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "34777",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1155,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34777,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34777)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34777\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 08:56:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459389000,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:26",
          "observer_window_end": "2026-01-03 08:56:30",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_link_private_tmp_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_private_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":34780}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":34780}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459389.0024378,
        "cmd_finished_at_unix_s": 1767459389.009776,
        "cmd_duration_s": 0.007338285446166992,
        "cmd_pid": 34780,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34780",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:27",
            "--end",
            "2026-01-03 08:56:31",
            "--row-id",
            "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_link_private_tmp_only.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "34780",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1506,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:29.143682-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34780) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:29.143682-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34780) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34780,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34780)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34780\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 08:56:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459389103,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:27",
          "observer_window_end": "2026-01-03 08:56:31",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":34783}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":34783}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459389.104993,
        "cmd_finished_at_unix_s": 1767459389.1122189,
        "cmd_duration_s": 0.007225751876831055,
        "cmd_pid": 34783,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34783",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:27",
            "--end",
            "2026-01-03 08:56:31",
            "--row-id",
            "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_link_private_tmp_only.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "34783",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1507,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:29.246113-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34783) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:29.246113-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34783) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34783,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34783)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34783\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 08:56:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459389207,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:27",
          "observer_window_end": "2026-01-03 08:56:31",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":34786}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":34786}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459389.208747,
        "cmd_finished_at_unix_s": 1767459389.216129,
        "cmd_duration_s": 0.00738215446472168,
        "cmd_pid": 34786,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34786",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:27",
            "--end",
            "2026-01-03 08:56:31",
            "--row-id",
            "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_link_private_tmp_only.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "34786",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1471,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:29.350020-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34786) deny(1) file-read-data /private/var/tmp/vfs_link_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:29.350020-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34786) deny(1) file-read-data /private/var/tmp/vfs_link_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34786,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34786)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34786\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 08:56:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459389308,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:27",
          "observer_window_end": "2026-01-03 08:56:31",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":34789}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":34789}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459389.309537,
        "cmd_finished_at_unix_s": 1767459389.31677,
        "cmd_duration_s": 0.007233142852783203,
        "cmd_pid": 34789,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34789",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:27",
            "--end",
            "2026-01-03 08:56:31",
            "--row-id",
            "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_link_private_tmp_only.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "34789",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1474,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:29.450679-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34789) deny(1) file-write-data /private/var/tmp/vfs_link_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:29.450679-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34789) deny(1) file-write-data /private/var/tmp/vfs_link_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34789,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34789)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34789\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 08:56:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459389411,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:27",
          "observer_window_end": "2026-01-03 08:56:31",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_link_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":34792}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":34792}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459389.413625,
        "cmd_finished_at_unix_s": 1767459389.420872,
        "cmd_duration_s": 0.007246971130371094,
        "cmd_pid": 34792,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34792",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:27",
            "--end",
            "2026-01-03 08:56:31",
            "--row-id",
            "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_link_both.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "34792",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1494,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:29.554786-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34792) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:29.554786-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(34792) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34792,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34792)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34792\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 08:56:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459389513,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:27",
          "observer_window_end": "2026-01-03 08:56:31",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":34795}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":34795}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459389.514944,
        "cmd_finished_at_unix_s": 1767459389.522232,
        "cmd_duration_s": 0.0072879791259765625,
        "cmd_pid": 34795,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34795",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:27",
            "--end",
            "2026-01-03 08:56:31",
            "--row-id",
            "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_link_both.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "34795",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1495,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:29.656138-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34795) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:29.656138-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(34795) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 34795,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34795)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34795\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 08:56:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459389616,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:27",
          "observer_window_end": "2026-01-03 08:56:31",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":34798}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":34798}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459389.618479,
        "cmd_finished_at_unix_s": 1767459389.625737,
        "cmd_duration_s": 0.007257938385009766,
        "cmd_pid": 34798,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34798",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:27",
            "--end",
            "2026-01-03 08:56:31",
            "--row-id",
            "vfs_link_both:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_link_both.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "34798",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1146,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34798,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34798)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34798\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 08:56:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459389724,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:27",
          "observer_window_end": "2026-01-03 08:56:31",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":34801}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":34801}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459389.726296,
        "cmd_finished_at_unix_s": 1767459389.733516,
        "cmd_duration_s": 0.007220029830932617,
        "cmd_pid": 34801,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34801",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:27",
            "--end",
            "2026-01-03 08:56:31",
            "--row-id",
            "vfs_link_both:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_link_both.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "34801",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1147,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34801,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34801)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34801\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 08:56:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459389828,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:27",
          "observer_window_end": "2026-01-03 08:56:31",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  },
  "vfs_link_both_plus_metadata_to_var_tmp": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_both_plus_metadata_to_var_tmp.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/private/tmp/vfs_linkdir/to_var_tmp",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp",
        "operation": "file-read-metadata",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "no_report_reason": null,
              "token_status": "ok",
              "canonical_flag_reason": "not_requested",
              "varargs_count": 1,
              "canonicalization": "raw",
              "filter_type": 0,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
              "check_type": 1073741824,
              "error": null,
              "filter_type_name": "path",
              "errno": 0,
              "api": "sandbox_check_by_audit_token",
              "decision": "deny",
              "token_mach_kr": 0,
              "rc": 1,
              "stage": "pre_syscall",
              "operation": "file-read-metadata",
              "canonical_flag_used": false,
              "no_report": true
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "no_report_reason": null,
              "token_status": "ok",
              "canonical_flag_reason": null,
              "varargs_count": 1,
              "canonicalization": "canonical",
              "filter_type": 0,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
              "check_type": 1610612736,
              "error": null,
              "filter_type_name": "path",
              "errno": 0,
              "api": "sandbox_check_by_audit_token",
              "decision": "deny",
              "token_mach_kr": 0,
              "rc": 1,
              "stage": "pre_syscall",
              "operation": "file-read-metadata",
              "canonical_flag_used": true,
              "no_report": true
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/private/tmp/vfs_linkdir/to_var_tmp",
          "--syscall",
          "lstat"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"errno\":0,\"err_class\":\"ok\",\"stage\":\"apply\",\"tool\":\"sbpl-apply\",\"api\":\"sandbox_init\",\"rc\":0,\"errbuf\":null,\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b\\/runtime_profiles\\/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":34804,\"marker_schema_version\":1,\"mode\":\"sbpl\",\"err_class_source\":\"none\"}\n{\"tool\":\"sbpl-apply\",\"stage\":\"applied\",\"mode\":\"sbpl\",\"marker_schema_version\":1,\"api\":\"sandbox_init\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b\\/runtime_profiles\\/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":34804,\"rc\":0}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"no_report_reason\":null,\"token_status\":\"ok\",\"canonical_flag_reason\":\"not_requested\",\"varargs_count\":1,\"canonicalization\":\"raw\",\"filter_type\":0,\"argument\":\"\\/private\\/tmp\\/vfs_linkdir\\/to_var_tmp\",\"check_type\":1073741824,\"error\":null,\"filter_type_name\":\"path\",\"errno\":0,\"api\":\"sandbox_check_by_audit_token\",\"decision\":\"deny\",\"token_mach_kr\":0,\"rc\":1,\"stage\":\"pre_syscall\",\"operation\":\"file-read-metadata\",\"canonical_flag_used\":false,\"no_report\":true}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"no_report_reason\":null,\"token_status\":\"ok\",\"canonical_flag_reason\":null,\"varargs_count\":1,\"canonicalization\":\"canonical\",\"filter_type\":0,\"argument\":\"\\/private\\/tmp\\/vfs_linkdir\\/to_var_tmp\",\"check_type\":1610612736,\"error\":null,\"filter_type_name\":\"path\",\"errno\":0,\"api\":\"sandbox_check_by_audit_token\",\"decision\":\"deny\",\"token_mach_kr\":0,\"rc\":1,\"stage\":\"pre_syscall\",\"operation\":\"file-read-metadata\",\"canonical_flag_used\":true,\"no_report\":true}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 0,
          "errno_name": "OK",
          "message": "stat-ok",
          "op": "file-read-metadata",
          "path": "/private/tmp/vfs_linkdir/to_var_tmp",
          "status": "ok",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767459389.83071,
        "cmd_finished_at_unix_s": 1767459389.840215,
        "cmd_duration_s": 0.009505033493041992,
        "cmd_pid": 34804,
        "cmd_process_name": "metadata_runner",
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34804",
            "--process-name",
            "metadata_runner",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:27",
            "--end",
            "2026-01-03 08:56:31",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_link_both_plus_metadata_to_var_tmp.lstat__private_tmp_vfs_linkdir_to_var_tmp.observer.json",
          "log_write_error": null,
          "pid": "34804",
          "process_name": "metadata_runner",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp",
          "correlation_id": null,
          "stdout_bytes": 8534,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:56:29.972367-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) sysctl-read kern.maxfilesperproc",
                "2026-01-03 08:56:29.972957-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/api/runtime/native/metadata_runner",
                "2026-01-03 08:56:29.972966-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/api/runtime/native/metadata_runner",
                "2026-01-03 08:56:29.973179-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:29.973215-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:29.973229-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:29.973230-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-metadata /Users/achyland",
                "2026-01-03 08:56:29.973319-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:29.973340-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:29.973459-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:29.973461-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:29.973484-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:29.973503-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:29.973504-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:29.973533-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:29.973565-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:29.973566-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:29.973592-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:29.973617-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:29.973618-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:56:29.973638-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:29.973776-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc",
                "2026-01-03 08:56:29.973777-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:56:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:56:29.972367-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) sysctl-read kern.maxfilesperproc\n2026-01-03 08:56:29.972957-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/api/runtime/native/metadata_runner\n2026-01-03 08:56:29.972966-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/api/runtime/native/metadata_runner\n2026-01-03 08:56:29.973179-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:29.973215-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc\n2026-01-03 08:56:29.973229-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc\n2026-01-03 08:56:29.973230-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-metadata /Users/achyland\n2026-01-03 08:56:29.973319-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:29.973340-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc\n2026-01-03 08:56:29.973459-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc\n2026-01-03 08:56:29.973461-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:29.973484-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc\n2026-01-03 08:56:29.973503-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc\n2026-01-03 08:56:29.973504-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:29.973533-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc\n2026-01-03 08:56:29.973565-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc\n2026-01-03 08:56:29.973566-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:29.973592-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc\n2026-01-03 08:56:29.973617-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc\n2026-01-03 08:56:29.973618-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:56:29.973638-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc\n2026-01-03 08:56:29.973776-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(34804) deny(1) file-read-metadata /etc\n2026-01-03 08:56:29.973777-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(34804) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 24,
              "observer_schema_version": 1,
              "pid": 34804,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: metadata_runner(34804)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34804\")))",
              "process_name": "metadata_runner",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp",
              "start": "2026-01-03 08:56:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459389933,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:27",
          "observer_window_end": "2026-01-03 08:56:31",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":34807}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":34807}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459389.9356952,
        "cmd_finished_at_unix_s": 1767459389.942987,
        "cmd_duration_s": 0.0072917938232421875,
        "cmd_pid": 34807,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34807",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:27",
            "--end",
            "2026-01-03 08:56:31",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_link_both_plus_metadata_to_var_tmp.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "34807",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1190,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34807,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34807)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34807\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 08:56:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459390038,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:27",
          "observer_window_end": "2026-01-03 08:56:31",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":34810}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":34810}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459390.039621,
        "cmd_finished_at_unix_s": 1767459390.046953,
        "cmd_duration_s": 0.00733184814453125,
        "cmd_pid": 34810,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34810",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:28",
            "--end",
            "2026-01-03 08:56:32",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_link_both_plus_metadata_to_var_tmp.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "34810",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1191,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:32",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34810,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34810)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34810\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 08:56:28",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459390134,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:28",
          "observer_window_end": "2026-01-03 08:56:32",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":34813}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":34813}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459390.136118,
        "cmd_finished_at_unix_s": 1767459390.14341,
        "cmd_duration_s": 0.007292032241821289,
        "cmd_pid": 34813,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34813",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:28",
            "--end",
            "2026-01-03 08:56:32",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_link_both_plus_metadata_to_var_tmp.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "34813",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1171,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:32",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34813,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(34813)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34813\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 08:56:28",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459390238,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:28",
          "observer_window_end": "2026-01-03 08:56:32",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":34816}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":34816}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767459390.240404,
        "cmd_finished_at_unix_s": 1767459390.2476978,
        "cmd_duration_s": 0.0072939395904541016,
        "cmd_pid": 34816,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "34816",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:56:28",
            "--end",
            "2026-01-03 08:56:32",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b/observer/vfs_link_both_plus_metadata_to_var_tmp.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "34816",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1172,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:56:32",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 34816,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(34816)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"34816\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 08:56:28",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767459390339,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:56:28",
          "observer_window_end": "2026-01-03 08:56:32",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "aa92be2a-d86e-4fed-8b0c-acd77fbb8f4b"
  }
}