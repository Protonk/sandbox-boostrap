{
  "vfs_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_tmp_only:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62280}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62280}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464408.244145,
        "cmd_finished_at_unix_s": 1767464408.493299,
        "cmd_duration_s": 0.24915409088134766,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62281}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62281}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464408.4950132,
        "cmd_finished_at_unix_s": 1767464408.51353,
        "cmd_duration_s": 0.01851677894592285,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_tmp_only:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62282}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62282}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464408.514616,
        "cmd_finished_at_unix_s": 1767464408.865621,
        "cmd_duration_s": 0.35100507736206055,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62285}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62285}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464408.8667269,
        "cmd_finished_at_unix_s": 1767464408.882936,
        "cmd_duration_s": 0.016209125518798828,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_tmp_only:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62286}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62286}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464408.883849,
        "cmd_finished_at_unix_s": 1767464408.899132,
        "cmd_duration_s": 0.01528310775756836,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62287}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62287}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464408.899891,
        "cmd_finished_at_unix_s": 1767464408.910995,
        "cmd_duration_s": 0.011104106903076172,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_tmp_only:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62288}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62288}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464408.9115741,
        "cmd_finished_at_unix_s": 1767464408.920682,
        "cmd_duration_s": 0.009107828140258789,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62289}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62289}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464408.9211771,
        "cmd_finished_at_unix_s": 1767464408.929736,
        "cmd_duration_s": 0.00855875015258789,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62290}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62290}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464408.930235,
        "cmd_finished_at_unix_s": 1767464408.9377222,
        "cmd_duration_s": 0.007487297058105469,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62291}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62291}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464408.938139,
        "cmd_finished_at_unix_s": 1767464408.956749,
        "cmd_duration_s": 0.018610000610351562,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62292}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62292}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464408.957226,
        "cmd_finished_at_unix_s": 1767464408.965036,
        "cmd_duration_s": 0.007809877395629883,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62293}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62293}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464408.965469,
        "cmd_finished_at_unix_s": 1767464408.972657,
        "cmd_duration_s": 0.007188081741333008,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62294}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62294}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464408.973074,
        "cmd_finished_at_unix_s": 1767464408.980095,
        "cmd_duration_s": 0.0070209503173828125,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62295}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62295}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464408.980493,
        "cmd_finished_at_unix_s": 1767464408.987319,
        "cmd_duration_s": 0.006825923919677734,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62296}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62296}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464408.987732,
        "cmd_finished_at_unix_s": 1767464408.994826,
        "cmd_duration_s": 0.007094144821166992,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62297}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":62297}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464408.9952672,
        "cmd_finished_at_unix_s": 1767464409.002413,
        "cmd_duration_s": 0.007145881652832031,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_private_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_private_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62298}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62298}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.003712,
        "cmd_finished_at_unix_s": 1767464409.010918,
        "cmd_duration_s": 0.007205963134765625,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62299}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62299}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.011358,
        "cmd_finished_at_unix_s": 1767464409.0186281,
        "cmd_duration_s": 0.007270097732543945,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62300}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62300}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.0190341,
        "cmd_finished_at_unix_s": 1767464409.026007,
        "cmd_duration_s": 0.006972789764404297,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62301}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62301}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.026443,
        "cmd_finished_at_unix_s": 1767464409.0335019,
        "cmd_duration_s": 0.007058858871459961,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62302}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62302}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.033866,
        "cmd_finished_at_unix_s": 1767464409.040669,
        "cmd_duration_s": 0.006803035736083984,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62303}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62303}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.0410602,
        "cmd_finished_at_unix_s": 1767464409.0478761,
        "cmd_duration_s": 0.006815910339355469,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62304}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62304}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.048275,
        "cmd_finished_at_unix_s": 1767464409.055198,
        "cmd_duration_s": 0.00692296028137207,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62305}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62305}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.055574,
        "cmd_finished_at_unix_s": 1767464409.062546,
        "cmd_duration_s": 0.006972074508666992,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62306}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62306}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.062944,
        "cmd_finished_at_unix_s": 1767464409.0698571,
        "cmd_duration_s": 0.006913185119628906,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62307}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62307}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.070266,
        "cmd_finished_at_unix_s": 1767464409.0770519,
        "cmd_duration_s": 0.006785869598388672,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62308}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62308}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.077429,
        "cmd_finished_at_unix_s": 1767464409.084386,
        "cmd_duration_s": 0.006957054138183594,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62309}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62309}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.0847738,
        "cmd_finished_at_unix_s": 1767464409.09151,
        "cmd_duration_s": 0.006736278533935547,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62310}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62310}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.091891,
        "cmd_finished_at_unix_s": 1767464409.09894,
        "cmd_duration_s": 0.007048845291137695,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks var tmp canon\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62311}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62311}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.099364,
        "cmd_finished_at_unix_s": 1767464409.106396,
        "cmd_duration_s": 0.007031917572021484,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62312}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62312}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.106793,
        "cmd_finished_at_unix_s": 1767464409.1137788,
        "cmd_duration_s": 0.006985902786254883,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62313}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62313}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.114181,
        "cmd_finished_at_unix_s": 1767464409.121139,
        "cmd_duration_s": 0.0069580078125,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/tmp/nested/../foo",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/nested/../foo",
        "operation": "file-read*",
        "path": "/private/tmp/nested/../foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/../foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/../foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62314}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62314}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.1215181,
        "cmd_finished_at_unix_s": 1767464409.128225,
        "cmd_duration_s": 0.006706953048706055,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/../foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/tmp/nested/../foo",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/nested/../foo",
        "operation": "file-write*",
        "path": "/private/tmp/nested/../foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/../foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/../foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62315}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":62315}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.128598,
        "cmd_finished_at_unix_s": 1767464409.1353972,
        "cmd_duration_s": 0.006799221038818359,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/../foo",
          "canonicalization": "both"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_both_paths": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_both_paths.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_both_paths:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62316}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62316}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.136487,
        "cmd_finished_at_unix_s": 1767464409.143435,
        "cmd_duration_s": 0.006947994232177734,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_both_paths:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62317}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62317}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.143819,
        "cmd_finished_at_unix_s": 1767464409.1507819,
        "cmd_duration_s": 0.006962776184082031,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_both_paths:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62318}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62318}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.1511848,
        "cmd_finished_at_unix_s": 1767464409.158247,
        "cmd_duration_s": 0.007062196731567383,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_both_paths:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62319}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62319}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.158613,
        "cmd_finished_at_unix_s": 1767464409.165658,
        "cmd_duration_s": 0.00704503059387207,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_both_paths:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62320}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62320}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.166035,
        "cmd_finished_at_unix_s": 1767464409.172949,
        "cmd_duration_s": 0.0069141387939453125,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_both_paths:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62321}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62321}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.173346,
        "cmd_finished_at_unix_s": 1767464409.180224,
        "cmd_duration_s": 0.006877899169921875,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_both_paths:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62322}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62322}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.180613,
        "cmd_finished_at_unix_s": 1767464409.1876328,
        "cmd_duration_s": 0.007019758224487305,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_both_paths:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62323}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62323}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.188001,
        "cmd_finished_at_unix_s": 1767464409.194855,
        "cmd_duration_s": 0.006854057312011719,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_both_paths:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62324}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62324}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.195255,
        "cmd_finished_at_unix_s": 1767464409.202076,
        "cmd_duration_s": 0.0068209171295166016,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_both_paths:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62325}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62325}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.2024698,
        "cmd_finished_at_unix_s": 1767464409.2093701,
        "cmd_duration_s": 0.006900310516357422,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_both_paths:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62326}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62326}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.2097569,
        "cmd_finished_at_unix_s": 1767464409.2166028,
        "cmd_duration_s": 0.006845951080322266,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_both_paths:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62327}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62327}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.216977,
        "cmd_finished_at_unix_s": 1767464409.2238562,
        "cmd_duration_s": 0.006879329681396484,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_both_paths:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62328}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62328}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.224247,
        "cmd_finished_at_unix_s": 1767464409.231043,
        "cmd_duration_s": 0.006796121597290039,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_both_paths:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks var tmp canon\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62329}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62329}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.231437,
        "cmd_finished_at_unix_s": 1767464409.238369,
        "cmd_duration_s": 0.00693202018737793,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_both_paths:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62330}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62330}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.238775,
        "cmd_finished_at_unix_s": 1767464409.2456489,
        "cmd_duration_s": 0.0068738460540771484,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_both_paths:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62331}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":62331}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.246015,
        "cmd_finished_at_unix_s": 1767464409.2528582,
        "cmd_duration_s": 0.006843090057373047,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_private_tmp_only_openat": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_private_tmp_only_openat.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_open_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_open_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":62332}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":62332}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.253833,
        "cmd_finished_at_unix_s": 1767464409.2607,
        "cmd_duration_s": 0.006866931915283203,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_openat_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":62333}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":62333}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen dir: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.261163,
        "cmd_finished_at_unix_s": 1767464409.559864,
        "cmd_duration_s": 0.29870104789733887,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_open_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_open_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":62334}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":62334}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.561527,
        "cmd_finished_at_unix_s": 1767464409.581619,
        "cmd_duration_s": 0.020092010498046875,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_openat_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":62335}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":62335}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nopen dir: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.582607,
        "cmd_finished_at_unix_s": 1767464409.5971782,
        "cmd_duration_s": 0.014571189880371094,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_openat_rootrel_tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_rootrel_tmp/foo",
        "operation": "file-read*",
        "path": "tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":62336}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":62336}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.597847,
        "cmd_finished_at_unix_s": 1767464409.863539,
        "cmd_duration_s": 0.26569199562072754,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_openat_rootrel_private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_rootrel_private/tmp/foo",
        "operation": "file-read*",
        "path": "private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":62337}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":62337}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.864654,
        "cmd_finished_at_unix_s": 1767464409.885362,
        "cmd_duration_s": 0.02070784568786621,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "private/tmp/foo",
          "canonicalization": "both"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_private_tmp_only_openat_dir_allowed": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_private_tmp_only_openat_dir_allowed.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_open_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat_dir_allowed:read_open_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":62338}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":62338}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.887839,
        "cmd_finished_at_unix_s": 1767464409.903224,
        "cmd_duration_s": 0.015384912490844727,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_openat_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat_dir_allowed:read_openat_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":62339}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":62339}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.903945,
        "cmd_finished_at_unix_s": 1767464409.915513,
        "cmd_duration_s": 0.011568069458007812,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_open_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat_dir_allowed:read_open_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":62340}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":62340}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.916075,
        "cmd_finished_at_unix_s": 1767464409.9255822,
        "cmd_duration_s": 0.009507179260253906,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_openat_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat_dir_allowed:read_openat_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":62341}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":62341}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.926104,
        "cmd_finished_at_unix_s": 1767464409.934478,
        "cmd_duration_s": 0.00837397575378418,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_openat_rootrel_tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat_dir_allowed:read_openat_rootrel_tmp/foo",
        "operation": "file-read*",
        "path": "tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb",
          "tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":62342}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":62342}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.9348302,
        "cmd_finished_at_unix_s": 1767464409.942369,
        "cmd_duration_s": 0.007538795471191406,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "tmp/foo",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_openat_rootrel_private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat_dir_allowed:read_openat_rootrel_private/tmp/foo",
        "operation": "file-read*",
        "path": "private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb",
          "private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":62343}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":62343}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.942775,
        "cmd_finished_at_unix_s": 1767464409.949693,
        "cmd_duration_s": 0.0069179534912109375,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "private/tmp/foo",
          "canonicalization": "both"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_var_tmp_alias_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_alias_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":62344}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":62344}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.950924,
        "cmd_finished_at_unix_s": 1767464409.957908,
        "cmd_duration_s": 0.00698399543762207,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":62345}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":62345}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.958281,
        "cmd_finished_at_unix_s": 1767464409.965089,
        "cmd_duration_s": 0.006808042526245117,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":62346}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":62346}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.965454,
        "cmd_finished_at_unix_s": 1767464409.972162,
        "cmd_duration_s": 0.006707906723022461,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":62347}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":62347}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.972526,
        "cmd_finished_at_unix_s": 1767464409.9792309,
        "cmd_duration_s": 0.006704807281494141,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":62348}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":62348}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.97962,
        "cmd_finished_at_unix_s": 1767464409.9863832,
        "cmd_duration_s": 0.0067632198333740234,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":62349}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":62349}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.9867709,
        "cmd_finished_at_unix_s": 1767464409.993642,
        "cmd_duration_s": 0.006871223449707031,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_var_tmp_private_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":62350}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":62350}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464409.99473,
        "cmd_finished_at_unix_s": 1767464410.00175,
        "cmd_duration_s": 0.007019996643066406,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":62351}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":62351}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.00211,
        "cmd_finished_at_unix_s": 1767464410.008876,
        "cmd_duration_s": 0.006766080856323242,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":62352}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":62352}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.0092769,
        "cmd_finished_at_unix_s": 1767464410.016475,
        "cmd_duration_s": 0.0071980953216552734,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":62353}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":62353}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.016868,
        "cmd_finished_at_unix_s": 1767464410.0237398,
        "cmd_duration_s": 0.006871700286865234,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":62354}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":62354}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.024124,
        "cmd_finished_at_unix_s": 1767464410.03085,
        "cmd_duration_s": 0.00672602653503418,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":62355}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":62355}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.0312479,
        "cmd_finished_at_unix_s": 1767464410.038039,
        "cmd_duration_s": 0.006791114807128906,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_var_tmp_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":62356}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":62356}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.038997,
        "cmd_finished_at_unix_s": 1767464410.045752,
        "cmd_duration_s": 0.00675511360168457,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":62357}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":62357}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.046128,
        "cmd_finished_at_unix_s": 1767464410.052783,
        "cmd_duration_s": 0.006654977798461914,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":62358}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":62358}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.053188,
        "cmd_finished_at_unix_s": 1767464410.06009,
        "cmd_duration_s": 0.006901979446411133,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":62359}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":62359}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.060488,
        "cmd_finished_at_unix_s": 1767464410.067465,
        "cmd_duration_s": 0.006977081298828125,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":62360}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":62360}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.067842,
        "cmd_finished_at_unix_s": 1767464410.074612,
        "cmd_duration_s": 0.006769895553588867,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":62361}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":62361}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.074977,
        "cmd_finished_at_unix_s": 1767464410.081863,
        "cmd_duration_s": 0.006886005401611328,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_var_tmp_both_plus_metadata_var": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_both_plus_metadata_var.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/var",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:lstat_/var",
        "operation": "file-read-metadata",
        "path": "/var",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "canonical_flag_used": false,
              "errno": 0,
              "argument": "/var",
              "canonicalization": "raw",
              "canonical_flag_reason": "not_requested",
              "no_report_reason": null,
              "varargs_count": 1,
              "operation": "file-read-metadata",
              "rc": 1,
              "filter_type_name": "unknown",
              "decision": "deny",
              "filter_type": 1,
              "token_status": "ok",
              "error": null,
              "api": "sandbox_check_by_audit_token",
              "no_report": true,
              "stage": "pre_syscall",
              "marker_schema_version": 2,
              "tool": "seatbelt-callout",
              "token_mach_kr": 0,
              "check_type": 1073741825
            },
            {
              "canonical_flag_used": true,
              "errno": 0,
              "argument": "/var",
              "canonicalization": "canonical",
              "canonical_flag_reason": null,
              "no_report_reason": null,
              "varargs_count": 1,
              "operation": "file-read-metadata",
              "rc": 1,
              "filter_type_name": "unknown",
              "decision": "deny",
              "filter_type": 1,
              "token_status": "ok",
              "error": null,
              "api": "sandbox_check_by_audit_token",
              "no_report": true,
              "stage": "pre_syscall",
              "marker_schema_version": 2,
              "tool": "seatbelt-callout",
              "token_mach_kr": 0,
              "check_type": 1610612737
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/var",
          "--syscall",
          "lstat"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"rc\":0,\"stage\":\"apply\",\"tool\":\"sbpl-apply\",\"mode\":\"sbpl\",\"err_class\":\"ok\",\"errbuf\":null,\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/945f21bb-fade-4b6f-83cd-a69a0b8f388e\\/runtime_profiles\\/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":62362,\"marker_schema_version\":1,\"api\":\"sandbox_init\",\"err_class_source\":\"none\",\"errno\":0}\n{\"rc\":0,\"stage\":\"applied\",\"tool\":\"sbpl-apply\",\"mode\":\"sbpl\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/945f21bb-fade-4b6f-83cd-a69a0b8f388e\\/runtime_profiles\\/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":62362,\"marker_schema_version\":1,\"api\":\"sandbox_init\"}\n{\"canonical_flag_used\":false,\"errno\":0,\"argument\":\"\\/var\",\"canonicalization\":\"raw\",\"canonical_flag_reason\":\"not_requested\",\"no_report_reason\":null,\"varargs_count\":1,\"operation\":\"file-read-metadata\",\"rc\":1,\"filter_type_name\":\"unknown\",\"decision\":\"deny\",\"filter_type\":1,\"token_status\":\"ok\",\"error\":null,\"api\":\"sandbox_check_by_audit_token\",\"no_report\":true,\"stage\":\"pre_syscall\",\"marker_schema_version\":2,\"tool\":\"seatbelt-callout\",\"token_mach_kr\":0,\"check_type\":1073741825}\n{\"canonical_flag_used\":true,\"errno\":0,\"argument\":\"\\/var\",\"canonicalization\":\"canonical\",\"canonical_flag_reason\":null,\"no_report_reason\":null,\"varargs_count\":1,\"operation\":\"file-read-metadata\",\"rc\":1,\"filter_type_name\":\"unknown\",\"decision\":\"deny\",\"filter_type\":1,\"token_status\":\"ok\",\"error\":null,\"api\":\"sandbox_check_by_audit_token\",\"no_report\":true,\"stage\":\"pre_syscall\",\"marker_schema_version\":2,\"tool\":\"seatbelt-callout\",\"token_mach_kr\":0,\"check_type\":1610612737}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 0,
          "errno_name": "OK",
          "message": "stat-ok",
          "op": "file-read-metadata",
          "path": "/var",
          "status": "ok",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767464410.0828521,
        "cmd_finished_at_unix_s": 1767464410.318043,
        "cmd_duration_s": 0.23519086837768555,
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":62363}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":62363}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.320204,
        "cmd_finished_at_unix_s": 1767464410.336789,
        "cmd_duration_s": 0.01658487319946289,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":62364}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":62364}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.337564,
        "cmd_finished_at_unix_s": 1767464410.35055,
        "cmd_duration_s": 0.012985944747924805,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":62365}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":62365}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.351259,
        "cmd_finished_at_unix_s": 1767464410.361805,
        "cmd_duration_s": 0.010545969009399414,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":62366}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":62366}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.3623621,
        "cmd_finished_at_unix_s": 1767464410.3715122,
        "cmd_duration_s": 0.009150028228759766,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_var_tmp_data_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_data_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":62367}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":62367}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.3727648,
        "cmd_finished_at_unix_s": 1767464410.3806279,
        "cmd_duration_s": 0.007863044738769531,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":62368}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":62368}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.381094,
        "cmd_finished_at_unix_s": 1767464410.3884149,
        "cmd_duration_s": 0.007320880889892578,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":62369}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":62369}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.388808,
        "cmd_finished_at_unix_s": 1767464410.3956192,
        "cmd_duration_s": 0.0068111419677734375,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":62370}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":62370}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.3960042,
        "cmd_finished_at_unix_s": 1767464410.402862,
        "cmd_duration_s": 0.006857872009277344,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":62371}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":62371}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.403218,
        "cmd_finished_at_unix_s": 1767464410.4100301,
        "cmd_duration_s": 0.006812095642089844,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":62372}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":62372}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.410455,
        "cmd_finished_at_unix_s": 1767464410.417525,
        "cmd_duration_s": 0.007070064544677734,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_etc_alias_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_alias_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_alias_only:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":62373}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":62373}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.418539,
        "cmd_finished_at_unix_s": 1767464410.425359,
        "cmd_duration_s": 0.006819963455200195,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_alias_only:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":62374}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":62374}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.4257479,
        "cmd_finished_at_unix_s": 1767464410.432464,
        "cmd_duration_s": 0.006716012954711914,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_etc_private_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_private_only:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":62375}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":62375}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.433436,
        "cmd_finished_at_unix_s": 1767464410.440136,
        "cmd_duration_s": 0.006700038909912109,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_private_only:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":62376}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":62376}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.440518,
        "cmd_finished_at_unix_s": 1767464410.447283,
        "cmd_duration_s": 0.006765127182006836,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_etc_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_both:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":62377}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":62377}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.4482749,
        "cmd_finished_at_unix_s": 1767464410.4550242,
        "cmd_duration_s": 0.006749391555786133,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_both:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":62378}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":62378}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.4554062,
        "cmd_finished_at_unix_s": 1767464410.462028,
        "cmd_duration_s": 0.006621837615966797,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_openat_rootrel_etc/hosts",
        "expectation_id": "vfs_etc_both:read_openat_rootrel_etc/hosts",
        "operation": "file-read*",
        "path": "etc/hosts",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":62379}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":62379}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopenat(root) target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.462396,
        "cmd_finished_at_unix_s": 1767464410.4691021,
        "cmd_duration_s": 0.00670623779296875,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "etc/hosts",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_openat_rootrel_private/etc/hosts",
        "expectation_id": "vfs_etc_both:read_openat_rootrel_private/etc/hosts",
        "operation": "file-read*",
        "path": "private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":62380}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":62380}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.469464,
        "cmd_finished_at_unix_s": 1767464410.476108,
        "cmd_duration_s": 0.006644010543823242,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "private/etc/hosts",
          "canonicalization": "both"
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_etc_both_plus_metadata_etc": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_both_plus_metadata_etc.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/etc",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:lstat_/etc",
        "operation": "file-read-metadata",
        "path": "/etc",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "varargs_count": 1,
              "marker_schema_version": 2,
              "api": "sandbox_check_by_audit_token",
              "canonicalization": "raw",
              "filter_type": 1,
              "decision": "deny",
              "check_type": 1073741825,
              "no_report_reason": null,
              "canonical_flag_used": false,
              "rc": 1,
              "argument": "/etc",
              "canonical_flag_reason": "not_requested",
              "errno": 0,
              "filter_type_name": "unknown",
              "operation": "file-read-metadata",
              "no_report": true,
              "error": null,
              "token_mach_kr": 0,
              "tool": "seatbelt-callout",
              "stage": "pre_syscall",
              "token_status": "ok"
            },
            {
              "varargs_count": 1,
              "marker_schema_version": 2,
              "api": "sandbox_check_by_audit_token",
              "canonicalization": "canonical",
              "filter_type": 1,
              "decision": "deny",
              "check_type": 1610612737,
              "no_report_reason": null,
              "canonical_flag_used": true,
              "rc": 1,
              "argument": "/etc",
              "canonical_flag_reason": null,
              "errno": 0,
              "filter_type_name": "unknown",
              "operation": "file-read-metadata",
              "no_report": true,
              "error": null,
              "token_mach_kr": 0,
              "tool": "seatbelt-callout",
              "stage": "pre_syscall",
              "token_status": "ok"
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/etc",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/etc",
          "--syscall",
          "lstat"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"err_class_source\":\"none\",\"pid\":62381,\"tool\":\"sbpl-apply\",\"mode\":\"sbpl\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/945f21bb-fade-4b6f-83cd-a69a0b8f388e\\/runtime_profiles\\/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"api\":\"sandbox_init\",\"marker_schema_version\":1,\"stage\":\"apply\",\"rc\":0,\"errbuf\":null,\"errno\":0,\"err_class\":\"ok\"}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"mode\":\"sbpl\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/945f21bb-fade-4b6f-83cd-a69a0b8f388e\\/runtime_profiles\\/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"rc\":0,\"pid\":62381,\"stage\":\"applied\",\"api\":\"sandbox_init\"}\n{\"varargs_count\":1,\"marker_schema_version\":2,\"api\":\"sandbox_check_by_audit_token\",\"canonicalization\":\"raw\",\"filter_type\":1,\"decision\":\"deny\",\"check_type\":1073741825,\"no_report_reason\":null,\"canonical_flag_used\":false,\"rc\":1,\"argument\":\"\\/etc\",\"canonical_flag_reason\":\"not_requested\",\"errno\":0,\"filter_type_name\":\"unknown\",\"operation\":\"file-read-metadata\",\"no_report\":true,\"error\":null,\"token_mach_kr\":0,\"tool\":\"seatbelt-callout\",\"stage\":\"pre_syscall\",\"token_status\":\"ok\"}\n{\"varargs_count\":1,\"marker_schema_version\":2,\"api\":\"sandbox_check_by_audit_token\",\"canonicalization\":\"canonical\",\"filter_type\":1,\"decision\":\"deny\",\"check_type\":1610612737,\"no_report_reason\":null,\"canonical_flag_used\":true,\"rc\":1,\"argument\":\"\\/etc\",\"canonical_flag_reason\":null,\"errno\":0,\"filter_type_name\":\"unknown\",\"operation\":\"file-read-metadata\",\"no_report\":true,\"error\":null,\"token_mach_kr\":0,\"tool\":\"seatbelt-callout\",\"stage\":\"pre_syscall\",\"token_status\":\"ok\"}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 0,
          "errno_name": "OK",
          "message": "stat-ok",
          "op": "file-read-metadata",
          "path": "/etc",
          "status": "ok",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767464410.477083,
        "cmd_finished_at_unix_s": 1767464410.486274,
        "cmd_duration_s": 0.009191036224365234,
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/etc",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_openat_rootrel_etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_etc/hosts",
        "operation": "file-read*",
        "path": "etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":62382}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":62382}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.4868412,
        "cmd_finished_at_unix_s": 1767464410.49378,
        "cmd_duration_s": 0.0069386959075927734,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "etc/hosts",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_openat_rootrel_private/etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_private/etc/hosts",
        "operation": "file-read*",
        "path": "private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":62383}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":62383}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.494112,
        "cmd_finished_at_unix_s": 1767464410.500842,
        "cmd_duration_s": 0.006730079650878906,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "private/etc/hosts",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":62384}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":62384}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.5012128,
        "cmd_finished_at_unix_s": 1767464410.507902,
        "cmd_duration_s": 0.0066890716552734375,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":62385}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":62385}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.5082932,
        "cmd_finished_at_unix_s": 1767464410.5150652,
        "cmd_duration_s": 0.006772041320800781,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_firmlink_private_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":62386}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":62386}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.5160608,
        "cmd_finished_at_unix_s": 1767464410.523385,
        "cmd_duration_s": 0.00732421875,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":62387}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":62387}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.523766,
        "cmd_finished_at_unix_s": 1767464410.530672,
        "cmd_duration_s": 0.006906032562255859,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":62388}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":62388}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.53106,
        "cmd_finished_at_unix_s": 1767464410.537859,
        "cmd_duration_s": 0.006798982620239258,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":62389}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":62389}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.538239,
        "cmd_finished_at_unix_s": 1767464410.5450099,
        "cmd_duration_s": 0.0067708492279052734,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_firmlink_data_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_data_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":62390}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":62390}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.54597,
        "cmd_finished_at_unix_s": 1767464410.552702,
        "cmd_duration_s": 0.006731986999511719,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":62391}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":62391}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.553094,
        "cmd_finished_at_unix_s": 1767464410.560003,
        "cmd_duration_s": 0.00690913200378418,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":62392}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":62392}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.560382,
        "cmd_finished_at_unix_s": 1767464410.567155,
        "cmd_duration_s": 0.0067729949951171875,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":62393}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":62393}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.567551,
        "cmd_finished_at_unix_s": 1767464410.574323,
        "cmd_duration_s": 0.006772041320800781,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_firmlink_both": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":62394}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":62394}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.575302,
        "cmd_finished_at_unix_s": 1767464410.5820968,
        "cmd_duration_s": 0.006794929504394531,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":62395}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":62395}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.5824928,
        "cmd_finished_at_unix_s": 1767464410.589411,
        "cmd_duration_s": 0.006918191909790039,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":62397}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":62397}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.5898082,
        "cmd_finished_at_unix_s": 1767464410.597634,
        "cmd_duration_s": 0.007825851440429688,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":62398}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":62398}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.598136,
        "cmd_finished_at_unix_s": 1767464410.605858,
        "cmd_duration_s": 0.007722139358520508,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_link_var_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_var_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":62403}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":62403}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.607019,
        "cmd_finished_at_unix_s": 1767464410.6141162,
        "cmd_duration_s": 0.0070972442626953125,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":62405}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":62405}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.614581,
        "cmd_finished_at_unix_s": 1767464410.622852,
        "cmd_duration_s": 0.008270978927612305,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":62412}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":62412}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.6233642,
        "cmd_finished_at_unix_s": 1767464410.631259,
        "cmd_duration_s": 0.007894754409790039,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":62417}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":62417}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.631835,
        "cmd_finished_at_unix_s": 1767464410.63921,
        "cmd_duration_s": 0.007375001907348633,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_link_private_tmp_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_private_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":62421}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":62421}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.640318,
        "cmd_finished_at_unix_s": 1767464410.647779,
        "cmd_duration_s": 0.007461071014404297,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":62426}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":62426}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.648254,
        "cmd_finished_at_unix_s": 1767464410.655571,
        "cmd_duration_s": 0.007317066192626953,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":62428}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":62428}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.656078,
        "cmd_finished_at_unix_s": 1767464410.663896,
        "cmd_duration_s": 0.007817983627319336,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":62431}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":62431}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.664414,
        "cmd_finished_at_unix_s": 1767464410.671921,
        "cmd_duration_s": 0.0075070858001708984,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_link_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":62432}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":62432}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.6730728,
        "cmd_finished_at_unix_s": 1767464410.680962,
        "cmd_duration_s": 0.007889270782470703,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":62439}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":62439}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.68148,
        "cmd_finished_at_unix_s": 1767464410.689142,
        "cmd_duration_s": 0.007662057876586914,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":62446}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":62446}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.689711,
        "cmd_finished_at_unix_s": 1767464410.6973171,
        "cmd_duration_s": 0.007606029510498047,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":62453}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":62453}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.697803,
        "cmd_finished_at_unix_s": 1767464410.7054641,
        "cmd_duration_s": 0.007661104202270508,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  },
  "vfs_link_both_plus_metadata_to_var_tmp": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_both_plus_metadata_to_var_tmp.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/private/tmp/vfs_linkdir/to_var_tmp",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp",
        "operation": "file-read-metadata",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "marker_schema_version": 2,
              "canonical_flag_used": false,
              "no_report_reason": null,
              "token_mach_kr": 0,
              "canonicalization": "raw",
              "operation": "file-read-metadata",
              "token_status": "ok",
              "api": "sandbox_check_by_audit_token",
              "canonical_flag_reason": "not_requested",
              "decision": "deny",
              "tool": "seatbelt-callout",
              "filter_type": 1,
              "varargs_count": 1,
              "no_report": true,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
              "error": null,
              "check_type": 1073741825,
              "stage": "pre_syscall",
              "rc": 1,
              "errno": 0,
              "filter_type_name": "unknown"
            },
            {
              "marker_schema_version": 2,
              "canonical_flag_used": true,
              "no_report_reason": null,
              "token_mach_kr": 0,
              "canonicalization": "canonical",
              "operation": "file-read-metadata",
              "token_status": "ok",
              "api": "sandbox_check_by_audit_token",
              "canonical_flag_reason": null,
              "decision": "deny",
              "tool": "seatbelt-callout",
              "filter_type": 1,
              "varargs_count": 1,
              "no_report": true,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
              "error": null,
              "check_type": 1610612737,
              "stage": "pre_syscall",
              "rc": 1,
              "errno": 0,
              "filter_type_name": "unknown"
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/private/tmp/vfs_linkdir/to_var_tmp",
          "--syscall",
          "lstat"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"rc\":0,\"pid\":62466,\"stage\":\"apply\",\"api\":\"sandbox_init\",\"err_class_source\":\"none\",\"marker_schema_version\":1,\"err_class\":\"ok\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/945f21bb-fade-4b6f-83cd-a69a0b8f388e\\/runtime_profiles\\/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"errno\":0,\"errbuf\":null,\"mode\":\"sbpl\",\"tool\":\"sbpl-apply\"}\n{\"mode\":\"sbpl\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/945f21bb-fade-4b6f-83cd-a69a0b8f388e\\/runtime_profiles\\/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"api\":\"sandbox_init\",\"stage\":\"applied\",\"rc\":0,\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"pid\":62466}\n{\"marker_schema_version\":2,\"canonical_flag_used\":false,\"no_report_reason\":null,\"token_mach_kr\":0,\"canonicalization\":\"raw\",\"operation\":\"file-read-metadata\",\"token_status\":\"ok\",\"api\":\"sandbox_check_by_audit_token\",\"canonical_flag_reason\":\"not_requested\",\"decision\":\"deny\",\"tool\":\"seatbelt-callout\",\"filter_type\":1,\"varargs_count\":1,\"no_report\":true,\"argument\":\"\\/private\\/tmp\\/vfs_linkdir\\/to_var_tmp\",\"error\":null,\"check_type\":1073741825,\"stage\":\"pre_syscall\",\"rc\":1,\"errno\":0,\"filter_type_name\":\"unknown\"}\n{\"marker_schema_version\":2,\"canonical_flag_used\":true,\"no_report_reason\":null,\"token_mach_kr\":0,\"canonicalization\":\"canonical\",\"operation\":\"file-read-metadata\",\"token_status\":\"ok\",\"api\":\"sandbox_check_by_audit_token\",\"canonical_flag_reason\":null,\"decision\":\"deny\",\"tool\":\"seatbelt-callout\",\"filter_type\":1,\"varargs_count\":1,\"no_report\":true,\"argument\":\"\\/private\\/tmp\\/vfs_linkdir\\/to_var_tmp\",\"error\":null,\"check_type\":1610612737,\"stage\":\"pre_syscall\",\"rc\":1,\"errno\":0,\"filter_type_name\":\"unknown\"}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 0,
          "errno_name": "OK",
          "message": "stat-ok",
          "op": "file-read-metadata",
          "path": "/private/tmp/vfs_linkdir/to_var_tmp",
          "status": "ok",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767464410.7067661,
        "cmd_finished_at_unix_s": 1767464410.7170691,
        "cmd_duration_s": 0.010303020477294922,
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":62473}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":62473}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.717762,
        "cmd_finished_at_unix_s": 1767464410.725334,
        "cmd_duration_s": 0.0075719356536865234,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":62486}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":62486}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.7259321,
        "cmd_finished_at_unix_s": 1767464410.734151,
        "cmd_duration_s": 0.008218765258789062,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":62487}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":62487}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.734677,
        "cmd_finished_at_unix_s": 1767464410.742707,
        "cmd_duration_s": 0.008029937744140625,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":62494}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.945f21bb-fade-4b6f-83cd-a69a0b8f388e/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/945f21bb-fade-4b6f-83cd-a69a0b8f388e/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":62494}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464410.7431612,
        "cmd_finished_at_unix_s": 1767464410.7505012,
        "cmd_duration_s": 0.007339954376220703,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "945f21bb-fade-4b6f-83cd-a69a0b8f388e"
  }
}