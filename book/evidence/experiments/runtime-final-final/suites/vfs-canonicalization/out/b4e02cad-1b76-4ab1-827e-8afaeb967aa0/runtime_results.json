{
  "vfs_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_tmp_only:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44020}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44020}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461107.6383822,
        "cmd_finished_at_unix_s": 1767461107.8935082,
        "cmd_duration_s": 0.2551259994506836,
        "cmd_pid": 44020,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44020",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:05",
            "--end",
            "2026-01-03 09:25:09",
            "--row-id",
            "vfs_tmp_only:read_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_tmp_only.read__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44020",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1122,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:09",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44020,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44020)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44020\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/tmp/foo",
              "start": "2026-01-03 09:25:05",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461109900,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:05",
          "observer_window_end": "2026-01-03 09:25:09",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44028}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44028}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461109.903274,
        "cmd_finished_at_unix_s": 1767461109.9148731,
        "cmd_duration_s": 0.011599063873291016,
        "cmd_pid": 44028,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44028",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:07",
            "--end",
            "2026-01-03 09:25:11",
            "--row-id",
            "vfs_tmp_only:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_tmp_only.read__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44028",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1130,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:11",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44028,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44028)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44028\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/tmp/foo",
              "start": "2026-01-03 09:25:07",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461110084,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:07",
          "observer_window_end": "2026-01-03 09:25:11",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_tmp_only:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44031}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44031}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461110.086763,
        "cmd_finished_at_unix_s": 1767461110.4336839,
        "cmd_duration_s": 0.3469209671020508,
        "cmd_pid": 44031,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44031",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:08",
            "--end",
            "2026-01-03 09:25:12",
            "--row-id",
            "vfs_tmp_only:write_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_tmp_only.write__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44031",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1123,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:12",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44031,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44031)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44031\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/tmp/foo",
              "start": "2026-01-03 09:25:08",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461110621,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:08",
          "observer_window_end": "2026-01-03 09:25:12",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44034}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44034}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461110.623717,
        "cmd_finished_at_unix_s": 1767461110.6350641,
        "cmd_duration_s": 0.011347055435180664,
        "cmd_pid": 44034,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44034",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:08",
            "--end",
            "2026-01-03 09:25:12",
            "--row-id",
            "vfs_tmp_only:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_tmp_only.write__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44034",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1131,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:12",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44034,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44034)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44034\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/tmp/foo",
              "start": "2026-01-03 09:25:08",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461110789,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:08",
          "observer_window_end": "2026-01-03 09:25:12",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_tmp_only:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44037}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44037}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461110.791987,
        "cmd_finished_at_unix_s": 1767461110.803327,
        "cmd_duration_s": 0.011340141296386719,
        "cmd_pid": 44037,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44037",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:08",
            "--end",
            "2026-01-03 09:25:12",
            "--row-id",
            "vfs_tmp_only:read_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_tmp_only.read__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "44037",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1122,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:12",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44037,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44037)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44037\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/tmp/bar",
              "start": "2026-01-03 09:25:08",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461110966,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:08",
          "observer_window_end": "2026-01-03 09:25:12",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44040}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44040}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461110.968461,
        "cmd_finished_at_unix_s": 1767461110.979975,
        "cmd_duration_s": 0.011513948440551758,
        "cmd_pid": 44040,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44040",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:08",
            "--end",
            "2026-01-03 09:25:12",
            "--row-id",
            "vfs_tmp_only:read_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_tmp_only.read__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "44040",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1130,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:12",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44040,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44040)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44040\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/tmp/bar",
              "start": "2026-01-03 09:25:08",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461111156,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:08",
          "observer_window_end": "2026-01-03 09:25:12",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_tmp_only:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44045}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44045}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461111.158838,
        "cmd_finished_at_unix_s": 1767461111.1703,
        "cmd_duration_s": 0.011461973190307617,
        "cmd_pid": 44045,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44045",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:09",
            "--end",
            "2026-01-03 09:25:13",
            "--row-id",
            "vfs_tmp_only:write_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_tmp_only.write__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "44045",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1123,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:13",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44045,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44045)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44045\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/tmp/bar",
              "start": "2026-01-03 09:25:09",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461111310,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:09",
          "observer_window_end": "2026-01-03 09:25:13",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44048}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44048}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461111.313202,
        "cmd_finished_at_unix_s": 1767461111.324856,
        "cmd_duration_s": 0.011654138565063477,
        "cmd_pid": 44048,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44048",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:09",
            "--end",
            "2026-01-03 09:25:13",
            "--row-id",
            "vfs_tmp_only:write_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_tmp_only.write__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "44048",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1131,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:13",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44048,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44048)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44048\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/tmp/bar",
              "start": "2026-01-03 09:25:09",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461111467,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:09",
          "observer_window_end": "2026-01-03 09:25:13",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44051}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44051}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461111.470316,
        "cmd_finished_at_unix_s": 1767461111.4818501,
        "cmd_duration_s": 0.01153421401977539,
        "cmd_pid": 44051,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44051",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:09",
            "--end",
            "2026-01-03 09:25:13",
            "--row-id",
            "vfs_tmp_only:read_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_tmp_only.read__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "44051",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1432,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:11.525287-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44051) deny(1) file-read-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:13",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:11.525287-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44051) deny(1) file-read-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44051,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44051)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44051\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/tmp/nested/child",
              "start": "2026-01-03 09:25:09",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461111626,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:09",
          "observer_window_end": "2026-01-03 09:25:13",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44054}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44054}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461111.629014,
        "cmd_finished_at_unix_s": 1767461111.640234,
        "cmd_duration_s": 0.011219978332519531,
        "cmd_pid": 44054,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44054",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:09",
            "--end",
            "2026-01-03 09:25:13",
            "--row-id",
            "vfs_tmp_only:read_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_tmp_only.read__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "44054",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1440,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:11.683711-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44054) deny(1) file-read-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:13",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:11.683711-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44054) deny(1) file-read-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44054,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44054)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44054\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/tmp/nested/child",
              "start": "2026-01-03 09:25:09",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461111786,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:09",
          "observer_window_end": "2026-01-03 09:25:13",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44057}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44057}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461111.789013,
        "cmd_finished_at_unix_s": 1767461111.800264,
        "cmd_duration_s": 0.011250972747802734,
        "cmd_pid": 44057,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44057",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:09",
            "--end",
            "2026-01-03 09:25:13",
            "--row-id",
            "vfs_tmp_only:write_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_tmp_only.write__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "44057",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1435,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:11.843723-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44057) deny(1) file-write-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:13",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:11.843723-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44057) deny(1) file-write-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44057,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44057)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44057\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/tmp/nested/child",
              "start": "2026-01-03 09:25:09",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461111955,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:09",
          "observer_window_end": "2026-01-03 09:25:13",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44060}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44060}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461111.9577532,
        "cmd_finished_at_unix_s": 1767461111.968919,
        "cmd_duration_s": 0.011165857315063477,
        "cmd_pid": 44060,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44060",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:09",
            "--end",
            "2026-01-03 09:25:13",
            "--row-id",
            "vfs_tmp_only:write_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_tmp_only.write__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "44060",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1443,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:12.012392-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44060) deny(1) file-write-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:13",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:12.012392-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44060) deny(1) file-write-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44060,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44060)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44060\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/tmp/nested/child",
              "start": "2026-01-03 09:25:09",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461112119,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:09",
          "observer_window_end": "2026-01-03 09:25:13",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44063}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44063}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461112.122124,
        "cmd_finished_at_unix_s": 1767461112.1335418,
        "cmd_duration_s": 0.011417865753173828,
        "cmd_pid": 44063,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44063",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:10",
            "--end",
            "2026-01-03 09:25:14",
            "--row-id",
            "vfs_tmp_only:read_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_tmp_only.read__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "44063",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1707,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:12.176453-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44063) deny(1) file-read-metadata /var",
                "2026-01-03 09:25:12.219649-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44063) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:14",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:12.176453-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44063) deny(1) file-read-metadata /var\n2026-01-03 09:25:12.219649-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44063) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44063,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44063)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44063\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/var/tmp/canon",
              "start": "2026-01-03 09:25:10",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461112275,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:10",
          "observer_window_end": "2026-01-03 09:25:14",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44067}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44067}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461112.27811,
        "cmd_finished_at_unix_s": 1767461112.290036,
        "cmd_duration_s": 0.011925935745239258,
        "cmd_pid": 44067,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44067",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:10",
            "--end",
            "2026-01-03 09:25:14",
            "--row-id",
            "vfs_tmp_only:read_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_tmp_only.read__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "44067",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1431,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:12.333452-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44067) deny(1) file-read-data /private/var/tmp/canon"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:14",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:12.333452-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44067) deny(1) file-read-data /private/var/tmp/canon",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44067,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44067)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44067\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/var/tmp/canon",
              "start": "2026-01-03 09:25:10",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461112443,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:10",
          "observer_window_end": "2026-01-03 09:25:14",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44074}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44074}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461112.445345,
        "cmd_finished_at_unix_s": 1767461112.456588,
        "cmd_duration_s": 0.011243104934692383,
        "cmd_pid": 44074,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44074",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:10",
            "--end",
            "2026-01-03 09:25:14",
            "--row-id",
            "vfs_tmp_only:write_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_tmp_only.write__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "44074",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1708,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:12.499515-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44074) deny(1) file-read-metadata /var",
                "2026-01-03 09:25:12.538475-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44074) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:14",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:12.499515-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44074) deny(1) file-read-metadata /var\n2026-01-03 09:25:12.538475-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44074) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44074,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44074)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44074\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/var/tmp/canon",
              "start": "2026-01-03 09:25:10",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461112602,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:10",
          "observer_window_end": "2026-01-03 09:25:14",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44077}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":44077}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461112.605029,
        "cmd_finished_at_unix_s": 1767461112.616229,
        "cmd_duration_s": 0.011199951171875,
        "cmd_pid": 44077,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44077",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:10",
            "--end",
            "2026-01-03 09:25:14",
            "--row-id",
            "vfs_tmp_only:write_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_tmp_only.write__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "44077",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1434,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:12.659729-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44077) deny(1) file-write-data /private/var/tmp/canon"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:14",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:12.659729-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44077) deny(1) file-write-data /private/var/tmp/canon",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44077,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44077)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44077\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/var/tmp/canon",
              "start": "2026-01-03 09:25:10",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461112764,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:10",
          "observer_window_end": "2026-01-03 09:25:14",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_private_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_private_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44080}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44080}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461112.768339,
        "cmd_finished_at_unix_s": 1767461112.779532,
        "cmd_duration_s": 0.011193037033081055,
        "cmd_pid": 44080,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44080",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:10",
            "--end",
            "2026-01-03 09:25:14",
            "--row-id",
            "vfs_private_tmp_only:read_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.read__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44080",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1130,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:14",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44080,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44080)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44080\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/tmp/foo",
              "start": "2026-01-03 09:25:10",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461112935,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:10",
          "observer_window_end": "2026-01-03 09:25:14",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44083}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44083}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461112.937288,
        "cmd_finished_at_unix_s": 1767461112.948575,
        "cmd_duration_s": 0.01128697395324707,
        "cmd_pid": 44083,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44083",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:10",
            "--end",
            "2026-01-03 09:25:14",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.read__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44083",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1138,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:14",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44083,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44083)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44083\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/foo",
              "start": "2026-01-03 09:25:10",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461113101,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:10",
          "observer_window_end": "2026-01-03 09:25:14",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44086}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44086}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461113.104119,
        "cmd_finished_at_unix_s": 1767461113.115343,
        "cmd_duration_s": 0.011224031448364258,
        "cmd_pid": 44086,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44086",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:11",
            "--end",
            "2026-01-03 09:25:15",
            "--row-id",
            "vfs_private_tmp_only:write_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.write__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44086",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1131,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:15",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44086,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44086)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44086\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/tmp/foo",
              "start": "2026-01-03 09:25:11",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461113264,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:11",
          "observer_window_end": "2026-01-03 09:25:15",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44089}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44089}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461113.2664828,
        "cmd_finished_at_unix_s": 1767461113.277625,
        "cmd_duration_s": 0.011142253875732422,
        "cmd_pid": 44089,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44089",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:11",
            "--end",
            "2026-01-03 09:25:15",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.write__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44089",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:15",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44089,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44089)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44089\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/foo",
              "start": "2026-01-03 09:25:11",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461113418,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:11",
          "observer_window_end": "2026-01-03 09:25:15",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44092}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44092}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461113.4205241,
        "cmd_finished_at_unix_s": 1767461113.431821,
        "cmd_duration_s": 0.011296987533569336,
        "cmd_pid": 44092,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44092",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:11",
            "--end",
            "2026-01-03 09:25:15",
            "--row-id",
            "vfs_private_tmp_only:read_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.read__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "44092",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1130,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:15",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44092,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44092)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44092\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/tmp/bar",
              "start": "2026-01-03 09:25:11",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461113570,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:11",
          "observer_window_end": "2026-01-03 09:25:15",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44097}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44097}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461113.572619,
        "cmd_finished_at_unix_s": 1767461113.583968,
        "cmd_duration_s": 0.011348962783813477,
        "cmd_pid": 44097,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44097",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:11",
            "--end",
            "2026-01-03 09:25:15",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.read__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "44097",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1138,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:15",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44097,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44097)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44097\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/bar",
              "start": "2026-01-03 09:25:11",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461113724,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:11",
          "observer_window_end": "2026-01-03 09:25:15",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44100}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44100}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461113.726794,
        "cmd_finished_at_unix_s": 1767461113.737969,
        "cmd_duration_s": 0.011174917221069336,
        "cmd_pid": 44100,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44100",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:11",
            "--end",
            "2026-01-03 09:25:15",
            "--row-id",
            "vfs_private_tmp_only:write_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.write__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "44100",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1131,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:15",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44100,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44100)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44100\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/tmp/bar",
              "start": "2026-01-03 09:25:11",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461113878,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:11",
          "observer_window_end": "2026-01-03 09:25:15",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44103}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44103}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461113.880367,
        "cmd_finished_at_unix_s": 1767461113.891616,
        "cmd_duration_s": 0.011249065399169922,
        "cmd_pid": 44103,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44103",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:11",
            "--end",
            "2026-01-03 09:25:15",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.write__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "44103",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:15",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44103,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44103)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44103\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/bar",
              "start": "2026-01-03 09:25:11",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461114062,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:11",
          "observer_window_end": "2026-01-03 09:25:15",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44107}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44107}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461114.0649118,
        "cmd_finished_at_unix_s": 1767461114.07644,
        "cmd_duration_s": 0.011528253555297852,
        "cmd_pid": 44107,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44107",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:12",
            "--end",
            "2026-01-03 09:25:16",
            "--row-id",
            "vfs_private_tmp_only:read_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.read__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "44107",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:16",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44107,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44107)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44107\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/tmp/nested/child",
              "start": "2026-01-03 09:25:12",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461114308,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:12",
          "observer_window_end": "2026-01-03 09:25:16",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44121}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44121}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461114.312187,
        "cmd_finished_at_unix_s": 1767461114.329226,
        "cmd_duration_s": 0.017039060592651367,
        "cmd_pid": 44121,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44121",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:12",
            "--end",
            "2026-01-03 09:25:16",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.read__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "44121",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1147,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:16",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44121,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44121)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44121\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/child",
              "start": "2026-01-03 09:25:12",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461114492,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:12",
          "observer_window_end": "2026-01-03 09:25:16",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44124}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44124}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461114.494975,
        "cmd_finished_at_unix_s": 1767461114.507831,
        "cmd_duration_s": 0.012856006622314453,
        "cmd_pid": 44124,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44124",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:12",
            "--end",
            "2026-01-03 09:25:16",
            "--row-id",
            "vfs_private_tmp_only:write_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.write__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "44124",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1140,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:16",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44124,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44124)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44124\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/tmp/nested/child",
              "start": "2026-01-03 09:25:12",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461114659,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:12",
          "observer_window_end": "2026-01-03 09:25:16",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44127}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44127}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461114.662004,
        "cmd_finished_at_unix_s": 1767461114.6733801,
        "cmd_duration_s": 0.011376142501831055,
        "cmd_pid": 44127,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44127",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:12",
            "--end",
            "2026-01-03 09:25:16",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.write__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "44127",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1148,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:16",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44127,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44127)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44127\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/child",
              "start": "2026-01-03 09:25:12",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461114863,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:12",
          "observer_window_end": "2026-01-03 09:25:16",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44130}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44130}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461114.865346,
        "cmd_finished_at_unix_s": 1767461114.8765922,
        "cmd_duration_s": 0.011246204376220703,
        "cmd_pid": 44130,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44130",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:12",
            "--end",
            "2026-01-03 09:25:16",
            "--row-id",
            "vfs_private_tmp_only:read_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.read__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "44130",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1715,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:14.919570-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44130) deny(1) file-read-metadata /var",
                "2026-01-03 09:25:14.955378-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44130) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:16",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:14.919570-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44130) deny(1) file-read-metadata /var\n2026-01-03 09:25:14.955378-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44130) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44130,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44130)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44130\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/var/tmp/canon",
              "start": "2026-01-03 09:25:12",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461115062,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:12",
          "observer_window_end": "2026-01-03 09:25:16",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks var tmp canon\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44134}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44134}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:111259441\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461115.0649421,
        "cmd_finished_at_unix_s": 1767461115.0762188,
        "cmd_duration_s": 0.011276721954345703,
        "cmd_pid": 44134,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44134",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:13",
            "--end",
            "2026-01-03 09:25:17",
            "--row-id",
            "vfs_private_tmp_only:read_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.read__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "44134",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1144,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:17",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44134,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44134)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44134\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/var/tmp/canon",
              "start": "2026-01-03 09:25:13",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461115213,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:13",
          "observer_window_end": "2026-01-03 09:25:17",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44137}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44137}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461115.2156641,
        "cmd_finished_at_unix_s": 1767461115.22696,
        "cmd_duration_s": 0.011295795440673828,
        "cmd_pid": 44137,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44137",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:13",
            "--end",
            "2026-01-03 09:25:17",
            "--row-id",
            "vfs_private_tmp_only:write_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.write__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "44137",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1716,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:15.269935-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44137) deny(1) file-read-metadata /var",
                "2026-01-03 09:25:15.307169-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44137) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:17",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:15.269935-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44137) deny(1) file-read-metadata /var\n2026-01-03 09:25:15.307169-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44137) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44137,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44137)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44137\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/var/tmp/canon",
              "start": "2026-01-03 09:25:13",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461115357,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:13",
          "observer_window_end": "2026-01-03 09:25:17",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44140}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44140}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:111259441\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461115.359468,
        "cmd_finished_at_unix_s": 1767461115.370792,
        "cmd_duration_s": 0.011323928833007812,
        "cmd_pid": 44140,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44140",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:13",
            "--end",
            "2026-01-03 09:25:17",
            "--row-id",
            "vfs_private_tmp_only:write_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.write__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "44140",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1145,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:17",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44140,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44140)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44140\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/var/tmp/canon",
              "start": "2026-01-03 09:25:13",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461115507,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:13",
          "observer_window_end": "2026-01-03 09:25:17",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/../foo",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/nested/../foo",
        "operation": "file-read*",
        "path": "/private/tmp/nested/../foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/../foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/../foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44143}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44143}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461115.5097852,
        "cmd_finished_at_unix_s": 1767461115.521091,
        "cmd_duration_s": 0.011305809020996094,
        "cmd_pid": 44143,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/../foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44143",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:13",
            "--end",
            "2026-01-03 09:25:17",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.read__private_tmp_nested_.._foo.observer.json",
          "log_write_error": null,
          "pid": "44143",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/../foo",
          "correlation_id": null,
          "stdout_bytes": 1148,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:17",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44143,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44143)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44143\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/../foo",
              "start": "2026-01-03 09:25:13",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461115663,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:13",
          "observer_window_end": "2026-01-03 09:25:17",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/../foo",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/nested/../foo",
        "operation": "file-write*",
        "path": "/private/tmp/nested/../foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/../foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/../foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44146}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":44146}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461115.665504,
        "cmd_finished_at_unix_s": 1767461115.6767051,
        "cmd_duration_s": 0.011201143264770508,
        "cmd_pid": 44146,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/../foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44146",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:13",
            "--end",
            "2026-01-03 09:25:17",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only.write__private_tmp_nested_.._foo.observer.json",
          "log_write_error": null,
          "pid": "44146",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/../foo",
          "correlation_id": null,
          "stdout_bytes": 1149,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:17",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44146,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44146)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44146\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/../foo",
              "start": "2026-01-03 09:25:13",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461115814,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:13",
          "observer_window_end": "2026-01-03 09:25:17",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_both_paths": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_both_paths.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_both_paths:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44149}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44149}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461115.818283,
        "cmd_finished_at_unix_s": 1767461115.829623,
        "cmd_duration_s": 0.011339902877807617,
        "cmd_pid": 44149,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44149",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:13",
            "--end",
            "2026-01-03 09:25:17",
            "--row-id",
            "vfs_both_paths:read_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_both_paths.read__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44149",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1124,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:17",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44149,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44149)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44149\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/tmp/foo",
              "start": "2026-01-03 09:25:13",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461115996,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:13",
          "observer_window_end": "2026-01-03 09:25:17",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_both_paths:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44152}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44152}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461115.998883,
        "cmd_finished_at_unix_s": 1767461116.010159,
        "cmd_duration_s": 0.011276006698608398,
        "cmd_pid": 44152,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44152",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:13",
            "--end",
            "2026-01-03 09:25:18",
            "--row-id",
            "vfs_both_paths:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_both_paths.read__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44152",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1132,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:18",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44152,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44152)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44152\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/tmp/foo",
              "start": "2026-01-03 09:25:13",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461116157,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:13",
          "observer_window_end": "2026-01-03 09:25:18",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_both_paths:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44155}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44155}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461116.1597939,
        "cmd_finished_at_unix_s": 1767461116.1711092,
        "cmd_duration_s": 0.011315345764160156,
        "cmd_pid": 44155,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44155",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:14",
            "--end",
            "2026-01-03 09:25:18",
            "--row-id",
            "vfs_both_paths:write_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_both_paths.write__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44155",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1125,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:18",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44155,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44155)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44155\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/tmp/foo",
              "start": "2026-01-03 09:25:14",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461116296,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:14",
          "observer_window_end": "2026-01-03 09:25:18",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_both_paths:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44158}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44158}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461116.298649,
        "cmd_finished_at_unix_s": 1767461116.310048,
        "cmd_duration_s": 0.011399030685424805,
        "cmd_pid": 44158,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44158",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:14",
            "--end",
            "2026-01-03 09:25:18",
            "--row-id",
            "vfs_both_paths:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_both_paths.write__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44158",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1133,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:18",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44158,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44158)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44158\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/tmp/foo",
              "start": "2026-01-03 09:25:14",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461116441,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:14",
          "observer_window_end": "2026-01-03 09:25:18",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_both_paths:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44161}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44161}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461116.443233,
        "cmd_finished_at_unix_s": 1767461116.4543412,
        "cmd_duration_s": 0.011108160018920898,
        "cmd_pid": 44161,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44161",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:14",
            "--end",
            "2026-01-03 09:25:18",
            "--row-id",
            "vfs_both_paths:read_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_both_paths.read__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "44161",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1124,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:18",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44161,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44161)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44161\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/tmp/bar",
              "start": "2026-01-03 09:25:14",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461116588,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:14",
          "observer_window_end": "2026-01-03 09:25:18",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_both_paths:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44164}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44164}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461116.590179,
        "cmd_finished_at_unix_s": 1767461116.6015282,
        "cmd_duration_s": 0.011349201202392578,
        "cmd_pid": 44164,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44164",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:14",
            "--end",
            "2026-01-03 09:25:18",
            "--row-id",
            "vfs_both_paths:read_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_both_paths.read__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "44164",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1132,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:18",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44164,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44164)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44164\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/tmp/bar",
              "start": "2026-01-03 09:25:14",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461116737,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:14",
          "observer_window_end": "2026-01-03 09:25:18",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_both_paths:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44167}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44167}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461116.739769,
        "cmd_finished_at_unix_s": 1767461116.751137,
        "cmd_duration_s": 0.011368036270141602,
        "cmd_pid": 44167,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44167",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:14",
            "--end",
            "2026-01-03 09:25:18",
            "--row-id",
            "vfs_both_paths:write_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_both_paths.write__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "44167",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1125,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:18",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44167,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44167)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44167\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/tmp/bar",
              "start": "2026-01-03 09:25:14",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461116901,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:14",
          "observer_window_end": "2026-01-03 09:25:18",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_both_paths:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44170}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44170}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461116.903957,
        "cmd_finished_at_unix_s": 1767461116.915242,
        "cmd_duration_s": 0.011285066604614258,
        "cmd_pid": 44170,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44170",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:14",
            "--end",
            "2026-01-03 09:25:18",
            "--row-id",
            "vfs_both_paths:write_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_both_paths.write__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "44170",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1133,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:18",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44170,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44170)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44170\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/tmp/bar",
              "start": "2026-01-03 09:25:14",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461117059,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:14",
          "observer_window_end": "2026-01-03 09:25:18",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_both_paths:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44173}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44173}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461117.061703,
        "cmd_finished_at_unix_s": 1767461117.0731761,
        "cmd_duration_s": 0.01147317886352539,
        "cmd_pid": 44173,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44173",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:15",
            "--end",
            "2026-01-03 09:25:19",
            "--row-id",
            "vfs_both_paths:read_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_both_paths.read__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "44173",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1133,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:19",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44173,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44173)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44173\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/tmp/nested/child",
              "start": "2026-01-03 09:25:15",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461117217,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:15",
          "observer_window_end": "2026-01-03 09:25:19",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_both_paths:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44176}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44176}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461117.219861,
        "cmd_finished_at_unix_s": 1767461117.2310688,
        "cmd_duration_s": 0.011207818984985352,
        "cmd_pid": 44176,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44176",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:15",
            "--end",
            "2026-01-03 09:25:19",
            "--row-id",
            "vfs_both_paths:read_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_both_paths.read__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "44176",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1141,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:19",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44176,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44176)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44176\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/tmp/nested/child",
              "start": "2026-01-03 09:25:15",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461117379,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:15",
          "observer_window_end": "2026-01-03 09:25:19",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_both_paths:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44179}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44179}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461117.381152,
        "cmd_finished_at_unix_s": 1767461117.392586,
        "cmd_duration_s": 0.011434078216552734,
        "cmd_pid": 44179,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44179",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:15",
            "--end",
            "2026-01-03 09:25:19",
            "--row-id",
            "vfs_both_paths:write_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_both_paths.write__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "44179",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1134,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:19",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44179,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44179)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44179\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/tmp/nested/child",
              "start": "2026-01-03 09:25:15",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461117538,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:15",
          "observer_window_end": "2026-01-03 09:25:19",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_both_paths:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44182}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44182}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461117.540511,
        "cmd_finished_at_unix_s": 1767461117.551784,
        "cmd_duration_s": 0.01127314567565918,
        "cmd_pid": 44182,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44182",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:15",
            "--end",
            "2026-01-03 09:25:19",
            "--row-id",
            "vfs_both_paths:write_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_both_paths.write__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "44182",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1142,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:19",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44182,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44182)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44182\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/tmp/nested/child",
              "start": "2026-01-03 09:25:15",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461117696,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:15",
          "observer_window_end": "2026-01-03 09:25:19",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_both_paths:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44185}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44185}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461117.6983218,
        "cmd_finished_at_unix_s": 1767461117.7096572,
        "cmd_duration_s": 0.011335372924804688,
        "cmd_pid": 44185,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44185",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:15",
            "--end",
            "2026-01-03 09:25:19",
            "--row-id",
            "vfs_both_paths:read_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_both_paths.read__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "44185",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1709,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:17.752728-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44185) deny(1) file-read-metadata /var",
                "2026-01-03 09:25:17.791262-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44185) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:19",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:17.752728-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44185) deny(1) file-read-metadata /var\n2026-01-03 09:25:17.791262-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44185) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44185,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44185)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44185\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/var/tmp/canon",
              "start": "2026-01-03 09:25:15",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461117857,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:15",
          "observer_window_end": "2026-01-03 09:25:19",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_both_paths:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks var tmp canon\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44188}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44188}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:111259441\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461117.8601222,
        "cmd_finished_at_unix_s": 1767461117.871467,
        "cmd_duration_s": 0.01134490966796875,
        "cmd_pid": 44188,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44188",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:15",
            "--end",
            "2026-01-03 09:25:19",
            "--row-id",
            "vfs_both_paths:read_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_both_paths.read__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "44188",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1138,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:19",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44188,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44188)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44188\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/var/tmp/canon",
              "start": "2026-01-03 09:25:15",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461118013,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:15",
          "observer_window_end": "2026-01-03 09:25:19",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_both_paths:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44191}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44191}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461118.0154119,
        "cmd_finished_at_unix_s": 1767461118.026739,
        "cmd_duration_s": 0.011327028274536133,
        "cmd_pid": 44191,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44191",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:16",
            "--end",
            "2026-01-03 09:25:20",
            "--row-id",
            "vfs_both_paths:write_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_both_paths.write__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "44191",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1710,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:18.069800-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44191) deny(1) file-read-metadata /var",
                "2026-01-03 09:25:18.103931-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44191) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:20",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:18.069800-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44191) deny(1) file-read-metadata /var\n2026-01-03 09:25:18.103931-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44191) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44191,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44191)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44191\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/var/tmp/canon",
              "start": "2026-01-03 09:25:16",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461118165,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:16",
          "observer_window_end": "2026-01-03 09:25:20",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_both_paths:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44194}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":44194}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:111259441\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461118.1674309,
        "cmd_finished_at_unix_s": 1767461118.1787012,
        "cmd_duration_s": 0.011270284652709961,
        "cmd_pid": 44194,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44194",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:16",
            "--end",
            "2026-01-03 09:25:20",
            "--row-id",
            "vfs_both_paths:write_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_both_paths.write__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "44194",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:20",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44194,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44194)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44194\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/var/tmp/canon",
              "start": "2026-01-03 09:25:16",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461118316,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:16",
          "observer_window_end": "2026-01-03 09:25:20",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_private_tmp_only_openat": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_private_tmp_only_openat.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_open_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_open_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":44197}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":44197}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461118.3203719,
        "cmd_finished_at_unix_s": 1767461118.33162,
        "cmd_duration_s": 0.011248111724853516,
        "cmd_pid": 44197,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44197",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:16",
            "--end",
            "2026-01-03 09:25:20",
            "--row-id",
            "vfs_private_tmp_only_openat:read_open_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only_openat.read_open__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44197",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_open_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1142,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:20",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44197,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44197)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44197\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat:read_open_/tmp/foo",
              "start": "2026-01-03 09:25:16",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461118475,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:16",
          "observer_window_end": "2026-01-03 09:25:20",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":44200}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":44200}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen dir: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461118.477716,
        "cmd_finished_at_unix_s": 1767461118.8734841,
        "cmd_duration_s": 0.3957681655883789,
        "cmd_pid": 44200,
        "cmd_process_name": "sandbox_openat_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44200",
            "--process-name",
            "sandbox_openat_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:16",
            "--end",
            "2026-01-03 09:25:20",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only_openat.read_openat__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44200",
          "process_name": "sandbox_openat_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1447,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:18.916293-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_reader(44200) deny(1) file-read-data /private/tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:20",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:18.916293-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_reader(44200) deny(1) file-read-data /private/tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44200,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_reader(44200)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44200\")))",
              "process_name": "sandbox_openat_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo",
              "start": "2026-01-03 09:25:16",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461119055,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:16",
          "observer_window_end": "2026-01-03 09:25:20",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_open_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_open_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":44203}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":44203}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461119.057965,
        "cmd_finished_at_unix_s": 1767461119.069293,
        "cmd_duration_s": 0.011327981948852539,
        "cmd_pid": 44203,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44203",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:17",
            "--end",
            "2026-01-03 09:25:21",
            "--row-id",
            "vfs_private_tmp_only_openat:read_open_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only_openat.read_open__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44203",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_open_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44203,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44203)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44203\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat:read_open_/private/tmp/foo",
              "start": "2026-01-03 09:25:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461119202,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:17",
          "observer_window_end": "2026-01-03 09:25:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":44206}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":44206}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nopen dir: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461119.205226,
        "cmd_finished_at_unix_s": 1767461119.216599,
        "cmd_duration_s": 0.011373043060302734,
        "cmd_pid": 44206,
        "cmd_process_name": "sandbox_openat_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44206",
            "--process-name",
            "sandbox_openat_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:17",
            "--end",
            "2026-01-03 09:25:21",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only_openat.read_openat__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44206",
          "process_name": "sandbox_openat_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1455,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:19.260281-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_reader(44206) deny(1) file-read-data /private/tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:19.260281-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_reader(44206) deny(1) file-read-data /private/tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44206,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_reader(44206)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44206\")))",
              "process_name": "sandbox_openat_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo",
              "start": "2026-01-03 09:25:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461119349,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:17",
          "observer_window_end": "2026-01-03 09:25:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_rootrel_tmp/foo",
        "operation": "file-read*",
        "path": "tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":44209}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":44209}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461119.351865,
        "cmd_finished_at_unix_s": 1767461119.663051,
        "cmd_duration_s": 0.3111858367919922,
        "cmd_pid": 44209,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44209",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:17",
            "--end",
            "2026-01-03 09:25:21",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_rootrel_tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only_openat.read_openat_rootrel_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44209",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_rootrel_tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1181,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44209,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(44209)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44209\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_rootrel_tmp/foo",
              "start": "2026-01-03 09:25:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461119836,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:17",
          "observer_window_end": "2026-01-03 09:25:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_rootrel_private/tmp/foo",
        "operation": "file-read*",
        "path": "private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":44212}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":44212}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461119.83844,
        "cmd_finished_at_unix_s": 1767461119.8496919,
        "cmd_duration_s": 0.01125192642211914,
        "cmd_pid": 44212,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44212",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:17",
            "--end",
            "2026-01-03 09:25:21",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_rootrel_private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_private_tmp_only_openat.read_openat_rootrel_private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "44212",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_rootrel_private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1189,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44212,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(44212)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44212\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_rootrel_private/tmp/foo",
              "start": "2026-01-03 09:25:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461119985,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:17",
          "observer_window_end": "2026-01-03 09:25:21",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_var_tmp_alias_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_alias_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":44215}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":44215}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461119.989069,
        "cmd_finished_at_unix_s": 1767461120.000345,
        "cmd_duration_s": 0.011276006698608398,
        "cmd_pid": 44215,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44215",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:17",
            "--end",
            "2026-01-03 09:25:22",
            "--row-id",
            "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_alias_only.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44215",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1727,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:20.043457-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44215) deny(1) file-read-metadata /var",
                "2026-01-03 09:25:20.077310-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44215) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:22",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:20.043457-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44215) deny(1) file-read-metadata /var\n2026-01-03 09:25:20.077310-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44215) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44215,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44215)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44215\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461120134,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:17",
          "observer_window_end": "2026-01-03 09:25:22",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":44218}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":44218}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461120.136833,
        "cmd_finished_at_unix_s": 1767461120.1480079,
        "cmd_duration_s": 0.011174917221069336,
        "cmd_pid": 44218,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44218",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:18",
            "--end",
            "2026-01-03 09:25:22",
            "--row-id",
            "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_alias_only.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44218",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1728,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:20.191114-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44218) deny(1) file-read-metadata /var",
                "2026-01-03 09:25:20.228014-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44218) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:22",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:20.191114-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44218) deny(1) file-read-metadata /var\n2026-01-03 09:25:20.228014-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44218) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44218,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44218)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44218\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:18",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461120277,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:18",
          "observer_window_end": "2026-01-03 09:25:22",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":44221}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":44221}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461120.2798662,
        "cmd_finished_at_unix_s": 1767461120.291001,
        "cmd_duration_s": 0.011134862899780273,
        "cmd_pid": 44221,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44221",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:18",
            "--end",
            "2026-01-03 09:25:22",
            "--row-id",
            "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_alias_only.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44221",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1471,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:20.334727-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44221) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:22",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:20.334727-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44221) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44221,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44221)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44221\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:18",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461120416,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:18",
          "observer_window_end": "2026-01-03 09:25:22",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":44224}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":44224}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461120.419167,
        "cmd_finished_at_unix_s": 1767461120.430418,
        "cmd_duration_s": 0.011250972747802734,
        "cmd_pid": 44224,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44224",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:18",
            "--end",
            "2026-01-03 09:25:22",
            "--row-id",
            "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_alias_only.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44224",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1474,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:20.474129-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44224) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:22",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:20.474129-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44224) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44224,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44224)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44224\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:18",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461120565,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:18",
          "observer_window_end": "2026-01-03 09:25:22",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":44227}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":44227}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461120.5673769,
        "cmd_finished_at_unix_s": 1767461120.578398,
        "cmd_duration_s": 0.011021137237548828,
        "cmd_pid": 44227,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44227",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:18",
            "--end",
            "2026-01-03 09:25:22",
            "--row-id",
            "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_alias_only.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44227",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1491,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:20.622118-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44227) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:22",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:20.622118-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44227) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44227,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44227)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44227\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:18",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461120710,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:18",
          "observer_window_end": "2026-01-03 09:25:22",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":44230}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":44230}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461120.712528,
        "cmd_finished_at_unix_s": 1767461120.723802,
        "cmd_duration_s": 0.011274099349975586,
        "cmd_pid": 44230,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44230",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:18",
            "--end",
            "2026-01-03 09:25:22",
            "--row-id",
            "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_alias_only.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44230",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1494,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:20.767520-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44230) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:22",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:20.767520-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44230) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44230,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44230)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44230\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:18",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461120852,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:18",
          "observer_window_end": "2026-01-03 09:25:22",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_var_tmp_private_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":44233}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":44233}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461120.8564742,
        "cmd_finished_at_unix_s": 1767461120.8676858,
        "cmd_duration_s": 0.011211633682250977,
        "cmd_pid": 44233,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44233",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:18",
            "--end",
            "2026-01-03 09:25:22",
            "--row-id",
            "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_private_only.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44233",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1729,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:20.910803-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44233) deny(1) file-read-metadata /var",
                "2026-01-03 09:25:20.944636-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44233) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:22",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:20.910803-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44233) deny(1) file-read-metadata /var\n2026-01-03 09:25:20.944636-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44233) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44233,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44233)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44233\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:18",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461121002,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:18",
          "observer_window_end": "2026-01-03 09:25:22",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":44236}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":44236}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461121.0051122,
        "cmd_finished_at_unix_s": 1767461121.016306,
        "cmd_duration_s": 0.01119375228881836,
        "cmd_pid": 44236,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44236",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:19",
            "--end",
            "2026-01-03 09:25:23",
            "--row-id",
            "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_private_only.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44236",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1730,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:21.059428-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44236) deny(1) file-read-metadata /var",
                "2026-01-03 09:25:21.092679-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44236) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:21.059428-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44236) deny(1) file-read-metadata /var\n2026-01-03 09:25:21.092679-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44236) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44236,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44236)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44236\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461121141,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:19",
          "observer_window_end": "2026-01-03 09:25:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":44239}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":44239}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461121.143502,
        "cmd_finished_at_unix_s": 1767461121.1549041,
        "cmd_duration_s": 0.011402130126953125,
        "cmd_pid": 44239,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44239",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:19",
            "--end",
            "2026-01-03 09:25:23",
            "--row-id",
            "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_private_only.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44239",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1158,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44239,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44239)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44239\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461121276,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:19",
          "observer_window_end": "2026-01-03 09:25:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":44242}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":44242}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461121.2789829,
        "cmd_finished_at_unix_s": 1767461121.290265,
        "cmd_duration_s": 0.011282205581665039,
        "cmd_pid": 44242,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44242",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:19",
            "--end",
            "2026-01-03 09:25:23",
            "--row-id",
            "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_private_only.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44242",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1159,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44242,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44242)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44242\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461121415,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:19",
          "observer_window_end": "2026-01-03 09:25:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":44245}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":44245}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461121.417296,
        "cmd_finished_at_unix_s": 1767461121.4284391,
        "cmd_duration_s": 0.011143207550048828,
        "cmd_pid": 44245,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44245",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:19",
            "--end",
            "2026-01-03 09:25:23",
            "--row-id",
            "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_private_only.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44245",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1178,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44245,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44245)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44245\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461121555,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:19",
          "observer_window_end": "2026-01-03 09:25:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":44248}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":44248}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461121.55796,
        "cmd_finished_at_unix_s": 1767461121.5691211,
        "cmd_duration_s": 0.011161088943481445,
        "cmd_pid": 44248,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44248",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:19",
            "--end",
            "2026-01-03 09:25:23",
            "--row-id",
            "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_private_only.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44248",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1179,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44248,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44248)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44248\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461121710,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:19",
          "observer_window_end": "2026-01-03 09:25:23",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_var_tmp_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":44251}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":44251}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461121.713801,
        "cmd_finished_at_unix_s": 1767461121.725072,
        "cmd_duration_s": 0.011270999908447266,
        "cmd_pid": 44251,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44251",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:19",
            "--end",
            "2026-01-03 09:25:23",
            "--row-id",
            "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_both.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44251",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1142,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44251,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44251)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44251\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461121866,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:19",
          "observer_window_end": "2026-01-03 09:25:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":44254}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":44254}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461121.8683462,
        "cmd_finished_at_unix_s": 1767461121.87965,
        "cmd_duration_s": 0.011303901672363281,
        "cmd_pid": 44254,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44254",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:19",
            "--end",
            "2026-01-03 09:25:23",
            "--row-id",
            "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_both.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44254",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1143,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44254,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44254)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44254\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461122021,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:19",
          "observer_window_end": "2026-01-03 09:25:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":44257}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":44257}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461122.023612,
        "cmd_finished_at_unix_s": 1767461122.034764,
        "cmd_duration_s": 0.011152029037475586,
        "cmd_pid": 44257,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44257",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:20",
            "--end",
            "2026-01-03 09:25:24",
            "--row-id",
            "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_both.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44257",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44257,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44257)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44257\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461122169,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:20",
          "observer_window_end": "2026-01-03 09:25:24",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":44260}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":44260}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461122.171714,
        "cmd_finished_at_unix_s": 1767461122.182998,
        "cmd_duration_s": 0.01128387451171875,
        "cmd_pid": 44260,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44260",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:20",
            "--end",
            "2026-01-03 09:25:24",
            "--row-id",
            "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_both.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44260",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1151,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44260,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44260)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44260\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461122321,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:20",
          "observer_window_end": "2026-01-03 09:25:24",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":44263}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":44263}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461122.32371,
        "cmd_finished_at_unix_s": 1767461122.33495,
        "cmd_duration_s": 0.011240005493164062,
        "cmd_pid": 44263,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44263",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:20",
            "--end",
            "2026-01-03 09:25:24",
            "--row-id",
            "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_both.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44263",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1170,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44263,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44263)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44263\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461122471,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:20",
          "observer_window_end": "2026-01-03 09:25:24",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":44266}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":44266}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461122.473898,
        "cmd_finished_at_unix_s": 1767461122.485236,
        "cmd_duration_s": 0.011337995529174805,
        "cmd_pid": 44266,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44266",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:20",
            "--end",
            "2026-01-03 09:25:24",
            "--row-id",
            "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_both.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44266",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1171,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44266,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44266)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44266\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461122622,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:20",
          "observer_window_end": "2026-01-03 09:25:24",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_var_tmp_both_plus_metadata_var": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_both_plus_metadata_var.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/var",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:lstat_/var",
        "operation": "file-read-metadata",
        "path": "/var",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "rc": 1,
              "filter_type_name": "unknown",
              "stage": "pre_syscall",
              "check_type": 1073741825,
              "varargs_count": 1,
              "tool": "seatbelt-callout",
              "canonical_flag_reason": "not_requested",
              "token_status": "ok",
              "canonicalization": "raw",
              "no_report_reason": null,
              "filter_type": 1,
              "token_mach_kr": 0,
              "errno": 0,
              "error": null,
              "marker_schema_version": 2,
              "argument": "/var",
              "operation": "file-read-metadata",
              "api": "sandbox_check_by_audit_token",
              "canonical_flag_used": false,
              "no_report": true,
              "decision": "deny"
            },
            {
              "rc": 1,
              "filter_type_name": "unknown",
              "stage": "pre_syscall",
              "check_type": 1610612737,
              "varargs_count": 1,
              "tool": "seatbelt-callout",
              "canonical_flag_reason": null,
              "token_status": "ok",
              "canonicalization": "canonical",
              "no_report_reason": null,
              "filter_type": 1,
              "token_mach_kr": 0,
              "errno": 0,
              "error": null,
              "marker_schema_version": 2,
              "argument": "/var",
              "operation": "file-read-metadata",
              "api": "sandbox_check_by_audit_token",
              "canonical_flag_used": true,
              "no_report": true,
              "decision": "deny"
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/var",
          "--syscall",
          "lstat"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"rc\":0,\"marker_schema_version\":1,\"errbuf\":null,\"err_class\":\"ok\",\"api\":\"sandbox_init\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/b4e02cad-1b76-4ab1-827e-8afaeb967aa0\\/runtime_profiles\\/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":44269,\"tool\":\"sbpl-apply\",\"mode\":\"sbpl\",\"err_class_source\":\"none\",\"errno\":0,\"stage\":\"apply\"}\n{\"mode\":\"sbpl\",\"marker_schema_version\":1,\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/b4e02cad-1b76-4ab1-827e-8afaeb967aa0\\/runtime_profiles\\/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"tool\":\"sbpl-apply\",\"api\":\"sandbox_init\",\"rc\":0,\"stage\":\"applied\",\"pid\":44269}\n{\"rc\":1,\"filter_type_name\":\"unknown\",\"stage\":\"pre_syscall\",\"check_type\":1073741825,\"varargs_count\":1,\"tool\":\"seatbelt-callout\",\"canonical_flag_reason\":\"not_requested\",\"token_status\":\"ok\",\"canonicalization\":\"raw\",\"no_report_reason\":null,\"filter_type\":1,\"token_mach_kr\":0,\"errno\":0,\"error\":null,\"marker_schema_version\":2,\"argument\":\"\\/var\",\"operation\":\"file-read-metadata\",\"api\":\"sandbox_check_by_audit_token\",\"canonical_flag_used\":false,\"no_report\":true,\"decision\":\"deny\"}\n{\"rc\":1,\"filter_type_name\":\"unknown\",\"stage\":\"pre_syscall\",\"check_type\":1610612737,\"varargs_count\":1,\"tool\":\"seatbelt-callout\",\"canonical_flag_reason\":null,\"token_status\":\"ok\",\"canonicalization\":\"canonical\",\"no_report_reason\":null,\"filter_type\":1,\"token_mach_kr\":0,\"errno\":0,\"error\":null,\"marker_schema_version\":2,\"argument\":\"\\/var\",\"operation\":\"file-read-metadata\",\"api\":\"sandbox_check_by_audit_token\",\"canonical_flag_used\":true,\"no_report\":true,\"decision\":\"deny\"}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 0,
          "errno_name": "OK",
          "message": "stat-ok",
          "op": "file-read-metadata",
          "path": "/var",
          "status": "ok",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767461122.626337,
        "cmd_finished_at_unix_s": 1767461122.9175448,
        "cmd_duration_s": 0.29120779037475586,
        "cmd_pid": 44269,
        "cmd_process_name": "metadata_runner",
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44269",
            "--process-name",
            "metadata_runner",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:20",
            "--end",
            "2026-01-03 09:25:24",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:lstat_/var"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_both_plus_metadata_var.lstat__var.observer.json",
          "log_write_error": null,
          "pid": "44269",
          "process_name": "metadata_runner",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:lstat_/var",
          "correlation_id": null,
          "stdout_bytes": 8499,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:22.955399-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) sysctl-read kern.maxfilesperproc",
                "2026-01-03 09:25:22.957297-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/api/runtime/native/metadata_runner",
                "2026-01-03 09:25:22.957332-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/api/runtime/native/metadata_runner",
                "2026-01-03 09:25:22.958095-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:22.958189-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:22.958230-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:22.958235-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-metadata /Users/achyland",
                "2026-01-03 09:25:22.958529-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:22.958618-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:22.959024-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:22.959029-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:22.959100-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:22.959175-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:22.959180-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:22.959248-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:22.959322-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:22.959326-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:22.959394-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:22.959465-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:22.959469-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:22.959535-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:22.960018-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:22.960022-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:22.955399-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) sysctl-read kern.maxfilesperproc\n2026-01-03 09:25:22.957297-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/api/runtime/native/metadata_runner\n2026-01-03 09:25:22.957332-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/api/runtime/native/metadata_runner\n2026-01-03 09:25:22.958095-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:22.958189-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc\n2026-01-03 09:25:22.958230-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc\n2026-01-03 09:25:22.958235-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-metadata /Users/achyland\n2026-01-03 09:25:22.958529-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:22.958618-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc\n2026-01-03 09:25:22.959024-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc\n2026-01-03 09:25:22.959029-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:22.959100-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc\n2026-01-03 09:25:22.959175-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc\n2026-01-03 09:25:22.959180-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:22.959248-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc\n2026-01-03 09:25:22.959322-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc\n2026-01-03 09:25:22.959326-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:22.959394-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc\n2026-01-03 09:25:22.959465-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc\n2026-01-03 09:25:22.959469-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:22.959535-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc\n2026-01-03 09:25:22.960018-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44269) deny(1) file-read-metadata /etc\n2026-01-03 09:25:22.960022-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44269) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 24,
              "observer_schema_version": 1,
              "pid": 44269,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: metadata_runner(44269)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44269\")))",
              "process_name": "metadata_runner",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:lstat_/var",
              "start": "2026-01-03 09:25:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461123086,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:20",
          "observer_window_end": "2026-01-03 09:25:24",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":44272}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":44272}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461123.0898051,
        "cmd_finished_at_unix_s": 1767461123.1011798,
        "cmd_duration_s": 0.011374711990356445,
        "cmd_pid": 44272,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44272",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:21",
            "--end",
            "2026-01-03 09:25:25",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_both_plus_metadata_var.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44272",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1160,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44272,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44272)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44272\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461123245,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:21",
          "observer_window_end": "2026-01-03 09:25:25",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":44275}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":44275}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461123.247905,
        "cmd_finished_at_unix_s": 1767461123.259347,
        "cmd_duration_s": 0.011441946029663086,
        "cmd_pid": 44275,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44275",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:21",
            "--end",
            "2026-01-03 09:25:25",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_both_plus_metadata_var.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44275",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1161,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44275,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44275)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44275\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461123419,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:21",
          "observer_window_end": "2026-01-03 09:25:25",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":44278}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":44278}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461123.422123,
        "cmd_finished_at_unix_s": 1767461123.433461,
        "cmd_duration_s": 0.011337995529174805,
        "cmd_pid": 44278,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44278",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:21",
            "--end",
            "2026-01-03 09:25:25",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_both_plus_metadata_var.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44278",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1168,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44278,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44278)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44278\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461123587,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:21",
          "observer_window_end": "2026-01-03 09:25:25",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":44281}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":44281}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461123.589531,
        "cmd_finished_at_unix_s": 1767461123.6009889,
        "cmd_duration_s": 0.01145792007446289,
        "cmd_pid": 44281,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44281",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:21",
            "--end",
            "2026-01-03 09:25:25",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_both_plus_metadata_var.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44281",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1169,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44281,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44281)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44281\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461123757,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:21",
          "observer_window_end": "2026-01-03 09:25:25",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_var_tmp_data_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_data_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":44284}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":44284}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461123.76107,
        "cmd_finished_at_unix_s": 1767461123.772162,
        "cmd_duration_s": 0.011091947555541992,
        "cmd_pid": 44284,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44284",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:21",
            "--end",
            "2026-01-03 09:25:25",
            "--row-id",
            "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_data_only.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44284",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1726,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:23.815392-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44284) deny(1) file-read-metadata /var",
                "2026-01-03 09:25:23.849227-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44284) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:23.815392-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44284) deny(1) file-read-metadata /var\n2026-01-03 09:25:23.849227-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44284) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44284,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44284)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44284\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461123930,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:21",
          "observer_window_end": "2026-01-03 09:25:25",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":44287}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":44287}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461123.932838,
        "cmd_finished_at_unix_s": 1767461123.943904,
        "cmd_duration_s": 0.011065959930419922,
        "cmd_pid": 44287,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44287",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:21",
            "--end",
            "2026-01-03 09:25:25",
            "--row-id",
            "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_data_only.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44287",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1727,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:23.987149-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44287) deny(1) file-read-metadata /var",
                "2026-01-03 09:25:24.023200-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44287) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:23.987149-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44287) deny(1) file-read-metadata /var\n2026-01-03 09:25:24.023200-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44287) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44287,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44287)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44287\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461124100,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:21",
          "observer_window_end": "2026-01-03 09:25:25",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":44290}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":44290}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461124.102551,
        "cmd_finished_at_unix_s": 1767461124.113857,
        "cmd_duration_s": 0.011306047439575195,
        "cmd_pid": 44290,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44290",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:22",
            "--end",
            "2026-01-03 09:25:26",
            "--row-id",
            "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_data_only.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44290",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1470,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:24.157673-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44290) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:24.157673-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44290) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44290,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44290)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44290\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461124260,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:22",
          "observer_window_end": "2026-01-03 09:25:26",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":44293}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":44293}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461124.262464,
        "cmd_finished_at_unix_s": 1767461124.273757,
        "cmd_duration_s": 0.01129293441772461,
        "cmd_pid": 44293,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44293",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:22",
            "--end",
            "2026-01-03 09:25:26",
            "--row-id",
            "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_data_only.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44293",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1473,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:24.317569-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44293) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:24.317569-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44293) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44293,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44293)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44293\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461124416,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:22",
          "observer_window_end": "2026-01-03 09:25:26",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":44296}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":44296}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461124.418998,
        "cmd_finished_at_unix_s": 1767461124.430248,
        "cmd_duration_s": 0.011250019073486328,
        "cmd_pid": 44296,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44296",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:22",
            "--end",
            "2026-01-03 09:25:26",
            "--row-id",
            "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_data_only.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44296",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1490,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:24.474063-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44296) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:24.474063-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44296) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44296,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44296)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44296\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461124589,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:22",
          "observer_window_end": "2026-01-03 09:25:26",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":44300}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":44300}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461124.591269,
        "cmd_finished_at_unix_s": 1767461124.602525,
        "cmd_duration_s": 0.011255979537963867,
        "cmd_pid": 44300,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44300",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:22",
            "--end",
            "2026-01-03 09:25:26",
            "--row-id",
            "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_var_tmp_data_only.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "44300",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1493,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:24.646345-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44300) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:24.646345-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44300) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44300,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44300)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44300\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 09:25:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461124776,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:22",
          "observer_window_end": "2026-01-03 09:25:26",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_etc_alias_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_alias_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_alias_only:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":44303}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":44303}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461124.779575,
        "cmd_finished_at_unix_s": 1767461124.790712,
        "cmd_duration_s": 0.011137008666992188,
        "cmd_pid": 44303,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44303",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:22",
            "--end",
            "2026-01-03 09:25:26",
            "--row-id",
            "vfs_etc_alias_only:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_etc_alias_only.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "44303",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_alias_only:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1709,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:24.833972-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44303) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:24.866195-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44303) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:24.833972-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44303) deny(1) file-read-metadata /etc\n2026-01-03 09:25:24.866195-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44303) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44303,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44303)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44303\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_alias_only:read_/etc/hosts",
              "start": "2026-01-03 09:25:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461124956,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:22",
          "observer_window_end": "2026-01-03 09:25:26",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_alias_only:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":44306}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":44306}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461124.9586601,
        "cmd_finished_at_unix_s": 1767461124.9698071,
        "cmd_duration_s": 0.011147022247314453,
        "cmd_pid": 44306,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44306",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:22",
            "--end",
            "2026-01-03 09:25:26",
            "--row-id",
            "vfs_etc_alias_only:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_etc_alias_only.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "44306",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_alias_only:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1425,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:25.013645-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44306) deny(1) file-read-data /private/etc/hosts"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:25.013645-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44306) deny(1) file-read-data /private/etc/hosts",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44306,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44306)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44306\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_alias_only:read_/private/etc/hosts",
              "start": "2026-01-03 09:25:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461125136,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:22",
          "observer_window_end": "2026-01-03 09:25:26",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_etc_private_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_private_only:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":44309}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":44309}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461125.139793,
        "cmd_finished_at_unix_s": 1767461125.150944,
        "cmd_duration_s": 0.01115107536315918,
        "cmd_pid": 44309,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44309",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:23",
            "--end",
            "2026-01-03 09:25:27",
            "--row-id",
            "vfs_etc_private_only:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_etc_private_only.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "44309",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_private_only:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1711,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:25.194226-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44309) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:25.230654-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44309) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:25.194226-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44309) deny(1) file-read-metadata /etc\n2026-01-03 09:25:25.230654-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44309) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44309,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44309)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44309\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_private_only:read_/etc/hosts",
              "start": "2026-01-03 09:25:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461125309,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:23",
          "observer_window_end": "2026-01-03 09:25:27",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_private_only:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":44312}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":44312}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461125.311358,
        "cmd_finished_at_unix_s": 1767461125.322556,
        "cmd_duration_s": 0.011198043823242188,
        "cmd_pid": 44312,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44312",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:23",
            "--end",
            "2026-01-03 09:25:27",
            "--row-id",
            "vfs_etc_private_only:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_etc_private_only.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "44312",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_private_only:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1140,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44312,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44312)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44312\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_private_only:read_/private/etc/hosts",
              "start": "2026-01-03 09:25:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461125476,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:23",
          "observer_window_end": "2026-01-03 09:25:27",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_etc_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_both:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":44315}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":44315}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461125.479989,
        "cmd_finished_at_unix_s": 1767461125.491154,
        "cmd_duration_s": 0.01116490364074707,
        "cmd_pid": 44315,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44315",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:23",
            "--end",
            "2026-01-03 09:25:27",
            "--row-id",
            "vfs_etc_both:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_etc_both.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "44315",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1703,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:25.534437-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44315) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:25.570250-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44315) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:25.534437-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44315) deny(1) file-read-metadata /etc\n2026-01-03 09:25:25.570250-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44315) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44315,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44315)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44315\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both:read_/etc/hosts",
              "start": "2026-01-03 09:25:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461125653,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:23",
          "observer_window_end": "2026-01-03 09:25:27",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_both:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":44318}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":44318}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461125.656161,
        "cmd_finished_at_unix_s": 1767461125.6673868,
        "cmd_duration_s": 0.011225700378417969,
        "cmd_pid": 44318,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44318",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:23",
            "--end",
            "2026-01-03 09:25:27",
            "--row-id",
            "vfs_etc_both:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_etc_both.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "44318",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1132,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44318,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44318)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44318\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both:read_/private/etc/hosts",
              "start": "2026-01-03 09:25:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461125833,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:23",
          "observer_window_end": "2026-01-03 09:25:27",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_etc/hosts",
        "expectation_id": "vfs_etc_both:read_openat_rootrel_etc/hosts",
        "operation": "file-read*",
        "path": "etc/hosts",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":44321}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":44321}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopenat(root) target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461125.835544,
        "cmd_finished_at_unix_s": 1767461125.846832,
        "cmd_duration_s": 0.011287927627563477,
        "cmd_pid": 44321,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44321",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:23",
            "--end",
            "2026-01-03 09:25:27",
            "--row-id",
            "vfs_etc_both:read_openat_rootrel_etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_etc_both.read_openat_rootrel_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "44321",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_openat_rootrel_etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1465,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:25.890699-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_rootrel_reader(44321) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:25.890699-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_rootrel_reader(44321) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44321,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(44321)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44321\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_etc_both:read_openat_rootrel_etc/hosts",
              "start": "2026-01-03 09:25:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461126010,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:23",
          "observer_window_end": "2026-01-03 09:25:27",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_private/etc/hosts",
        "expectation_id": "vfs_etc_both:read_openat_rootrel_private/etc/hosts",
        "operation": "file-read*",
        "path": "private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":44324}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":44324}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461126.0128279,
        "cmd_finished_at_unix_s": 1767461126.023977,
        "cmd_duration_s": 0.011149168014526367,
        "cmd_pid": 44324,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44324",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:24",
            "--end",
            "2026-01-03 09:25:28",
            "--row-id",
            "vfs_etc_both:read_openat_rootrel_private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_etc_both.read_openat_rootrel_private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "44324",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_openat_rootrel_private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1176,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44324,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(44324)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44324\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_etc_both:read_openat_rootrel_private/etc/hosts",
              "start": "2026-01-03 09:25:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461126171,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:24",
          "observer_window_end": "2026-01-03 09:25:28",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_etc_both_plus_metadata_etc": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_both_plus_metadata_etc.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/etc",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:lstat_/etc",
        "operation": "file-read-metadata",
        "path": "/etc",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "no_report_reason": null,
              "operation": "file-read-metadata",
              "canonicalization": "raw",
              "rc": 1,
              "argument": "/etc",
              "token_mach_kr": 0,
              "decision": "deny",
              "check_type": 1073741825,
              "varargs_count": 1,
              "stage": "pre_syscall",
              "filter_type": 1,
              "canonical_flag_reason": "not_requested",
              "error": null,
              "canonical_flag_used": false,
              "no_report": true,
              "errno": 0,
              "api": "sandbox_check_by_audit_token",
              "tool": "seatbelt-callout",
              "token_status": "ok",
              "marker_schema_version": 2,
              "filter_type_name": "unknown"
            },
            {
              "no_report_reason": null,
              "operation": "file-read-metadata",
              "canonicalization": "canonical",
              "rc": 1,
              "argument": "/etc",
              "token_mach_kr": 0,
              "decision": "deny",
              "check_type": 1610612737,
              "varargs_count": 1,
              "stage": "pre_syscall",
              "filter_type": 1,
              "canonical_flag_reason": null,
              "error": null,
              "canonical_flag_used": true,
              "no_report": true,
              "errno": 0,
              "api": "sandbox_check_by_audit_token",
              "tool": "seatbelt-callout",
              "token_status": "ok",
              "marker_schema_version": 2,
              "filter_type_name": "unknown"
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/etc",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/etc",
          "--syscall",
          "lstat"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"err_class_source\":\"none\",\"err_class\":\"ok\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/b4e02cad-1b76-4ab1-827e-8afaeb967aa0\\/runtime_profiles\\/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":44327,\"marker_schema_version\":1,\"errno\":0,\"rc\":0,\"api\":\"sandbox_init\",\"errbuf\":null,\"stage\":\"apply\",\"mode\":\"sbpl\",\"tool\":\"sbpl-apply\"}\n{\"tool\":\"sbpl-apply\",\"api\":\"sandbox_init\",\"rc\":0,\"pid\":44327,\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/b4e02cad-1b76-4ab1-827e-8afaeb967aa0\\/runtime_profiles\\/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\"}\n{\"no_report_reason\":null,\"operation\":\"file-read-metadata\",\"canonicalization\":\"raw\",\"rc\":1,\"argument\":\"\\/etc\",\"token_mach_kr\":0,\"decision\":\"deny\",\"check_type\":1073741825,\"varargs_count\":1,\"stage\":\"pre_syscall\",\"filter_type\":1,\"canonical_flag_reason\":\"not_requested\",\"error\":null,\"canonical_flag_used\":false,\"no_report\":true,\"errno\":0,\"api\":\"sandbox_check_by_audit_token\",\"tool\":\"seatbelt-callout\",\"token_status\":\"ok\",\"marker_schema_version\":2,\"filter_type_name\":\"unknown\"}\n{\"no_report_reason\":null,\"operation\":\"file-read-metadata\",\"canonicalization\":\"canonical\",\"rc\":1,\"argument\":\"\\/etc\",\"token_mach_kr\":0,\"decision\":\"deny\",\"check_type\":1610612737,\"varargs_count\":1,\"stage\":\"pre_syscall\",\"filter_type\":1,\"canonical_flag_reason\":null,\"error\":null,\"canonical_flag_used\":true,\"no_report\":true,\"errno\":0,\"api\":\"sandbox_check_by_audit_token\",\"tool\":\"seatbelt-callout\",\"token_status\":\"ok\",\"marker_schema_version\":2,\"filter_type_name\":\"unknown\"}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 0,
          "errno_name": "OK",
          "message": "stat-ok",
          "op": "file-read-metadata",
          "path": "/etc",
          "status": "ok",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767461126.174488,
        "cmd_finished_at_unix_s": 1767461126.188802,
        "cmd_duration_s": 0.014313936233520508,
        "cmd_pid": 44327,
        "cmd_process_name": "metadata_runner",
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/etc",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44327",
            "--process-name",
            "metadata_runner",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:24",
            "--end",
            "2026-01-03 09:25:28",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:lstat_/etc"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_etc_both_plus_metadata_etc.lstat__etc.observer.json",
          "log_write_error": null,
          "pid": "44327",
          "process_name": "metadata_runner",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:lstat_/etc",
          "correlation_id": null,
          "stdout_bytes": 8531,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:26.230045-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) sysctl-read kern.maxfilesperproc",
                "2026-01-03 09:25:26.230861-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/api/runtime/native/metadata_runner",
                "2026-01-03 09:25:26.230873-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/api/runtime/native/metadata_runner",
                "2026-01-03 09:25:26.231194-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:26.231263-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 09:25:26.231274-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 09:25:26.231288-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-metadata /Users/achyland",
                "2026-01-03 09:25:26.231438-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:26.231494-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 09:25:26.231502-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 09:25:26.231701-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:26.231747-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 09:25:26.231754-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 09:25:26.231788-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:26.231837-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 09:25:26.231845-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 09:25:26.231874-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:26.231918-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 09:25:26.231925-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 09:25:26.231951-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:26.231995-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 09:25:26.232002-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 09:25:26.232187-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:26.230045-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) sysctl-read kern.maxfilesperproc\n2026-01-03 09:25:26.230861-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/api/runtime/native/metadata_runner\n2026-01-03 09:25:26.230873-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/api/runtime/native/metadata_runner\n2026-01-03 09:25:26.231194-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:26.231263-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-data /private/etc/passwd\n2026-01-03 09:25:26.231274-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 09:25:26.231288-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-metadata /Users/achyland\n2026-01-03 09:25:26.231438-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:26.231494-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-data /private/etc/passwd\n2026-01-03 09:25:26.231502-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 09:25:26.231701-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:26.231747-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-data /private/etc/passwd\n2026-01-03 09:25:26.231754-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 09:25:26.231788-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:26.231837-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-data /private/etc/passwd\n2026-01-03 09:25:26.231845-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 09:25:26.231874-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:26.231918-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-data /private/etc/passwd\n2026-01-03 09:25:26.231925-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 09:25:26.231951-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:26.231995-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-data /private/etc/passwd\n2026-01-03 09:25:26.232002-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 09:25:26.232187-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44327) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 24,
              "observer_schema_version": 1,
              "pid": 44327,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: metadata_runner(44327)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44327\")))",
              "process_name": "metadata_runner",
              "row_id": "vfs_etc_both_plus_metadata_etc:lstat_/etc",
              "start": "2026-01-03 09:25:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461126340,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:24",
          "observer_window_end": "2026-01-03 09:25:28",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_etc/hosts",
        "operation": "file-read*",
        "path": "etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":44330}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":44330}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461126.343175,
        "cmd_finished_at_unix_s": 1767461126.354309,
        "cmd_duration_s": 0.011134147644042969,
        "cmd_pid": 44330,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44330",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:24",
            "--end",
            "2026-01-03 09:25:28",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_etc_both_plus_metadata_etc.read_openat_rootrel_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "44330",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1186,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44330,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(44330)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44330\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_etc/hosts",
              "start": "2026-01-03 09:25:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461126511,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:24",
          "observer_window_end": "2026-01-03 09:25:28",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_private/etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_private/etc/hosts",
        "operation": "file-read*",
        "path": "private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":44333}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":44333}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461126.514057,
        "cmd_finished_at_unix_s": 1767461126.525311,
        "cmd_duration_s": 0.011254072189331055,
        "cmd_pid": 44333,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44333",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:24",
            "--end",
            "2026-01-03 09:25:28",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_etc_both_plus_metadata_etc.read_openat_rootrel_private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "44333",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1194,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44333,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(44333)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44333\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_private/etc/hosts",
              "start": "2026-01-03 09:25:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461126683,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:24",
          "observer_window_end": "2026-01-03 09:25:28",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":44336}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":44336}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461126.685741,
        "cmd_finished_at_unix_s": 1767461126.6969721,
        "cmd_duration_s": 0.011231184005737305,
        "cmd_pid": 44336,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44336",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:24",
            "--end",
            "2026-01-03 09:25:28",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_etc_both_plus_metadata_etc.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "44336",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1142,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44336,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44336)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44336\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_/etc/hosts",
              "start": "2026-01-03 09:25:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461126856,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:24",
          "observer_window_end": "2026-01-03 09:25:28",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":44339}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":44339}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461126.8591979,
        "cmd_finished_at_unix_s": 1767461126.8702269,
        "cmd_duration_s": 0.01102900505065918,
        "cmd_pid": 44339,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44339",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:24",
            "--end",
            "2026-01-03 09:25:28",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_etc_both_plus_metadata_etc.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "44339",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44339,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44339)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44339\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts",
              "start": "2026-01-03 09:25:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461127031,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:24",
          "observer_window_end": "2026-01-03 09:25:28",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_firmlink_private_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":44342}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":44342}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461127.034977,
        "cmd_finished_at_unix_s": 1767461127.046394,
        "cmd_duration_s": 0.011417150497436523,
        "cmd_pid": 44342,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44342",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:25",
            "--end",
            "2026-01-03 09:25:29",
            "--row-id",
            "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_firmlink_private_only.read__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "44342",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1158,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44342,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44342)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44342\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 09:25:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461127189,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:25",
          "observer_window_end": "2026-01-03 09:25:29",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":44345}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":44345}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461127.19171,
        "cmd_finished_at_unix_s": 1767461127.202966,
        "cmd_duration_s": 0.011255979537963867,
        "cmd_pid": 44345,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44345",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:25",
            "--end",
            "2026-01-03 09:25:29",
            "--row-id",
            "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_firmlink_private_only.write__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "44345",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1159,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44345,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44345)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44345\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 09:25:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461127343,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:25",
          "observer_window_end": "2026-01-03 09:25:29",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":44348}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":44348}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461127.345681,
        "cmd_finished_at_unix_s": 1767461127.356859,
        "cmd_duration_s": 0.011178016662597656,
        "cmd_pid": 44348,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44348",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:25",
            "--end",
            "2026-01-03 09:25:29",
            "--row-id",
            "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_firmlink_private_only.read__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "44348",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1178,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44348,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44348)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44348\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 09:25:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461127500,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:25",
          "observer_window_end": "2026-01-03 09:25:29",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":44351}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":44351}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461127.502492,
        "cmd_finished_at_unix_s": 1767461127.51397,
        "cmd_duration_s": 0.011477947235107422,
        "cmd_pid": 44351,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44351",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:25",
            "--end",
            "2026-01-03 09:25:29",
            "--row-id",
            "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_firmlink_private_only.write__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "44351",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1179,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44351,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44351)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44351\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 09:25:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461127655,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:25",
          "observer_window_end": "2026-01-03 09:25:29",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_firmlink_data_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_data_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":44354}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":44354}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461127.659304,
        "cmd_finished_at_unix_s": 1767461127.67052,
        "cmd_duration_s": 0.011216163635253906,
        "cmd_pid": 44354,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44354",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:25",
            "--end",
            "2026-01-03 09:25:29",
            "--row-id",
            "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_firmlink_data_only.read__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "44354",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1468,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:27.714369-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44354) deny(1) file-read-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:27.714369-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44354) deny(1) file-read-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44354,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44354)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44354\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 09:25:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461127819,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:25",
          "observer_window_end": "2026-01-03 09:25:29",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":44357}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":44357}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461127.82196,
        "cmd_finished_at_unix_s": 1767461127.833416,
        "cmd_duration_s": 0.011456012725830078,
        "cmd_pid": 44357,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44357",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:25",
            "--end",
            "2026-01-03 09:25:29",
            "--row-id",
            "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_firmlink_data_only.write__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "44357",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1471,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:27.877201-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44357) deny(1) file-write-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:27.877201-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44357) deny(1) file-write-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44357,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44357)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44357\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 09:25:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461127985,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:25",
          "observer_window_end": "2026-01-03 09:25:29",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":44360}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":44360}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461127.9881961,
        "cmd_finished_at_unix_s": 1767461127.999585,
        "cmd_duration_s": 0.011388778686523438,
        "cmd_pid": 44360,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44360",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:25",
            "--end",
            "2026-01-03 09:25:29",
            "--row-id",
            "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_firmlink_data_only.read__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "44360",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1488,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:28.043443-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44360) deny(1) file-read-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:28.043443-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44360) deny(1) file-read-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44360,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44360)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44360\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 09:25:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461128155,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:25",
          "observer_window_end": "2026-01-03 09:25:29",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":44363}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":44363}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461128.157346,
        "cmd_finished_at_unix_s": 1767461128.168483,
        "cmd_duration_s": 0.011137008666992188,
        "cmd_pid": 44363,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44363",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:26",
            "--end",
            "2026-01-03 09:25:30",
            "--row-id",
            "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_firmlink_data_only.write__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "44363",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1491,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:28.212388-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44363) deny(1) file-write-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:28.212388-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44363) deny(1) file-write-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44363,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44363)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44363\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 09:25:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461128361,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:26",
          "observer_window_end": "2026-01-03 09:25:30",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_firmlink_both": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":44366}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":44366}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461128.364661,
        "cmd_finished_at_unix_s": 1767461128.376039,
        "cmd_duration_s": 0.011378049850463867,
        "cmd_pid": 44366,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44366",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:26",
            "--end",
            "2026-01-03 09:25:30",
            "--row-id",
            "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_firmlink_both.read__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "44366",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44366,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44366)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44366\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 09:25:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461128550,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:26",
          "observer_window_end": "2026-01-03 09:25:30",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":44369}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":44369}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461128.552591,
        "cmd_finished_at_unix_s": 1767461128.564002,
        "cmd_duration_s": 0.011410951614379883,
        "cmd_pid": 44369,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44369",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:26",
            "--end",
            "2026-01-03 09:25:30",
            "--row-id",
            "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_firmlink_both.write__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "44369",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1151,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44369,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44369)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44369\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 09:25:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461128742,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:26",
          "observer_window_end": "2026-01-03 09:25:30",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":44372}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":44372}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461128.744816,
        "cmd_finished_at_unix_s": 1767461128.756075,
        "cmd_duration_s": 0.011258840560913086,
        "cmd_pid": 44372,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44372",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:26",
            "--end",
            "2026-01-03 09:25:30",
            "--row-id",
            "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_firmlink_both.read__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "44372",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1170,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44372,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44372)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44372\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 09:25:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461128925,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:26",
          "observer_window_end": "2026-01-03 09:25:30",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":44375}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":44375}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461128.928115,
        "cmd_finished_at_unix_s": 1767461128.9394372,
        "cmd_duration_s": 0.011322259902954102,
        "cmd_pid": 44375,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44375",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:26",
            "--end",
            "2026-01-03 09:25:30",
            "--row-id",
            "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_firmlink_both.write__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "44375",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1171,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44375,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44375)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44375\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 09:25:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461129108,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:26",
          "observer_window_end": "2026-01-03 09:25:30",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_link_var_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_var_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":44378}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":44378}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461129.111743,
        "cmd_finished_at_unix_s": 1767461129.122883,
        "cmd_duration_s": 0.011140108108520508,
        "cmd_pid": 44378,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44378",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:27",
            "--end",
            "2026-01-03 09:25:31",
            "--row-id",
            "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_link_var_tmp_only.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "44378",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1876,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:29.166202-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44378) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
                "2026-01-03 09:25:29.197931-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44378) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:29.166202-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44378) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp\n2026-01-03 09:25:29.197931-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44378) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44378,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44378)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44378\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 09:25:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461129275,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:27",
          "observer_window_end": "2026-01-03 09:25:31",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":44381}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":44381}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461129.2779,
        "cmd_finished_at_unix_s": 1767461129.289278,
        "cmd_duration_s": 0.011378049850463867,
        "cmd_pid": 44381,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44381",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:27",
            "--end",
            "2026-01-03 09:25:31",
            "--row-id",
            "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_link_var_tmp_only.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "44381",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1877,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:29.332588-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44381) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
                "2026-01-03 09:25:29.366837-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44381) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:29.332588-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44381) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp\n2026-01-03 09:25:29.366837-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44381) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44381,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44381)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44381\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 09:25:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461129460,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:27",
          "observer_window_end": "2026-01-03 09:25:31",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":44384}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":44384}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461129.4627872,
        "cmd_finished_at_unix_s": 1767461129.474272,
        "cmd_duration_s": 0.011484861373901367,
        "cmd_pid": 44384,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44384",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:27",
            "--end",
            "2026-01-03 09:25:31",
            "--row-id",
            "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_link_var_tmp_only.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "44384",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1154,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44384,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44384)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44384\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 09:25:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461129634,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:27",
          "observer_window_end": "2026-01-03 09:25:31",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":44387}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":44387}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461129.6369238,
        "cmd_finished_at_unix_s": 1767461129.648233,
        "cmd_duration_s": 0.011309146881103516,
        "cmd_pid": 44387,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44387",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:27",
            "--end",
            "2026-01-03 09:25:31",
            "--row-id",
            "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_link_var_tmp_only.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "44387",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1155,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44387,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44387)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44387\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 09:25:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461129825,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:27",
          "observer_window_end": "2026-01-03 09:25:31",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_link_private_tmp_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_private_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":44390}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":44390}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461129.8285599,
        "cmd_finished_at_unix_s": 1767461129.839983,
        "cmd_duration_s": 0.011423110961914062,
        "cmd_pid": 44390,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44390",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:27",
            "--end",
            "2026-01-03 09:25:31",
            "--row-id",
            "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_link_private_tmp_only.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "44390",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1880,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:29.883334-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44390) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
                "2026-01-03 09:25:29.921734-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44390) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:29.883334-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44390) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp\n2026-01-03 09:25:29.921734-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44390) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44390,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44390)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44390\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 09:25:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461130067,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:27",
          "observer_window_end": "2026-01-03 09:25:31",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":44393}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":44393}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461130.070292,
        "cmd_finished_at_unix_s": 1767461130.0820348,
        "cmd_duration_s": 0.011742830276489258,
        "cmd_pid": 44393,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44393",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:28",
            "--end",
            "2026-01-03 09:25:32",
            "--row-id",
            "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_link_private_tmp_only.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "44393",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1881,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:30.125273-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44393) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
                "2026-01-03 09:25:30.158574-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44393) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:32",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:30.125273-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44393) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp\n2026-01-03 09:25:30.158574-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44393) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44393,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44393)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44393\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 09:25:28",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461130277,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:28",
          "observer_window_end": "2026-01-03 09:25:32",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":44396}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":44396}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461130.280096,
        "cmd_finished_at_unix_s": 1767461130.291405,
        "cmd_duration_s": 0.011308908462524414,
        "cmd_pid": 44396,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44396",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:28",
            "--end",
            "2026-01-03 09:25:32",
            "--row-id",
            "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_link_private_tmp_only.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "44396",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1471,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:30.335364-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44396) deny(1) file-read-data /private/var/tmp/vfs_link_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:32",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:30.335364-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44396) deny(1) file-read-data /private/var/tmp/vfs_link_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44396,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44396)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44396\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 09:25:28",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461130481,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:28",
          "observer_window_end": "2026-01-03 09:25:32",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":44399}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":44399}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461130.484067,
        "cmd_finished_at_unix_s": 1767461130.495389,
        "cmd_duration_s": 0.011322021484375,
        "cmd_pid": 44399,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44399",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:28",
            "--end",
            "2026-01-03 09:25:32",
            "--row-id",
            "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_link_private_tmp_only.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "44399",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1474,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:30.539355-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44399) deny(1) file-write-data /private/var/tmp/vfs_link_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:32",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:30.539355-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44399) deny(1) file-write-data /private/var/tmp/vfs_link_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 44399,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44399)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44399\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 09:25:28",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461130690,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:28",
          "observer_window_end": "2026-01-03 09:25:32",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_link_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":44402}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":44402}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461130.693526,
        "cmd_finished_at_unix_s": 1767461130.705298,
        "cmd_duration_s": 0.011771917343139648,
        "cmd_pid": 44402,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44402",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:28",
            "--end",
            "2026-01-03 09:25:32",
            "--row-id",
            "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_link_both.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "44402",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1868,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:30.748563-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44402) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
                "2026-01-03 09:25:30.820378-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44402) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:32",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:30.748563-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(44402) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp\n2026-01-03 09:25:30.820378-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(44402) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44402,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44402)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44402\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 09:25:28",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461130936,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:28",
          "observer_window_end": "2026-01-03 09:25:32",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":44405}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":44405}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461130.9391448,
        "cmd_finished_at_unix_s": 1767461130.950569,
        "cmd_duration_s": 0.011424064636230469,
        "cmd_pid": 44405,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44405",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:28",
            "--end",
            "2026-01-03 09:25:32",
            "--row-id",
            "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_link_both.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "44405",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1869,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:30.993903-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44405) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
                "2026-01-03 09:25:31.023437-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44405) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:32",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:30.993903-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(44405) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp\n2026-01-03 09:25:31.023437-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(44405) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 44405,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44405)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44405\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 09:25:28",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461131140,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:28",
          "observer_window_end": "2026-01-03 09:25:32",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":44408}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":44408}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461131.14317,
        "cmd_finished_at_unix_s": 1767461131.154515,
        "cmd_duration_s": 0.01134490966796875,
        "cmd_pid": 44408,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44408",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:29",
            "--end",
            "2026-01-03 09:25:33",
            "--row-id",
            "vfs_link_both:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_link_both.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "44408",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1146,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:33",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44408,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44408)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44408\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 09:25:29",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461131348,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:29",
          "observer_window_end": "2026-01-03 09:25:33",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":44417}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":44417}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461131.350636,
        "cmd_finished_at_unix_s": 1767461131.3620212,
        "cmd_duration_s": 0.011385202407836914,
        "cmd_pid": 44417,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44417",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:29",
            "--end",
            "2026-01-03 09:25:33",
            "--row-id",
            "vfs_link_both:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_link_both.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "44417",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1147,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:33",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44417,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44417)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44417\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 09:25:29",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461131560,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:29",
          "observer_window_end": "2026-01-03 09:25:33",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  },
  "vfs_link_both_plus_metadata_to_var_tmp": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_both_plus_metadata_to_var_tmp.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/private/tmp/vfs_linkdir/to_var_tmp",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp",
        "operation": "file-read-metadata",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "check_type": 1073741825,
              "canonicalization": "raw",
              "error": null,
              "tool": "seatbelt-callout",
              "varargs_count": 1,
              "filter_type_name": "unknown",
              "operation": "file-read-metadata",
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
              "no_report": true,
              "canonical_flag_used": false,
              "token_mach_kr": 0,
              "token_status": "ok",
              "api": "sandbox_check_by_audit_token",
              "stage": "pre_syscall",
              "marker_schema_version": 2,
              "errno": 0,
              "no_report_reason": null,
              "rc": 1,
              "decision": "deny",
              "canonical_flag_reason": "not_requested",
              "filter_type": 1
            },
            {
              "check_type": 1610612737,
              "canonicalization": "canonical",
              "error": null,
              "tool": "seatbelt-callout",
              "varargs_count": 1,
              "filter_type_name": "unknown",
              "operation": "file-read-metadata",
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
              "no_report": true,
              "canonical_flag_used": true,
              "token_mach_kr": 0,
              "token_status": "ok",
              "api": "sandbox_check_by_audit_token",
              "stage": "pre_syscall",
              "marker_schema_version": 2,
              "errno": 0,
              "no_report_reason": null,
              "rc": 1,
              "decision": "deny",
              "canonical_flag_reason": null,
              "filter_type": 1
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/private/tmp/vfs_linkdir/to_var_tmp",
          "--syscall",
          "lstat"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"errbuf\":null,\"marker_schema_version\":1,\"rc\":0,\"pid\":44420,\"err_class\":\"ok\",\"stage\":\"apply\",\"api\":\"sandbox_init\",\"mode\":\"sbpl\",\"errno\":0,\"tool\":\"sbpl-apply\",\"err_class_source\":\"none\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/b4e02cad-1b76-4ab1-827e-8afaeb967aa0\\/runtime_profiles\\/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\"}\n{\"pid\":44420,\"api\":\"sandbox_init\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/b4e02cad-1b76-4ab1-827e-8afaeb967aa0\\/runtime_profiles\\/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"rc\":0,\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"mode\":\"sbpl\",\"stage\":\"applied\"}\n{\"check_type\":1073741825,\"canonicalization\":\"raw\",\"error\":null,\"tool\":\"seatbelt-callout\",\"varargs_count\":1,\"filter_type_name\":\"unknown\",\"operation\":\"file-read-metadata\",\"argument\":\"\\/private\\/tmp\\/vfs_linkdir\\/to_var_tmp\",\"no_report\":true,\"canonical_flag_used\":false,\"token_mach_kr\":0,\"token_status\":\"ok\",\"api\":\"sandbox_check_by_audit_token\",\"stage\":\"pre_syscall\",\"marker_schema_version\":2,\"errno\":0,\"no_report_reason\":null,\"rc\":1,\"decision\":\"deny\",\"canonical_flag_reason\":\"not_requested\",\"filter_type\":1}\n{\"check_type\":1610612737,\"canonicalization\":\"canonical\",\"error\":null,\"tool\":\"seatbelt-callout\",\"varargs_count\":1,\"filter_type_name\":\"unknown\",\"operation\":\"file-read-metadata\",\"argument\":\"\\/private\\/tmp\\/vfs_linkdir\\/to_var_tmp\",\"no_report\":true,\"canonical_flag_used\":true,\"token_mach_kr\":0,\"token_status\":\"ok\",\"api\":\"sandbox_check_by_audit_token\",\"stage\":\"pre_syscall\",\"marker_schema_version\":2,\"errno\":0,\"no_report_reason\":null,\"rc\":1,\"decision\":\"deny\",\"canonical_flag_reason\":null,\"filter_type\":1}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 0,
          "errno_name": "OK",
          "message": "stat-ok",
          "op": "file-read-metadata",
          "path": "/private/tmp/vfs_linkdir/to_var_tmp",
          "status": "ok",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767461131.563662,
        "cmd_finished_at_unix_s": 1767461131.578857,
        "cmd_duration_s": 0.015194892883300781,
        "cmd_pid": 44420,
        "cmd_process_name": "metadata_runner",
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44420",
            "--process-name",
            "metadata_runner",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:29",
            "--end",
            "2026-01-03 09:25:33",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_link_both_plus_metadata_to_var_tmp.lstat__private_tmp_vfs_linkdir_to_var_tmp.observer.json",
          "log_write_error": null,
          "pid": "44420",
          "process_name": "metadata_runner",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp",
          "correlation_id": null,
          "stdout_bytes": 8534,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 09:25:31.620136-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) sysctl-read kern.maxfilesperproc",
                "2026-01-03 09:25:31.621001-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/api/runtime/native/metadata_runner",
                "2026-01-03 09:25:31.621016-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/api/runtime/native/metadata_runner",
                "2026-01-03 09:25:31.621481-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:31.621529-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:31.621550-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:31.621552-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-metadata /Users/achyland",
                "2026-01-03 09:25:31.621680-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:31.621718-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:31.621897-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:31.621899-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:31.621933-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:31.621967-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:31.621969-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:31.622001-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:31.622034-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:31.622036-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:31.622067-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:31.622097-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:31.622099-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 09:25:31.622129-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:31.622316-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc",
                "2026-01-03 09:25:31.622318-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist"
              ],
              "duration_ms": null,
              "end": "2026-01-03 09:25:33",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 09:25:31.620136-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) sysctl-read kern.maxfilesperproc\n2026-01-03 09:25:31.621001-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/api/runtime/native/metadata_runner\n2026-01-03 09:25:31.621016-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/api/runtime/native/metadata_runner\n2026-01-03 09:25:31.621481-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:31.621529-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc\n2026-01-03 09:25:31.621550-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc\n2026-01-03 09:25:31.621552-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-metadata /Users/achyland\n2026-01-03 09:25:31.621680-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:31.621718-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc\n2026-01-03 09:25:31.621897-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc\n2026-01-03 09:25:31.621899-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:31.621933-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc\n2026-01-03 09:25:31.621967-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc\n2026-01-03 09:25:31.621969-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:31.622001-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc\n2026-01-03 09:25:31.622034-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc\n2026-01-03 09:25:31.622036-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:31.622067-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc\n2026-01-03 09:25:31.622097-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc\n2026-01-03 09:25:31.622099-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 09:25:31.622129-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc\n2026-01-03 09:25:31.622316-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(44420) deny(1) file-read-metadata /etc\n2026-01-03 09:25:31.622318-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(44420) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 24,
              "observer_schema_version": 1,
              "pid": 44420,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: metadata_runner(44420)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44420\")))",
              "process_name": "metadata_runner",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp",
              "start": "2026-01-03 09:25:29",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461131773,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:29",
          "observer_window_end": "2026-01-03 09:25:33",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":44423}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":44423}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461131.775858,
        "cmd_finished_at_unix_s": 1767461131.7880661,
        "cmd_duration_s": 0.012208223342895508,
        "cmd_pid": 44423,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44423",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:29",
            "--end",
            "2026-01-03 09:25:33",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_link_both_plus_metadata_to_var_tmp.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "44423",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1190,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:33",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44423,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44423)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44423\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 09:25:29",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461131989,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:29",
          "observer_window_end": "2026-01-03 09:25:33",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":44426}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":44426}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461131.992116,
        "cmd_finished_at_unix_s": 1767461132.003787,
        "cmd_duration_s": 0.011671066284179688,
        "cmd_pid": 44426,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44426",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:29",
            "--end",
            "2026-01-03 09:25:34",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_link_both_plus_metadata_to_var_tmp.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "44426",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1191,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:34",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44426,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44426)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44426\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 09:25:29",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461132207,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:29",
          "observer_window_end": "2026-01-03 09:25:34",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":44429}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":44429}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461132.209923,
        "cmd_finished_at_unix_s": 1767461132.221616,
        "cmd_duration_s": 0.011693000793457031,
        "cmd_pid": 44429,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44429",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:30",
            "--end",
            "2026-01-03 09:25:34",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_link_both_plus_metadata_to_var_tmp.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "44429",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1171,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:34",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44429,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(44429)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44429\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 09:25:30",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461132399,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:30",
          "observer_window_end": "2026-01-03 09:25:34",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":44432}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b4e02cad-1b76-4ab1-827e-8afaeb967aa0/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":44432}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767461132.40129,
        "cmd_finished_at_unix_s": 1767461132.412645,
        "cmd_duration_s": 0.011355161666870117,
        "cmd_pid": 44432,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "44432",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 09:25:30",
            "--end",
            "2026-01-03 09:25:34",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b4e02cad-1b76-4ab1-827e-8afaeb967aa0/observer/vfs_link_both_plus_metadata_to_var_tmp.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "44432",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1172,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 09:25:34",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 44432,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(44432)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"44432\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 09:25:30",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767461132606,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 09:25:30",
          "observer_window_end": "2026-01-03 09:25:34",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b4e02cad-1b76-4ab1-827e-8afaeb967aa0"
  }
}