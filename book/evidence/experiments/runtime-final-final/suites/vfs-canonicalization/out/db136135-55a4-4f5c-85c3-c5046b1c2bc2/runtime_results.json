{
  "vfs_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_tmp_only:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28790}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28790}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458809.110444,
        "cmd_finished_at_unix_s": 1767458809.409993,
        "cmd_duration_s": 0.299548864364624,
        "cmd_pid": 28790,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28790",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:47",
            "--end",
            "2026-01-03 08:46:51",
            "--row-id",
            "vfs_tmp_only:read_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_tmp_only.read__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28790",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1122,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:51",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28790,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28790)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28790\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/tmp/foo",
              "start": "2026-01-03 08:46:47",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458810906,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:47",
          "observer_window_end": "2026-01-03 08:46:51",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28795}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28795}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458810.90842,
        "cmd_finished_at_unix_s": 1767458810.915595,
        "cmd_duration_s": 0.007174968719482422,
        "cmd_pid": 28795,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28795",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:48",
            "--end",
            "2026-01-03 08:46:52",
            "--row-id",
            "vfs_tmp_only:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_tmp_only.read__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28795",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1130,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:52",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28795,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28795)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28795\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/tmp/foo",
              "start": "2026-01-03 08:46:48",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458811060,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:48",
          "observer_window_end": "2026-01-03 08:46:52",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_tmp_only:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28798}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28798}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458811.061644,
        "cmd_finished_at_unix_s": 1767458811.395078,
        "cmd_duration_s": 0.3334338665008545,
        "cmd_pid": 28798,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28798",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:49",
            "--end",
            "2026-01-03 08:46:53",
            "--row-id",
            "vfs_tmp_only:write_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_tmp_only.write__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28798",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1123,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:53",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28798,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28798)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28798\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/tmp/foo",
              "start": "2026-01-03 08:46:49",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458811564,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:49",
          "observer_window_end": "2026-01-03 08:46:53",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28801}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28801}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458811.566327,
        "cmd_finished_at_unix_s": 1767458811.5736299,
        "cmd_duration_s": 0.007302761077880859,
        "cmd_pid": 28801,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28801",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:49",
            "--end",
            "2026-01-03 08:46:53",
            "--row-id",
            "vfs_tmp_only:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_tmp_only.write__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28801",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1131,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:53",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28801,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28801)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28801\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/tmp/foo",
              "start": "2026-01-03 08:46:49",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458811692,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:49",
          "observer_window_end": "2026-01-03 08:46:53",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_tmp_only:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28804}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28804}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458811.69401,
        "cmd_finished_at_unix_s": 1767458811.701157,
        "cmd_duration_s": 0.007147073745727539,
        "cmd_pid": 28804,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28804",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:49",
            "--end",
            "2026-01-03 08:46:53",
            "--row-id",
            "vfs_tmp_only:read_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_tmp_only.read__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "28804",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1122,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:53",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28804,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28804)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28804\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/tmp/bar",
              "start": "2026-01-03 08:46:49",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458811815,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:49",
          "observer_window_end": "2026-01-03 08:46:53",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28813}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28813}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458811.817248,
        "cmd_finished_at_unix_s": 1767458811.824384,
        "cmd_duration_s": 0.007135868072509766,
        "cmd_pid": 28813,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28813",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:49",
            "--end",
            "2026-01-03 08:46:53",
            "--row-id",
            "vfs_tmp_only:read_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_tmp_only.read__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "28813",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1130,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:53",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28813,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28813)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28813\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/tmp/bar",
              "start": "2026-01-03 08:46:49",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458811942,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:49",
          "observer_window_end": "2026-01-03 08:46:53",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_tmp_only:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28816}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28816}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458811.943465,
        "cmd_finished_at_unix_s": 1767458811.9506571,
        "cmd_duration_s": 0.007192134857177734,
        "cmd_pid": 28816,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28816",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:49",
            "--end",
            "2026-01-03 08:46:53",
            "--row-id",
            "vfs_tmp_only:write_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_tmp_only.write__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "28816",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1123,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:53",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28816,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28816)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28816\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/tmp/bar",
              "start": "2026-01-03 08:46:49",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458812074,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:49",
          "observer_window_end": "2026-01-03 08:46:53",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28819}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28819}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458812.075947,
        "cmd_finished_at_unix_s": 1767458812.083083,
        "cmd_duration_s": 0.007135868072509766,
        "cmd_pid": 28819,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28819",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:50",
            "--end",
            "2026-01-03 08:46:54",
            "--row-id",
            "vfs_tmp_only:write_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_tmp_only.write__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "28819",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1131,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:54",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28819,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28819)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28819\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/tmp/bar",
              "start": "2026-01-03 08:46:50",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458812196,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:50",
          "observer_window_end": "2026-01-03 08:46:54",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28822}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28822}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458812.197999,
        "cmd_finished_at_unix_s": 1767458812.205203,
        "cmd_duration_s": 0.0072040557861328125,
        "cmd_pid": 28822,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28822",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:50",
            "--end",
            "2026-01-03 08:46:54",
            "--row-id",
            "vfs_tmp_only:read_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_tmp_only.read__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "28822",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1131,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:54",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28822,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28822)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28822\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/tmp/nested/child",
              "start": "2026-01-03 08:46:50",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458812316,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:50",
          "observer_window_end": "2026-01-03 08:46:54",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28825}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28825}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458812.3183029,
        "cmd_finished_at_unix_s": 1767458812.32537,
        "cmd_duration_s": 0.007067203521728516,
        "cmd_pid": 28825,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28825",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:50",
            "--end",
            "2026-01-03 08:46:54",
            "--row-id",
            "vfs_tmp_only:read_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_tmp_only.read__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "28825",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1440,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:52.426569-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28825) deny(1) file-read-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:46:54",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:52.426569-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28825) deny(1) file-read-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28825,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28825)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28825\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/tmp/nested/child",
              "start": "2026-01-03 08:46:50",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458812438,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:50",
          "observer_window_end": "2026-01-03 08:46:54",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28828}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28828}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458812.439966,
        "cmd_finished_at_unix_s": 1767458812.4471622,
        "cmd_duration_s": 0.007196187973022461,
        "cmd_pid": 28828,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28828",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:50",
            "--end",
            "2026-01-03 08:46:54",
            "--row-id",
            "vfs_tmp_only:write_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_tmp_only.write__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "28828",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1435,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:52.548333-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28828) deny(1) file-write-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:46:54",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:52.548333-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28828) deny(1) file-write-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28828,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28828)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28828\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/tmp/nested/child",
              "start": "2026-01-03 08:46:50",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458812559,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:50",
          "observer_window_end": "2026-01-03 08:46:54",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28831}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28831}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458812.561068,
        "cmd_finished_at_unix_s": 1767458812.568176,
        "cmd_duration_s": 0.007107973098754883,
        "cmd_pid": 28831,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28831",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:50",
            "--end",
            "2026-01-03 08:46:54",
            "--row-id",
            "vfs_tmp_only:write_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_tmp_only.write__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "28831",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1443,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:52.669367-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28831) deny(1) file-write-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:46:54",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:52.669367-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28831) deny(1) file-write-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28831,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28831)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28831\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/tmp/nested/child",
              "start": "2026-01-03 08:46:50",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458812682,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:50",
          "observer_window_end": "2026-01-03 08:46:54",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28834}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28834}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458812.683606,
        "cmd_finished_at_unix_s": 1767458812.6907551,
        "cmd_duration_s": 0.007149219512939453,
        "cmd_pid": 28834,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28834",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:50",
            "--end",
            "2026-01-03 08:46:54",
            "--row-id",
            "vfs_tmp_only:read_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_tmp_only.read__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "28834",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1395,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:52.791953-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28834) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:46:54",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:52.791953-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28834) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28834,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28834)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28834\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/var/tmp/canon",
              "start": "2026-01-03 08:46:50",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458812806,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:50",
          "observer_window_end": "2026-01-03 08:46:54",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28837}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28837}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458812.8079302,
        "cmd_finished_at_unix_s": 1767458812.815109,
        "cmd_duration_s": 0.007178783416748047,
        "cmd_pid": 28837,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28837",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:50",
            "--end",
            "2026-01-03 08:46:54",
            "--row-id",
            "vfs_tmp_only:read_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_tmp_only.read__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "28837",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1431,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:52.916289-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28837) deny(1) file-read-data /private/var/tmp/canon"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:46:54",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:52.916289-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28837) deny(1) file-read-data /private/var/tmp/canon",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28837,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28837)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28837\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/var/tmp/canon",
              "start": "2026-01-03 08:46:50",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458812933,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:50",
          "observer_window_end": "2026-01-03 08:46:54",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28840}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28840}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458812.935401,
        "cmd_finished_at_unix_s": 1767458812.942338,
        "cmd_duration_s": 0.0069370269775390625,
        "cmd_pid": 28840,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28840",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:50",
            "--end",
            "2026-01-03 08:46:54",
            "--row-id",
            "vfs_tmp_only:write_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_tmp_only.write__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "28840",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1396,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:53.043541-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28840) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:46:54",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:53.043541-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28840) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28840,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28840)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28840\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/var/tmp/canon",
              "start": "2026-01-03 08:46:50",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458813054,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:50",
          "observer_window_end": "2026-01-03 08:46:54",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28843}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":28843}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458813.055947,
        "cmd_finished_at_unix_s": 1767458813.063,
        "cmd_duration_s": 0.007052898406982422,
        "cmd_pid": 28843,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28843",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:51",
            "--end",
            "2026-01-03 08:46:55",
            "--row-id",
            "vfs_tmp_only:write_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_tmp_only.write__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "28843",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1434,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:53.164216-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28843) deny(1) file-write-data /private/var/tmp/canon"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:46:55",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:53.164216-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28843) deny(1) file-write-data /private/var/tmp/canon",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28843,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28843)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28843\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/var/tmp/canon",
              "start": "2026-01-03 08:46:51",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458813180,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:51",
          "observer_window_end": "2026-01-03 08:46:55",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_private_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_private_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28846}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28846}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458813.1829162,
        "cmd_finished_at_unix_s": 1767458813.1899772,
        "cmd_duration_s": 0.007061004638671875,
        "cmd_pid": 28846,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28846",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:51",
            "--end",
            "2026-01-03 08:46:55",
            "--row-id",
            "vfs_private_tmp_only:read_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.read__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28846",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1130,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:55",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28846,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28846)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28846\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/tmp/foo",
              "start": "2026-01-03 08:46:51",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458813302,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:51",
          "observer_window_end": "2026-01-03 08:46:55",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28849}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28849}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458813.3036082,
        "cmd_finished_at_unix_s": 1767458813.310791,
        "cmd_duration_s": 0.0071828365325927734,
        "cmd_pid": 28849,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28849",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:51",
            "--end",
            "2026-01-03 08:46:55",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.read__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28849",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1138,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:55",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28849,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28849)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28849\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/foo",
              "start": "2026-01-03 08:46:51",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458813427,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:51",
          "observer_window_end": "2026-01-03 08:46:55",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28852}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28852}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458813.429201,
        "cmd_finished_at_unix_s": 1767458813.436457,
        "cmd_duration_s": 0.007256031036376953,
        "cmd_pid": 28852,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28852",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:51",
            "--end",
            "2026-01-03 08:46:55",
            "--row-id",
            "vfs_private_tmp_only:write_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.write__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28852",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1131,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:55",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28852,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28852)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28852\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/tmp/foo",
              "start": "2026-01-03 08:46:51",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458813549,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:51",
          "observer_window_end": "2026-01-03 08:46:55",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28855}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28855}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458813.550804,
        "cmd_finished_at_unix_s": 1767458813.557993,
        "cmd_duration_s": 0.007189035415649414,
        "cmd_pid": 28855,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28855",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:51",
            "--end",
            "2026-01-03 08:46:55",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.write__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28855",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:55",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28855,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28855)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28855\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/foo",
              "start": "2026-01-03 08:46:51",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458813675,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:51",
          "observer_window_end": "2026-01-03 08:46:55",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28858}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28858}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458813.676757,
        "cmd_finished_at_unix_s": 1767458813.683897,
        "cmd_duration_s": 0.007139921188354492,
        "cmd_pid": 28858,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28858",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:51",
            "--end",
            "2026-01-03 08:46:55",
            "--row-id",
            "vfs_private_tmp_only:read_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.read__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "28858",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1130,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:55",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28858,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28858)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28858\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/tmp/bar",
              "start": "2026-01-03 08:46:51",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458813799,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:51",
          "observer_window_end": "2026-01-03 08:46:55",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28861}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28861}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458813.801168,
        "cmd_finished_at_unix_s": 1767458813.8082838,
        "cmd_duration_s": 0.007115840911865234,
        "cmd_pid": 28861,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28861",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:51",
            "--end",
            "2026-01-03 08:46:55",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.read__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "28861",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1138,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:55",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28861,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28861)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28861\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/bar",
              "start": "2026-01-03 08:46:51",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458813922,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:51",
          "observer_window_end": "2026-01-03 08:46:55",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28864}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28864}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458813.924267,
        "cmd_finished_at_unix_s": 1767458813.931495,
        "cmd_duration_s": 0.007227897644042969,
        "cmd_pid": 28864,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28864",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:51",
            "--end",
            "2026-01-03 08:46:55",
            "--row-id",
            "vfs_private_tmp_only:write_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.write__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "28864",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1131,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:55",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28864,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28864)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28864\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/tmp/bar",
              "start": "2026-01-03 08:46:51",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458814051,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:51",
          "observer_window_end": "2026-01-03 08:46:55",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28867}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28867}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458814.0530298,
        "cmd_finished_at_unix_s": 1767458814.060192,
        "cmd_duration_s": 0.007162332534790039,
        "cmd_pid": 28867,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28867",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:52",
            "--end",
            "2026-01-03 08:46:56",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.write__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "28867",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:56",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28867,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28867)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28867\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/bar",
              "start": "2026-01-03 08:46:52",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458814167,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:52",
          "observer_window_end": "2026-01-03 08:46:56",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28870}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28870}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458814.169447,
        "cmd_finished_at_unix_s": 1767458814.1765492,
        "cmd_duration_s": 0.007102251052856445,
        "cmd_pid": 28870,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28870",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:52",
            "--end",
            "2026-01-03 08:46:56",
            "--row-id",
            "vfs_private_tmp_only:read_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.read__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "28870",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:56",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28870,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28870)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28870\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/tmp/nested/child",
              "start": "2026-01-03 08:46:52",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458814287,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:52",
          "observer_window_end": "2026-01-03 08:46:56",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28873}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28873}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458814.288738,
        "cmd_finished_at_unix_s": 1767458814.29591,
        "cmd_duration_s": 0.0071718692779541016,
        "cmd_pid": 28873,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28873",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:52",
            "--end",
            "2026-01-03 08:46:56",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.read__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "28873",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1147,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:56",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28873,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28873)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28873\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/child",
              "start": "2026-01-03 08:46:52",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458814402,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:52",
          "observer_window_end": "2026-01-03 08:46:56",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28876}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28876}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458814.4042711,
        "cmd_finished_at_unix_s": 1767458814.411552,
        "cmd_duration_s": 0.007280826568603516,
        "cmd_pid": 28876,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28876",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:52",
            "--end",
            "2026-01-03 08:46:56",
            "--row-id",
            "vfs_private_tmp_only:write_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.write__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "28876",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1140,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:56",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28876,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28876)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28876\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/tmp/nested/child",
              "start": "2026-01-03 08:46:52",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458814511,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:52",
          "observer_window_end": "2026-01-03 08:46:56",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28879}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28879}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458814.513351,
        "cmd_finished_at_unix_s": 1767458814.5206022,
        "cmd_duration_s": 0.007251262664794922,
        "cmd_pid": 28879,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28879",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:52",
            "--end",
            "2026-01-03 08:46:56",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.write__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "28879",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1148,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:56",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28879,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28879)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28879\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/child",
              "start": "2026-01-03 08:46:52",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458814628,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:52",
          "observer_window_end": "2026-01-03 08:46:56",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28882}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28882}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458814.6297321,
        "cmd_finished_at_unix_s": 1767458814.636962,
        "cmd_duration_s": 0.007229804992675781,
        "cmd_pid": 28882,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28882",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:52",
            "--end",
            "2026-01-03 08:46:56",
            "--row-id",
            "vfs_private_tmp_only:read_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.read__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "28882",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1403,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:54.738201-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28882) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:46:56",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:54.738201-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28882) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28882,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28882)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28882\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/var/tmp/canon",
              "start": "2026-01-03 08:46:52",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458814745,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:52",
          "observer_window_end": "2026-01-03 08:46:56",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks var tmp canon\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28885}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28885}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:111259441\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458814.747249,
        "cmd_finished_at_unix_s": 1767458814.7544372,
        "cmd_duration_s": 0.007188320159912109,
        "cmd_pid": 28885,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28885",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:52",
            "--end",
            "2026-01-03 08:46:56",
            "--row-id",
            "vfs_private_tmp_only:read_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.read__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "28885",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1144,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:56",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28885,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28885)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28885\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/var/tmp/canon",
              "start": "2026-01-03 08:46:52",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458814866,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:52",
          "observer_window_end": "2026-01-03 08:46:56",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28888}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28888}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458814.868098,
        "cmd_finished_at_unix_s": 1767458814.87528,
        "cmd_duration_s": 0.007181882858276367,
        "cmd_pid": 28888,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28888",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:52",
            "--end",
            "2026-01-03 08:46:56",
            "--row-id",
            "vfs_private_tmp_only:write_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.write__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "28888",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1404,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:54.976551-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28888) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:46:56",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:54.976551-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28888) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28888,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28888)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28888\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/var/tmp/canon",
              "start": "2026-01-03 08:46:52",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458814984,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:52",
          "observer_window_end": "2026-01-03 08:46:56",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28891}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28891}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:111259441\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458814.985785,
        "cmd_finished_at_unix_s": 1767458814.992979,
        "cmd_duration_s": 0.007194042205810547,
        "cmd_pid": 28891,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28891",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:52",
            "--end",
            "2026-01-03 08:46:56",
            "--row-id",
            "vfs_private_tmp_only:write_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.write__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "28891",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1145,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:56",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28891,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28891)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28891\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/var/tmp/canon",
              "start": "2026-01-03 08:46:52",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458815101,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:52",
          "observer_window_end": "2026-01-03 08:46:56",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/../foo",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/nested/../foo",
        "operation": "file-read*",
        "path": "/private/tmp/nested/../foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/../foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/../foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28894}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28894}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458815.103214,
        "cmd_finished_at_unix_s": 1767458815.1104581,
        "cmd_duration_s": 0.007244110107421875,
        "cmd_pid": 28894,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/../foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28894",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:53",
            "--end",
            "2026-01-03 08:46:57",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.read__private_tmp_nested_.._foo.observer.json",
          "log_write_error": null,
          "pid": "28894",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/../foo",
          "correlation_id": null,
          "stdout_bytes": 1148,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:57",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28894,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28894)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28894\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/../foo",
              "start": "2026-01-03 08:46:53",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458815213,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:53",
          "observer_window_end": "2026-01-03 08:46:57",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/../foo",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/nested/../foo",
        "operation": "file-write*",
        "path": "/private/tmp/nested/../foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/../foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/../foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28897}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":28897}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458815.215208,
        "cmd_finished_at_unix_s": 1767458815.2223182,
        "cmd_duration_s": 0.007110118865966797,
        "cmd_pid": 28897,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/../foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28897",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:53",
            "--end",
            "2026-01-03 08:46:57",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only.write__private_tmp_nested_.._foo.observer.json",
          "log_write_error": null,
          "pid": "28897",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/../foo",
          "correlation_id": null,
          "stdout_bytes": 1149,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:57",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28897,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28897)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28897\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/../foo",
              "start": "2026-01-03 08:46:53",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458815328,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:53",
          "observer_window_end": "2026-01-03 08:46:57",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_both_paths": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_both_paths.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_both_paths:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28900}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28900}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458815.3311,
        "cmd_finished_at_unix_s": 1767458815.3382468,
        "cmd_duration_s": 0.0071468353271484375,
        "cmd_pid": 28900,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28900",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:53",
            "--end",
            "2026-01-03 08:46:57",
            "--row-id",
            "vfs_both_paths:read_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_both_paths.read__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28900",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1124,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:57",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28900,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28900)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28900\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/tmp/foo",
              "start": "2026-01-03 08:46:53",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458815443,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:53",
          "observer_window_end": "2026-01-03 08:46:57",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_both_paths:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28903}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28903}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458815.445111,
        "cmd_finished_at_unix_s": 1767458815.4523,
        "cmd_duration_s": 0.007189035415649414,
        "cmd_pid": 28903,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28903",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:53",
            "--end",
            "2026-01-03 08:46:57",
            "--row-id",
            "vfs_both_paths:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_both_paths.read__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28903",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1132,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:57",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28903,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28903)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28903\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/tmp/foo",
              "start": "2026-01-03 08:46:53",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458815561,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:53",
          "observer_window_end": "2026-01-03 08:46:57",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_both_paths:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28906}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28906}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458815.5626009,
        "cmd_finished_at_unix_s": 1767458815.5698318,
        "cmd_duration_s": 0.007230997085571289,
        "cmd_pid": 28906,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28906",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:53",
            "--end",
            "2026-01-03 08:46:57",
            "--row-id",
            "vfs_both_paths:write_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_both_paths.write__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28906",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1125,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:57",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28906,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28906)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28906\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/tmp/foo",
              "start": "2026-01-03 08:46:53",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458815677,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:53",
          "observer_window_end": "2026-01-03 08:46:57",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_both_paths:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28909}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28909}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458815.6786811,
        "cmd_finished_at_unix_s": 1767458815.685844,
        "cmd_duration_s": 0.007162809371948242,
        "cmd_pid": 28909,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28909",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:53",
            "--end",
            "2026-01-03 08:46:57",
            "--row-id",
            "vfs_both_paths:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_both_paths.write__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28909",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1133,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:57",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28909,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28909)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28909\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/tmp/foo",
              "start": "2026-01-03 08:46:53",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458815794,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:53",
          "observer_window_end": "2026-01-03 08:46:57",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_both_paths:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28912}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28912}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458815.796169,
        "cmd_finished_at_unix_s": 1767458815.803355,
        "cmd_duration_s": 0.007185935974121094,
        "cmd_pid": 28912,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28912",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:53",
            "--end",
            "2026-01-03 08:46:57",
            "--row-id",
            "vfs_both_paths:read_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_both_paths.read__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "28912",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1124,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:57",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28912,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28912)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28912\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/tmp/bar",
              "start": "2026-01-03 08:46:53",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458815913,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:53",
          "observer_window_end": "2026-01-03 08:46:57",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_both_paths:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28915}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28915}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458815.915004,
        "cmd_finished_at_unix_s": 1767458815.9221199,
        "cmd_duration_s": 0.007115840911865234,
        "cmd_pid": 28915,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28915",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:53",
            "--end",
            "2026-01-03 08:46:57",
            "--row-id",
            "vfs_both_paths:read_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_both_paths.read__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "28915",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1132,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:57",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28915,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28915)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28915\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/tmp/bar",
              "start": "2026-01-03 08:46:53",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458816030,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:53",
          "observer_window_end": "2026-01-03 08:46:57",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_both_paths:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28918}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28918}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458816.031731,
        "cmd_finished_at_unix_s": 1767458816.038912,
        "cmd_duration_s": 0.0071811676025390625,
        "cmd_pid": 28918,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28918",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:54",
            "--end",
            "2026-01-03 08:46:58",
            "--row-id",
            "vfs_both_paths:write_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_both_paths.write__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "28918",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1125,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28918,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28918)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28918\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/tmp/bar",
              "start": "2026-01-03 08:46:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458816137,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:54",
          "observer_window_end": "2026-01-03 08:46:58",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_both_paths:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28921}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28921}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458816.138517,
        "cmd_finished_at_unix_s": 1767458816.145823,
        "cmd_duration_s": 0.007306098937988281,
        "cmd_pid": 28921,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28921",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:54",
            "--end",
            "2026-01-03 08:46:58",
            "--row-id",
            "vfs_both_paths:write_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_both_paths.write__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "28921",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1133,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28921,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28921)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28921\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/tmp/bar",
              "start": "2026-01-03 08:46:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458816244,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:54",
          "observer_window_end": "2026-01-03 08:46:58",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_both_paths:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28924}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28924}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458816.24607,
        "cmd_finished_at_unix_s": 1767458816.2533069,
        "cmd_duration_s": 0.007236957550048828,
        "cmd_pid": 28924,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28924",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:54",
            "--end",
            "2026-01-03 08:46:58",
            "--row-id",
            "vfs_both_paths:read_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_both_paths.read__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "28924",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1133,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28924,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28924)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28924\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/tmp/nested/child",
              "start": "2026-01-03 08:46:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458816349,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:54",
          "observer_window_end": "2026-01-03 08:46:58",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_both_paths:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28927}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28927}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458816.350632,
        "cmd_finished_at_unix_s": 1767458816.3579142,
        "cmd_duration_s": 0.007282257080078125,
        "cmd_pid": 28927,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28927",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:54",
            "--end",
            "2026-01-03 08:46:58",
            "--row-id",
            "vfs_both_paths:read_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_both_paths.read__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "28927",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1141,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28927,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28927)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28927\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/tmp/nested/child",
              "start": "2026-01-03 08:46:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458816450,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:54",
          "observer_window_end": "2026-01-03 08:46:58",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_both_paths:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28930}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28930}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458816.4521642,
        "cmd_finished_at_unix_s": 1767458816.459338,
        "cmd_duration_s": 0.007173776626586914,
        "cmd_pid": 28930,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28930",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:54",
            "--end",
            "2026-01-03 08:46:58",
            "--row-id",
            "vfs_both_paths:write_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_both_paths.write__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "28930",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1134,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28930,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28930)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28930\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/tmp/nested/child",
              "start": "2026-01-03 08:46:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458816556,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:54",
          "observer_window_end": "2026-01-03 08:46:58",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_both_paths:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28933}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28933}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458816.557664,
        "cmd_finished_at_unix_s": 1767458816.564826,
        "cmd_duration_s": 0.0071620941162109375,
        "cmd_pid": 28933,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28933",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:54",
            "--end",
            "2026-01-03 08:46:58",
            "--row-id",
            "vfs_both_paths:write_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_both_paths.write__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "28933",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1142,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28933,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28933)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28933\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/tmp/nested/child",
              "start": "2026-01-03 08:46:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458816658,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:54",
          "observer_window_end": "2026-01-03 08:46:58",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_both_paths:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28936}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28936}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458816.6594481,
        "cmd_finished_at_unix_s": 1767458816.666605,
        "cmd_duration_s": 0.007156848907470703,
        "cmd_pid": 28936,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28936",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:54",
            "--end",
            "2026-01-03 08:46:58",
            "--row-id",
            "vfs_both_paths:read_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_both_paths.read__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "28936",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1397,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:56.767895-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28936) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:46:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:56.767895-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28936) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28936,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28936)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28936\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/var/tmp/canon",
              "start": "2026-01-03 08:46:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458816759,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:54",
          "observer_window_end": "2026-01-03 08:46:58",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_both_paths:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks var tmp canon\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28939}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28939}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:111259441\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458816.76125,
        "cmd_finished_at_unix_s": 1767458816.768471,
        "cmd_duration_s": 0.0072209835052490234,
        "cmd_pid": 28939,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28939",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:54",
            "--end",
            "2026-01-03 08:46:58",
            "--row-id",
            "vfs_both_paths:read_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_both_paths.read__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "28939",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1138,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28939,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28939)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28939\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/var/tmp/canon",
              "start": "2026-01-03 08:46:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458816869,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:54",
          "observer_window_end": "2026-01-03 08:46:58",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_both_paths:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28942}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28942}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458816.8709,
        "cmd_finished_at_unix_s": 1767458816.8779929,
        "cmd_duration_s": 0.007092952728271484,
        "cmd_pid": 28942,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28942",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:54",
            "--end",
            "2026-01-03 08:46:58",
            "--row-id",
            "vfs_both_paths:write_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_both_paths.write__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "28942",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1398,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:56.979281-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28942) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:46:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:56.979281-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28942) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28942,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28942)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28942\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/var/tmp/canon",
              "start": "2026-01-03 08:46:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458816982,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:54",
          "observer_window_end": "2026-01-03 08:46:58",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_both_paths:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28945}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":28945}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:111259441\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458816.983995,
        "cmd_finished_at_unix_s": 1767458816.9912698,
        "cmd_duration_s": 0.0072748661041259766,
        "cmd_pid": 28945,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28945",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:54",
            "--end",
            "2026-01-03 08:46:58",
            "--row-id",
            "vfs_both_paths:write_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_both_paths.write__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "28945",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28945,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28945)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28945\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/var/tmp/canon",
              "start": "2026-01-03 08:46:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458817166,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:54",
          "observer_window_end": "2026-01-03 08:46:58",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_private_tmp_only_openat": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_private_tmp_only_openat.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_open_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_open_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":28948}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":28948}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458817.1687438,
        "cmd_finished_at_unix_s": 1767458817.175991,
        "cmd_duration_s": 0.007247209548950195,
        "cmd_pid": 28948,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28948",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:55",
            "--end",
            "2026-01-03 08:46:59",
            "--row-id",
            "vfs_private_tmp_only_openat:read_open_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only_openat.read_open__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28948",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_open_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1142,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:59",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28948,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28948)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28948\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat:read_open_/tmp/foo",
              "start": "2026-01-03 08:46:55",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458817279,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:55",
          "observer_window_end": "2026-01-03 08:46:59",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":28951}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":28951}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458817.280468,
        "cmd_finished_at_unix_s": 1767458817.287698,
        "cmd_duration_s": 0.007230043411254883,
        "cmd_pid": 28951,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28951",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:55",
            "--end",
            "2026-01-03 08:46:59",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only_openat.read_openat__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28951",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1144,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:59",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28951,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28951)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28951\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo",
              "start": "2026-01-03 08:46:55",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458817388,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:55",
          "observer_window_end": "2026-01-03 08:46:59",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_open_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_open_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":28954}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":28954}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458817.389695,
        "cmd_finished_at_unix_s": 1767458817.396857,
        "cmd_duration_s": 0.0071620941162109375,
        "cmd_pid": 28954,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28954",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:55",
            "--end",
            "2026-01-03 08:46:59",
            "--row-id",
            "vfs_private_tmp_only_openat:read_open_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only_openat.read_open__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28954",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_open_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:59",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28954,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28954)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28954\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat:read_open_/private/tmp/foo",
              "start": "2026-01-03 08:46:55",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458817499,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:55",
          "observer_window_end": "2026-01-03 08:46:59",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":28957}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":28957}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458817.501051,
        "cmd_finished_at_unix_s": 1767458817.508197,
        "cmd_duration_s": 0.007146120071411133,
        "cmd_pid": 28957,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28957",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:55",
            "--end",
            "2026-01-03 08:46:59",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only_openat.read_openat__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28957",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1152,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:59",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28957,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28957)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28957\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo",
              "start": "2026-01-03 08:46:55",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458817608,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:55",
          "observer_window_end": "2026-01-03 08:46:59",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_rootrel_tmp/foo",
        "operation": "file-read*",
        "path": "tmp/foo",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":28960}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":28960}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: No such file or directory\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458817.6100988,
        "cmd_finished_at_unix_s": 1767458817.617373,
        "cmd_duration_s": 0.007274150848388672,
        "cmd_pid": 28960,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28960",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:55",
            "--end",
            "2026-01-03 08:46:59",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_rootrel_tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only_openat.read_openat_rootrel_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28960",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_rootrel_tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1151,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:59",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28960,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28960)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28960\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_rootrel_tmp/foo",
              "start": "2026-01-03 08:46:55",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458817716,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:55",
          "observer_window_end": "2026-01-03 08:46:59",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_rootrel_private/tmp/foo",
        "operation": "file-read*",
        "path": "private/tmp/foo",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "private/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":28963}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":28963}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: No such file or directory\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458817.717698,
        "cmd_finished_at_unix_s": 1767458817.724889,
        "cmd_duration_s": 0.0071909427642822266,
        "cmd_pid": 28963,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28963",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:55",
            "--end",
            "2026-01-03 08:46:59",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_rootrel_private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_private_tmp_only_openat.read_openat_rootrel_private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "28963",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_rootrel_private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1159,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:46:59",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28963,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28963)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28963\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_rootrel_private/tmp/foo",
              "start": "2026-01-03 08:46:55",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458817824,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:55",
          "observer_window_end": "2026-01-03 08:46:59",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_var_tmp_alias_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_alias_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":28966}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":28966}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458817.826792,
        "cmd_finished_at_unix_s": 1767458817.833933,
        "cmd_duration_s": 0.00714111328125,
        "cmd_pid": 28966,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28966",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:55",
            "--end",
            "2026-01-03 08:46:59",
            "--row-id",
            "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_alias_only.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "28966",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1415,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:57.935272-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28966) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:46:59",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:57.935272-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28966) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28966,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28966)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28966\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:55",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458817932,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:55",
          "observer_window_end": "2026-01-03 08:46:59",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":28969}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":28969}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458817.933822,
        "cmd_finished_at_unix_s": 1767458817.940894,
        "cmd_duration_s": 0.007071971893310547,
        "cmd_pid": 28969,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28969",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:55",
            "--end",
            "2026-01-03 08:46:59",
            "--row-id",
            "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_alias_only.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "28969",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1416,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:58.042238-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28969) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:46:59",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:58.042238-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28969) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28969,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28969)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28969\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:55",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458818040,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:55",
          "observer_window_end": "2026-01-03 08:46:59",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":28972}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":28972}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458818.042149,
        "cmd_finished_at_unix_s": 1767458818.049313,
        "cmd_duration_s": 0.00716400146484375,
        "cmd_pid": 28972,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28972",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:56",
            "--end",
            "2026-01-03 08:47:00",
            "--row-id",
            "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_alias_only.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "28972",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1471,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:58.150638-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28972) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:00",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:58.150638-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28972) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28972,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28972)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28972\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:56",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458818151,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:56",
          "observer_window_end": "2026-01-03 08:47:00",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":28975}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":28975}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458818.1524742,
        "cmd_finished_at_unix_s": 1767458818.1596658,
        "cmd_duration_s": 0.007191658020019531,
        "cmd_pid": 28975,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28975",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:56",
            "--end",
            "2026-01-03 08:47:00",
            "--row-id",
            "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_alias_only.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "28975",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1474,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:58.260997-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28975) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:00",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:58.260997-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28975) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28975,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28975)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28975\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:56",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458818261,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:56",
          "observer_window_end": "2026-01-03 08:47:00",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":28978}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":28978}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458818.2629042,
        "cmd_finished_at_unix_s": 1767458818.2700841,
        "cmd_duration_s": 0.007179975509643555,
        "cmd_pid": 28978,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28978",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:56",
            "--end",
            "2026-01-03 08:47:00",
            "--row-id",
            "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_alias_only.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "28978",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1491,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:58.371407-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28978) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:00",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:58.371407-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28978) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28978,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28978)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28978\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:56",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458818368,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:56",
          "observer_window_end": "2026-01-03 08:47:00",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":28981}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":28981}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458818.369527,
        "cmd_finished_at_unix_s": 1767458818.3767948,
        "cmd_duration_s": 0.00726771354675293,
        "cmd_pid": 28981,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28981",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:56",
            "--end",
            "2026-01-03 08:47:00",
            "--row-id",
            "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_alias_only.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "28981",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1494,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:58.478124-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28981) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:00",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:58.478124-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28981) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28981,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28981)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28981\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:56",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458818477,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:56",
          "observer_window_end": "2026-01-03 08:47:00",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_var_tmp_private_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":28984}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":28984}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458818.479687,
        "cmd_finished_at_unix_s": 1767458818.486885,
        "cmd_duration_s": 0.0071980953216552734,
        "cmd_pid": 28984,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28984",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:56",
            "--end",
            "2026-01-03 08:47:00",
            "--row-id",
            "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_private_only.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "28984",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1417,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:58.588211-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28984) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:00",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:58.588211-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(28984) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28984,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28984)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28984\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:56",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458818593,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:56",
          "observer_window_end": "2026-01-03 08:47:00",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":28987}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":28987}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458818.594632,
        "cmd_finished_at_unix_s": 1767458818.601773,
        "cmd_duration_s": 0.00714111328125,
        "cmd_pid": 28987,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28987",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:56",
            "--end",
            "2026-01-03 08:47:00",
            "--row-id",
            "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_private_only.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "28987",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1418,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:58.703130-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28987) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:00",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:58.703130-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(28987) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 28987,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28987)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28987\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:56",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458818701,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:56",
          "observer_window_end": "2026-01-03 08:47:00",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":28990}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":28990}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458818.70311,
        "cmd_finished_at_unix_s": 1767458818.71053,
        "cmd_duration_s": 0.007420063018798828,
        "cmd_pid": 28990,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28990",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:56",
            "--end",
            "2026-01-03 08:47:00",
            "--row-id",
            "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_private_only.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "28990",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1158,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:00",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28990,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28990)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28990\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:56",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458818812,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:56",
          "observer_window_end": "2026-01-03 08:47:00",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":28993}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":28993}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458818.8138392,
        "cmd_finished_at_unix_s": 1767458818.8209548,
        "cmd_duration_s": 0.007115602493286133,
        "cmd_pid": 28993,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28993",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:56",
            "--end",
            "2026-01-03 08:47:00",
            "--row-id",
            "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_private_only.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "28993",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1159,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:00",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28993,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28993)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28993\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:56",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458818921,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:56",
          "observer_window_end": "2026-01-03 08:47:00",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":28996}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":28996}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458818.922901,
        "cmd_finished_at_unix_s": 1767458818.930028,
        "cmd_duration_s": 0.007127046585083008,
        "cmd_pid": 28996,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28996",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:56",
            "--end",
            "2026-01-03 08:47:00",
            "--row-id",
            "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_private_only.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "28996",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1178,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:00",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28996,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(28996)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28996\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:56",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458819034,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:56",
          "observer_window_end": "2026-01-03 08:47:00",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":28999}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":28999}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458819.036171,
        "cmd_finished_at_unix_s": 1767458819.0433762,
        "cmd_duration_s": 0.00720524787902832,
        "cmd_pid": 28999,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "28999",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:57",
            "--end",
            "2026-01-03 08:47:01",
            "--row-id",
            "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_private_only.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "28999",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1179,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:01",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 28999,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(28999)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"28999\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:57",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458819138,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:57",
          "observer_window_end": "2026-01-03 08:47:01",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_var_tmp_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":29002}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":29002}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458819.140367,
        "cmd_finished_at_unix_s": 1767458819.1474261,
        "cmd_duration_s": 0.0070590972900390625,
        "cmd_pid": 29002,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29002",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:57",
            "--end",
            "2026-01-03 08:47:01",
            "--row-id",
            "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_both.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "29002",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1409,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:59.248769-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29002) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:01",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:59.248769-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29002) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29002,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29002)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29002\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:57",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458819242,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:57",
          "observer_window_end": "2026-01-03 08:47:01",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":29005}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":29005}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458819.243618,
        "cmd_finished_at_unix_s": 1767458819.250724,
        "cmd_duration_s": 0.00710606575012207,
        "cmd_pid": 29005,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29005",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:57",
            "--end",
            "2026-01-03 08:47:01",
            "--row-id",
            "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_both.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "29005",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1410,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:46:59.352089-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29005) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:01",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:46:59.352089-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29005) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29005,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29005)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29005\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:57",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458819340,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:57",
          "observer_window_end": "2026-01-03 08:47:01",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":29008}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":29008}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458819.3418398,
        "cmd_finished_at_unix_s": 1767458819.348832,
        "cmd_duration_s": 0.0069921016693115234,
        "cmd_pid": 29008,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29008",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:57",
            "--end",
            "2026-01-03 08:47:01",
            "--row-id",
            "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_both.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "29008",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:01",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29008,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29008)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29008\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:57",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458819438,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:57",
          "observer_window_end": "2026-01-03 08:47:01",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":29011}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":29011}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458819.440288,
        "cmd_finished_at_unix_s": 1767458819.447438,
        "cmd_duration_s": 0.007149934768676758,
        "cmd_pid": 29011,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29011",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:57",
            "--end",
            "2026-01-03 08:47:01",
            "--row-id",
            "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_both.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "29011",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1151,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:01",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29011,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29011)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29011\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:57",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458819543,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:57",
          "observer_window_end": "2026-01-03 08:47:01",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":29014}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":29014}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458819.545294,
        "cmd_finished_at_unix_s": 1767458819.5524821,
        "cmd_duration_s": 0.007188081741333008,
        "cmd_pid": 29014,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29014",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:57",
            "--end",
            "2026-01-03 08:47:01",
            "--row-id",
            "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_both.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "29014",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1170,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:01",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29014,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29014)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29014\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:57",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458819644,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:57",
          "observer_window_end": "2026-01-03 08:47:01",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":29017}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":29017}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458819.645581,
        "cmd_finished_at_unix_s": 1767458819.65276,
        "cmd_duration_s": 0.0071790218353271484,
        "cmd_pid": 29017,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29017",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:57",
            "--end",
            "2026-01-03 08:47:01",
            "--row-id",
            "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_both.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "29017",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1171,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:01",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29017,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29017)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29017\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:57",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458819747,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:57",
          "observer_window_end": "2026-01-03 08:47:01",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_var_tmp_both_plus_metadata_var": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_both_plus_metadata_var.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/var",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:lstat_/var",
        "operation": "file-read-metadata",
        "path": "/var",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "api": "sandbox_check_by_audit_token",
              "decision": "deny",
              "canonical_flag_reason": "not_requested",
              "argument": "/var",
              "token_status": "ok",
              "errno": 0,
              "filter_type_name": "path",
              "filter_type": 0,
              "tool": "seatbelt-callout",
              "no_report": true,
              "varargs_count": 1,
              "error": null,
              "no_report_reason": null,
              "stage": "pre_syscall",
              "operation": "file-read-metadata",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "rc": 1,
              "token_mach_kr": 0,
              "check_type": 1073741824,
              "marker_schema_version": 2
            },
            {
              "api": "sandbox_check_by_audit_token",
              "decision": "deny",
              "canonical_flag_reason": null,
              "argument": "/var",
              "token_status": "ok",
              "errno": 0,
              "filter_type_name": "path",
              "filter_type": 0,
              "tool": "seatbelt-callout",
              "no_report": true,
              "varargs_count": 1,
              "error": null,
              "no_report_reason": null,
              "stage": "pre_syscall",
              "operation": "file-read-metadata",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "rc": 1,
              "token_mach_kr": 0,
              "check_type": 1610612736,
              "marker_schema_version": 2
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/var"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"err_class_source\":\"none\",\"tool\":\"sbpl-apply\",\"api\":\"sandbox_init\",\"mode\":\"sbpl\",\"marker_schema_version\":1,\"errno\":0,\"pid\":29020,\"errbuf\":null,\"rc\":0,\"stage\":\"apply\",\"err_class\":\"ok\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/db136135-55a4-4f5c-85c3-c5046b1c2bc2\\/runtime_profiles\\/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\"}\n{\"pid\":29020,\"marker_schema_version\":1,\"tool\":\"sbpl-apply\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/db136135-55a4-4f5c-85c3-c5046b1c2bc2\\/runtime_profiles\\/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"stage\":\"applied\",\"rc\":0}\n{\"api\":\"sandbox_check_by_audit_token\",\"decision\":\"deny\",\"canonical_flag_reason\":\"not_requested\",\"argument\":\"\\/var\",\"token_status\":\"ok\",\"errno\":0,\"filter_type_name\":\"path\",\"filter_type\":0,\"tool\":\"seatbelt-callout\",\"no_report\":true,\"varargs_count\":1,\"error\":null,\"no_report_reason\":null,\"stage\":\"pre_syscall\",\"operation\":\"file-read-metadata\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"rc\":1,\"token_mach_kr\":0,\"check_type\":1073741824,\"marker_schema_version\":2}\n{\"api\":\"sandbox_check_by_audit_token\",\"decision\":\"deny\",\"canonical_flag_reason\":null,\"argument\":\"\\/var\",\"token_status\":\"ok\",\"errno\":0,\"filter_type_name\":\"path\",\"filter_type\":0,\"tool\":\"seatbelt-callout\",\"no_report\":true,\"varargs_count\":1,\"error\":null,\"no_report_reason\":null,\"stage\":\"pre_syscall\",\"operation\":\"file-read-metadata\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"rc\":1,\"token_mach_kr\":0,\"check_type\":1610612736,\"marker_schema_version\":2}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 0,
          "errno_name": "OK",
          "message": "stat-ok",
          "op": "file-read-metadata",
          "path": "/var",
          "status": "ok",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767458819.749826,
        "cmd_finished_at_unix_s": 1767458820.030734,
        "cmd_duration_s": 0.28090810775756836,
        "cmd_pid": 29020,
        "cmd_process_name": "metadata_runner",
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29020",
            "--process-name",
            "metadata_runner",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:57",
            "--end",
            "2026-01-03 08:47:02",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:lstat_/var"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_both_plus_metadata_var.lstat__var.observer.json",
          "log_write_error": null,
          "pid": "29020",
          "process_name": "metadata_runner",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:lstat_/var",
          "correlation_id": null,
          "stdout_bytes": 8499,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:00.125232-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) sysctl-read kern.maxfilesperproc",
                "2026-01-03 08:47:00.127058-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/api/runtime/native/metadata_runner",
                "2026-01-03 08:47:00.127091-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/api/runtime/native/metadata_runner",
                "2026-01-03 08:47:00.127811-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:47:00.127916-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:00.127960-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:00.127967-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-metadata /Users/achyland",
                "2026-01-03 08:47:00.128273-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:47:00.128344-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:00.128802-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:00.128806-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:47:00.128861-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:00.128936-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:00.128941-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:47:00.129009-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:00.129086-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:00.129091-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:47:00.129154-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:00.129216-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:00.129220-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:47:00.129273-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:00.130059-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:00.130065-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:02",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:00.125232-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) sysctl-read kern.maxfilesperproc\n2026-01-03 08:47:00.127058-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/api/runtime/native/metadata_runner\n2026-01-03 08:47:00.127091-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/api/runtime/native/metadata_runner\n2026-01-03 08:47:00.127811-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:47:00.127916-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc\n2026-01-03 08:47:00.127960-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc\n2026-01-03 08:47:00.127967-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-metadata /Users/achyland\n2026-01-03 08:47:00.128273-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:47:00.128344-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc\n2026-01-03 08:47:00.128802-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc\n2026-01-03 08:47:00.128806-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:47:00.128861-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc\n2026-01-03 08:47:00.128936-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc\n2026-01-03 08:47:00.128941-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:47:00.129009-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc\n2026-01-03 08:47:00.129086-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc\n2026-01-03 08:47:00.129091-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:47:00.129154-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc\n2026-01-03 08:47:00.129216-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc\n2026-01-03 08:47:00.129220-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:47:00.129273-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc\n2026-01-03 08:47:00.130059-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29020) deny(1) file-read-metadata /etc\n2026-01-03 08:47:00.130065-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29020) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 24,
              "observer_schema_version": 1,
              "pid": 29020,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: metadata_runner(29020)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29020\")))",
              "process_name": "metadata_runner",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:lstat_/var",
              "start": "2026-01-03 08:46:57",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458820185,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:57",
          "observer_window_end": "2026-01-03 08:47:02",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":29023}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":29023}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458820.1875148,
        "cmd_finished_at_unix_s": 1767458820.194762,
        "cmd_duration_s": 0.007247209548950195,
        "cmd_pid": 29023,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29023",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:58",
            "--end",
            "2026-01-03 08:47:02",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_both_plus_metadata_var.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "29023",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1160,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:02",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29023,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29023)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29023\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:58",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458820302,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:58",
          "observer_window_end": "2026-01-03 08:47:02",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":29026}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":29026}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458820.3034189,
        "cmd_finished_at_unix_s": 1767458820.310694,
        "cmd_duration_s": 0.007275104522705078,
        "cmd_pid": 29026,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29026",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:58",
            "--end",
            "2026-01-03 08:47:02",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_both_plus_metadata_var.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "29026",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1161,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:02",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29026,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29026)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29026\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:58",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458820417,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:58",
          "observer_window_end": "2026-01-03 08:47:02",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":29029}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":29029}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458820.419366,
        "cmd_finished_at_unix_s": 1767458820.426532,
        "cmd_duration_s": 0.007166147232055664,
        "cmd_pid": 29029,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29029",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:58",
            "--end",
            "2026-01-03 08:47:02",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_both_plus_metadata_var.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "29029",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1168,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:02",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29029,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29029)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29029\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:58",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458820530,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:58",
          "observer_window_end": "2026-01-03 08:47:02",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":29032}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":29032}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458820.53216,
        "cmd_finished_at_unix_s": 1767458820.539392,
        "cmd_duration_s": 0.007231950759887695,
        "cmd_pid": 29032,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29032",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:58",
            "--end",
            "2026-01-03 08:47:02",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_both_plus_metadata_var.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "29032",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1169,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:02",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29032,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29032)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29032\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:58",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458820643,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:58",
          "observer_window_end": "2026-01-03 08:47:02",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_var_tmp_data_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_data_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":29035}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":29035}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458820.644971,
        "cmd_finished_at_unix_s": 1767458820.652119,
        "cmd_duration_s": 0.007148027420043945,
        "cmd_pid": 29035,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29035",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:58",
            "--end",
            "2026-01-03 08:47:02",
            "--row-id",
            "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_data_only.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "29035",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1414,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:00.753493-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29035) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:02",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:00.753493-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29035) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29035,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29035)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29035\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:58",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458820756,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:58",
          "observer_window_end": "2026-01-03 08:47:02",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":29038}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":29038}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458820.758441,
        "cmd_finished_at_unix_s": 1767458820.765592,
        "cmd_duration_s": 0.007151126861572266,
        "cmd_pid": 29038,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29038",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:58",
            "--end",
            "2026-01-03 08:47:02",
            "--row-id",
            "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_data_only.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "29038",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1415,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:00.866977-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29038) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:02",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:00.866977-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29038) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29038,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29038)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29038\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:58",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458820874,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:58",
          "observer_window_end": "2026-01-03 08:47:02",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":29041}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":29041}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458820.8762162,
        "cmd_finished_at_unix_s": 1767458820.883478,
        "cmd_duration_s": 0.007261753082275391,
        "cmd_pid": 29041,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29041",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:58",
            "--end",
            "2026-01-03 08:47:02",
            "--row-id",
            "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_data_only.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "29041",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1470,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:00.984846-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29041) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:02",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:00.984846-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29041) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29041,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29041)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29041\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:58",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458820989,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:58",
          "observer_window_end": "2026-01-03 08:47:02",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":29044}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":29044}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458820.990974,
        "cmd_finished_at_unix_s": 1767458820.998073,
        "cmd_duration_s": 0.007099151611328125,
        "cmd_pid": 29044,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29044",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:58",
            "--end",
            "2026-01-03 08:47:02",
            "--row-id",
            "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_data_only.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "29044",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1473,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:01.099475-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29044) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:02",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:01.099475-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29044) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29044,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29044)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29044\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:58",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458821097,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:58",
          "observer_window_end": "2026-01-03 08:47:02",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":29047}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":29047}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458821.098824,
        "cmd_finished_at_unix_s": 1767458821.1059232,
        "cmd_duration_s": 0.007099151611328125,
        "cmd_pid": 29047,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29047",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:59",
            "--end",
            "2026-01-03 08:47:03",
            "--row-id",
            "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_data_only.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "29047",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1490,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:01.207312-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29047) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:03",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:01.207312-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29047) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29047,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29047)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29047\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:59",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458821205,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:59",
          "observer_window_end": "2026-01-03 08:47:03",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":29050}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":29050}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458821.207364,
        "cmd_finished_at_unix_s": 1767458821.2144241,
        "cmd_duration_s": 0.007060050964355469,
        "cmd_pid": 29050,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29050",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:59",
            "--end",
            "2026-01-03 08:47:03",
            "--row-id",
            "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_var_tmp_data_only.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "29050",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1493,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:01.315807-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29050) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:03",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:01.315807-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29050) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29050,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29050)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29050\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 08:46:59",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458821314,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:59",
          "observer_window_end": "2026-01-03 08:47:03",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_etc_alias_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_alias_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_alias_only:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":29053}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":29053}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458821.316022,
        "cmd_finished_at_unix_s": 1767458821.32303,
        "cmd_duration_s": 0.007008075714111328,
        "cmd_pid": 29053,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29053",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:59",
            "--end",
            "2026-01-03 08:47:03",
            "--row-id",
            "vfs_etc_alias_only:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_etc_alias_only.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "29053",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_alias_only:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1397,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:01.424423-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29053) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:03",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:01.424423-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29053) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29053,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29053)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29053\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_alias_only:read_/etc/hosts",
              "start": "2026-01-03 08:46:59",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458821423,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:59",
          "observer_window_end": "2026-01-03 08:47:03",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_alias_only:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":29056}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":29056}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458821.4253619,
        "cmd_finished_at_unix_s": 1767458821.4324732,
        "cmd_duration_s": 0.007111310958862305,
        "cmd_pid": 29056,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29056",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:59",
            "--end",
            "2026-01-03 08:47:03",
            "--row-id",
            "vfs_etc_alias_only:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_etc_alias_only.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "29056",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_alias_only:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1425,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:01.533883-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29056) deny(1) file-read-data /private/etc/hosts"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:03",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:01.533883-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29056) deny(1) file-read-data /private/etc/hosts",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29056,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29056)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29056\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_alias_only:read_/private/etc/hosts",
              "start": "2026-01-03 08:46:59",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458821533,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:59",
          "observer_window_end": "2026-01-03 08:47:03",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_etc_private_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_private_only:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":29059}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":29059}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458821.535375,
        "cmd_finished_at_unix_s": 1767458821.543488,
        "cmd_duration_s": 0.008112907409667969,
        "cmd_pid": 29059,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29059",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:59",
            "--end",
            "2026-01-03 08:47:03",
            "--row-id",
            "vfs_etc_private_only:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_etc_private_only.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "29059",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_private_only:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1399,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:01.644881-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29059) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:03",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:01.644881-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29059) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29059,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29059)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29059\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_private_only:read_/etc/hosts",
              "start": "2026-01-03 08:46:59",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458821645,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:59",
          "observer_window_end": "2026-01-03 08:47:03",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_private_only:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":29062}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":29062}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458821.647033,
        "cmd_finished_at_unix_s": 1767458821.654149,
        "cmd_duration_s": 0.007116079330444336,
        "cmd_pid": 29062,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29062",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:59",
            "--end",
            "2026-01-03 08:47:03",
            "--row-id",
            "vfs_etc_private_only:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_etc_private_only.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "29062",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_private_only:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1140,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:03",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29062,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29062)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29062\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_private_only:read_/private/etc/hosts",
              "start": "2026-01-03 08:46:59",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458821755,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:59",
          "observer_window_end": "2026-01-03 08:47:03",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_etc_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_both:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":29065}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":29065}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458821.758512,
        "cmd_finished_at_unix_s": 1767458821.765543,
        "cmd_duration_s": 0.007030963897705078,
        "cmd_pid": 29065,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29065",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:59",
            "--end",
            "2026-01-03 08:47:03",
            "--row-id",
            "vfs_etc_both:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_etc_both.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "29065",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1391,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:01.866950-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29065) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:03",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:01.866950-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29065) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29065,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29065)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29065\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both:read_/etc/hosts",
              "start": "2026-01-03 08:46:59",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458821870,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:59",
          "observer_window_end": "2026-01-03 08:47:03",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_both:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":29068}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":29068}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458821.872381,
        "cmd_finished_at_unix_s": 1767458821.879508,
        "cmd_duration_s": 0.007127046585083008,
        "cmd_pid": 29068,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29068",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:59",
            "--end",
            "2026-01-03 08:47:03",
            "--row-id",
            "vfs_etc_both:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_etc_both.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "29068",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1132,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:03",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29068,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29068)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29068\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both:read_/private/etc/hosts",
              "start": "2026-01-03 08:46:59",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458821987,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:59",
          "observer_window_end": "2026-01-03 08:47:03",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_etc/hosts",
        "expectation_id": "vfs_etc_both:read_openat_rootrel_etc/hosts",
        "operation": "file-read*",
        "path": "etc/hosts",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":29071}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":29071}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: No such file or directory\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458821.989175,
        "cmd_finished_at_unix_s": 1767458821.996376,
        "cmd_duration_s": 0.007200956344604492,
        "cmd_pid": 29071,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29071",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:46:59",
            "--end",
            "2026-01-03 08:47:03",
            "--row-id",
            "vfs_etc_both:read_openat_rootrel_etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_etc_both.read_openat_rootrel_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "29071",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_openat_rootrel_etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1138,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:03",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29071,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29071)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29071\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both:read_openat_rootrel_etc/hosts",
              "start": "2026-01-03 08:46:59",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458822098,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:46:59",
          "observer_window_end": "2026-01-03 08:47:03",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_private/etc/hosts",
        "expectation_id": "vfs_etc_both:read_openat_rootrel_private/etc/hosts",
        "operation": "file-read*",
        "path": "private/etc/hosts",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "private/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":29074}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":29074}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: No such file or directory\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458822.1000571,
        "cmd_finished_at_unix_s": 1767458822.10709,
        "cmd_duration_s": 0.007032871246337891,
        "cmd_pid": 29074,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29074",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:00",
            "--end",
            "2026-01-03 08:47:04",
            "--row-id",
            "vfs_etc_both:read_openat_rootrel_private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_etc_both.read_openat_rootrel_private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "29074",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_openat_rootrel_private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1146,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:04",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29074,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29074)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29074\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both:read_openat_rootrel_private/etc/hosts",
              "start": "2026-01-03 08:47:00",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458822211,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:00",
          "observer_window_end": "2026-01-03 08:47:04",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_etc_both_plus_metadata_etc": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_both_plus_metadata_etc.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/etc",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:lstat_/etc",
        "operation": "file-read-metadata",
        "path": "/etc",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "errno": 0,
              "varargs_count": 1,
              "no_report_reason": null,
              "check_type": 1073741824,
              "filter_type": 0,
              "argument": "/etc",
              "canonical_flag_reason": "not_requested",
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "decision": "deny",
              "error": null,
              "marker_schema_version": 2,
              "api": "sandbox_check_by_audit_token",
              "no_report": true,
              "canonical_flag_used": false,
              "filter_type_name": "path",
              "canonicalization": "raw",
              "tool": "seatbelt-callout",
              "stage": "pre_syscall",
              "operation": "file-read-metadata"
            },
            {
              "errno": 0,
              "varargs_count": 1,
              "no_report_reason": null,
              "check_type": 1610612736,
              "filter_type": 0,
              "argument": "/etc",
              "canonical_flag_reason": null,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "decision": "deny",
              "error": null,
              "marker_schema_version": 2,
              "api": "sandbox_check_by_audit_token",
              "no_report": true,
              "canonical_flag_used": true,
              "filter_type_name": "path",
              "canonicalization": "canonical",
              "tool": "seatbelt-callout",
              "stage": "pre_syscall",
              "operation": "file-read-metadata"
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/etc",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/etc"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"rc\":0,\"errno\":0,\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/db136135-55a4-4f5c-85c3-c5046b1c2bc2\\/runtime_profiles\\/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"err_class\":\"ok\",\"err_class_source\":\"none\",\"tool\":\"sbpl-apply\",\"pid\":29077,\"errbuf\":null,\"mode\":\"sbpl\",\"marker_schema_version\":1,\"stage\":\"apply\",\"api\":\"sandbox_init\"}\n{\"pid\":29077,\"rc\":0,\"tool\":\"sbpl-apply\",\"mode\":\"sbpl\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/db136135-55a4-4f5c-85c3-c5046b1c2bc2\\/runtime_profiles\\/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"marker_schema_version\":1,\"stage\":\"applied\",\"api\":\"sandbox_init\"}\n{\"errno\":0,\"varargs_count\":1,\"no_report_reason\":null,\"check_type\":1073741824,\"filter_type\":0,\"argument\":\"\\/etc\",\"canonical_flag_reason\":\"not_requested\",\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"decision\":\"deny\",\"error\":null,\"marker_schema_version\":2,\"api\":\"sandbox_check_by_audit_token\",\"no_report\":true,\"canonical_flag_used\":false,\"filter_type_name\":\"path\",\"canonicalization\":\"raw\",\"tool\":\"seatbelt-callout\",\"stage\":\"pre_syscall\",\"operation\":\"file-read-metadata\"}\n{\"errno\":0,\"varargs_count\":1,\"no_report_reason\":null,\"check_type\":1610612736,\"filter_type\":0,\"argument\":\"\\/etc\",\"canonical_flag_reason\":null,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"decision\":\"deny\",\"error\":null,\"marker_schema_version\":2,\"api\":\"sandbox_check_by_audit_token\",\"no_report\":true,\"canonical_flag_used\":true,\"filter_type_name\":\"path\",\"canonicalization\":\"canonical\",\"tool\":\"seatbelt-callout\",\"stage\":\"pre_syscall\",\"operation\":\"file-read-metadata\"}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 0,
          "errno_name": "OK",
          "message": "stat-ok",
          "op": "file-read-metadata",
          "path": "/etc",
          "status": "ok",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767458822.213601,
        "cmd_finished_at_unix_s": 1767458822.223077,
        "cmd_duration_s": 0.009475946426391602,
        "cmd_pid": 29077,
        "cmd_process_name": "metadata_runner",
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/etc",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29077",
            "--process-name",
            "metadata_runner",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:00",
            "--end",
            "2026-01-03 08:47:04",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:lstat_/etc"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_etc_both_plus_metadata_etc.lstat__etc.observer.json",
          "log_write_error": null,
          "pid": "29077",
          "process_name": "metadata_runner",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:lstat_/etc",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:04",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29077,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: metadata_runner(29077)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29077\")))",
              "process_name": "metadata_runner",
              "row_id": "vfs_etc_both_plus_metadata_etc:lstat_/etc",
              "start": "2026-01-03 08:47:00",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458822330,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:00",
          "observer_window_end": "2026-01-03 08:47:04",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_etc/hosts",
        "operation": "file-read*",
        "path": "etc/hosts",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":29080}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":29080}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: No such file or directory\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458822.3319008,
        "cmd_finished_at_unix_s": 1767458822.338994,
        "cmd_duration_s": 0.007093191146850586,
        "cmd_pid": 29080,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29080",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:00",
            "--end",
            "2026-01-03 08:47:04",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_etc_both_plus_metadata_etc.read_openat_rootrel_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "29080",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1156,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:04",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29080,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29080)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29080\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_etc/hosts",
              "start": "2026-01-03 08:47:00",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458822438,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:00",
          "observer_window_end": "2026-01-03 08:47:04",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_private/etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_private/etc/hosts",
        "operation": "file-read*",
        "path": "private/etc/hosts",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "private/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":29083}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":29083}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: No such file or directory\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458822.439855,
        "cmd_finished_at_unix_s": 1767458822.4469178,
        "cmd_duration_s": 0.007062673568725586,
        "cmd_pid": 29083,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29083",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:00",
            "--end",
            "2026-01-03 08:47:04",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_etc_both_plus_metadata_etc.read_openat_rootrel_private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "29083",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1164,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:04",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29083,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29083)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29083\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_private/etc/hosts",
              "start": "2026-01-03 08:47:00",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458822546,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:00",
          "observer_window_end": "2026-01-03 08:47:04",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":29086}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":29086}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458822.548194,
        "cmd_finished_at_unix_s": 1767458822.555323,
        "cmd_duration_s": 0.00712895393371582,
        "cmd_pid": 29086,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29086",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:00",
            "--end",
            "2026-01-03 08:47:04",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_etc_both_plus_metadata_etc.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "29086",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1142,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:04",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29086,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29086)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29086\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_/etc/hosts",
              "start": "2026-01-03 08:47:00",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458822657,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:00",
          "observer_window_end": "2026-01-03 08:47:04",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":29089}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":29089}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458822.6592581,
        "cmd_finished_at_unix_s": 1767458822.666421,
        "cmd_duration_s": 0.007162809371948242,
        "cmd_pid": 29089,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29089",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:00",
            "--end",
            "2026-01-03 08:47:04",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_etc_both_plus_metadata_etc.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "29089",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:04",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29089,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29089)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29089\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts",
              "start": "2026-01-03 08:47:00",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458822770,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:00",
          "observer_window_end": "2026-01-03 08:47:04",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_firmlink_private_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":29092}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":29092}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458822.772474,
        "cmd_finished_at_unix_s": 1767458822.779932,
        "cmd_duration_s": 0.0074579715728759766,
        "cmd_pid": 29092,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29092",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:00",
            "--end",
            "2026-01-03 08:47:04",
            "--row-id",
            "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_firmlink_private_only.read__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "29092",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1158,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:04",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29092,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29092)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29092\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:47:00",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458822885,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:00",
          "observer_window_end": "2026-01-03 08:47:04",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":29095}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":29095}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458822.886821,
        "cmd_finished_at_unix_s": 1767458822.894052,
        "cmd_duration_s": 0.007230997085571289,
        "cmd_pid": 29095,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29095",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:00",
            "--end",
            "2026-01-03 08:47:04",
            "--row-id",
            "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_firmlink_private_only.write__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "29095",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1159,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:04",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29095,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29095)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29095\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:47:00",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458822998,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:00",
          "observer_window_end": "2026-01-03 08:47:04",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":29098}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":29098}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458823.000072,
        "cmd_finished_at_unix_s": 1767458823.007159,
        "cmd_duration_s": 0.007086992263793945,
        "cmd_pid": 29098,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29098",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:01",
            "--end",
            "2026-01-03 08:47:05",
            "--row-id",
            "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_firmlink_private_only.read__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "29098",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1178,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29098,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29098)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29098\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:47:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458823103,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:01",
          "observer_window_end": "2026-01-03 08:47:05",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":29101}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":29101}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458823.104896,
        "cmd_finished_at_unix_s": 1767458823.112013,
        "cmd_duration_s": 0.007117033004760742,
        "cmd_pid": 29101,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29101",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:01",
            "--end",
            "2026-01-03 08:47:05",
            "--row-id",
            "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_firmlink_private_only.write__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "29101",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1179,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29101,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29101)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29101\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:47:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458823207,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:01",
          "observer_window_end": "2026-01-03 08:47:05",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_firmlink_data_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_data_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":29104}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":29104}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458823.209486,
        "cmd_finished_at_unix_s": 1767458823.216564,
        "cmd_duration_s": 0.007077932357788086,
        "cmd_pid": 29104,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29104",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:01",
            "--end",
            "2026-01-03 08:47:05",
            "--row-id",
            "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_firmlink_data_only.read__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "29104",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1468,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:03.318008-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29104) deny(1) file-read-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:03.318008-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29104) deny(1) file-read-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29104,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29104)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29104\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:47:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458823309,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:01",
          "observer_window_end": "2026-01-03 08:47:05",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":29107}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":29107}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458823.311084,
        "cmd_finished_at_unix_s": 1767458823.318208,
        "cmd_duration_s": 0.0071239471435546875,
        "cmd_pid": 29107,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29107",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:01",
            "--end",
            "2026-01-03 08:47:05",
            "--row-id",
            "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_firmlink_data_only.write__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "29107",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1471,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:03.419668-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29107) deny(1) file-write-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:03.419668-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29107) deny(1) file-write-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29107,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29107)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29107\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:47:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458823409,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:01",
          "observer_window_end": "2026-01-03 08:47:05",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":29110}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":29110}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458823.41094,
        "cmd_finished_at_unix_s": 1767458823.418185,
        "cmd_duration_s": 0.007245063781738281,
        "cmd_pid": 29110,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29110",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:01",
            "--end",
            "2026-01-03 08:47:05",
            "--row-id",
            "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_firmlink_data_only.read__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "29110",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1488,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:03.519640-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29110) deny(1) file-read-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:03.519640-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29110) deny(1) file-read-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29110,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29110)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29110\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:47:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458823504,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:01",
          "observer_window_end": "2026-01-03 08:47:05",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":29113}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":29113}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458823.506038,
        "cmd_finished_at_unix_s": 1767458823.5131571,
        "cmd_duration_s": 0.007119178771972656,
        "cmd_pid": 29113,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29113",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:01",
            "--end",
            "2026-01-03 08:47:05",
            "--row-id",
            "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_firmlink_data_only.write__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "29113",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1491,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:03.614599-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29113) deny(1) file-write-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:03.614599-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29113) deny(1) file-write-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29113,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29113)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29113\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:47:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458823605,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:01",
          "observer_window_end": "2026-01-03 08:47:05",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_firmlink_both": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":29116}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":29116}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458823.607709,
        "cmd_finished_at_unix_s": 1767458823.6148732,
        "cmd_duration_s": 0.0071642398834228516,
        "cmd_pid": 29116,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29116",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:01",
            "--end",
            "2026-01-03 08:47:05",
            "--row-id",
            "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_firmlink_both.read__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "29116",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29116,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29116)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29116\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:47:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458823709,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:01",
          "observer_window_end": "2026-01-03 08:47:05",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":29119}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":29119}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458823.710463,
        "cmd_finished_at_unix_s": 1767458823.717621,
        "cmd_duration_s": 0.007158041000366211,
        "cmd_pid": 29119,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29119",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:01",
            "--end",
            "2026-01-03 08:47:05",
            "--row-id",
            "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_firmlink_both.write__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "29119",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1151,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29119,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29119)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29119\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:47:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458823814,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:01",
          "observer_window_end": "2026-01-03 08:47:05",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":29122}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":29122}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458823.81581,
        "cmd_finished_at_unix_s": 1767458823.822965,
        "cmd_duration_s": 0.007154941558837891,
        "cmd_pid": 29122,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29122",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:01",
            "--end",
            "2026-01-03 08:47:05",
            "--row-id",
            "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_firmlink_both.read__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "29122",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1170,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29122,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29122)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29122\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:47:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458823919,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:01",
          "observer_window_end": "2026-01-03 08:47:05",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":29125}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":29125}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458823.920943,
        "cmd_finished_at_unix_s": 1767458823.9280791,
        "cmd_duration_s": 0.007136106491088867,
        "cmd_pid": 29125,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29125",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:01",
            "--end",
            "2026-01-03 08:47:05",
            "--row-id",
            "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_firmlink_both.write__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "29125",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1171,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29125,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29125)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29125\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 08:47:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458824022,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:01",
          "observer_window_end": "2026-01-03 08:47:05",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_link_var_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_var_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":29128}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":29128}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458824.02498,
        "cmd_finished_at_unix_s": 1767458824.032185,
        "cmd_duration_s": 0.007205009460449219,
        "cmd_pid": 29128,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29128",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:02",
            "--end",
            "2026-01-03 08:47:06",
            "--row-id",
            "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_link_var_tmp_only.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "29128",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1502,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:04.133618-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29128) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:06",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:04.133618-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29128) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29128,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29128)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29128\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 08:47:02",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458824120,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:02",
          "observer_window_end": "2026-01-03 08:47:06",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":29131}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":29131}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458824.121939,
        "cmd_finished_at_unix_s": 1767458824.129066,
        "cmd_duration_s": 0.007127046585083008,
        "cmd_pid": 29131,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29131",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:02",
            "--end",
            "2026-01-03 08:47:06",
            "--row-id",
            "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_link_var_tmp_only.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "29131",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1503,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:04.230518-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29131) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:06",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:04.230518-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29131) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29131,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29131)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29131\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 08:47:02",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458824219,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:02",
          "observer_window_end": "2026-01-03 08:47:06",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":29134}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":29134}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458824.220968,
        "cmd_finished_at_unix_s": 1767458824.228286,
        "cmd_duration_s": 0.007318019866943359,
        "cmd_pid": 29134,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29134",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:02",
            "--end",
            "2026-01-03 08:47:06",
            "--row-id",
            "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_link_var_tmp_only.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "29134",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1154,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:06",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29134,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29134)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29134\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 08:47:02",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458824318,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:02",
          "observer_window_end": "2026-01-03 08:47:06",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":29137}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":29137}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458824.320235,
        "cmd_finished_at_unix_s": 1767458824.327412,
        "cmd_duration_s": 0.007176876068115234,
        "cmd_pid": 29137,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29137",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:02",
            "--end",
            "2026-01-03 08:47:06",
            "--row-id",
            "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_link_var_tmp_only.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "29137",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1155,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:06",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29137,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29137)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29137\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 08:47:02",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458824418,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:02",
          "observer_window_end": "2026-01-03 08:47:06",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_link_private_tmp_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_private_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":29140}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":29140}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458824.420806,
        "cmd_finished_at_unix_s": 1767458824.4279501,
        "cmd_duration_s": 0.00714421272277832,
        "cmd_pid": 29140,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29140",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:02",
            "--end",
            "2026-01-03 08:47:06",
            "--row-id",
            "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_link_private_tmp_only.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "29140",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1506,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:04.529424-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29140) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:06",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:04.529424-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29140) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29140,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29140)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29140\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 08:47:02",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458824516,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:02",
          "observer_window_end": "2026-01-03 08:47:06",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":29143}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":29143}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458824.517528,
        "cmd_finished_at_unix_s": 1767458824.524652,
        "cmd_duration_s": 0.0071239471435546875,
        "cmd_pid": 29143,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29143",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:02",
            "--end",
            "2026-01-03 08:47:06",
            "--row-id",
            "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_link_private_tmp_only.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "29143",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1507,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:04.626132-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29143) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:06",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:04.626132-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29143) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29143,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29143)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29143\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 08:47:02",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458824612,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:02",
          "observer_window_end": "2026-01-03 08:47:06",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":29146}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":29146}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458824.613697,
        "cmd_finished_at_unix_s": 1767458824.6207738,
        "cmd_duration_s": 0.007076740264892578,
        "cmd_pid": 29146,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29146",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:02",
            "--end",
            "2026-01-03 08:47:06",
            "--row-id",
            "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_link_private_tmp_only.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "29146",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1471,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:04.722246-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29146) deny(1) file-read-data /private/var/tmp/vfs_link_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:06",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:04.722246-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29146) deny(1) file-read-data /private/var/tmp/vfs_link_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29146,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29146)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29146\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 08:47:02",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458824709,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:02",
          "observer_window_end": "2026-01-03 08:47:06",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":29149}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":29149}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458824.711385,
        "cmd_finished_at_unix_s": 1767458824.718509,
        "cmd_duration_s": 0.0071239471435546875,
        "cmd_pid": 29149,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29149",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:02",
            "--end",
            "2026-01-03 08:47:06",
            "--row-id",
            "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_link_private_tmp_only.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "29149",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1474,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:04.819992-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29149) deny(1) file-write-data /private/var/tmp/vfs_link_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:06",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:04.819992-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29149) deny(1) file-write-data /private/var/tmp/vfs_link_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29149,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29149)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29149\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 08:47:02",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458824812,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:02",
          "observer_window_end": "2026-01-03 08:47:06",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_link_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":29152}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":29152}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458824.814253,
        "cmd_finished_at_unix_s": 1767458824.821444,
        "cmd_duration_s": 0.0071909427642822266,
        "cmd_pid": 29152,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29152",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:02",
            "--end",
            "2026-01-03 08:47:06",
            "--row-id",
            "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_link_both.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "29152",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1494,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:04.922934-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29152) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:06",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:04.922934-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(29152) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29152,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29152)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29152\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 08:47:02",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458824907,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:02",
          "observer_window_end": "2026-01-03 08:47:06",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":29155}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":29155}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458824.9088588,
        "cmd_finished_at_unix_s": 1767458824.91598,
        "cmd_duration_s": 0.00712132453918457,
        "cmd_pid": 29155,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29155",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:02",
            "--end",
            "2026-01-03 08:47:06",
            "--row-id",
            "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_link_both.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "29155",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1495,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:05.017454-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29155) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:06",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:05.017454-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(29155) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 29155,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29155)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29155\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 08:47:02",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458825004,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:02",
          "observer_window_end": "2026-01-03 08:47:06",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":29158}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":29158}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458825.006134,
        "cmd_finished_at_unix_s": 1767458825.013589,
        "cmd_duration_s": 0.007454872131347656,
        "cmd_pid": 29158,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29158",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:03",
            "--end",
            "2026-01-03 08:47:07",
            "--row-id",
            "vfs_link_both:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_link_both.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "29158",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1146,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:07",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29158,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29158)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29158\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 08:47:03",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458825099,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:03",
          "observer_window_end": "2026-01-03 08:47:07",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":29161}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":29161}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458825.101238,
        "cmd_finished_at_unix_s": 1767458825.108345,
        "cmd_duration_s": 0.0071070194244384766,
        "cmd_pid": 29161,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29161",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:03",
            "--end",
            "2026-01-03 08:47:07",
            "--row-id",
            "vfs_link_both:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_link_both.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "29161",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1147,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:07",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29161,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29161)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29161\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 08:47:03",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458825201,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:03",
          "observer_window_end": "2026-01-03 08:47:07",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  },
  "vfs_link_both_plus_metadata_to_var_tmp": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_both_plus_metadata_to_var_tmp.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/private/tmp/vfs_linkdir/to_var_tmp",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp",
        "operation": "file-read-metadata",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "marker_schema_version": 2,
              "no_report": true,
              "filter_type_name": "path",
              "errno": 0,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
              "decision": "deny",
              "check_type": 1073741824,
              "token_status": "ok",
              "canonicalization": "raw",
              "error": null,
              "api": "sandbox_check_by_audit_token",
              "varargs_count": 1,
              "canonical_flag_reason": "not_requested",
              "stage": "pre_syscall",
              "no_report_reason": null,
              "rc": 1,
              "operation": "file-read-metadata",
              "tool": "seatbelt-callout",
              "filter_type": 0,
              "token_mach_kr": 0,
              "canonical_flag_used": false
            },
            {
              "marker_schema_version": 2,
              "no_report": true,
              "filter_type_name": "path",
              "errno": 0,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
              "decision": "deny",
              "check_type": 1610612736,
              "token_status": "ok",
              "canonicalization": "canonical",
              "error": null,
              "api": "sandbox_check_by_audit_token",
              "varargs_count": 1,
              "canonical_flag_reason": null,
              "stage": "pre_syscall",
              "no_report_reason": null,
              "rc": 1,
              "operation": "file-read-metadata",
              "tool": "seatbelt-callout",
              "filter_type": 0,
              "token_mach_kr": 0,
              "canonical_flag_used": true
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/private/tmp/vfs_linkdir/to_var_tmp"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"mode\":\"sbpl\",\"rc\":0,\"tool\":\"sbpl-apply\",\"errno\":0,\"err_class_source\":\"none\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/db136135-55a4-4f5c-85c3-c5046b1c2bc2\\/runtime_profiles\\/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":29164,\"marker_schema_version\":1,\"stage\":\"apply\",\"api\":\"sandbox_init\",\"err_class\":\"ok\",\"errbuf\":null}\n{\"api\":\"sandbox_init\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/db136135-55a4-4f5c-85c3-c5046b1c2bc2\\/runtime_profiles\\/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"mode\":\"sbpl\",\"rc\":0,\"tool\":\"sbpl-apply\",\"pid\":29164,\"marker_schema_version\":1,\"stage\":\"applied\"}\n{\"marker_schema_version\":2,\"no_report\":true,\"filter_type_name\":\"path\",\"errno\":0,\"argument\":\"\\/private\\/tmp\\/vfs_linkdir\\/to_var_tmp\",\"decision\":\"deny\",\"check_type\":1073741824,\"token_status\":\"ok\",\"canonicalization\":\"raw\",\"error\":null,\"api\":\"sandbox_check_by_audit_token\",\"varargs_count\":1,\"canonical_flag_reason\":\"not_requested\",\"stage\":\"pre_syscall\",\"no_report_reason\":null,\"rc\":1,\"operation\":\"file-read-metadata\",\"tool\":\"seatbelt-callout\",\"filter_type\":0,\"token_mach_kr\":0,\"canonical_flag_used\":false}\n{\"marker_schema_version\":2,\"no_report\":true,\"filter_type_name\":\"path\",\"errno\":0,\"argument\":\"\\/private\\/tmp\\/vfs_linkdir\\/to_var_tmp\",\"decision\":\"deny\",\"check_type\":1610612736,\"token_status\":\"ok\",\"canonicalization\":\"canonical\",\"error\":null,\"api\":\"sandbox_check_by_audit_token\",\"varargs_count\":1,\"canonical_flag_reason\":null,\"stage\":\"pre_syscall\",\"no_report_reason\":null,\"rc\":1,\"operation\":\"file-read-metadata\",\"tool\":\"seatbelt-callout\",\"filter_type\":0,\"token_mach_kr\":0,\"canonical_flag_used\":true}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 0,
          "errno_name": "OK",
          "message": "stat-ok",
          "op": "file-read-metadata",
          "path": "/private/tmp/vfs_linkdir/to_var_tmp",
          "status": "ok",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767458825.203377,
        "cmd_finished_at_unix_s": 1767458825.21287,
        "cmd_duration_s": 0.009492874145507812,
        "cmd_pid": 29164,
        "cmd_process_name": "metadata_runner",
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29164",
            "--process-name",
            "metadata_runner",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:03",
            "--end",
            "2026-01-03 08:47:07",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_link_both_plus_metadata_to_var_tmp.lstat__private_tmp_vfs_linkdir_to_var_tmp.observer.json",
          "log_write_error": null,
          "pid": "29164",
          "process_name": "metadata_runner",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp",
          "correlation_id": null,
          "stdout_bytes": 8534,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 08:47:05.312515-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) sysctl-read kern.maxfilesperproc",
                "2026-01-03 08:47:05.313043-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/api/runtime/native/metadata_runner",
                "2026-01-03 08:47:05.313051-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/api/runtime/native/metadata_runner",
                "2026-01-03 08:47:05.313309-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:47:05.313361-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:05.313376-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:05.313377-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-metadata /Users/achyland",
                "2026-01-03 08:47:05.313461-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:47:05.313481-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:05.313609-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:05.313610-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:47:05.313636-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:05.313655-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:05.313657-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:47:05.313686-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:05.313720-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:05.313721-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:47:05.313747-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:05.313767-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:05.313768-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 08:47:05.313789-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:05.313944-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc",
                "2026-01-03 08:47:05.313945-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist"
              ],
              "duration_ms": null,
              "end": "2026-01-03 08:47:07",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 08:47:05.312515-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) sysctl-read kern.maxfilesperproc\n2026-01-03 08:47:05.313043-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/api/runtime/native/metadata_runner\n2026-01-03 08:47:05.313051-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/api/runtime/native/metadata_runner\n2026-01-03 08:47:05.313309-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:47:05.313361-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc\n2026-01-03 08:47:05.313376-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc\n2026-01-03 08:47:05.313377-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-metadata /Users/achyland\n2026-01-03 08:47:05.313461-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:47:05.313481-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc\n2026-01-03 08:47:05.313609-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc\n2026-01-03 08:47:05.313610-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:47:05.313636-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc\n2026-01-03 08:47:05.313655-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc\n2026-01-03 08:47:05.313657-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:47:05.313686-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc\n2026-01-03 08:47:05.313720-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc\n2026-01-03 08:47:05.313721-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:47:05.313747-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc\n2026-01-03 08:47:05.313767-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc\n2026-01-03 08:47:05.313768-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 08:47:05.313789-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc\n2026-01-03 08:47:05.313944-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(29164) deny(1) file-read-metadata /etc\n2026-01-03 08:47:05.313945-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(29164) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 24,
              "observer_schema_version": 1,
              "pid": 29164,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: metadata_runner(29164)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29164\")))",
              "process_name": "metadata_runner",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp",
              "start": "2026-01-03 08:47:03",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458825307,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:03",
          "observer_window_end": "2026-01-03 08:47:07",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":29167}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":29167}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458825.309349,
        "cmd_finished_at_unix_s": 1767458825.316652,
        "cmd_duration_s": 0.007302999496459961,
        "cmd_pid": 29167,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29167",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:03",
            "--end",
            "2026-01-03 08:47:07",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_link_both_plus_metadata_to_var_tmp.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "29167",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1190,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:07",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29167,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29167)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29167\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 08:47:03",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458825410,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:03",
          "observer_window_end": "2026-01-03 08:47:07",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":29170}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":29170}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458825.412328,
        "cmd_finished_at_unix_s": 1767458825.419619,
        "cmd_duration_s": 0.007291078567504883,
        "cmd_pid": 29170,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29170",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:03",
            "--end",
            "2026-01-03 08:47:07",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_link_both_plus_metadata_to_var_tmp.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "29170",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1191,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:07",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29170,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29170)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29170\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 08:47:03",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458825517,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:03",
          "observer_window_end": "2026-01-03 08:47:07",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":29173}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":29173}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458825.518629,
        "cmd_finished_at_unix_s": 1767458825.5259368,
        "cmd_duration_s": 0.007307767868041992,
        "cmd_pid": 29173,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29173",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:03",
            "--end",
            "2026-01-03 08:47:07",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_link_both_plus_metadata_to_var_tmp.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "29173",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1171,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:07",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29173,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(29173)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29173\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 08:47:03",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458825622,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:03",
          "observer_window_end": "2026-01-03 08:47:07",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "ok",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":29176}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.db136135-55a4-4f5c-85c3-c5046b1c2bc2/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":29176}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767458825.6237419,
        "cmd_finished_at_unix_s": 1767458825.6308758,
        "cmd_duration_s": 0.007133960723876953,
        "cmd_pid": 29176,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "29176",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 08:47:03",
            "--end",
            "2026-01-03 08:47:07",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/db136135-55a4-4f5c-85c3-c5046b1c2bc2/observer/vfs_link_both_plus_metadata_to_var_tmp.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "29176",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1172,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 08:47:07",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 29176,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(29176)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"29176\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 08:47:03",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767458825729,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 08:47:03",
          "observer_window_end": "2026-01-03 08:47:07",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "db136135-55a4-4f5c-85c3-c5046b1c2bc2"
  }
}