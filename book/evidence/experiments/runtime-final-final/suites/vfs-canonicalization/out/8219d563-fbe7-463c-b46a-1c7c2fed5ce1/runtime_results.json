{
  "vfs_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_tmp_only:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70635}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70635}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434956.327144,
        "cmd_finished_at_unix_s": 1767434956.541863,
        "cmd_duration_s": 0.21471905708312988,
        "cmd_pid": 70635,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70635",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:14",
            "--end",
            "2026-01-03 02:09:18",
            "--row-id",
            "vfs_tmp_only:read_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_tmp_only.read__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "70635",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1405,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:16.561670-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70635) deny(1) file-read-data /private/tmp/foo"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:18",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:16.561670-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70635) deny(1) file-read-data /private/tmp/foo",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70635,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70635)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70635\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/tmp/foo",
              "start": "2026-01-03 02:09:14",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434958055,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:14",
          "observer_window_end": "2026-01-03 02:09:18",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70638}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70638}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434958.0582242,
        "cmd_finished_at_unix_s": 1767434958.069689,
        "cmd_duration_s": 0.011464834213256836,
        "cmd_pid": 70638,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70638",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:16",
            "--end",
            "2026-01-03 02:09:20",
            "--row-id",
            "vfs_tmp_only:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_tmp_only.read__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "70638",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1413,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:18.089853-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70638) deny(1) file-read-data /private/tmp/foo"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:20",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:18.089853-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70638) deny(1) file-read-data /private/tmp/foo",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70638,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70638)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70638\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/tmp/foo",
              "start": "2026-01-03 02:09:16",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434958205,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:16",
          "observer_window_end": "2026-01-03 02:09:20",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_tmp_only:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70641}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70641}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434958.207681,
        "cmd_finished_at_unix_s": 1767434958.447602,
        "cmd_duration_s": 0.23992109298706055,
        "cmd_pid": 70641,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70641",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:16",
            "--end",
            "2026-01-03 02:09:20",
            "--row-id",
            "vfs_tmp_only:write_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_tmp_only.write__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "70641",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1408,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:18.467219-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70641) deny(1) file-write-data /private/tmp/foo"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:20",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:18.467219-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70641) deny(1) file-write-data /private/tmp/foo",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70641,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70641)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70641\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/tmp/foo",
              "start": "2026-01-03 02:09:16",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434958629,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:16",
          "observer_window_end": "2026-01-03 02:09:20",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70644}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70644}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434958.632134,
        "cmd_finished_at_unix_s": 1767434958.6438432,
        "cmd_duration_s": 0.011709213256835938,
        "cmd_pid": 70644,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70644",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:16",
            "--end",
            "2026-01-03 02:09:20",
            "--row-id",
            "vfs_tmp_only:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_tmp_only.write__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "70644",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1416,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:18.663987-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70644) deny(1) file-write-data /private/tmp/foo"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:20",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:18.663987-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70644) deny(1) file-write-data /private/tmp/foo",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70644,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70644)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70644\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/tmp/foo",
              "start": "2026-01-03 02:09:16",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434958799,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:16",
          "observer_window_end": "2026-01-03 02:09:20",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_tmp_only:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70647}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70647}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434958.801418,
        "cmd_finished_at_unix_s": 1767434958.812719,
        "cmd_duration_s": 0.011301040649414062,
        "cmd_pid": 70647,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70647",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:16",
            "--end",
            "2026-01-03 02:09:20",
            "--row-id",
            "vfs_tmp_only:read_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_tmp_only.read__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "70647",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1405,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:18.832950-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70647) deny(1) file-read-data /private/tmp/bar"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:20",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:18.832950-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70647) deny(1) file-read-data /private/tmp/bar",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70647,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70647)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70647\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/tmp/bar",
              "start": "2026-01-03 02:09:16",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434958966,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:16",
          "observer_window_end": "2026-01-03 02:09:20",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70650}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70650}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434958.968907,
        "cmd_finished_at_unix_s": 1767434958.980204,
        "cmd_duration_s": 0.011296987533569336,
        "cmd_pid": 70650,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70650",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:16",
            "--end",
            "2026-01-03 02:09:20",
            "--row-id",
            "vfs_tmp_only:read_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_tmp_only.read__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "70650",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1413,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:19.000433-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70650) deny(1) file-read-data /private/tmp/bar"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:20",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:19.000433-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70650) deny(1) file-read-data /private/tmp/bar",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70650,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70650)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70650\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/tmp/bar",
              "start": "2026-01-03 02:09:16",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434959130,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:16",
          "observer_window_end": "2026-01-03 02:09:20",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_tmp_only:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70653}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70653}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434959.132214,
        "cmd_finished_at_unix_s": 1767434959.143536,
        "cmd_duration_s": 0.011322021484375,
        "cmd_pid": 70653,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70653",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:17",
            "--end",
            "2026-01-03 02:09:21",
            "--row-id",
            "vfs_tmp_only:write_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_tmp_only.write__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "70653",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1408,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:19.163771-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70653) deny(1) file-write-data /private/tmp/bar"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:19.163771-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70653) deny(1) file-write-data /private/tmp/bar",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70653,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70653)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70653\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/tmp/bar",
              "start": "2026-01-03 02:09:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434959284,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:17",
          "observer_window_end": "2026-01-03 02:09:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70656}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70656}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434959.287006,
        "cmd_finished_at_unix_s": 1767434959.2982578,
        "cmd_duration_s": 0.01125192642211914,
        "cmd_pid": 70656,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70656",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:17",
            "--end",
            "2026-01-03 02:09:21",
            "--row-id",
            "vfs_tmp_only:write_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_tmp_only.write__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "70656",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1416,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:19.318486-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70656) deny(1) file-write-data /private/tmp/bar"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:19.318486-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70656) deny(1) file-write-data /private/tmp/bar",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70656,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70656)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70656\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/tmp/bar",
              "start": "2026-01-03 02:09:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434959445,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:17",
          "observer_window_end": "2026-01-03 02:09:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70659}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70659}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434959.447917,
        "cmd_finished_at_unix_s": 1767434959.459079,
        "cmd_duration_s": 0.011162042617797852,
        "cmd_pid": 70659,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70659",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:17",
            "--end",
            "2026-01-03 02:09:21",
            "--row-id",
            "vfs_tmp_only:read_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_tmp_only.read__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "70659",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1432,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:19.479311-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70659) deny(1) file-read-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:19.479311-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70659) deny(1) file-read-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70659,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70659)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70659\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/tmp/nested/child",
              "start": "2026-01-03 02:09:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434959610,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:17",
          "observer_window_end": "2026-01-03 02:09:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70662}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70662}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434959.612308,
        "cmd_finished_at_unix_s": 1767434959.623672,
        "cmd_duration_s": 0.011363983154296875,
        "cmd_pid": 70662,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70662",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:17",
            "--end",
            "2026-01-03 02:09:21",
            "--row-id",
            "vfs_tmp_only:read_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_tmp_only.read__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "70662",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1440,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:19.643867-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70662) deny(1) file-read-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:19.643867-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70662) deny(1) file-read-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70662,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70662)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70662\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/tmp/nested/child",
              "start": "2026-01-03 02:09:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434959776,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:17",
          "observer_window_end": "2026-01-03 02:09:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70665}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70665}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434959.778225,
        "cmd_finished_at_unix_s": 1767434959.789516,
        "cmd_duration_s": 0.011291027069091797,
        "cmd_pid": 70665,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70665",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:17",
            "--end",
            "2026-01-03 02:09:21",
            "--row-id",
            "vfs_tmp_only:write_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_tmp_only.write__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "70665",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1435,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:19.809746-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70665) deny(1) file-write-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:19.809746-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70665) deny(1) file-write-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70665,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70665)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70665\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/tmp/nested/child",
              "start": "2026-01-03 02:09:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434959943,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:17",
          "observer_window_end": "2026-01-03 02:09:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70678}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70678}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434959.9474401,
        "cmd_finished_at_unix_s": 1767434959.95918,
        "cmd_duration_s": 0.011739969253540039,
        "cmd_pid": 70678,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70678",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:17",
            "--end",
            "2026-01-03 02:09:21",
            "--row-id",
            "vfs_tmp_only:write_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_tmp_only.write__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "70678",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1443,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:19.979380-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70678) deny(1) file-write-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:21",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:19.979380-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70678) deny(1) file-write-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70678,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70678)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70678\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/tmp/nested/child",
              "start": "2026-01-03 02:09:17",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434960123,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:17",
          "observer_window_end": "2026-01-03 02:09:21",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70697}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70697}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434960.125398,
        "cmd_finished_at_unix_s": 1767434960.137027,
        "cmd_duration_s": 0.011629104614257812,
        "cmd_pid": 70697,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70697",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:18",
            "--end",
            "2026-01-03 02:09:22",
            "--row-id",
            "vfs_tmp_only:read_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_tmp_only.read__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "70697",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1395,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:20.157209-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70697) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:22",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:20.157209-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70697) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70697,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70697)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70697\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/var/tmp/canon",
              "start": "2026-01-03 02:09:18",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434960309,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:18",
          "observer_window_end": "2026-01-03 02:09:22",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70703}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70703}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434960.311847,
        "cmd_finished_at_unix_s": 1767434960.323544,
        "cmd_duration_s": 0.011697053909301758,
        "cmd_pid": 70703,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70703",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:18",
            "--end",
            "2026-01-03 02:09:22",
            "--row-id",
            "vfs_tmp_only:read_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_tmp_only.read__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "70703",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1431,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:20.343698-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70703) deny(1) file-read-data /private/var/tmp/canon"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:22",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:20.343698-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70703) deny(1) file-read-data /private/var/tmp/canon",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70703,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70703)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70703\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/var/tmp/canon",
              "start": "2026-01-03 02:09:18",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434960483,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:18",
          "observer_window_end": "2026-01-03 02:09:22",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70706}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70706}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434960.485921,
        "cmd_finished_at_unix_s": 1767434960.49756,
        "cmd_duration_s": 0.011639118194580078,
        "cmd_pid": 70706,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70706",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:18",
            "--end",
            "2026-01-03 02:09:22",
            "--row-id",
            "vfs_tmp_only:write_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_tmp_only.write__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "70706",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1396,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:20.517750-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70706) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:22",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:20.517750-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70706) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70706,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70706)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70706\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/var/tmp/canon",
              "start": "2026-01-03 02:09:18",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434960657,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:18",
          "observer_window_end": "2026-01-03 02:09:22",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70710}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":70710}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434960.6599329,
        "cmd_finished_at_unix_s": 1767434960.671251,
        "cmd_duration_s": 0.011318206787109375,
        "cmd_pid": 70710,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70710",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:18",
            "--end",
            "2026-01-03 02:09:22",
            "--row-id",
            "vfs_tmp_only:write_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_tmp_only.write__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "70710",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1434,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:20.691516-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70710) deny(1) file-write-data /private/var/tmp/canon"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:22",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:20.691516-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70710) deny(1) file-write-data /private/var/tmp/canon",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70710,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70710)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70710\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/var/tmp/canon",
              "start": "2026-01-03 02:09:18",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434960859,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:18",
          "observer_window_end": "2026-01-03 02:09:22",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_private_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_private_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70713}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70713}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434960.86285,
        "cmd_finished_at_unix_s": 1767434960.874044,
        "cmd_duration_s": 0.011193990707397461,
        "cmd_pid": 70713,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70713",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:18",
            "--end",
            "2026-01-03 02:09:22",
            "--row-id",
            "vfs_private_tmp_only:read_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only.read__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "70713",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1130,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:22",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70713,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70713)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70713\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/tmp/foo",
              "start": "2026-01-03 02:09:18",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434961042,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:18",
          "observer_window_end": "2026-01-03 02:09:22",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70716}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70716}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434961.044481,
        "cmd_finished_at_unix_s": 1767434961.055758,
        "cmd_duration_s": 0.011276960372924805,
        "cmd_pid": 70716,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70716",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:19",
            "--end",
            "2026-01-03 02:09:23",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only.read__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "70716",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1138,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70716,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70716)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70716\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/foo",
              "start": "2026-01-03 02:09:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434961203,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:19",
          "observer_window_end": "2026-01-03 02:09:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70719}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70719}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434961.205482,
        "cmd_finished_at_unix_s": 1767434961.216765,
        "cmd_duration_s": 0.011282920837402344,
        "cmd_pid": 70719,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70719",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:19",
            "--end",
            "2026-01-03 02:09:23",
            "--row-id",
            "vfs_private_tmp_only:write_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only.write__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "70719",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1131,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70719,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70719)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70719\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/tmp/foo",
              "start": "2026-01-03 02:09:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434961367,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:19",
          "observer_window_end": "2026-01-03 02:09:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70723}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70723}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434961.369733,
        "cmd_finished_at_unix_s": 1767434961.3811672,
        "cmd_duration_s": 0.011434078216552734,
        "cmd_pid": 70723,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70723",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:19",
            "--end",
            "2026-01-03 02:09:23",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only.write__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "70723",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70723,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70723)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70723\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/foo",
              "start": "2026-01-03 02:09:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434961528,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:19",
          "observer_window_end": "2026-01-03 02:09:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70726}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70726}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434961.5306659,
        "cmd_finished_at_unix_s": 1767434961.542084,
        "cmd_duration_s": 0.01141810417175293,
        "cmd_pid": 70726,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70726",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:19",
            "--end",
            "2026-01-03 02:09:23",
            "--row-id",
            "vfs_private_tmp_only:read_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only.read__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "70726",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1130,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70726,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70726)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70726\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/tmp/bar",
              "start": "2026-01-03 02:09:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434961694,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:19",
          "observer_window_end": "2026-01-03 02:09:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70729}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70729}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434961.697075,
        "cmd_finished_at_unix_s": 1767434961.708375,
        "cmd_duration_s": 0.011300086975097656,
        "cmd_pid": 70729,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70729",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:19",
            "--end",
            "2026-01-03 02:09:23",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only.read__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "70729",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1138,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70729,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70729)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70729\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/bar",
              "start": "2026-01-03 02:09:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434961863,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:19",
          "observer_window_end": "2026-01-03 02:09:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70733}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70733}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434961.86563,
        "cmd_finished_at_unix_s": 1767434961.87715,
        "cmd_duration_s": 0.011520147323608398,
        "cmd_pid": 70733,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70733",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:19",
            "--end",
            "2026-01-03 02:09:23",
            "--row-id",
            "vfs_private_tmp_only:write_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only.write__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "70733",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1131,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:23",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70733,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70733)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70733\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/tmp/bar",
              "start": "2026-01-03 02:09:19",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434962065,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:19",
          "observer_window_end": "2026-01-03 02:09:23",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70736}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70736}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434962.067564,
        "cmd_finished_at_unix_s": 1767434962.0789719,
        "cmd_duration_s": 0.011407852172851562,
        "cmd_pid": 70736,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70736",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:20",
            "--end",
            "2026-01-03 02:09:24",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only.write__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "70736",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70736,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70736)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70736\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/bar",
              "start": "2026-01-03 02:09:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434962211,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:20",
          "observer_window_end": "2026-01-03 02:09:24",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70739}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70739}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434962.213206,
        "cmd_finished_at_unix_s": 1767434962.224544,
        "cmd_duration_s": 0.011337995529174805,
        "cmd_pid": 70739,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70739",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:20",
            "--end",
            "2026-01-03 02:09:24",
            "--row-id",
            "vfs_private_tmp_only:read_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only.read__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "70739",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70739,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70739)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70739\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/tmp/nested/child",
              "start": "2026-01-03 02:09:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434962356,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:20",
          "observer_window_end": "2026-01-03 02:09:24",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70743}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70743}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434962.358892,
        "cmd_finished_at_unix_s": 1767434962.370118,
        "cmd_duration_s": 0.01122593879699707,
        "cmd_pid": 70743,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70743",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:20",
            "--end",
            "2026-01-03 02:09:24",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only.read__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "70743",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1147,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70743,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70743)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70743\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/child",
              "start": "2026-01-03 02:09:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434962513,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:20",
          "observer_window_end": "2026-01-03 02:09:24",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70746}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70746}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434962.515826,
        "cmd_finished_at_unix_s": 1767434962.527325,
        "cmd_duration_s": 0.01149892807006836,
        "cmd_pid": 70746,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70746",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:20",
            "--end",
            "2026-01-03 02:09:24",
            "--row-id",
            "vfs_private_tmp_only:write_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only.write__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "70746",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1140,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70746,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70746)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70746\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/tmp/nested/child",
              "start": "2026-01-03 02:09:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434962662,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:20",
          "observer_window_end": "2026-01-03 02:09:24",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70749}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70749}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434962.6648169,
        "cmd_finished_at_unix_s": 1767434962.676223,
        "cmd_duration_s": 0.011406183242797852,
        "cmd_pid": 70749,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70749",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:20",
            "--end",
            "2026-01-03 02:09:24",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only.write__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "70749",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1148,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70749,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70749)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70749\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/child",
              "start": "2026-01-03 02:09:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434962817,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:20",
          "observer_window_end": "2026-01-03 02:09:24",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70752}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70752}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434962.8195899,
        "cmd_finished_at_unix_s": 1767434962.830857,
        "cmd_duration_s": 0.01126718521118164,
        "cmd_pid": 70752,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70752",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:20",
            "--end",
            "2026-01-03 02:09:24",
            "--row-id",
            "vfs_private_tmp_only:read_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only.read__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "70752",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1403,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:22.851196-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70752) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:22.851196-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70752) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70752,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70752)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70752\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/var/tmp/canon",
              "start": "2026-01-03 02:09:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434962971,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:20",
          "observer_window_end": "2026-01-03 02:09:24",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks var tmp canon\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70756}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70756}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:111259441\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434962.973809,
        "cmd_finished_at_unix_s": 1767434962.985141,
        "cmd_duration_s": 0.011332035064697266,
        "cmd_pid": 70756,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70756",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:20",
            "--end",
            "2026-01-03 02:09:24",
            "--row-id",
            "vfs_private_tmp_only:read_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only.read__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "70756",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1144,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:24",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70756,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70756)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70756\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/var/tmp/canon",
              "start": "2026-01-03 02:09:20",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434963130,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:20",
          "observer_window_end": "2026-01-03 02:09:24",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70759}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70759}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434963.132972,
        "cmd_finished_at_unix_s": 1767434963.144247,
        "cmd_duration_s": 0.011275053024291992,
        "cmd_pid": 70759,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70759",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:21",
            "--end",
            "2026-01-03 02:09:25",
            "--row-id",
            "vfs_private_tmp_only:write_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only.write__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "70759",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1404,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:23.164602-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70759) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:23.164602-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70759) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70759,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70759)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70759\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/var/tmp/canon",
              "start": "2026-01-03 02:09:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434963261,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:21",
          "observer_window_end": "2026-01-03 02:09:25",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70762}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":70762}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:111259441\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434963.2633102,
        "cmd_finished_at_unix_s": 1767434963.274503,
        "cmd_duration_s": 0.011192798614501953,
        "cmd_pid": 70762,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70762",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:21",
            "--end",
            "2026-01-03 02:09:25",
            "--row-id",
            "vfs_private_tmp_only:write_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only.write__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "70762",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1145,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70762,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70762)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70762\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/var/tmp/canon",
              "start": "2026-01-03 02:09:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434963392,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:21",
          "observer_window_end": "2026-01-03 02:09:25",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_both_paths": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_both_paths.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_both_paths:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70766}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70766}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434963.3962991,
        "cmd_finished_at_unix_s": 1767434963.4077709,
        "cmd_duration_s": 0.011471748352050781,
        "cmd_pid": 70766,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70766",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:21",
            "--end",
            "2026-01-03 02:09:25",
            "--row-id",
            "vfs_both_paths:read_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_both_paths.read__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "70766",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1124,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70766,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70766)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70766\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/tmp/foo",
              "start": "2026-01-03 02:09:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434963527,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:21",
          "observer_window_end": "2026-01-03 02:09:25",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_both_paths:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70769}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70769}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434963.529433,
        "cmd_finished_at_unix_s": 1767434963.54078,
        "cmd_duration_s": 0.011347055435180664,
        "cmd_pid": 70769,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70769",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:21",
            "--end",
            "2026-01-03 02:09:25",
            "--row-id",
            "vfs_both_paths:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_both_paths.read__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "70769",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1132,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70769,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70769)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70769\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/tmp/foo",
              "start": "2026-01-03 02:09:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434963655,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:21",
          "observer_window_end": "2026-01-03 02:09:25",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_both_paths:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70772}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70772}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434963.6578078,
        "cmd_finished_at_unix_s": 1767434963.669291,
        "cmd_duration_s": 0.011483192443847656,
        "cmd_pid": 70772,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70772",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:21",
            "--end",
            "2026-01-03 02:09:25",
            "--row-id",
            "vfs_both_paths:write_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_both_paths.write__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "70772",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1125,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70772,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70772)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70772\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/tmp/foo",
              "start": "2026-01-03 02:09:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434963786,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:21",
          "observer_window_end": "2026-01-03 02:09:25",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_both_paths:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70775}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70775}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434963.788198,
        "cmd_finished_at_unix_s": 1767434963.799607,
        "cmd_duration_s": 0.01140904426574707,
        "cmd_pid": 70775,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70775",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:21",
            "--end",
            "2026-01-03 02:09:25",
            "--row-id",
            "vfs_both_paths:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_both_paths.write__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "70775",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1133,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70775,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70775)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70775\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/tmp/foo",
              "start": "2026-01-03 02:09:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434963918,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:21",
          "observer_window_end": "2026-01-03 02:09:25",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_both_paths:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70779}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70779}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434963.921085,
        "cmd_finished_at_unix_s": 1767434963.9326668,
        "cmd_duration_s": 0.011581897735595703,
        "cmd_pid": 70779,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70779",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:21",
            "--end",
            "2026-01-03 02:09:25",
            "--row-id",
            "vfs_both_paths:read_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_both_paths.read__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "70779",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1124,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:25",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70779,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70779)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70779\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/tmp/bar",
              "start": "2026-01-03 02:09:21",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434964051,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:21",
          "observer_window_end": "2026-01-03 02:09:25",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_both_paths:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70782}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70782}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434964.0540102,
        "cmd_finished_at_unix_s": 1767434964.065498,
        "cmd_duration_s": 0.011487960815429688,
        "cmd_pid": 70782,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70782",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:22",
            "--end",
            "2026-01-03 02:09:26",
            "--row-id",
            "vfs_both_paths:read_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_both_paths.read__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "70782",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1132,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70782,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70782)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70782\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/tmp/bar",
              "start": "2026-01-03 02:09:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434964184,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:22",
          "observer_window_end": "2026-01-03 02:09:26",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_both_paths:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70785}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70785}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434964.186486,
        "cmd_finished_at_unix_s": 1767434964.1978948,
        "cmd_duration_s": 0.011408805847167969,
        "cmd_pid": 70785,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70785",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:22",
            "--end",
            "2026-01-03 02:09:26",
            "--row-id",
            "vfs_both_paths:write_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_both_paths.write__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "70785",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1125,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70785,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70785)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70785\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/tmp/bar",
              "start": "2026-01-03 02:09:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434964311,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:22",
          "observer_window_end": "2026-01-03 02:09:26",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_both_paths:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70788}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70788}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401834\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434964.3135,
        "cmd_finished_at_unix_s": 1767434964.325108,
        "cmd_duration_s": 0.011608123779296875,
        "cmd_pid": 70788,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70788",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:22",
            "--end",
            "2026-01-03 02:09:26",
            "--row-id",
            "vfs_both_paths:write_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_both_paths.write__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "70788",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1133,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70788,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70788)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70788\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/tmp/bar",
              "start": "2026-01-03 02:09:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434964443,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:22",
          "observer_window_end": "2026-01-03 02:09:26",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_both_paths:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70792}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70792}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434964.445786,
        "cmd_finished_at_unix_s": 1767434964.457373,
        "cmd_duration_s": 0.011586904525756836,
        "cmd_pid": 70792,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70792",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:22",
            "--end",
            "2026-01-03 02:09:26",
            "--row-id",
            "vfs_both_paths:read_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_both_paths.read__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "70792",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1133,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70792,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70792)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70792\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/tmp/nested/child",
              "start": "2026-01-03 02:09:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434964578,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:22",
          "observer_window_end": "2026-01-03 02:09:26",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_both_paths:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70795}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70795}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434964.580384,
        "cmd_finished_at_unix_s": 1767434964.59191,
        "cmd_duration_s": 0.011525869369506836,
        "cmd_pid": 70795,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70795",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:22",
            "--end",
            "2026-01-03 02:09:26",
            "--row-id",
            "vfs_both_paths:read_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_both_paths.read__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "70795",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1141,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70795,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70795)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70795\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/tmp/nested/child",
              "start": "2026-01-03 02:09:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434964714,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:22",
          "observer_window_end": "2026-01-03 02:09:26",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_both_paths:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70798}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70798}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434964.7163782,
        "cmd_finished_at_unix_s": 1767434964.727919,
        "cmd_duration_s": 0.011540889739990234,
        "cmd_pid": 70798,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70798",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:22",
            "--end",
            "2026-01-03 02:09:26",
            "--row-id",
            "vfs_both_paths:write_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_both_paths.write__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "70798",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1134,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70798,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70798)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70798\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/tmp/nested/child",
              "start": "2026-01-03 02:09:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434964854,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:22",
          "observer_window_end": "2026-01-03 02:09:26",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_both_paths:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70801}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70801}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401837\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434964.856446,
        "cmd_finished_at_unix_s": 1767434964.8677068,
        "cmd_duration_s": 0.011260747909545898,
        "cmd_pid": 70801,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70801",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:22",
            "--end",
            "2026-01-03 02:09:26",
            "--row-id",
            "vfs_both_paths:write_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_both_paths.write__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "70801",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1142,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:26",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70801,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70801)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70801\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/tmp/nested/child",
              "start": "2026-01-03 02:09:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434964996,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:22",
          "observer_window_end": "2026-01-03 02:09:26",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_both_paths:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70805}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70805}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434964.999022,
        "cmd_finished_at_unix_s": 1767434965.010263,
        "cmd_duration_s": 0.011240959167480469,
        "cmd_pid": 70805,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70805",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:22",
            "--end",
            "2026-01-03 02:09:27",
            "--row-id",
            "vfs_both_paths:read_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_both_paths.read__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "70805",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1130,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70805,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70805)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70805\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/var/tmp/canon",
              "start": "2026-01-03 02:09:22",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434965140,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:22",
          "observer_window_end": "2026-01-03 02:09:27",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_both_paths:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks var tmp canon\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70808}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70808}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:111259441\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434965.142362,
        "cmd_finished_at_unix_s": 1767434965.153894,
        "cmd_duration_s": 0.011531829833984375,
        "cmd_pid": 70808,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70808",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:23",
            "--end",
            "2026-01-03 02:09:27",
            "--row-id",
            "vfs_both_paths:read_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_both_paths.read__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "70808",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1138,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70808,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70808)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70808\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/var/tmp/canon",
              "start": "2026-01-03 02:09:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434965284,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:23",
          "observer_window_end": "2026-01-03 02:09:27",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_both_paths:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70811}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70811}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434965.287068,
        "cmd_finished_at_unix_s": 1767434965.298568,
        "cmd_duration_s": 0.011500120162963867,
        "cmd_pid": 70811,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70811",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:23",
            "--end",
            "2026-01-03 02:09:27",
            "--row-id",
            "vfs_both_paths:write_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_both_paths.write__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "70811",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1131,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70811,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70811)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70811\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/var/tmp/canon",
              "start": "2026-01-03 02:09:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434965425,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:23",
          "observer_window_end": "2026-01-03 02:09:27",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_both_paths:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70814}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":70814}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:111259441\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434965.4277918,
        "cmd_finished_at_unix_s": 1767434965.439667,
        "cmd_duration_s": 0.011875152587890625,
        "cmd_pid": 70814,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70814",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:23",
            "--end",
            "2026-01-03 02:09:27",
            "--row-id",
            "vfs_both_paths:write_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_both_paths.write__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "70814",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70814,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70814)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70814\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/var/tmp/canon",
              "start": "2026-01-03 02:09:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434965572,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:23",
          "observer_window_end": "2026-01-03 02:09:27",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_private_tmp_only_openat": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_private_tmp_only_openat.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_open_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_open_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":70818}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":70818}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434965.576229,
        "cmd_finished_at_unix_s": 1767434965.587588,
        "cmd_duration_s": 0.011358976364135742,
        "cmd_pid": 70818,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70818",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:23",
            "--end",
            "2026-01-03 02:09:27",
            "--row-id",
            "vfs_private_tmp_only_openat:read_open_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only_openat.read_open__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "70818",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_open_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1142,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70818,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70818)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70818\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat:read_open_/tmp/foo",
              "start": "2026-01-03 02:09:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434965721,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:23",
          "observer_window_end": "2026-01-03 02:09:27",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":70821}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":70821}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434965.72365,
        "cmd_finished_at_unix_s": 1767434965.735133,
        "cmd_duration_s": 0.011482954025268555,
        "cmd_pid": 70821,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70821",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:23",
            "--end",
            "2026-01-03 02:09:27",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only_openat.read_openat__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "70821",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1144,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70821,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70821)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70821\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo",
              "start": "2026-01-03 02:09:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434965866,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:23",
          "observer_window_end": "2026-01-03 02:09:27",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_open_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_open_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":70824}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":70824}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434965.869051,
        "cmd_finished_at_unix_s": 1767434965.8803608,
        "cmd_duration_s": 0.01130986213684082,
        "cmd_pid": 70824,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70824",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:23",
            "--end",
            "2026-01-03 02:09:27",
            "--row-id",
            "vfs_private_tmp_only_openat:read_open_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only_openat.read_open__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "70824",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_open_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70824,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70824)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70824\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat:read_open_/private/tmp/foo",
              "start": "2026-01-03 02:09:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434966028,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:23",
          "observer_window_end": "2026-01-03 02:09:27",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":70829}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":70829}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117401832\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434966.030945,
        "cmd_finished_at_unix_s": 1767434966.0425138,
        "cmd_duration_s": 0.011568784713745117,
        "cmd_pid": 70829,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70829",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:24",
            "--end",
            "2026-01-03 02:09:28",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_private_tmp_only_openat.read_openat__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "70829",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1152,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70829,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70829)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70829\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo",
              "start": "2026-01-03 02:09:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434966194,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:24",
          "observer_window_end": "2026-01-03 02:09:28",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_var_tmp_alias_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_alias_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":70832}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":70832}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434966.1975522,
        "cmd_finished_at_unix_s": 1767434966.209025,
        "cmd_duration_s": 0.011472702026367188,
        "cmd_pid": 70832,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70832",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:24",
            "--end",
            "2026-01-03 02:09:28",
            "--row-id",
            "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_alias_only.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70832",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1148,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70832,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70832)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70832\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434966366,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:24",
          "observer_window_end": "2026-01-03 02:09:28",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":70835}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":70835}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434966.3689349,
        "cmd_finished_at_unix_s": 1767434966.380358,
        "cmd_duration_s": 0.011423110961914062,
        "cmd_pid": 70835,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70835",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:24",
            "--end",
            "2026-01-03 02:09:28",
            "--row-id",
            "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_alias_only.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70835",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1149,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70835,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70835)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70835\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434966541,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:24",
          "observer_window_end": "2026-01-03 02:09:28",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":70839}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":70839}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434966.543561,
        "cmd_finished_at_unix_s": 1767434966.554962,
        "cmd_duration_s": 0.011400938034057617,
        "cmd_pid": 70839,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70839",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:24",
            "--end",
            "2026-01-03 02:09:28",
            "--row-id",
            "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_alias_only.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70839",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1471,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:26.575403-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70839) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:26.575403-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70839) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70839,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70839)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70839\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434966708,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:24",
          "observer_window_end": "2026-01-03 02:09:28",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":70842}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":70842}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434966.711091,
        "cmd_finished_at_unix_s": 1767434966.722524,
        "cmd_duration_s": 0.011432886123657227,
        "cmd_pid": 70842,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70842",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:24",
            "--end",
            "2026-01-03 02:09:28",
            "--row-id",
            "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_alias_only.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70842",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1474,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:26.742986-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70842) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:26.742986-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70842) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70842,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70842)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70842\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434966878,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:24",
          "observer_window_end": "2026-01-03 02:09:28",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":70845}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":70845}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434966.880723,
        "cmd_finished_at_unix_s": 1767434966.892137,
        "cmd_duration_s": 0.011414051055908203,
        "cmd_pid": 70845,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70845",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:24",
            "--end",
            "2026-01-03 02:09:28",
            "--row-id",
            "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_alias_only.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70845",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1491,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:26.912594-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70845) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:28",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:26.912594-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70845) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70845,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70845)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70845\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:24",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434967049,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:24",
          "observer_window_end": "2026-01-03 02:09:28",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":70849}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":70849}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434967.05172,
        "cmd_finished_at_unix_s": 1767434967.063154,
        "cmd_duration_s": 0.011434078216552734,
        "cmd_pid": 70849,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70849",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:25",
            "--end",
            "2026-01-03 02:09:29",
            "--row-id",
            "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_alias_only.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70849",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1494,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:27.083624-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70849) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:27.083624-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70849) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70849,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70849)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70849\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434967210,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:25",
          "observer_window_end": "2026-01-03 02:09:29",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_var_tmp_private_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":70852}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":70852}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434967.213804,
        "cmd_finished_at_unix_s": 1767434967.225142,
        "cmd_duration_s": 0.011337995529174805,
        "cmd_pid": 70852,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70852",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:25",
            "--end",
            "2026-01-03 02:09:29",
            "--row-id",
            "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_private_only.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70852",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1417,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:27.245601-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70852) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:27.245601-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70852) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70852,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70852)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70852\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434967385,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:25",
          "observer_window_end": "2026-01-03 02:09:29",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":70855}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":70855}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434967.387697,
        "cmd_finished_at_unix_s": 1767434967.3989298,
        "cmd_duration_s": 0.011232852935791016,
        "cmd_pid": 70855,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70855",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:25",
            "--end",
            "2026-01-03 02:09:29",
            "--row-id",
            "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_private_only.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70855",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1418,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:27.419393-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70855) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:27.419393-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70855) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70855,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70855)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70855\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434967556,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:25",
          "observer_window_end": "2026-01-03 02:09:29",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":70865}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":70865}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434967.559253,
        "cmd_finished_at_unix_s": 1767434967.5717509,
        "cmd_duration_s": 0.012497901916503906,
        "cmd_pid": 70865,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70865",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:25",
            "--end",
            "2026-01-03 02:09:29",
            "--row-id",
            "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_private_only.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70865",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1158,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70865,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70865)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70865\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434967734,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:25",
          "observer_window_end": "2026-01-03 02:09:29",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":70874}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":70874}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434967.736402,
        "cmd_finished_at_unix_s": 1767434967.747833,
        "cmd_duration_s": 0.011430978775024414,
        "cmd_pid": 70874,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70874",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:25",
            "--end",
            "2026-01-03 02:09:29",
            "--row-id",
            "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_private_only.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70874",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1159,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70874,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70874)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70874\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434967908,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:25",
          "observer_window_end": "2026-01-03 02:09:29",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":70877}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":70877}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434967.910959,
        "cmd_finished_at_unix_s": 1767434967.922296,
        "cmd_duration_s": 0.011337041854858398,
        "cmd_pid": 70877,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70877",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:25",
            "--end",
            "2026-01-03 02:09:29",
            "--row-id",
            "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_private_only.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70877",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1178,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:29",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70877,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70877)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70877\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:25",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434968086,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:25",
          "observer_window_end": "2026-01-03 02:09:29",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":70880}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":70880}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434968.0888908,
        "cmd_finished_at_unix_s": 1767434968.10027,
        "cmd_duration_s": 0.011379241943359375,
        "cmd_pid": 70880,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70880",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:26",
            "--end",
            "2026-01-03 02:09:30",
            "--row-id",
            "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_private_only.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70880",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1179,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70880,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70880)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70880\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434968250,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:26",
          "observer_window_end": "2026-01-03 02:09:30",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_var_tmp_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":70883}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":70883}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434968.253885,
        "cmd_finished_at_unix_s": 1767434968.26526,
        "cmd_duration_s": 0.011374950408935547,
        "cmd_pid": 70883,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70883",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:26",
            "--end",
            "2026-01-03 02:09:30",
            "--row-id",
            "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_both.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70883",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1409,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:28.285735-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70883) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:28.285735-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70883) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70883,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70883)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70883\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434968410,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:26",
          "observer_window_end": "2026-01-03 02:09:30",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":70886}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":70886}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434968.4128509,
        "cmd_finished_at_unix_s": 1767434968.4242408,
        "cmd_duration_s": 0.011389970779418945,
        "cmd_pid": 70886,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70886",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:26",
            "--end",
            "2026-01-03 02:09:30",
            "--row-id",
            "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_both.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70886",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1410,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:28.444738-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70886) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:28.444738-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70886) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70886,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70886)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70886\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434968571,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:26",
          "observer_window_end": "2026-01-03 02:09:30",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":70889}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":70889}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434968.57367,
        "cmd_finished_at_unix_s": 1767434968.584857,
        "cmd_duration_s": 0.011187076568603516,
        "cmd_pid": 70889,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70889",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:26",
            "--end",
            "2026-01-03 02:09:30",
            "--row-id",
            "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_both.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70889",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70889,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70889)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70889\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434968730,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:26",
          "observer_window_end": "2026-01-03 02:09:30",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":70892}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":70892}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434968.733114,
        "cmd_finished_at_unix_s": 1767434968.744587,
        "cmd_duration_s": 0.011472940444946289,
        "cmd_pid": 70892,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70892",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:26",
            "--end",
            "2026-01-03 02:09:30",
            "--row-id",
            "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_both.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70892",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1151,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70892,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70892)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70892\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434968898,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:26",
          "observer_window_end": "2026-01-03 02:09:30",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":70895}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":70895}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434968.9002082,
        "cmd_finished_at_unix_s": 1767434968.911424,
        "cmd_duration_s": 0.011215686798095703,
        "cmd_pid": 70895,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70895",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:26",
            "--end",
            "2026-01-03 02:09:30",
            "--row-id",
            "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_both.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70895",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1170,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:30",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70895,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70895)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70895\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:26",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434969074,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:26",
          "observer_window_end": "2026-01-03 02:09:30",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":70898}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":70898}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434969.0765681,
        "cmd_finished_at_unix_s": 1767434969.087886,
        "cmd_duration_s": 0.011317968368530273,
        "cmd_pid": 70898,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70898",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:27",
            "--end",
            "2026-01-03 02:09:31",
            "--row-id",
            "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_both.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70898",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1171,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70898,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70898)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70898\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434969236,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:27",
          "observer_window_end": "2026-01-03 02:09:31",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_var_tmp_both_plus_metadata_var": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_both_plus_metadata_var.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/var",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:lstat_/var",
        "operation": "file-read-metadata",
        "path": "/var",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "canonicalization": "raw",
              "canonical_flag_reason": "not_requested",
              "no_report_reason": null,
              "tool": "seatbelt-callout",
              "operation": "file-read-metadata",
              "filter_type": 0,
              "varargs_count": 1,
              "stage": "pre_syscall",
              "check_type": 1073741824,
              "token_status": "ok",
              "decision": "deny",
              "rc": 1,
              "api": "sandbox_check_by_audit_token",
              "errno": 0,
              "token_mach_kr": 0,
              "error": null,
              "filter_type_name": "path",
              "argument": "/var",
              "canonical_flag_used": false,
              "marker_schema_version": 2,
              "no_report": true
            },
            {
              "canonicalization": "canonical",
              "canonical_flag_reason": null,
              "no_report_reason": null,
              "tool": "seatbelt-callout",
              "operation": "file-read-metadata",
              "filter_type": 0,
              "varargs_count": 1,
              "stage": "pre_syscall",
              "check_type": 1610612736,
              "token_status": "ok",
              "decision": "deny",
              "rc": 1,
              "api": "sandbox_check_by_audit_token",
              "errno": 0,
              "token_mach_kr": 0,
              "error": null,
              "filter_type_name": "path",
              "argument": "/var",
              "canonical_flag_used": true,
              "marker_schema_version": 2,
              "no_report": true
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/var"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"err_class_source\":\"none\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/8219d563-fbe7-463c-b46a-1c7c2fed5ce1\\/runtime_profiles\\/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":70901,\"marker_schema_version\":1,\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"errno\":0,\"err_class\":\"ok\",\"stage\":\"apply\",\"rc\":0,\"tool\":\"sbpl-apply\",\"errbuf\":null}\n{\"marker_schema_version\":1,\"api\":\"sandbox_init\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/8219d563-fbe7-463c-b46a-1c7c2fed5ce1\\/runtime_profiles\\/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":70901,\"mode\":\"sbpl\",\"tool\":\"sbpl-apply\",\"rc\":0,\"stage\":\"applied\"}\n{\"canonicalization\":\"raw\",\"canonical_flag_reason\":\"not_requested\",\"no_report_reason\":null,\"tool\":\"seatbelt-callout\",\"operation\":\"file-read-metadata\",\"filter_type\":0,\"varargs_count\":1,\"stage\":\"pre_syscall\",\"check_type\":1073741824,\"token_status\":\"ok\",\"decision\":\"deny\",\"rc\":1,\"api\":\"sandbox_check_by_audit_token\",\"errno\":0,\"token_mach_kr\":0,\"error\":null,\"filter_type_name\":\"path\",\"argument\":\"\\/var\",\"canonical_flag_used\":false,\"marker_schema_version\":2,\"no_report\":true}\n{\"canonicalization\":\"canonical\",\"canonical_flag_reason\":null,\"no_report_reason\":null,\"tool\":\"seatbelt-callout\",\"operation\":\"file-read-metadata\",\"filter_type\":0,\"varargs_count\":1,\"stage\":\"pre_syscall\",\"check_type\":1610612736,\"token_status\":\"ok\",\"decision\":\"deny\",\"rc\":1,\"api\":\"sandbox_check_by_audit_token\",\"errno\":0,\"token_mach_kr\":0,\"error\":null,\"filter_type_name\":\"path\",\"argument\":\"\\/var\",\"canonical_flag_used\":true,\"marker_schema_version\":2,\"no_report\":true}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 0,
          "errno_name": "OK",
          "message": "stat-ok",
          "op": "file-read-metadata",
          "path": "/var",
          "status": "ok",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767434969.2397,
        "cmd_finished_at_unix_s": 1767434969.5060139,
        "cmd_duration_s": 0.2663137912750244,
        "cmd_pid": 70901,
        "cmd_process_name": "metadata_runner",
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70901",
            "--process-name",
            "metadata_runner",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:27",
            "--end",
            "2026-01-03 02:09:31",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:lstat_/var"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_both_plus_metadata_var.lstat__var.observer.json",
          "log_write_error": null,
          "pid": "70901",
          "process_name": "metadata_runner",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:lstat_/var",
          "correlation_id": null,
          "stdout_bytes": 7875,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:29.523051-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/api/runtime/native/metadata_runner",
                "2026-01-03 02:09:29.523083-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/api/runtime/native/metadata_runner",
                "2026-01-03 02:09:29.523736-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:29.523829-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:29.523867-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:29.523872-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-metadata /Users/achyland",
                "2026-01-03 02:09:29.524159-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:29.524246-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:29.524637-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:29.524644-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:29.524703-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:29.524764-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:29.524768-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:29.524822-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:29.524878-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:29.524882-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:29.524934-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:29.524988-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:29.524991-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:29.525041-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:29.525395-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:29.523051-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/api/runtime/native/metadata_runner\n2026-01-03 02:09:29.523083-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/api/runtime/native/metadata_runner\n2026-01-03 02:09:29.523736-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:29.523829-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc\n2026-01-03 02:09:29.523867-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc\n2026-01-03 02:09:29.523872-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-metadata /Users/achyland\n2026-01-03 02:09:29.524159-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:29.524246-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc\n2026-01-03 02:09:29.524637-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc\n2026-01-03 02:09:29.524644-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:29.524703-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc\n2026-01-03 02:09:29.524764-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc\n2026-01-03 02:09:29.524768-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:29.524822-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc\n2026-01-03 02:09:29.524878-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc\n2026-01-03 02:09:29.524882-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:29.524934-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc\n2026-01-03 02:09:29.524988-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc\n2026-01-03 02:09:29.524991-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:29.525041-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc\n2026-01-03 02:09:29.525395-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(70901) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 22,
              "observer_schema_version": 1,
              "pid": 70901,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: metadata_runner(70901)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70901\")))",
              "process_name": "metadata_runner",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:lstat_/var",
              "start": "2026-01-03 02:09:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434969679,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:27",
          "observer_window_end": "2026-01-03 02:09:31",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":70904}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":70904}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434969.6823502,
        "cmd_finished_at_unix_s": 1767434969.693789,
        "cmd_duration_s": 0.011438846588134766,
        "cmd_pid": 70904,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70904",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:27",
            "--end",
            "2026-01-03 02:09:31",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_both_plus_metadata_var.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70904",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1160,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70904,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70904)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70904\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434969849,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:27",
          "observer_window_end": "2026-01-03 02:09:31",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":70907}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":70907}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434969.851378,
        "cmd_finished_at_unix_s": 1767434969.86289,
        "cmd_duration_s": 0.011512041091918945,
        "cmd_pid": 70907,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70907",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:27",
            "--end",
            "2026-01-03 02:09:31",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_both_plus_metadata_var.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70907",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1161,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:31",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70907,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70907)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70907\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:27",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434970020,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:27",
          "observer_window_end": "2026-01-03 02:09:31",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":70910}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":70910}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434970.0224729,
        "cmd_finished_at_unix_s": 1767434970.03393,
        "cmd_duration_s": 0.011457204818725586,
        "cmd_pid": 70910,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70910",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:28",
            "--end",
            "2026-01-03 02:09:32",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_both_plus_metadata_var.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70910",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1168,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:32",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70910,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70910)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70910\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:28",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434970178,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:28",
          "observer_window_end": "2026-01-03 02:09:32",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":70913}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":70913}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181447\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434970.180989,
        "cmd_finished_at_unix_s": 1767434970.19252,
        "cmd_duration_s": 0.011530876159667969,
        "cmd_pid": 70913,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70913",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:28",
            "--end",
            "2026-01-03 02:09:32",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_both_plus_metadata_var.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70913",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1169,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:32",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70913,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70913)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70913\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:28",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434970335,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:28",
          "observer_window_end": "2026-01-03 02:09:32",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_var_tmp_data_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_data_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":70916}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":70916}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434970.3391879,
        "cmd_finished_at_unix_s": 1767434970.350494,
        "cmd_duration_s": 0.011306047439575195,
        "cmd_pid": 70916,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70916",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:28",
            "--end",
            "2026-01-03 02:09:32",
            "--row-id",
            "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_data_only.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70916",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1414,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:30.371071-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70916) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:32",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:30.371071-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70916) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70916,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70916)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70916\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:28",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434970501,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:28",
          "observer_window_end": "2026-01-03 02:09:32",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":70919}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":70919}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434970.503198,
        "cmd_finished_at_unix_s": 1767434970.5144398,
        "cmd_duration_s": 0.011241912841796875,
        "cmd_pid": 70919,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70919",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:28",
            "--end",
            "2026-01-03 02:09:32",
            "--row-id",
            "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_data_only.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70919",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1148,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:32",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70919,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70919)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70919\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:28",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434970656,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:28",
          "observer_window_end": "2026-01-03 02:09:32",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":70922}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":70922}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434970.65854,
        "cmd_finished_at_unix_s": 1767434970.669788,
        "cmd_duration_s": 0.011247873306274414,
        "cmd_pid": 70922,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70922",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:28",
            "--end",
            "2026-01-03 02:09:32",
            "--row-id",
            "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_data_only.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70922",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1470,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:30.690371-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70922) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:32",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:30.690371-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70922) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70922,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70922)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70922\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:28",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434970821,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:28",
          "observer_window_end": "2026-01-03 02:09:32",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":70925}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":70925}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434970.8236952,
        "cmd_finished_at_unix_s": 1767434970.834841,
        "cmd_duration_s": 0.011145830154418945,
        "cmd_pid": 70925,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70925",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:28",
            "--end",
            "2026-01-03 02:09:32",
            "--row-id",
            "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_data_only.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70925",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1473,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:30.855422-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70925) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:32",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:30.855422-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70925) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70925,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70925)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70925\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:28",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434970985,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:28",
          "observer_window_end": "2026-01-03 02:09:32",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":70928}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":70928}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434970.98736,
        "cmd_finished_at_unix_s": 1767434970.99867,
        "cmd_duration_s": 0.011310100555419922,
        "cmd_pid": 70928,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70928",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:28",
            "--end",
            "2026-01-03 02:09:32",
            "--row-id",
            "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_data_only.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70928",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1490,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:31.019266-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70928) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:32",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:31.019266-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70928) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70928,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70928)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70928\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:28",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434971146,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:28",
          "observer_window_end": "2026-01-03 02:09:32",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":70931}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":70931}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434971.15885,
        "cmd_finished_at_unix_s": 1767434971.170175,
        "cmd_duration_s": 0.01132512092590332,
        "cmd_pid": 70931,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70931",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:29",
            "--end",
            "2026-01-03 02:09:33",
            "--row-id",
            "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_var_tmp_data_only.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "70931",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1493,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:31.190769-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70931) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:33",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:31.190769-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(70931) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70931,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70931)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70931\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 02:09:29",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434971310,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:29",
          "observer_window_end": "2026-01-03 02:09:33",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_etc_alias_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_alias_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_alias_only:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":70934}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":70934}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434971.313684,
        "cmd_finished_at_unix_s": 1767434971.3249788,
        "cmd_duration_s": 0.011294841766357422,
        "cmd_pid": 70934,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70934",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:29",
            "--end",
            "2026-01-03 02:09:33",
            "--row-id",
            "vfs_etc_alias_only:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_etc_alias_only.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "70934",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_alias_only:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1397,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:31.345579-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70934) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:33",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:31.345579-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70934) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70934,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70934)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70934\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_alias_only:read_/etc/hosts",
              "start": "2026-01-03 02:09:29",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434971538,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:29",
          "observer_window_end": "2026-01-03 02:09:33",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_alias_only:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":70941}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":70941}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434971.541064,
        "cmd_finished_at_unix_s": 1767434971.552274,
        "cmd_duration_s": 0.011209964752197266,
        "cmd_pid": 70941,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70941",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:29",
            "--end",
            "2026-01-03 02:09:33",
            "--row-id",
            "vfs_etc_alias_only:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_etc_alias_only.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "70941",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_alias_only:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1425,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:31.572835-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70941) deny(1) file-read-data /private/etc/hosts"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:33",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:31.572835-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70941) deny(1) file-read-data /private/etc/hosts",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70941,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70941)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70941\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_alias_only:read_/private/etc/hosts",
              "start": "2026-01-03 02:09:29",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434971709,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:29",
          "observer_window_end": "2026-01-03 02:09:33",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_etc_private_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_private_only:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":70944}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":70944}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434971.71237,
        "cmd_finished_at_unix_s": 1767434971.723545,
        "cmd_duration_s": 0.011175155639648438,
        "cmd_pid": 70944,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70944",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:29",
            "--end",
            "2026-01-03 02:09:33",
            "--row-id",
            "vfs_etc_private_only:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_etc_private_only.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "70944",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_private_only:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1399,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:31.744076-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70944) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:33",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:31.744076-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70944) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70944,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70944)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70944\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_private_only:read_/etc/hosts",
              "start": "2026-01-03 02:09:29",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434971880,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:29",
          "observer_window_end": "2026-01-03 02:09:33",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_private_only:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":70947}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":70947}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434971.88222,
        "cmd_finished_at_unix_s": 1767434971.893415,
        "cmd_duration_s": 0.011194944381713867,
        "cmd_pid": 70947,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70947",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:29",
            "--end",
            "2026-01-03 02:09:33",
            "--row-id",
            "vfs_etc_private_only:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_etc_private_only.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "70947",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_private_only:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1140,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:33",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70947,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70947)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70947\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_private_only:read_/private/etc/hosts",
              "start": "2026-01-03 02:09:29",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434972049,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:29",
          "observer_window_end": "2026-01-03 02:09:33",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_etc_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_both:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":70950}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":70950}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434972.05316,
        "cmd_finished_at_unix_s": 1767434972.0644171,
        "cmd_duration_s": 0.011257171630859375,
        "cmd_pid": 70950,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70950",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:30",
            "--end",
            "2026-01-03 02:09:34",
            "--row-id",
            "vfs_etc_both:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_etc_both.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "70950",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1391,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:32.085029-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70950) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:34",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:32.085029-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(70950) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 70950,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70950)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70950\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both:read_/etc/hosts",
              "start": "2026-01-03 02:09:30",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434972193,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:30",
          "observer_window_end": "2026-01-03 02:09:34",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_both:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":70953}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":70953}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434972.195659,
        "cmd_finished_at_unix_s": 1767434972.207017,
        "cmd_duration_s": 0.011358022689819336,
        "cmd_pid": 70953,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70953",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:30",
            "--end",
            "2026-01-03 02:09:34",
            "--row-id",
            "vfs_etc_both:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_etc_both.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "70953",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1132,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:34",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70953,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70953)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70953\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both:read_/private/etc/hosts",
              "start": "2026-01-03 02:09:30",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434972341,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:30",
          "observer_window_end": "2026-01-03 02:09:34",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_etc_both_plus_metadata_etc": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_both_plus_metadata_etc.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/etc",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:lstat_/etc",
        "operation": "file-read-metadata",
        "path": "/etc",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "decision": "deny",
              "rc": 1,
              "no_report": true,
              "operation": "file-read-metadata",
              "varargs_count": 1,
              "marker_schema_version": 2,
              "canonicalization": "raw",
              "stage": "pre_syscall",
              "errno": 0,
              "canonical_flag_reason": "not_requested",
              "error": null,
              "filter_type": 0,
              "api": "sandbox_check_by_audit_token",
              "argument": "/etc",
              "token_mach_kr": 0,
              "tool": "seatbelt-callout",
              "filter_type_name": "path",
              "check_type": 1073741824,
              "token_status": "ok",
              "canonical_flag_used": false,
              "no_report_reason": null
            },
            {
              "decision": "deny",
              "rc": 1,
              "no_report": true,
              "operation": "file-read-metadata",
              "varargs_count": 1,
              "marker_schema_version": 2,
              "canonicalization": "canonical",
              "stage": "pre_syscall",
              "errno": 0,
              "canonical_flag_reason": null,
              "error": null,
              "filter_type": 0,
              "api": "sandbox_check_by_audit_token",
              "argument": "/etc",
              "token_mach_kr": 0,
              "tool": "seatbelt-callout",
              "filter_type_name": "path",
              "check_type": 1610612736,
              "token_status": "ok",
              "canonical_flag_used": true,
              "no_report_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/etc",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/etc"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"err_class\":\"ok\",\"api\":\"sandbox_init\",\"pid\":70956,\"errbuf\":null,\"marker_schema_version\":1,\"stage\":\"apply\",\"rc\":0,\"errno\":0,\"mode\":\"sbpl\",\"tool\":\"sbpl-apply\",\"err_class_source\":\"none\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/8219d563-fbe7-463c-b46a-1c7c2fed5ce1\\/runtime_profiles\\/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\"}\n{\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/8219d563-fbe7-463c-b46a-1c7c2fed5ce1\\/runtime_profiles\\/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"api\":\"sandbox_init\",\"mode\":\"sbpl\",\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"pid\":70956,\"stage\":\"applied\",\"rc\":0}\n{\"decision\":\"deny\",\"rc\":1,\"no_report\":true,\"operation\":\"file-read-metadata\",\"varargs_count\":1,\"marker_schema_version\":2,\"canonicalization\":\"raw\",\"stage\":\"pre_syscall\",\"errno\":0,\"canonical_flag_reason\":\"not_requested\",\"error\":null,\"filter_type\":0,\"api\":\"sandbox_check_by_audit_token\",\"argument\":\"\\/etc\",\"token_mach_kr\":0,\"tool\":\"seatbelt-callout\",\"filter_type_name\":\"path\",\"check_type\":1073741824,\"token_status\":\"ok\",\"canonical_flag_used\":false,\"no_report_reason\":null}\n{\"decision\":\"deny\",\"rc\":1,\"no_report\":true,\"operation\":\"file-read-metadata\",\"varargs_count\":1,\"marker_schema_version\":2,\"canonicalization\":\"canonical\",\"stage\":\"pre_syscall\",\"errno\":0,\"canonical_flag_reason\":null,\"error\":null,\"filter_type\":0,\"api\":\"sandbox_check_by_audit_token\",\"argument\":\"\\/etc\",\"token_mach_kr\":0,\"tool\":\"seatbelt-callout\",\"filter_type_name\":\"path\",\"check_type\":1610612736,\"token_status\":\"ok\",\"canonical_flag_used\":true,\"no_report_reason\":null}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 0,
          "errno_name": "OK",
          "message": "stat-ok",
          "op": "file-read-metadata",
          "path": "/etc",
          "status": "ok",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767434972.344651,
        "cmd_finished_at_unix_s": 1767434972.359313,
        "cmd_duration_s": 0.014662027359008789,
        "cmd_pid": 70956,
        "cmd_process_name": "metadata_runner",
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/etc",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70956",
            "--process-name",
            "metadata_runner",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:30",
            "--end",
            "2026-01-03 02:09:34",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:lstat_/etc"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_etc_both_plus_metadata_etc.lstat__etc.observer.json",
          "log_write_error": null,
          "pid": "70956",
          "process_name": "metadata_runner",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:lstat_/etc",
          "correlation_id": null,
          "stdout_bytes": 8531,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:32.377202-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) sysctl-read kern.maxfilesperproc",
                "2026-01-03 02:09:32.378064-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/api/runtime/native/metadata_runner",
                "2026-01-03 02:09:32.378079-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/api/runtime/native/metadata_runner",
                "2026-01-03 02:09:32.378418-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:32.378486-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 02:09:32.378496-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 02:09:32.378509-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-metadata /Users/achyland",
                "2026-01-03 02:09:32.378639-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:32.378698-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 02:09:32.378707-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 02:09:32.378909-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:32.378955-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 02:09:32.378962-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 02:09:32.378994-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:32.379042-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 02:09:32.379050-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 02:09:32.379077-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:32.379121-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 02:09:32.379128-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 02:09:32.379157-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:32.379200-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 02:09:32.379206-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 02:09:32.379407-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:34",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:32.377202-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) sysctl-read kern.maxfilesperproc\n2026-01-03 02:09:32.378064-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/api/runtime/native/metadata_runner\n2026-01-03 02:09:32.378079-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/api/runtime/native/metadata_runner\n2026-01-03 02:09:32.378418-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:32.378486-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-data /private/etc/passwd\n2026-01-03 02:09:32.378496-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 02:09:32.378509-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-metadata /Users/achyland\n2026-01-03 02:09:32.378639-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:32.378698-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-data /private/etc/passwd\n2026-01-03 02:09:32.378707-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 02:09:32.378909-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:32.378955-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-data /private/etc/passwd\n2026-01-03 02:09:32.378962-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 02:09:32.378994-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:32.379042-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-data /private/etc/passwd\n2026-01-03 02:09:32.379050-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 02:09:32.379077-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:32.379121-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-data /private/etc/passwd\n2026-01-03 02:09:32.379128-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 02:09:32.379157-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:32.379200-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-data /private/etc/passwd\n2026-01-03 02:09:32.379206-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 02:09:32.379407-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(70956) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 24,
              "observer_schema_version": 1,
              "pid": 70956,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: metadata_runner(70956)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70956\")))",
              "process_name": "metadata_runner",
              "row_id": "vfs_etc_both_plus_metadata_etc:lstat_/etc",
              "start": "2026-01-03 02:09:30",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434972494,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:30",
          "observer_window_end": "2026-01-03 02:09:34",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":70959}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":70959}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434972.497354,
        "cmd_finished_at_unix_s": 1767434972.508728,
        "cmd_duration_s": 0.01137399673461914,
        "cmd_pid": 70959,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70959",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:30",
            "--end",
            "2026-01-03 02:09:34",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_etc_both_plus_metadata_etc.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "70959",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1142,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:34",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70959,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70959)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70959\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_/etc/hosts",
              "start": "2026-01-03 02:09:30",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434972644,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:30",
          "observer_window_end": "2026-01-03 02:09:34",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":70962}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":70962}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:79488775\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434972.646463,
        "cmd_finished_at_unix_s": 1767434972.657676,
        "cmd_duration_s": 0.011213064193725586,
        "cmd_pid": 70962,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70962",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:30",
            "--end",
            "2026-01-03 02:09:34",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_etc_both_plus_metadata_etc.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "70962",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:34",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70962,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70962)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70962\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts",
              "start": "2026-01-03 02:09:30",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434972789,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:30",
          "observer_window_end": "2026-01-03 02:09:34",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_firmlink_private_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "runtime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":70965}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":70965}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434972.7932348,
        "cmd_finished_at_unix_s": 1767434972.804585,
        "cmd_duration_s": 0.011350154876708984,
        "cmd_pid": 70965,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70965",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:30",
            "--end",
            "2026-01-03 02:09:34",
            "--row-id",
            "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_firmlink_private_only.read__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "70965",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1158,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:34",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70965,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70965)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70965\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 02:09:30",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434972944,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:30",
          "observer_window_end": "2026-01-03 02:09:34",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":70968}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":70968}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434972.946808,
        "cmd_finished_at_unix_s": 1767434972.958261,
        "cmd_duration_s": 0.011452913284301758,
        "cmd_pid": 70968,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70968",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:30",
            "--end",
            "2026-01-03 02:09:34",
            "--row-id",
            "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_firmlink_private_only.write__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "70968",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1159,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:34",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70968,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(70968)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70968\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 02:09:30",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434973100,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:30",
          "observer_window_end": "2026-01-03 02:09:34",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "runtime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":70997}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":70997}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434973.1023822,
        "cmd_finished_at_unix_s": 1767434973.113867,
        "cmd_duration_s": 0.011484861373901367,
        "cmd_pid": 70997,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "70997",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:31",
            "--end",
            "2026-01-03 02:09:35",
            "--row-id",
            "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_firmlink_private_only.read__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "70997",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1178,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:35",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 70997,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(70997)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"70997\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 02:09:31",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434973252,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:31",
          "observer_window_end": "2026-01-03 02:09:35",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":71006}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":71006}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434973.254681,
        "cmd_finished_at_unix_s": 1767434973.2661052,
        "cmd_duration_s": 0.011424064636230469,
        "cmd_pid": 71006,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71006",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:31",
            "--end",
            "2026-01-03 02:09:35",
            "--row-id",
            "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_firmlink_private_only.write__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "71006",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1179,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:35",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71006,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(71006)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71006\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 02:09:31",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434973410,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:31",
          "observer_window_end": "2026-01-03 02:09:35",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_firmlink_data_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_data_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":71009}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":71009}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434973.4134212,
        "cmd_finished_at_unix_s": 1767434973.424751,
        "cmd_duration_s": 0.011329889297485352,
        "cmd_pid": 71009,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71009",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:31",
            "--end",
            "2026-01-03 02:09:35",
            "--row-id",
            "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_firmlink_data_only.read__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "71009",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1468,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:33.445424-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(71009) deny(1) file-read-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:35",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:33.445424-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(71009) deny(1) file-read-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 71009,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(71009)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71009\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 02:09:31",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434973570,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:31",
          "observer_window_end": "2026-01-03 02:09:35",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":71012}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":71012}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434973.573237,
        "cmd_finished_at_unix_s": 1767434973.5844638,
        "cmd_duration_s": 0.011226892471313477,
        "cmd_pid": 71012,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71012",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:31",
            "--end",
            "2026-01-03 02:09:35",
            "--row-id",
            "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_firmlink_data_only.write__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "71012",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1471,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:33.605108-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(71012) deny(1) file-write-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:35",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:33.605108-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(71012) deny(1) file-write-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 71012,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(71012)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71012\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 02:09:31",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434973728,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:31",
          "observer_window_end": "2026-01-03 02:09:35",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":71015}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":71015}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434973.730603,
        "cmd_finished_at_unix_s": 1767434973.741801,
        "cmd_duration_s": 0.011198043823242188,
        "cmd_pid": 71015,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71015",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:31",
            "--end",
            "2026-01-03 02:09:35",
            "--row-id",
            "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_firmlink_data_only.read__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "71015",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1488,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:33.762448-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(71015) deny(1) file-read-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:35",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:33.762448-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(71015) deny(1) file-read-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 71015,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(71015)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71015\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 02:09:31",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434973888,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:31",
          "observer_window_end": "2026-01-03 02:09:35",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":71018}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":71018}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434973.891084,
        "cmd_finished_at_unix_s": 1767434973.902257,
        "cmd_duration_s": 0.011173009872436523,
        "cmd_pid": 71018,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71018",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:31",
            "--end",
            "2026-01-03 02:09:35",
            "--row-id",
            "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_firmlink_data_only.write__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "71018",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1491,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:33.922937-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(71018) deny(1) file-write-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:35",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:33.922937-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(71018) deny(1) file-write-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 71018,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(71018)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71018\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 02:09:31",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434974042,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:31",
          "observer_window_end": "2026-01-03 02:09:35",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_firmlink_both": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "runtime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":71021}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":71021}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434974.0458272,
        "cmd_finished_at_unix_s": 1767434974.057125,
        "cmd_duration_s": 0.011297941207885742,
        "cmd_pid": 71021,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71021",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:32",
            "--end",
            "2026-01-03 02:09:36",
            "--row-id",
            "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_firmlink_both.read__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "71021",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:36",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71021,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(71021)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71021\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 02:09:32",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434974184,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:32",
          "observer_window_end": "2026-01-03 02:09:36",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":71024}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":71024}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434974.186655,
        "cmd_finished_at_unix_s": 1767434974.198014,
        "cmd_duration_s": 0.011358976364135742,
        "cmd_pid": 71024,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71024",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:32",
            "--end",
            "2026-01-03 02:09:36",
            "--row-id",
            "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_firmlink_both.write__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "71024",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1151,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:36",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71024,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(71024)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71024\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 02:09:32",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434974321,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:32",
          "observer_window_end": "2026-01-03 02:09:36",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "runtime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":71027}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":71027}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434974.323355,
        "cmd_finished_at_unix_s": 1767434974.334534,
        "cmd_duration_s": 0.011178970336914062,
        "cmd_pid": 71027,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71027",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:32",
            "--end",
            "2026-01-03 02:09:36",
            "--row-id",
            "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_firmlink_both.read__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "71027",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1170,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:36",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71027,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(71027)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71027\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 02:09:32",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434974462,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:32",
          "observer_window_end": "2026-01-03 02:09:36",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":71030}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":71030}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:117970109\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434974.465152,
        "cmd_finished_at_unix_s": 1767434974.4765692,
        "cmd_duration_s": 0.011417150497436523,
        "cmd_pid": 71030,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71030",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:32",
            "--end",
            "2026-01-03 02:09:36",
            "--row-id",
            "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_firmlink_both.write__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "71030",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1171,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:36",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71030,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(71030)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71030\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 02:09:32",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434974603,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:32",
          "observer_window_end": "2026-01-03 02:09:36",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_link_var_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_var_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": null,
          "observed_path_source": "unsandboxed_error",
          "observed_path_errno": 2,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_error",
          "observed_path_nofirmlink_errno": 2
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":71033}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":71033}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: No such file or directory\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434974.606615,
        "cmd_finished_at_unix_s": 1767434974.6177979,
        "cmd_duration_s": 0.011182785034179688,
        "cmd_pid": 71033,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71033",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:32",
            "--end",
            "2026-01-03 02:09:36",
            "--row-id",
            "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_link_var_tmp_only.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "71033",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1173,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:36",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71033,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(71033)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71033\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 02:09:32",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434974753,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:32",
          "observer_window_end": "2026-01-03 02:09:36",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": null,
          "observed_path_source": "unsandboxed_error",
          "observed_path_errno": 2,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_error",
          "observed_path_nofirmlink_errno": 2
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":71036}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":71036}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: No such file or directory\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434974.755588,
        "cmd_finished_at_unix_s": 1767434974.766787,
        "cmd_duration_s": 0.011198997497558594,
        "cmd_pid": 71036,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71036",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:32",
            "--end",
            "2026-01-03 02:09:36",
            "--row-id",
            "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_link_var_tmp_only.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "71036",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1174,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:36",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71036,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(71036)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71036\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 02:09:32",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434974902,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:32",
          "observer_window_end": "2026-01-03 02:09:36",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":71039}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":71039}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434974.904574,
        "cmd_finished_at_unix_s": 1767434974.915895,
        "cmd_duration_s": 0.011321067810058594,
        "cmd_pid": 71039,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71039",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:32",
            "--end",
            "2026-01-03 02:09:36",
            "--row-id",
            "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_link_var_tmp_only.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "71039",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1154,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:36",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71039,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(71039)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71039\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 02:09:32",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434975049,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:32",
          "observer_window_end": "2026-01-03 02:09:36",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":71042}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":71042}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434975.0517702,
        "cmd_finished_at_unix_s": 1767434975.063152,
        "cmd_duration_s": 0.011381864547729492,
        "cmd_pid": 71042,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71042",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:33",
            "--end",
            "2026-01-03 02:09:37",
            "--row-id",
            "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_link_var_tmp_only.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "71042",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1155,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:37",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71042,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(71042)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71042\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 02:09:33",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434975188,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:33",
          "observer_window_end": "2026-01-03 02:09:37",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_link_private_tmp_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_private_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": null,
          "observed_path_source": "unsandboxed_error",
          "observed_path_errno": 2,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_error",
          "observed_path_nofirmlink_errno": 2
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":71045}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":71045}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: No such file or directory\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434975.1921139,
        "cmd_finished_at_unix_s": 1767434975.203385,
        "cmd_duration_s": 0.011271238327026367,
        "cmd_pid": 71045,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71045",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:33",
            "--end",
            "2026-01-03 02:09:37",
            "--row-id",
            "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_link_private_tmp_only.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "71045",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1177,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:37",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71045,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(71045)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71045\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 02:09:33",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434975332,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:33",
          "observer_window_end": "2026-01-03 02:09:37",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": null,
          "observed_path_source": "unsandboxed_error",
          "observed_path_errno": 2,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_error",
          "observed_path_nofirmlink_errno": 2
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":71048}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":71048}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: No such file or directory\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434975.334765,
        "cmd_finished_at_unix_s": 1767434975.346011,
        "cmd_duration_s": 0.011245965957641602,
        "cmd_pid": 71048,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71048",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:33",
            "--end",
            "2026-01-03 02:09:37",
            "--row-id",
            "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_link_private_tmp_only.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "71048",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1178,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:37",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71048,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(71048)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71048\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 02:09:33",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434975480,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:33",
          "observer_window_end": "2026-01-03 02:09:37",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":71051}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":71051}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434975.483049,
        "cmd_finished_at_unix_s": 1767434975.494196,
        "cmd_duration_s": 0.011147022247314453,
        "cmd_pid": 71051,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71051",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:33",
            "--end",
            "2026-01-03 02:09:37",
            "--row-id",
            "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_link_private_tmp_only.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "71051",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1471,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:35.514915-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(71051) deny(1) file-read-data /private/var/tmp/vfs_link_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:37",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:35.514915-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(71051) deny(1) file-read-data /private/var/tmp/vfs_link_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 71051,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(71051)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71051\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 02:09:33",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434975625,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:33",
          "observer_window_end": "2026-01-03 02:09:37",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":71054}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":71054}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434975.627672,
        "cmd_finished_at_unix_s": 1767434975.6388721,
        "cmd_duration_s": 0.011200189590454102,
        "cmd_pid": 71054,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71054",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:33",
            "--end",
            "2026-01-03 02:09:37",
            "--row-id",
            "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_link_private_tmp_only.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "71054",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1474,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:35.659604-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(71054) deny(1) file-write-data /private/var/tmp/vfs_link_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:37",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:35.659604-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(71054) deny(1) file-write-data /private/var/tmp/vfs_link_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 71054,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(71054)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71054\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 02:09:33",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434975771,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:33",
          "observer_window_end": "2026-01-03 02:09:37",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_link_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": null,
          "observed_path_source": "unsandboxed_error",
          "observed_path_errno": 2,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_error",
          "observed_path_nofirmlink_errno": 2
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":71057}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":71057}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: No such file or directory\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434975.775216,
        "cmd_finished_at_unix_s": 1767434975.786549,
        "cmd_duration_s": 0.011332988739013672,
        "cmd_pid": 71057,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71057",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:33",
            "--end",
            "2026-01-03 02:09:37",
            "--row-id",
            "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_link_both.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "71057",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1165,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:37",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71057,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(71057)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71057\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 02:09:33",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434975932,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:33",
          "observer_window_end": "2026-01-03 02:09:37",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": null,
          "observed_path_source": "unsandboxed_error",
          "observed_path_errno": 2,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_error",
          "observed_path_nofirmlink_errno": 2
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":71092}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":71092}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: No such file or directory\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434975.9345632,
        "cmd_finished_at_unix_s": 1767434975.946056,
        "cmd_duration_s": 0.011492729187011719,
        "cmd_pid": 71092,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71092",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:33",
            "--end",
            "2026-01-03 02:09:37",
            "--row-id",
            "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_link_both.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "71092",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1166,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:37",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71092,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(71092)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71092\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 02:09:33",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434976090,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:33",
          "observer_window_end": "2026-01-03 02:09:37",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":71095}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":71095}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434976.093035,
        "cmd_finished_at_unix_s": 1767434976.104449,
        "cmd_duration_s": 0.011414051055908203,
        "cmd_pid": 71095,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71095",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:34",
            "--end",
            "2026-01-03 02:09:38",
            "--row-id",
            "vfs_link_both:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_link_both.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "71095",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1146,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:38",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71095,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(71095)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71095\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 02:09:34",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434976241,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:34",
          "observer_window_end": "2026-01-03 02:09:38",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":71098}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":71098}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434976.2440698,
        "cmd_finished_at_unix_s": 1767434976.255331,
        "cmd_duration_s": 0.011261224746704102,
        "cmd_pid": 71098,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71098",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:34",
            "--end",
            "2026-01-03 02:09:38",
            "--row-id",
            "vfs_link_both:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_link_both.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "71098",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1147,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:38",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71098,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(71098)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71098\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 02:09:34",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434976391,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:34",
          "observer_window_end": "2026-01-03 02:09:38",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  },
  "vfs_link_both_plus_metadata_to_var_tmp": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_both_plus_metadata_to_var_tmp.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/private/tmp/vfs_linkdir/to_var_tmp",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp",
        "operation": "file-read-metadata",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "decision": "deny",
              "filter_type_name": "path",
              "error": null,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
              "marker_schema_version": 2,
              "api": "sandbox_check_by_audit_token",
              "check_type": 1073741824,
              "token_status": "ok",
              "tool": "seatbelt-callout",
              "errno": 0,
              "filter_type": 0,
              "canonical_flag_reason": "not_requested",
              "no_report_reason": null,
              "stage": "pre_syscall",
              "varargs_count": 1,
              "rc": 1,
              "token_mach_kr": 0,
              "operation": "file-read-metadata",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "no_report": true
            },
            {
              "decision": "deny",
              "filter_type_name": "path",
              "error": null,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
              "marker_schema_version": 2,
              "api": "sandbox_check_by_audit_token",
              "check_type": 1610612736,
              "token_status": "ok",
              "tool": "seatbelt-callout",
              "errno": 0,
              "filter_type": 0,
              "canonical_flag_reason": null,
              "no_report_reason": null,
              "stage": "pre_syscall",
              "varargs_count": 1,
              "rc": 1,
              "token_mach_kr": 0,
              "operation": "file-read-metadata",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": null,
          "observed_path_source": "unsandboxed_error",
          "observed_path_errno": 2,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_error",
          "observed_path_nofirmlink_errno": 2
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/private/tmp/vfs_linkdir/to_var_tmp"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"errno\":0,\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/8219d563-fbe7-463c-b46a-1c7c2fed5ce1\\/runtime_profiles\\/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":71101,\"api\":\"sandbox_init\",\"err_class\":\"ok\",\"tool\":\"sbpl-apply\",\"err_class_source\":\"none\",\"errbuf\":null,\"rc\":0}\n{\"marker_schema_version\":1,\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/8219d563-fbe7-463c-b46a-1c7c2fed5ce1\\/runtime_profiles\\/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"stage\":\"applied\",\"mode\":\"sbpl\",\"tool\":\"sbpl-apply\",\"pid\":71101}\n{\"decision\":\"deny\",\"filter_type_name\":\"path\",\"error\":null,\"argument\":\"\\/private\\/tmp\\/vfs_linkdir\\/to_var_tmp\",\"marker_schema_version\":2,\"api\":\"sandbox_check_by_audit_token\",\"check_type\":1073741824,\"token_status\":\"ok\",\"tool\":\"seatbelt-callout\",\"errno\":0,\"filter_type\":0,\"canonical_flag_reason\":\"not_requested\",\"no_report_reason\":null,\"stage\":\"pre_syscall\",\"varargs_count\":1,\"rc\":1,\"token_mach_kr\":0,\"operation\":\"file-read-metadata\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"no_report\":true}\n{\"decision\":\"deny\",\"filter_type_name\":\"path\",\"error\":null,\"argument\":\"\\/private\\/tmp\\/vfs_linkdir\\/to_var_tmp\",\"marker_schema_version\":2,\"api\":\"sandbox_check_by_audit_token\",\"check_type\":1610612736,\"token_status\":\"ok\",\"tool\":\"seatbelt-callout\",\"errno\":0,\"filter_type\":0,\"canonical_flag_reason\":null,\"no_report_reason\":null,\"stage\":\"pre_syscall\",\"varargs_count\":1,\"rc\":1,\"token_mach_kr\":0,\"operation\":\"file-read-metadata\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 2,
          "errno_name": "ENOENT",
          "message": "No such file or directory",
          "op": "file-read-metadata",
          "path": "/private/tmp/vfs_linkdir/to_var_tmp",
          "status": "op_failed",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767434976.394793,
        "cmd_finished_at_unix_s": 1767434976.409475,
        "cmd_duration_s": 0.01468205451965332,
        "cmd_pid": 71101,
        "cmd_process_name": "metadata_runner",
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71101",
            "--process-name",
            "metadata_runner",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:34",
            "--end",
            "2026-01-03 02:09:38",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_link_both_plus_metadata_to_var_tmp.lstat__private_tmp_vfs_linkdir_to_var_tmp.observer.json",
          "log_write_error": null,
          "pid": "71101",
          "process_name": "metadata_runner",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp",
          "correlation_id": null,
          "stdout_bytes": 8534,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 02:09:36.427623-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) sysctl-read kern.maxfilesperproc",
                "2026-01-03 02:09:36.428414-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/api/runtime/native/metadata_runner",
                "2026-01-03 02:09:36.428428-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/api/runtime/native/metadata_runner",
                "2026-01-03 02:09:36.428761-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:36.428809-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:36.428830-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:36.428832-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-metadata /Users/achyland",
                "2026-01-03 02:09:36.428966-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:36.429007-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:36.429230-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:36.429232-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:36.429265-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:36.429311-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:36.429313-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:36.429347-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:36.429382-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:36.429385-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:36.429416-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:36.429447-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:36.429449-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 02:09:36.429480-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:36.429696-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc",
                "2026-01-03 02:09:36.429698-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist"
              ],
              "duration_ms": null,
              "end": "2026-01-03 02:09:38",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 02:09:36.427623-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) sysctl-read kern.maxfilesperproc\n2026-01-03 02:09:36.428414-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/api/runtime/native/metadata_runner\n2026-01-03 02:09:36.428428-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/api/runtime/native/metadata_runner\n2026-01-03 02:09:36.428761-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:36.428809-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc\n2026-01-03 02:09:36.428830-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc\n2026-01-03 02:09:36.428832-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-metadata /Users/achyland\n2026-01-03 02:09:36.428966-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:36.429007-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc\n2026-01-03 02:09:36.429230-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc\n2026-01-03 02:09:36.429232-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:36.429265-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc\n2026-01-03 02:09:36.429311-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc\n2026-01-03 02:09:36.429313-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:36.429347-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc\n2026-01-03 02:09:36.429382-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc\n2026-01-03 02:09:36.429385-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:36.429416-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc\n2026-01-03 02:09:36.429447-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc\n2026-01-03 02:09:36.429449-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 02:09:36.429480-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc\n2026-01-03 02:09:36.429696-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(71101) deny(1) file-read-metadata /etc\n2026-01-03 02:09:36.429698-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(71101) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 24,
              "observer_schema_version": 1,
              "pid": 71101,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: metadata_runner(71101)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71101\")))",
              "process_name": "metadata_runner",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp",
              "start": "2026-01-03 02:09:34",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434976549,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:34",
          "observer_window_end": "2026-01-03 02:09:38",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": null,
          "observed_path_source": "unsandboxed_error",
          "observed_path_errno": 2,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_error",
          "observed_path_nofirmlink_errno": 2
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":71104}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":71104}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: No such file or directory\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434976.552138,
        "cmd_finished_at_unix_s": 1767434976.563551,
        "cmd_duration_s": 0.011412858963012695,
        "cmd_pid": 71104,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71104",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:34",
            "--end",
            "2026-01-03 02:09:38",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_link_both_plus_metadata_to_var_tmp.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "71104",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1190,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:38",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71104,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(71104)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71104\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 02:09:34",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434976708,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:34",
          "observer_window_end": "2026-01-03 02:09:38",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": null,
          "observed_path_source": "unsandboxed_error",
          "observed_path_errno": 2,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_error",
          "observed_path_nofirmlink_errno": 2
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":71107}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":71107}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: No such file or directory\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434976.71017,
        "cmd_finished_at_unix_s": 1767434976.7216132,
        "cmd_duration_s": 0.011443138122558594,
        "cmd_pid": 71107,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71107",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:34",
            "--end",
            "2026-01-03 02:09:38",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_link_both_plus_metadata_to_var_tmp.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "71107",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1191,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:38",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71107,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(71107)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71107\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 02:09:34",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434976858,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:34",
          "observer_window_end": "2026-01-03 02:09:38",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc",
            "tool_build_id": "71828267d627e667c81c0f1b8b0a3f18d6a062d4ca4db57a724b02049a548bfc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":71110}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":71110}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434976.861137,
        "cmd_finished_at_unix_s": 1767434976.872658,
        "cmd_duration_s": 0.011521100997924805,
        "cmd_pid": 71110,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71110",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:34",
            "--end",
            "2026-01-03 02:09:38",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_link_both_plus_metadata_to_var_tmp.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "71110",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1171,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:38",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71110,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(71110)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71110\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 02:09:34",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434977014,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:34",
          "observer_window_end": "2026-01-03 02:09:38",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc",
            "tool_build_id": "124073a2f7263980e0b924683280c5d6750365465c3bd66b5f0b7e4760b778fc"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":71113}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.8219d563-fbe7-463c-b46a-1c7c2fed5ce1/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":71113}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\nFD_IDENTITY:1\nFSTAT_ST_DEV:16777230\nFSTAT_ST_INO:113181449\nFSTATFS_FSTYPENAME:apfs\nFSTATFS_MNTONNAME:/System/Volumes/Data\nFSTATFS_FSID0:16777230\nFSTATFS_FSID1:26\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767434977.016961,
        "cmd_finished_at_unix_s": 1767434977.028469,
        "cmd_duration_s": 0.011507987976074219,
        "cmd_pid": 71113,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "71113",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 02:09:35",
            "--end",
            "2026-01-03 02:09:39",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/8219d563-fbe7-463c-b46a-1c7c2fed5ce1/observer/vfs_link_both_plus_metadata_to_var_tmp.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "71113",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1172,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 02:09:39",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 71113,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(71113)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"71113\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 02:09:35",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767434977166,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 02:09:35",
          "observer_window_end": "2026-01-03 02:09:39",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "8219d563-fbe7-463c-b46a-1c7c2fed5ce1"
  }
}