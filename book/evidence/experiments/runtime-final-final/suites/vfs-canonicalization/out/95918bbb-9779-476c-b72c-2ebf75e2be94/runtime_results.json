{
  "vfs_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/95918bbb-9779-476c-b72c-2ebf75e2be94/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/95918bbb-9779-476c-b72c-2ebf75e2be94/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_tmp_only:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "efa67dec03ae6ac5a64fc058d4bd284f8cd21fb55c37b5aaf65420d650ffe7fe",
            "tool_build_id": "efa67dec03ae6ac5a64fc058d4bd284f8cd21fb55c37b5aaf65420d650ffe7fe"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1610612736,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/95918bbb-9779-476c-b72c-2ebf75e2be94/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.95918bbb-9779-476c-b72c-2ebf75e2be94/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/95918bbb-9779-476c-b72c-2ebf75e2be94/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":45877}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.95918bbb-9779-476c-b72c-2ebf75e2be94/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/95918bbb-9779-476c-b72c-2ebf75e2be94/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":45877}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767432145.487883,
        "cmd_finished_at_unix_s": 1767432145.769237,
        "cmd_duration_s": 0.2813539505004883,
        "cmd_pid": 45877,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "45877",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 01:22:23",
            "--end",
            "2026-01-03 01:22:27",
            "--row-id",
            "vfs_tmp_only:read_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/95918bbb-9779-476c-b72c-2ebf75e2be94/observer/vfs_tmp_only.read__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "45877",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1405,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 01:22:25.828815-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(45877) deny(1) file-read-data /private/tmp/foo"
              ],
              "duration_ms": null,
              "end": "2026-01-03 01:22:27",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 01:22:25.828815-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(45877) deny(1) file-read-data /private/tmp/foo",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 45877,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(45877)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"45877\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/tmp/foo",
              "start": "2026-01-03 01:22:23",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767432147775,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 01:22:23",
          "observer_window_end": "2026-01-03 01:22:27",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "95918bbb-9779-476c-b72c-2ebf75e2be94"
  }
}