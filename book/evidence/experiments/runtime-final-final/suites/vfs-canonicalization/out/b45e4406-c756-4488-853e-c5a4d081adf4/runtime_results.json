{
  "vfs_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_tmp_only:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64309}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64309}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464571.4636211,
        "cmd_finished_at_unix_s": 1767464571.612395,
        "cmd_duration_s": 0.1487739086151123,
        "cmd_pid": 64309,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64309",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:49",
            "--end",
            "2026-01-03 10:22:53",
            "--row-id",
            "vfs_tmp_only:read_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_tmp_only.read__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64309",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1405,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:51.681701-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64309) deny(1) file-read-data /private/tmp/foo"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:53",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:51.681701-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64309) deny(1) file-read-data /private/tmp/foo",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64309,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64309)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64309\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/tmp/foo",
              "start": "2026-01-03 10:22:49",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464573177,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:49",
          "observer_window_end": "2026-01-03 10:22:53",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64353}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64353}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464573.179511,
        "cmd_finished_at_unix_s": 1767464573.187375,
        "cmd_duration_s": 0.007863998413085938,
        "cmd_pid": 64353,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64353",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:51",
            "--end",
            "2026-01-03 10:22:55",
            "--row-id",
            "vfs_tmp_only:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_tmp_only.read__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64353",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1413,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:53.257039-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64353) deny(1) file-read-data /private/tmp/foo"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:55",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:53.257039-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64353) deny(1) file-read-data /private/tmp/foo",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64353,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64353)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64353\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/tmp/foo",
              "start": "2026-01-03 10:22:51",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464573308,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:51",
          "observer_window_end": "2026-01-03 10:22:55",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_tmp_only:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64364}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64364}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464573.309967,
        "cmd_finished_at_unix_s": 1767464573.462798,
        "cmd_duration_s": 0.1528310775756836,
        "cmd_pid": 64364,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64364",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:51",
            "--end",
            "2026-01-03 10:22:55",
            "--row-id",
            "vfs_tmp_only:write_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_tmp_only.write__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64364",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1408,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:53.532468-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64364) deny(1) file-write-data /private/tmp/foo"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:55",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:53.532468-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64364) deny(1) file-write-data /private/tmp/foo",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64364,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64364)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64364\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/tmp/foo",
              "start": "2026-01-03 10:22:51",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464573582,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:51",
          "observer_window_end": "2026-01-03 10:22:55",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64383}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64383}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464573.583759,
        "cmd_finished_at_unix_s": 1767464573.591359,
        "cmd_duration_s": 0.007599830627441406,
        "cmd_pid": 64383,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64383",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:51",
            "--end",
            "2026-01-03 10:22:55",
            "--row-id",
            "vfs_tmp_only:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_tmp_only.write__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64383",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1416,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:53.661019-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64383) deny(1) file-write-data /private/tmp/foo"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:55",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:53.661019-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64383) deny(1) file-write-data /private/tmp/foo",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64383,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64383)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64383\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/tmp/foo",
              "start": "2026-01-03 10:22:51",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464573718,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:51",
          "observer_window_end": "2026-01-03 10:22:55",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_tmp_only:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64394}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64394}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464573.720371,
        "cmd_finished_at_unix_s": 1767464573.7280278,
        "cmd_duration_s": 0.00765681266784668,
        "cmd_pid": 64394,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64394",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:51",
            "--end",
            "2026-01-03 10:22:55",
            "--row-id",
            "vfs_tmp_only:read_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_tmp_only.read__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "64394",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1405,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:53.797735-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64394) deny(1) file-read-data /private/tmp/bar"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:55",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:53.797735-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64394) deny(1) file-read-data /private/tmp/bar",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64394,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64394)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64394\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/tmp/bar",
              "start": "2026-01-03 10:22:51",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464573857,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:51",
          "observer_window_end": "2026-01-03 10:22:55",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64402}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64402}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464573.858846,
        "cmd_finished_at_unix_s": 1767464573.866635,
        "cmd_duration_s": 0.007789134979248047,
        "cmd_pid": 64402,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64402",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:51",
            "--end",
            "2026-01-03 10:22:55",
            "--row-id",
            "vfs_tmp_only:read_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_tmp_only.read__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "64402",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1413,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:53.936334-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64402) deny(1) file-read-data /private/tmp/bar"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:55",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:53.936334-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64402) deny(1) file-read-data /private/tmp/bar",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64402,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64402)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64402\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/tmp/bar",
              "start": "2026-01-03 10:22:51",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464574111,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:51",
          "observer_window_end": "2026-01-03 10:22:55",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_tmp_only:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64406}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64406}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464574.115433,
        "cmd_finished_at_unix_s": 1767464574.131955,
        "cmd_duration_s": 0.016521930694580078,
        "cmd_pid": 64406,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64406",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:52",
            "--end",
            "2026-01-03 10:22:56",
            "--row-id",
            "vfs_tmp_only:write_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_tmp_only.write__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "64406",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1408,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:54.201033-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64406) deny(1) file-write-data /private/tmp/bar"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:56",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:54.201033-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64406) deny(1) file-write-data /private/tmp/bar",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64406,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64406)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64406\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/tmp/bar",
              "start": "2026-01-03 10:22:52",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464574283,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:52",
          "observer_window_end": "2026-01-03 10:22:56",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64409}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64409}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464574.2855208,
        "cmd_finished_at_unix_s": 1767464574.293237,
        "cmd_duration_s": 0.007716178894042969,
        "cmd_pid": 64409,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64409",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:52",
            "--end",
            "2026-01-03 10:22:56",
            "--row-id",
            "vfs_tmp_only:write_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_tmp_only.write__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "64409",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1416,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:54.362986-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64409) deny(1) file-write-data /private/tmp/bar"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:56",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:54.362986-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64409) deny(1) file-write-data /private/tmp/bar",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64409,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64409)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64409\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/tmp/bar",
              "start": "2026-01-03 10:22:52",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464574414,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:52",
          "observer_window_end": "2026-01-03 10:22:56",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64417}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64417}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464574.4157288,
        "cmd_finished_at_unix_s": 1767464574.4235032,
        "cmd_duration_s": 0.00777435302734375,
        "cmd_pid": 64417,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64417",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:52",
            "--end",
            "2026-01-03 10:22:56",
            "--row-id",
            "vfs_tmp_only:read_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_tmp_only.read__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "64417",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1432,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:54.493247-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64417) deny(1) file-read-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:56",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:54.493247-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64417) deny(1) file-read-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64417,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64417)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64417\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/tmp/nested/child",
              "start": "2026-01-03 10:22:52",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464574539,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:52",
          "observer_window_end": "2026-01-03 10:22:56",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64424}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64424}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464574.541287,
        "cmd_finished_at_unix_s": 1767464574.548801,
        "cmd_duration_s": 0.007513999938964844,
        "cmd_pid": 64424,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64424",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:52",
            "--end",
            "2026-01-03 10:22:56",
            "--row-id",
            "vfs_tmp_only:read_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_tmp_only.read__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "64424",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1440,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:54.618569-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64424) deny(1) file-read-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:56",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:54.618569-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64424) deny(1) file-read-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64424,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64424)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64424\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/tmp/nested/child",
              "start": "2026-01-03 10:22:52",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464574685,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:52",
          "observer_window_end": "2026-01-03 10:22:56",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64431}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64431}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464574.686752,
        "cmd_finished_at_unix_s": 1767464574.6945002,
        "cmd_duration_s": 0.007748126983642578,
        "cmd_pid": 64431,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64431",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:52",
            "--end",
            "2026-01-03 10:22:56",
            "--row-id",
            "vfs_tmp_only:write_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_tmp_only.write__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "64431",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1435,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:54.764248-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64431) deny(1) file-write-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:56",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:54.764248-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64431) deny(1) file-write-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64431,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64431)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64431\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/tmp/nested/child",
              "start": "2026-01-03 10:22:52",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464574829,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:52",
          "observer_window_end": "2026-01-03 10:22:56",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_tmp_only:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64440}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64440}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464574.830803,
        "cmd_finished_at_unix_s": 1767464574.8388171,
        "cmd_duration_s": 0.008014202117919922,
        "cmd_pid": 64440,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64440",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:52",
            "--end",
            "2026-01-03 10:22:56",
            "--row-id",
            "vfs_tmp_only:write_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_tmp_only.write__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "64440",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1443,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:54.908555-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64440) deny(1) file-write-data /private/tmp/nested/child"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:56",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:54.908555-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64440) deny(1) file-write-data /private/tmp/nested/child",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64440,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64440)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64440\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/tmp/nested/child",
              "start": "2026-01-03 10:22:52",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464574967,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:52",
          "observer_window_end": "2026-01-03 10:22:56",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64447}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64447}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464574.9689338,
        "cmd_finished_at_unix_s": 1767464574.976429,
        "cmd_duration_s": 0.00749516487121582,
        "cmd_pid": 64447,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64447",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:52",
            "--end",
            "2026-01-03 10:22:56",
            "--row-id",
            "vfs_tmp_only:read_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_tmp_only.read__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "64447",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1707,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:55.045885-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64447) deny(1) file-read-metadata /var",
                "2026-01-03 10:22:55.089567-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64447) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:56",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:55.045885-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64447) deny(1) file-read-metadata /var\n2026-01-03 10:22:55.089567-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64447) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64447,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64447)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64447\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/var/tmp/canon",
              "start": "2026-01-03 10:22:52",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464575111,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:52",
          "observer_window_end": "2026-01-03 10:22:56",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64450}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64450}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464575.112871,
        "cmd_finished_at_unix_s": 1767464575.120557,
        "cmd_duration_s": 0.007686138153076172,
        "cmd_pid": 64450,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64450",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:53",
            "--end",
            "2026-01-03 10:22:57",
            "--row-id",
            "vfs_tmp_only:read_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_tmp_only.read__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "64450",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:read_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1431,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:55.190352-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64450) deny(1) file-read-data /private/var/tmp/canon"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:57",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:55.190352-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64450) deny(1) file-read-data /private/var/tmp/canon",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64450,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64450)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64450\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_tmp_only:read_/private/var/tmp/canon",
              "start": "2026-01-03 10:22:53",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464575245,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:53",
          "observer_window_end": "2026-01-03 10:22:57",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64453}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64453}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464575.247322,
        "cmd_finished_at_unix_s": 1767464575.2548459,
        "cmd_duration_s": 0.007523775100708008,
        "cmd_pid": 64453,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64453",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:53",
            "--end",
            "2026-01-03 10:22:57",
            "--row-id",
            "vfs_tmp_only:write_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_tmp_only.write__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "64453",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1708,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:55.324297-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64453) deny(1) file-read-metadata /var",
                "2026-01-03 10:22:55.359546-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64453) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:57",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:55.324297-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64453) deny(1) file-read-metadata /var\n2026-01-03 10:22:55.359546-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64453) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64453,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64453)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64453\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/var/tmp/canon",
              "start": "2026-01-03 10:22:53",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464575380,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:53",
          "observer_window_end": "2026-01-03 10:22:57",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_tmp_only:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64457}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_tmp_only.vfs_tmp_only.runtime.sb\",\"pid\":64457}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464575.382391,
        "cmd_finished_at_unix_s": 1767464575.389965,
        "cmd_duration_s": 0.0075740814208984375,
        "cmd_pid": 64457,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64457",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:53",
            "--end",
            "2026-01-03 10:22:57",
            "--row-id",
            "vfs_tmp_only:write_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_tmp_only.write__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "64457",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_tmp_only:write_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1434,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:55.459763-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64457) deny(1) file-write-data /private/var/tmp/canon"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:57",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:55.459763-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64457) deny(1) file-write-data /private/var/tmp/canon",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64457,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64457)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64457\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_tmp_only:write_/private/var/tmp/canon",
              "start": "2026-01-03 10:22:53",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464575578,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:53",
          "observer_window_end": "2026-01-03 10:22:57",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_private_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_private_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64467}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64467}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464575.581144,
        "cmd_finished_at_unix_s": 1767464575.588733,
        "cmd_duration_s": 0.007588863372802734,
        "cmd_pid": 64467,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64467",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:53",
            "--end",
            "2026-01-03 10:22:57",
            "--row-id",
            "vfs_private_tmp_only:read_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.read__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64467",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1130,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:22:57",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64467,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64467)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64467\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/tmp/foo",
              "start": "2026-01-03 10:22:53",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464575723,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:53",
          "observer_window_end": "2026-01-03 10:22:57",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64470}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64470}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464575.7253811,
        "cmd_finished_at_unix_s": 1767464575.733025,
        "cmd_duration_s": 0.007643938064575195,
        "cmd_pid": 64470,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64470",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:53",
            "--end",
            "2026-01-03 10:22:57",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.read__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64470",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1138,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:22:57",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64470,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64470)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64470\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/foo",
              "start": "2026-01-03 10:22:53",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464575867,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:53",
          "observer_window_end": "2026-01-03 10:22:57",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64475}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64475}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464575.8686311,
        "cmd_finished_at_unix_s": 1767464575.8761978,
        "cmd_duration_s": 0.007566690444946289,
        "cmd_pid": 64475,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64475",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:53",
            "--end",
            "2026-01-03 10:22:57",
            "--row-id",
            "vfs_private_tmp_only:write_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.write__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64475",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1131,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:22:57",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64475,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64475)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64475\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/tmp/foo",
              "start": "2026-01-03 10:22:53",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464576006,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:53",
          "observer_window_end": "2026-01-03 10:22:57",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64478}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64478}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464576.0082371,
        "cmd_finished_at_unix_s": 1767464576.015569,
        "cmd_duration_s": 0.00733184814453125,
        "cmd_pid": 64478,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64478",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:54",
            "--end",
            "2026-01-03 10:22:58",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.write__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64478",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:22:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64478,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64478)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64478\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/foo",
              "start": "2026-01-03 10:22:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464576131,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:54",
          "observer_window_end": "2026-01-03 10:22:58",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64481}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64481}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464576.133138,
        "cmd_finished_at_unix_s": 1767464576.140527,
        "cmd_duration_s": 0.007389068603515625,
        "cmd_pid": 64481,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64481",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:54",
            "--end",
            "2026-01-03 10:22:58",
            "--row-id",
            "vfs_private_tmp_only:read_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.read__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "64481",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1130,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:22:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64481,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64481)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64481\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/tmp/bar",
              "start": "2026-01-03 10:22:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464576258,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:54",
          "observer_window_end": "2026-01-03 10:22:58",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64484}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64484}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464576.259656,
        "cmd_finished_at_unix_s": 1767464576.2669492,
        "cmd_duration_s": 0.007293224334716797,
        "cmd_pid": 64484,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64484",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:54",
            "--end",
            "2026-01-03 10:22:58",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.read__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "64484",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1138,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:22:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64484,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64484)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64484\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/bar",
              "start": "2026-01-03 10:22:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464576388,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:54",
          "observer_window_end": "2026-01-03 10:22:58",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64487}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64487}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464576.3901498,
        "cmd_finished_at_unix_s": 1767464576.397542,
        "cmd_duration_s": 0.007392168045043945,
        "cmd_pid": 64487,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64487",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:54",
            "--end",
            "2026-01-03 10:22:58",
            "--row-id",
            "vfs_private_tmp_only:write_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.write__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "64487",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1131,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:22:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64487,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64487)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64487\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/tmp/bar",
              "start": "2026-01-03 10:22:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464576514,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:54",
          "observer_window_end": "2026-01-03 10:22:58",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64490}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64490}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464576.5155551,
        "cmd_finished_at_unix_s": 1767464576.522867,
        "cmd_duration_s": 0.007311820983886719,
        "cmd_pid": 64490,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64490",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:54",
            "--end",
            "2026-01-03 10:22:58",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.write__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "64490",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:22:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64490,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64490)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64490\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/bar",
              "start": "2026-01-03 10:22:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464576641,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:54",
          "observer_window_end": "2026-01-03 10:22:58",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64493}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64493}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464576.642932,
        "cmd_finished_at_unix_s": 1767464576.650256,
        "cmd_duration_s": 0.0073239803314208984,
        "cmd_pid": 64493,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64493",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:54",
            "--end",
            "2026-01-03 10:22:58",
            "--row-id",
            "vfs_private_tmp_only:read_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.read__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "64493",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:22:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64493,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64493)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64493\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/tmp/nested/child",
              "start": "2026-01-03 10:22:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464576771,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:54",
          "observer_window_end": "2026-01-03 10:22:58",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64496}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64496}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464576.7729568,
        "cmd_finished_at_unix_s": 1767464576.7801678,
        "cmd_duration_s": 0.007210969924926758,
        "cmd_pid": 64496,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64496",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:54",
            "--end",
            "2026-01-03 10:22:58",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.read__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "64496",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1147,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:22:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64496,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64496)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64496\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/child",
              "start": "2026-01-03 10:22:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464576898,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:54",
          "observer_window_end": "2026-01-03 10:22:58",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64499}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64499}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464576.899734,
        "cmd_finished_at_unix_s": 1767464576.906982,
        "cmd_duration_s": 0.0072479248046875,
        "cmd_pid": 64499,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64499",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:54",
            "--end",
            "2026-01-03 10:22:58",
            "--row-id",
            "vfs_private_tmp_only:write_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.write__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "64499",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1140,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:22:58",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64499,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64499)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64499\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/tmp/nested/child",
              "start": "2026-01-03 10:22:54",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464577032,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:54",
          "observer_window_end": "2026-01-03 10:22:58",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64502}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64502}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464577.034354,
        "cmd_finished_at_unix_s": 1767464577.041569,
        "cmd_duration_s": 0.007215023040771484,
        "cmd_pid": 64502,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64502",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:55",
            "--end",
            "2026-01-03 10:22:59",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.write__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "64502",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1148,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:22:59",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64502,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64502)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64502\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/child",
              "start": "2026-01-03 10:22:55",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464577149,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:55",
          "observer_window_end": "2026-01-03 10:22:59",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64505}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64505}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464577.151129,
        "cmd_finished_at_unix_s": 1767464577.158384,
        "cmd_duration_s": 0.007255077362060547,
        "cmd_pid": 64505,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64505",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:55",
            "--end",
            "2026-01-03 10:22:59",
            "--row-id",
            "vfs_private_tmp_only:read_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.read__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "64505",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1451,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:57.259092-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64505) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:59",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:57.259092-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64505) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64505,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64505)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64505\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/var/tmp/canon",
              "start": "2026-01-03 10:22:55",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464577271,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:55",
          "observer_window_end": "2026-01-03 10:22:59",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks var tmp canon\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64508}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64508}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464577.2732742,
        "cmd_finished_at_unix_s": 1767464577.2804868,
        "cmd_duration_s": 0.007212638854980469,
        "cmd_pid": 64508,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64508",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:55",
            "--end",
            "2026-01-03 10:22:59",
            "--row-id",
            "vfs_private_tmp_only:read_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.read__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "64508",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1144,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:22:59",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64508,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64508)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64508\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/var/tmp/canon",
              "start": "2026-01-03 10:22:55",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464577388,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:55",
          "observer_window_end": "2026-01-03 10:22:59",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64511}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64511}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464577.39001,
        "cmd_finished_at_unix_s": 1767464577.3972852,
        "cmd_duration_s": 0.007275104522705078,
        "cmd_pid": 64511,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64511",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:55",
            "--end",
            "2026-01-03 10:22:59",
            "--row-id",
            "vfs_private_tmp_only:write_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.write__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "64511",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1452,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:57.504194-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64511) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:22:59",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:57.504194-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64511) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64511,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64511)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64511\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/var/tmp/canon",
              "start": "2026-01-03 10:22:55",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464577509,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:55",
          "observer_window_end": "2026-01-03 10:22:59",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_private_tmp_only:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64514}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64514}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464577.510866,
        "cmd_finished_at_unix_s": 1767464577.5182028,
        "cmd_duration_s": 0.007336854934692383,
        "cmd_pid": 64514,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64514",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:55",
            "--end",
            "2026-01-03 10:22:59",
            "--row-id",
            "vfs_private_tmp_only:write_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.write__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "64514",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1145,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:22:59",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64514,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64514)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64514\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/var/tmp/canon",
              "start": "2026-01-03 10:22:55",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464577631,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:55",
          "observer_window_end": "2026-01-03 10:22:59",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/../foo",
        "expectation_id": "vfs_private_tmp_only:read_/private/tmp/nested/../foo",
        "operation": "file-read*",
        "path": "/private/tmp/nested/../foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/../foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/../foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64517}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64517}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464577.633316,
        "cmd_finished_at_unix_s": 1767464577.640523,
        "cmd_duration_s": 0.007206916809082031,
        "cmd_pid": 64517,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/../foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64517",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:55",
            "--end",
            "2026-01-03 10:22:59",
            "--row-id",
            "vfs_private_tmp_only:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.read__private_tmp_nested_.._foo.observer.json",
          "log_write_error": null,
          "pid": "64517",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/../foo",
          "correlation_id": null,
          "stdout_bytes": 1148,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:22:59",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64517,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64517)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64517\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only:read_/private/tmp/nested/../foo",
              "start": "2026-01-03 10:22:55",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464577757,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:55",
          "observer_window_end": "2026-01-03 10:22:59",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/../foo",
        "expectation_id": "vfs_private_tmp_only:write_/private/tmp/nested/../foo",
        "operation": "file-write*",
        "path": "/private/tmp/nested/../foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/../foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/../foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb",
          "/private/tmp/nested/../foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64520}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only.vfs_private_tmp_only.runtime.sb\",\"pid\":64520}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/../foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464577.758833,
        "cmd_finished_at_unix_s": 1767464577.7661161,
        "cmd_duration_s": 0.007283210754394531,
        "cmd_pid": 64520,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/../foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64520",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:55",
            "--end",
            "2026-01-03 10:22:59",
            "--row-id",
            "vfs_private_tmp_only:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only.write__private_tmp_nested_.._foo.observer.json",
          "log_write_error": null,
          "pid": "64520",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/../foo",
          "correlation_id": null,
          "stdout_bytes": 1149,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:22:59",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64520,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64520)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64520\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_private_tmp_only:write_/private/tmp/nested/../foo",
              "start": "2026-01-03 10:22:55",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464577875,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:55",
          "observer_window_end": "2026-01-03 10:22:59",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_both_paths": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_both_paths.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/tmp/foo",
        "expectation_id": "vfs_both_paths:read_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64523}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64523}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464577.8771431,
        "cmd_finished_at_unix_s": 1767464577.884543,
        "cmd_duration_s": 0.007399797439575195,
        "cmd_pid": 64523,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64523",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:55",
            "--end",
            "2026-01-03 10:22:59",
            "--row-id",
            "vfs_both_paths:read_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_both_paths.read__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64523",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1124,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:22:59",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64523,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64523)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64523\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/tmp/foo",
              "start": "2026-01-03 10:22:55",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464578026,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:55",
          "observer_window_end": "2026-01-03 10:22:59",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/foo",
        "expectation_id": "vfs_both_paths:read_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64526}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64526}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464578.0278451,
        "cmd_finished_at_unix_s": 1767464578.035087,
        "cmd_duration_s": 0.007241964340209961,
        "cmd_pid": 64526,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64526",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:56",
            "--end",
            "2026-01-03 10:23:00",
            "--row-id",
            "vfs_both_paths:read_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_both_paths.read__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64526",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1132,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:00",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64526,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64526)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64526\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/tmp/foo",
              "start": "2026-01-03 10:22:56",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464578163,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:56",
          "observer_window_end": "2026-01-03 10:23:00",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/foo",
        "expectation_id": "vfs_both_paths:write_/tmp/foo",
        "operation": "file-write*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64529}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64529}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464578.1645608,
        "cmd_finished_at_unix_s": 1767464578.171911,
        "cmd_duration_s": 0.00735020637512207,
        "cmd_pid": 64529,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64529",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:56",
            "--end",
            "2026-01-03 10:23:00",
            "--row-id",
            "vfs_both_paths:write_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_both_paths.write__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64529",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1125,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:00",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64529,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64529)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64529\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/tmp/foo",
              "start": "2026-01-03 10:22:56",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464578320,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:56",
          "observer_window_end": "2026-01-03 10:23:00",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/foo",
        "expectation_id": "vfs_both_paths:write_/private/tmp/foo",
        "operation": "file-write*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64532}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64532}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464578.321897,
        "cmd_finished_at_unix_s": 1767464578.3291678,
        "cmd_duration_s": 0.00727081298828125,
        "cmd_pid": 64532,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64532",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:56",
            "--end",
            "2026-01-03 10:23:00",
            "--row-id",
            "vfs_both_paths:write_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_both_paths.write__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64532",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1133,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:00",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64532,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64532)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64532\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/tmp/foo",
              "start": "2026-01-03 10:22:56",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464578445,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:56",
          "observer_window_end": "2026-01-03 10:23:00",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/bar",
        "expectation_id": "vfs_both_paths:read_/tmp/bar",
        "operation": "file-read*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64536}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64536}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464578.447434,
        "cmd_finished_at_unix_s": 1767464578.454775,
        "cmd_duration_s": 0.007341146469116211,
        "cmd_pid": 64536,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64536",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:56",
            "--end",
            "2026-01-03 10:23:00",
            "--row-id",
            "vfs_both_paths:read_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_both_paths.read__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "64536",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1124,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:00",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64536,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64536)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64536\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/tmp/bar",
              "start": "2026-01-03 10:22:56",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464578575,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:56",
          "observer_window_end": "2026-01-03 10:23:00",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/bar",
        "expectation_id": "vfs_both_paths:read_/private/tmp/bar",
        "operation": "file-read*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks bar\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64539}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64539}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464578.5768058,
        "cmd_finished_at_unix_s": 1767464578.5840771,
        "cmd_duration_s": 0.007271289825439453,
        "cmd_pid": 64539,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64539",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:56",
            "--end",
            "2026-01-03 10:23:00",
            "--row-id",
            "vfs_both_paths:read_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_both_paths.read__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "64539",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1132,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:00",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64539,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64539)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64539\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/tmp/bar",
              "start": "2026-01-03 10:22:56",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464578711,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:56",
          "observer_window_end": "2026-01-03 10:23:00",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/bar",
        "expectation_id": "vfs_both_paths:write_/tmp/bar",
        "operation": "file-write*",
        "path": "/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64542}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64542}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464578.712725,
        "cmd_finished_at_unix_s": 1767464578.7201548,
        "cmd_duration_s": 0.007429838180541992,
        "cmd_pid": 64542,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64542",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:56",
            "--end",
            "2026-01-03 10:23:00",
            "--row-id",
            "vfs_both_paths:write_/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_both_paths.write__tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "64542",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1125,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:00",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64542,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64542)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64542\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/tmp/bar",
              "start": "2026-01-03 10:22:56",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464578843,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:56",
          "observer_window_end": "2026-01-03 10:23:00",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/bar",
        "expectation_id": "vfs_both_paths:write_/private/tmp/bar",
        "operation": "file-write*",
        "path": "/private/tmp/bar",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/bar",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/bar",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/bar",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/bar"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64545}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64545}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/bar\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/bar\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/bar\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464578.8450298,
        "cmd_finished_at_unix_s": 1767464578.8523788,
        "cmd_duration_s": 0.0073490142822265625,
        "cmd_pid": 64545,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/bar",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64545",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:56",
            "--end",
            "2026-01-03 10:23:00",
            "--row-id",
            "vfs_both_paths:write_/private/tmp/bar"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_both_paths.write__private_tmp_bar.observer.json",
          "log_write_error": null,
          "pid": "64545",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/tmp/bar",
          "correlation_id": null,
          "stdout_bytes": 1133,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:00",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64545,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64545)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64545\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/tmp/bar",
              "start": "2026-01-03 10:22:56",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464578973,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:56",
          "observer_window_end": "2026-01-03 10:23:00",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/tmp/nested/child",
        "expectation_id": "vfs_both_paths:read_/tmp/nested/child",
        "operation": "file-read*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64548}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64548}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464578.975157,
        "cmd_finished_at_unix_s": 1767464578.982502,
        "cmd_duration_s": 0.007344961166381836,
        "cmd_pid": 64548,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64548",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:56",
            "--end",
            "2026-01-03 10:23:00",
            "--row-id",
            "vfs_both_paths:read_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_both_paths.read__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "64548",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1133,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:00",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64548,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64548)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64548\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/tmp/nested/child",
              "start": "2026-01-03 10:22:56",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464579097,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:56",
          "observer_window_end": "2026-01-03 10:23:00",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/nested/child",
        "expectation_id": "vfs_both_paths:read_/private/tmp/nested/child",
        "operation": "file-read*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks nested child\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64551}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64551}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464579.099091,
        "cmd_finished_at_unix_s": 1767464579.106571,
        "cmd_duration_s": 0.00747990608215332,
        "cmd_pid": 64551,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64551",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:57",
            "--end",
            "2026-01-03 10:23:01",
            "--row-id",
            "vfs_both_paths:read_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_both_paths.read__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "64551",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1141,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:01",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64551,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64551)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64551\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/tmp/nested/child",
              "start": "2026-01-03 10:22:57",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464579223,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:57",
          "observer_window_end": "2026-01-03 10:23:01",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/tmp/nested/child",
        "expectation_id": "vfs_both_paths:write_/tmp/nested/child",
        "operation": "file-write*",
        "path": "/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64554}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64554}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464579.225058,
        "cmd_finished_at_unix_s": 1767464579.23283,
        "cmd_duration_s": 0.007771968841552734,
        "cmd_pid": 64554,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64554",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:57",
            "--end",
            "2026-01-03 10:23:01",
            "--row-id",
            "vfs_both_paths:write_/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_both_paths.write__tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "64554",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1134,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:01",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64554,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64554)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64554\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/tmp/nested/child",
              "start": "2026-01-03 10:22:57",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464579355,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:57",
          "observer_window_end": "2026-01-03 10:23:01",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/nested/child",
        "expectation_id": "vfs_both_paths:write_/private/tmp/nested/child",
        "operation": "file-write*",
        "path": "/private/tmp/nested/child",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/nested/child",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/nested/child",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/nested/child",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/tmp/nested/child"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64557}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64557}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/nested/child\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/nested/child\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/nested/child\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464579.357288,
        "cmd_finished_at_unix_s": 1767464579.3646789,
        "cmd_duration_s": 0.0073909759521484375,
        "cmd_pid": 64557,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/nested/child",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64557",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:57",
            "--end",
            "2026-01-03 10:23:01",
            "--row-id",
            "vfs_both_paths:write_/private/tmp/nested/child"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_both_paths.write__private_tmp_nested_child.observer.json",
          "log_write_error": null,
          "pid": "64557",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/tmp/nested/child",
          "correlation_id": null,
          "stdout_bytes": 1142,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:01",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64557,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64557)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64557\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/tmp/nested/child",
              "start": "2026-01-03 10:22:57",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464579484,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:57",
          "observer_window_end": "2026-01-03 10:23:01",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/canon",
        "expectation_id": "vfs_both_paths:read_/var/tmp/canon",
        "operation": "file-read*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64560}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64560}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464579.4857721,
        "cmd_finished_at_unix_s": 1767464579.4930282,
        "cmd_duration_s": 0.007256031036376953,
        "cmd_pid": 64560,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64560",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:57",
            "--end",
            "2026-01-03 10:23:01",
            "--row-id",
            "vfs_both_paths:read_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_both_paths.read__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "64560",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1709,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:59.562684-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64560) deny(1) file-read-metadata /var",
                "2026-01-03 10:22:59.592214-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64560) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:01",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:59.562684-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64560) deny(1) file-read-metadata /var\n2026-01-03 10:22:59.592214-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64560) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64560,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64560)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64560\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/var/tmp/canon",
              "start": "2026-01-03 10:22:57",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464579613,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:57",
          "observer_window_end": "2026-01-03 10:23:01",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/canon",
        "expectation_id": "vfs_both_paths:read_/private/var/tmp/canon",
        "operation": "file-read*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks var tmp canon\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64563}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64563}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464579.6152241,
        "cmd_finished_at_unix_s": 1767464579.6224341,
        "cmd_duration_s": 0.0072100162506103516,
        "cmd_pid": 64563,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64563",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:57",
            "--end",
            "2026-01-03 10:23:01",
            "--row-id",
            "vfs_both_paths:read_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_both_paths.read__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "64563",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:read_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1138,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:01",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64563,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64563)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64563\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_both_paths:read_/private/var/tmp/canon",
              "start": "2026-01-03 10:22:57",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464579746,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:57",
          "observer_window_end": "2026-01-03 10:23:01",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/canon",
        "expectation_id": "vfs_both_paths:write_/var/tmp/canon",
        "operation": "file-write*",
        "path": "/var/tmp/canon",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/var/tmp/canon"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64566}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64566}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464579.7483258,
        "cmd_finished_at_unix_s": 1767464579.755677,
        "cmd_duration_s": 0.0073511600494384766,
        "cmd_pid": 64566,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64566",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:57",
            "--end",
            "2026-01-03 10:23:01",
            "--row-id",
            "vfs_both_paths:write_/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_both_paths.write__var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "64566",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1710,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:22:59.825337-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64566) deny(1) file-read-metadata /var",
                "2026-01-03 10:22:59.856637-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64566) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:01",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:22:59.825337-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64566) deny(1) file-read-metadata /var\n2026-01-03 10:22:59.856637-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64566) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64566,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64566)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64566\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/var/tmp/canon",
              "start": "2026-01-03 10:22:57",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464579874,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:57",
          "observer_window_end": "2026-01-03 10:23:01",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/canon",
        "expectation_id": "vfs_both_paths:write_/private/var/tmp/canon",
        "operation": "file-write*",
        "path": "/private/var/tmp/canon",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/canon",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/canon",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/canon",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb",
          "/private/var/tmp/canon"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64569}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_both_paths.vfs_both_paths.runtime.sb\",\"pid\":64569}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/canon\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/canon\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/canon\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464579.87595,
        "cmd_finished_at_unix_s": 1767464579.883349,
        "cmd_duration_s": 0.007398843765258789,
        "cmd_pid": 64569,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/canon",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64569",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:57",
            "--end",
            "2026-01-03 10:23:01",
            "--row-id",
            "vfs_both_paths:write_/private/var/tmp/canon"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_both_paths.write__private_var_tmp_canon.observer.json",
          "log_write_error": null,
          "pid": "64569",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_both_paths:write_/private/var/tmp/canon",
          "correlation_id": null,
          "stdout_bytes": 1139,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:01",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64569,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64569)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64569\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_both_paths:write_/private/var/tmp/canon",
              "start": "2026-01-03 10:22:57",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464580023,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:57",
          "observer_window_end": "2026-01-03 10:23:01",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_private_tmp_only_openat": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_private_tmp_only_openat.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_open_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_open_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":64572}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":64572}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464580.025752,
        "cmd_finished_at_unix_s": 1767464580.0331259,
        "cmd_duration_s": 0.007373809814453125,
        "cmd_pid": 64572,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64572",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:58",
            "--end",
            "2026-01-03 10:23:02",
            "--row-id",
            "vfs_private_tmp_only_openat:read_open_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only_openat.read_open__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64572",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_open_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1142,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:02",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64572,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64572)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64572\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat:read_open_/tmp/foo",
              "start": "2026-01-03 10:22:58",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464580144,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:58",
          "observer_window_end": "2026-01-03 10:23:02",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":64575}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":64575}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen dir: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464580.1459682,
        "cmd_finished_at_unix_s": 1767464580.3343308,
        "cmd_duration_s": 0.18836259841918945,
        "cmd_pid": 64575,
        "cmd_process_name": "sandbox_openat_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64575",
            "--process-name",
            "sandbox_openat_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:58",
            "--end",
            "2026-01-03 10:23:02",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only_openat.read_openat__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64575",
          "process_name": "sandbox_openat_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1447,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:00.403911-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_reader(64575) deny(1) file-read-data /private/tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:02",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:00.403911-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_reader(64575) deny(1) file-read-data /private/tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64575,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_reader(64575)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64575\")))",
              "process_name": "sandbox_openat_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_/tmp/foo",
              "start": "2026-01-03 10:22:58",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464580492,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:58",
          "observer_window_end": "2026-01-03 10:23:02",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_open_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_open_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":64578}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":64578}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464580.4937222,
        "cmd_finished_at_unix_s": 1767464580.500944,
        "cmd_duration_s": 0.007221698760986328,
        "cmd_pid": 64578,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64578",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:58",
            "--end",
            "2026-01-03 10:23:02",
            "--row-id",
            "vfs_private_tmp_only_openat:read_open_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only_openat.read_open__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64578",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_open_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:02",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64578,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64578)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64578\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat:read_open_/private/tmp/foo",
              "start": "2026-01-03 10:22:58",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464580623,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:58",
          "observer_window_end": "2026-01-03 10:23:02",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":64581}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":64581}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nopen dir: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464580.625157,
        "cmd_finished_at_unix_s": 1767464580.632389,
        "cmd_duration_s": 0.007231950759887695,
        "cmd_pid": 64581,
        "cmd_process_name": "sandbox_openat_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64581",
            "--process-name",
            "sandbox_openat_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:58",
            "--end",
            "2026-01-03 10:23:02",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only_openat.read_openat__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64581",
          "process_name": "sandbox_openat_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1455,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:00.702447-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_reader(64581) deny(1) file-read-data /private/tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:02",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:00.702447-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_reader(64581) deny(1) file-read-data /private/tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64581,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_reader(64581)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64581\")))",
              "process_name": "sandbox_openat_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_/private/tmp/foo",
              "start": "2026-01-03 10:22:58",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464580755,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:58",
          "observer_window_end": "2026-01-03 10:23:02",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_rootrel_tmp/foo",
        "operation": "file-read*",
        "path": "tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":64584}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":64584}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464580.757303,
        "cmd_finished_at_unix_s": 1767464580.945268,
        "cmd_duration_s": 0.18796491622924805,
        "cmd_pid": 64584,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64584",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:58",
            "--end",
            "2026-01-03 10:23:02",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_rootrel_tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only_openat.read_openat_rootrel_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64584",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_rootrel_tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1181,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:02",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64584,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(64584)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64584\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_rootrel_tmp/foo",
              "start": "2026-01-03 10:22:58",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464581102,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:58",
          "observer_window_end": "2026-01-03 10:23:02",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat:read_openat_rootrel_private/tmp/foo",
        "operation": "file-read*",
        "path": "private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb",
          "private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":64587}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat.vfs_private_tmp_only_openat.runtime.sb\",\"pid\":64587}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464581.103776,
        "cmd_finished_at_unix_s": 1767464581.111091,
        "cmd_duration_s": 0.007314920425415039,
        "cmd_pid": 64587,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64587",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:59",
            "--end",
            "2026-01-03 10:23:03",
            "--row-id",
            "vfs_private_tmp_only_openat:read_openat_rootrel_private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only_openat.read_openat_rootrel_private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64587",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat:read_openat_rootrel_private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1189,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:03",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64587,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(64587)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64587\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_private_tmp_only_openat:read_openat_rootrel_private/tmp/foo",
              "start": "2026-01-03 10:22:59",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464581217,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:59",
          "observer_window_end": "2026-01-03 10:23:03",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_private_tmp_only_openat_dir_allowed": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_private_tmp_only_openat_dir_allowed.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_open_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat_dir_allowed:read_open_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":64590}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":64590}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464581.219723,
        "cmd_finished_at_unix_s": 1767464581.2269702,
        "cmd_duration_s": 0.007247209548950195,
        "cmd_pid": 64590,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64590",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:59",
            "--end",
            "2026-01-03 10:23:03",
            "--row-id",
            "vfs_private_tmp_only_openat_dir_allowed:read_open_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only_openat_dir_allowed.read_open__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64590",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat_dir_allowed:read_open_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1154,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:03",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64590,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64590)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64590\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat_dir_allowed:read_open_/tmp/foo",
              "start": "2026-01-03 10:22:59",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464581334,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:59",
          "observer_window_end": "2026-01-03 10:23:03",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat_dir_allowed:read_openat_/tmp/foo",
        "operation": "file-read*",
        "path": "/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb",
          "/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":64593}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":64593}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464581.336499,
        "cmd_finished_at_unix_s": 1767464581.343822,
        "cmd_duration_s": 0.007323026657104492,
        "cmd_pid": 64593,
        "cmd_process_name": "sandbox_openat_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64593",
            "--process-name",
            "sandbox_openat_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:59",
            "--end",
            "2026-01-03 10:23:03",
            "--row-id",
            "vfs_private_tmp_only_openat_dir_allowed:read_openat_/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only_openat_dir_allowed.read_openat__tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64593",
          "process_name": "sandbox_openat_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat_dir_allowed:read_openat_/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1170,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:03",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64593,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_reader(64593)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64593\")))",
              "process_name": "sandbox_openat_reader",
              "row_id": "vfs_private_tmp_only_openat_dir_allowed:read_openat_/tmp/foo",
              "start": "2026-01-03 10:22:59",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464581453,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:59",
          "observer_window_end": "2026-01-03 10:23:03",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_open_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat_dir_allowed:read_open_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":64596}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":64596}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464581.4549062,
        "cmd_finished_at_unix_s": 1767464581.4621902,
        "cmd_duration_s": 0.007283926010131836,
        "cmd_pid": 64596,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64596",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:59",
            "--end",
            "2026-01-03 10:23:03",
            "--row-id",
            "vfs_private_tmp_only_openat_dir_allowed:read_open_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only_openat_dir_allowed.read_open__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64596",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat_dir_allowed:read_open_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1162,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:03",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64596,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64596)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64596\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_private_tmp_only_openat_dir_allowed:read_open_/private/tmp/foo",
              "start": "2026-01-03 10:22:59",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464581572,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:59",
          "observer_window_end": "2026-01-03 10:23:03",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_/private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat_dir_allowed:read_openat_/private/tmp/foo",
        "operation": "file-read*",
        "path": "/private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/foo",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb",
          "/private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":64599}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":64599}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464581.573913,
        "cmd_finished_at_unix_s": 1767464581.5813801,
        "cmd_duration_s": 0.007467031478881836,
        "cmd_pid": 64599,
        "cmd_process_name": "sandbox_openat_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64599",
            "--process-name",
            "sandbox_openat_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:59",
            "--end",
            "2026-01-03 10:23:03",
            "--row-id",
            "vfs_private_tmp_only_openat_dir_allowed:read_openat_/private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only_openat_dir_allowed.read_openat__private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64599",
          "process_name": "sandbox_openat_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat_dir_allowed:read_openat_/private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1178,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:03",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64599,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_reader(64599)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64599\")))",
              "process_name": "sandbox_openat_reader",
              "row_id": "vfs_private_tmp_only_openat_dir_allowed:read_openat_/private/tmp/foo",
              "start": "2026-01-03 10:22:59",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464581692,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:59",
          "observer_window_end": "2026-01-03 10:23:03",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat_dir_allowed:read_openat_rootrel_tmp/foo",
        "operation": "file-read*",
        "path": "tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb",
          "tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":64602}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":64602}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464581.6940942,
        "cmd_finished_at_unix_s": 1767464581.701458,
        "cmd_duration_s": 0.007363796234130859,
        "cmd_pid": 64602,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64602",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:59",
            "--end",
            "2026-01-03 10:23:03",
            "--row-id",
            "vfs_private_tmp_only_openat_dir_allowed:read_openat_rootrel_tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only_openat_dir_allowed.read_openat_rootrel_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64602",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat_dir_allowed:read_openat_rootrel_tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1193,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:03",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64602,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(64602)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64602\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_private_tmp_only_openat_dir_allowed:read_openat_rootrel_tmp/foo",
              "start": "2026-01-03 10:22:59",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464581817,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:59",
          "observer_window_end": "2026-01-03 10:23:03",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_private/tmp/foo",
        "expectation_id": "vfs_private_tmp_only_openat_dir_allowed:read_openat_rootrel_private/tmp/foo",
        "operation": "file-read*",
        "path": "private/tmp/foo",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "private/tmp/foo",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "private/tmp/foo",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "private/tmp/foo",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb",
          "private/tmp/foo"
        ],
        "exit_code": 0,
        "stdout": "runtime-checks foo\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":64605}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_private_tmp_only_openat_dir_allowed.vfs_private_tmp_only_openat_dir_allowed.runtime.sb\",\"pid\":64605}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"private/tmp/foo\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"private/tmp/foo\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464581.8193228,
        "cmd_finished_at_unix_s": 1767464581.826515,
        "cmd_duration_s": 0.007192134857177734,
        "cmd_pid": 64605,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "private/tmp/foo",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64605",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:59",
            "--end",
            "2026-01-03 10:23:03",
            "--row-id",
            "vfs_private_tmp_only_openat_dir_allowed:read_openat_rootrel_private/tmp/foo"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_private_tmp_only_openat_dir_allowed.read_openat_rootrel_private_tmp_foo.observer.json",
          "log_write_error": null,
          "pid": "64605",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_private_tmp_only_openat_dir_allowed:read_openat_rootrel_private/tmp/foo",
          "correlation_id": null,
          "stdout_bytes": 1201,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:03",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64605,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(64605)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64605\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_private_tmp_only_openat_dir_allowed:read_openat_rootrel_private/tmp/foo",
              "start": "2026-01-03 10:22:59",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464581934,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:59",
          "observer_window_end": "2026-01-03 10:23:03",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_var_tmp_alias_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_alias_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":64608}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":64608}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464581.9368541,
        "cmd_finished_at_unix_s": 1767464581.9440992,
        "cmd_duration_s": 0.007245063781738281,
        "cmd_pid": 64608,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64608",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:22:59",
            "--end",
            "2026-01-03 10:23:03",
            "--row-id",
            "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_alias_only.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64608",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1148,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:03",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64608,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64608)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64608\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_alias_only:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:22:59",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464582054,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:22:59",
          "observer_window_end": "2026-01-03 10:23:03",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":64611}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":64611}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464582.0564458,
        "cmd_finished_at_unix_s": 1767464582.063636,
        "cmd_duration_s": 0.007190227508544922,
        "cmd_pid": 64611,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64611",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:00",
            "--end",
            "2026-01-03 10:23:04",
            "--row-id",
            "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_alias_only.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64611",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1149,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:04",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64611,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64611)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64611\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_alias_only:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:00",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464582168,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:00",
          "observer_window_end": "2026-01-03 10:23:04",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":64614}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":64614}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464582.17027,
        "cmd_finished_at_unix_s": 1767464582.177382,
        "cmd_duration_s": 0.007112026214599609,
        "cmd_pid": 64614,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64614",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:00",
            "--end",
            "2026-01-03 10:23:04",
            "--row-id",
            "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_alias_only.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64614",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1156,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:04",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64614,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64614)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64614\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_alias_only:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:00",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464582284,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:00",
          "observer_window_end": "2026-01-03 10:23:04",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":64617}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":64617}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464582.286252,
        "cmd_finished_at_unix_s": 1767464582.293458,
        "cmd_duration_s": 0.007205963134765625,
        "cmd_pid": 64617,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64617",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:00",
            "--end",
            "2026-01-03 10:23:04",
            "--row-id",
            "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_alias_only.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64617",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1157,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:04",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64617,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64617)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64617\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_alias_only:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:00",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464582401,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:00",
          "observer_window_end": "2026-01-03 10:23:04",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":64620}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":64620}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464582.4030578,
        "cmd_finished_at_unix_s": 1767464582.4102569,
        "cmd_duration_s": 0.00719904899597168,
        "cmd_pid": 64620,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64620",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:00",
            "--end",
            "2026-01-03 10:23:04",
            "--row-id",
            "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_alias_only.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64620",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1176,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:04",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64620,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64620)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64620\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_alias_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:00",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464582513,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:00",
          "observer_window_end": "2026-01-03 10:23:04",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":64623}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_alias_only.vfs_var_tmp_alias_only.runtime.sb\",\"pid\":64623}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464582.515199,
        "cmd_finished_at_unix_s": 1767464582.522323,
        "cmd_duration_s": 0.0071239471435546875,
        "cmd_pid": 64623,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64623",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:00",
            "--end",
            "2026-01-03 10:23:04",
            "--row-id",
            "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_alias_only.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64623",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1494,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:02.592441-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64623) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:04",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:02.592441-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64623) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64623,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64623)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64623\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_alias_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:00",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464582630,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:00",
          "observer_window_end": "2026-01-03 10:23:04",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_var_tmp_private_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":64626}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":64626}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464582.632124,
        "cmd_finished_at_unix_s": 1767464582.639283,
        "cmd_duration_s": 0.007158994674682617,
        "cmd_pid": 64626,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64626",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:00",
            "--end",
            "2026-01-03 10:23:04",
            "--row-id",
            "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_private_only.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64626",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1729,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:02.709096-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64626) deny(1) file-read-metadata /var",
                "2026-01-03 10:23:02.741365-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64626) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:04",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:02.709096-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64626) deny(1) file-read-metadata /var\n2026-01-03 10:23:02.741365-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64626) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64626,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64626)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64626\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_private_only:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:00",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464582744,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:00",
          "observer_window_end": "2026-01-03 10:23:04",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":64629}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":64629}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464582.745507,
        "cmd_finished_at_unix_s": 1767464582.752697,
        "cmd_duration_s": 0.00718998908996582,
        "cmd_pid": 64629,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64629",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:00",
            "--end",
            "2026-01-03 10:23:04",
            "--row-id",
            "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_private_only.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64629",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1730,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:02.822464-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64629) deny(1) file-read-metadata /var",
                "2026-01-03 10:23:02.852126-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64629) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:04",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:02.822464-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64629) deny(1) file-read-metadata /var\n2026-01-03 10:23:02.852126-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64629) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64629,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64629)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64629\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_private_only:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:00",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464582857,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:00",
          "observer_window_end": "2026-01-03 10:23:04",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":64632}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":64632}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464582.8589902,
        "cmd_finished_at_unix_s": 1767464582.866375,
        "cmd_duration_s": 0.007384777069091797,
        "cmd_pid": 64632,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64632",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:00",
            "--end",
            "2026-01-03 10:23:04",
            "--row-id",
            "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_private_only.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64632",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1158,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:04",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64632,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64632)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64632\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_private_only:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:00",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464582973,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:00",
          "observer_window_end": "2026-01-03 10:23:04",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":64635}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":64635}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464582.974991,
        "cmd_finished_at_unix_s": 1767464582.982286,
        "cmd_duration_s": 0.007294893264770508,
        "cmd_pid": 64635,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64635",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:00",
            "--end",
            "2026-01-03 10:23:04",
            "--row-id",
            "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_private_only.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64635",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1159,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:04",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64635,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64635)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64635\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_private_only:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:00",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464583094,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:00",
          "observer_window_end": "2026-01-03 10:23:04",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":64638}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":64638}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464583.0960221,
        "cmd_finished_at_unix_s": 1767464583.10329,
        "cmd_duration_s": 0.007267951965332031,
        "cmd_pid": 64638,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64638",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:01",
            "--end",
            "2026-01-03 10:23:05",
            "--row-id",
            "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_private_only.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64638",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1178,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64638,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64638)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64638\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_private_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464583206,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:01",
          "observer_window_end": "2026-01-03 10:23:05",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":64641}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_private_only.vfs_var_tmp_private_only.runtime.sb\",\"pid\":64641}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464583.207693,
        "cmd_finished_at_unix_s": 1767464583.214904,
        "cmd_duration_s": 0.007210969924926758,
        "cmd_pid": 64641,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64641",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:01",
            "--end",
            "2026-01-03 10:23:05",
            "--row-id",
            "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_private_only.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64641",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1179,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64641,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64641)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64641\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_private_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464583312,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:01",
          "observer_window_end": "2026-01-03 10:23:05",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_var_tmp_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":64644}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":64644}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464583.3148658,
        "cmd_finished_at_unix_s": 1767464583.322096,
        "cmd_duration_s": 0.007230281829833984,
        "cmd_pid": 64644,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64644",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:01",
            "--end",
            "2026-01-03 10:23:05",
            "--row-id",
            "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_both.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64644",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1721,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:03.391915-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64644) deny(1) file-read-metadata /var",
                "2026-01-03 10:23:03.422494-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64644) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:03.391915-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64644) deny(1) file-read-metadata /var\n2026-01-03 10:23:03.422494-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64644) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64644,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64644)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64644\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464583421,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:01",
          "observer_window_end": "2026-01-03 10:23:05",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":64647}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":64647}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464583.4231691,
        "cmd_finished_at_unix_s": 1767464583.430441,
        "cmd_duration_s": 0.007271766662597656,
        "cmd_pid": 64647,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64647",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:01",
            "--end",
            "2026-01-03 10:23:05",
            "--row-id",
            "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_both.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64647",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1722,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:03.500269-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64647) deny(1) file-read-metadata /var",
                "2026-01-03 10:23:03.531406-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64647) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:03.500269-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64647) deny(1) file-read-metadata /var\n2026-01-03 10:23:03.531406-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64647) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64647,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64647)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64647\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464583534,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:01",
          "observer_window_end": "2026-01-03 10:23:05",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":64650}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":64650}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464583.5355022,
        "cmd_finished_at_unix_s": 1767464583.5426838,
        "cmd_duration_s": 0.007181644439697266,
        "cmd_pid": 64650,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64650",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:01",
            "--end",
            "2026-01-03 10:23:05",
            "--row-id",
            "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_both.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64650",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64650,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64650)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64650\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464583647,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:01",
          "observer_window_end": "2026-01-03 10:23:05",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":64653}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":64653}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464583.6493251,
        "cmd_finished_at_unix_s": 1767464583.656613,
        "cmd_duration_s": 0.0072879791259765625,
        "cmd_pid": 64653,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64653",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:01",
            "--end",
            "2026-01-03 10:23:05",
            "--row-id",
            "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_both.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64653",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1151,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64653,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64653)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64653\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464583761,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:01",
          "observer_window_end": "2026-01-03 10:23:05",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":64656}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":64656}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464583.763293,
        "cmd_finished_at_unix_s": 1767464583.7704692,
        "cmd_duration_s": 0.00717616081237793,
        "cmd_pid": 64656,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64656",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:01",
            "--end",
            "2026-01-03 10:23:05",
            "--row-id",
            "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_both.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64656",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1170,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64656,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64656)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64656\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464583871,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:01",
          "observer_window_end": "2026-01-03 10:23:05",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":64659}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both.vfs_var_tmp_both.runtime.sb\",\"pid\":64659}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464583.8730052,
        "cmd_finished_at_unix_s": 1767464583.8803499,
        "cmd_duration_s": 0.007344722747802734,
        "cmd_pid": 64659,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64659",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:01",
            "--end",
            "2026-01-03 10:23:05",
            "--row-id",
            "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_both.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64659",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1171,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:05",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64659,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64659)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64659\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464583982,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:01",
          "observer_window_end": "2026-01-03 10:23:05",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_var_tmp_both_plus_metadata_var": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_both_plus_metadata_var.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/var",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:lstat_/var",
        "operation": "file-read-metadata",
        "path": "/var",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "api": "sandbox_check_by_audit_token",
              "token_status": "ok",
              "operation": "file-read-metadata",
              "rc": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "error": null,
              "marker_schema_version": 2,
              "canonical_flag_used": false,
              "decision": "deny",
              "no_report": true,
              "argument": "/var",
              "canonicalization": "raw",
              "varargs_count": 1,
              "no_report_reason": null,
              "filter_type": 1,
              "stage": "pre_syscall",
              "token_mach_kr": 0,
              "canonical_flag_reason": "not_requested",
              "tool": "seatbelt-callout",
              "errno": 0
            },
            {
              "api": "sandbox_check_by_audit_token",
              "token_status": "ok",
              "operation": "file-read-metadata",
              "rc": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "error": null,
              "marker_schema_version": 2,
              "canonical_flag_used": true,
              "decision": "deny",
              "no_report": true,
              "argument": "/var",
              "canonicalization": "canonical",
              "varargs_count": 1,
              "no_report_reason": null,
              "filter_type": 1,
              "stage": "pre_syscall",
              "token_mach_kr": 0,
              "canonical_flag_reason": null,
              "tool": "seatbelt-callout",
              "errno": 0
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/var",
          "--syscall",
          "lstat"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"mode\":\"sbpl\",\"marker_schema_version\":1,\"stage\":\"apply\",\"api\":\"sandbox_init\",\"errno\":0,\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/b45e4406-c756-4488-853e-c5a4d081adf4\\/runtime_profiles\\/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":64662,\"tool\":\"sbpl-apply\",\"err_class\":\"ok\",\"rc\":0,\"errbuf\":null,\"err_class_source\":\"none\"}\n{\"tool\":\"sbpl-apply\",\"mode\":\"sbpl\",\"marker_schema_version\":1,\"api\":\"sandbox_init\",\"stage\":\"applied\",\"rc\":0,\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/b45e4406-c756-4488-853e-c5a4d081adf4\\/runtime_profiles\\/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":64662}\n{\"api\":\"sandbox_check_by_audit_token\",\"token_status\":\"ok\",\"operation\":\"file-read-metadata\",\"rc\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"error\":null,\"marker_schema_version\":2,\"canonical_flag_used\":false,\"decision\":\"deny\",\"no_report\":true,\"argument\":\"\\/var\",\"canonicalization\":\"raw\",\"varargs_count\":1,\"no_report_reason\":null,\"filter_type\":1,\"stage\":\"pre_syscall\",\"token_mach_kr\":0,\"canonical_flag_reason\":\"not_requested\",\"tool\":\"seatbelt-callout\",\"errno\":0}\n{\"api\":\"sandbox_check_by_audit_token\",\"token_status\":\"ok\",\"operation\":\"file-read-metadata\",\"rc\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"error\":null,\"marker_schema_version\":2,\"canonical_flag_used\":true,\"decision\":\"deny\",\"no_report\":true,\"argument\":\"\\/var\",\"canonicalization\":\"canonical\",\"varargs_count\":1,\"no_report_reason\":null,\"filter_type\":1,\"stage\":\"pre_syscall\",\"token_mach_kr\":0,\"canonical_flag_reason\":null,\"tool\":\"seatbelt-callout\",\"errno\":0}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 0,
          "errno_name": "OK",
          "message": "stat-ok",
          "op": "file-read-metadata",
          "path": "/var",
          "status": "ok",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767464583.984496,
        "cmd_finished_at_unix_s": 1767464584.188892,
        "cmd_duration_s": 0.20439577102661133,
        "cmd_pid": 64662,
        "cmd_process_name": "metadata_runner",
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64662",
            "--process-name",
            "metadata_runner",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:01",
            "--end",
            "2026-01-03 10:23:06",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:lstat_/var"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_both_plus_metadata_var.lstat__var.observer.json",
          "log_write_error": null,
          "pid": "64662",
          "process_name": "metadata_runner",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:lstat_/var",
          "correlation_id": null,
          "stdout_bytes": 8499,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:04.254239-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) sysctl-read kern.maxfilesperproc",
                "2026-01-03 10:23:04.255724-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/api/runtime/native/metadata_runner",
                "2026-01-03 10:23:04.255748-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/api/runtime/native/metadata_runner",
                "2026-01-03 10:23:04.256312-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:04.256393-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:04.256428-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:04.256431-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-metadata /Users/achyland",
                "2026-01-03 10:23:04.256655-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:04.256720-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:04.257037-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:04.257041-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:04.257096-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:04.257159-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:04.257163-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:04.257222-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:04.257279-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:04.257282-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:04.257335-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:04.257389-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:04.257393-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:04.257443-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:04.257804-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:04.257807-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:06",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:04.254239-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) sysctl-read kern.maxfilesperproc\n2026-01-03 10:23:04.255724-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/api/runtime/native/metadata_runner\n2026-01-03 10:23:04.255748-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/api/runtime/native/metadata_runner\n2026-01-03 10:23:04.256312-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:04.256393-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc\n2026-01-03 10:23:04.256428-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc\n2026-01-03 10:23:04.256431-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-metadata /Users/achyland\n2026-01-03 10:23:04.256655-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:04.256720-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc\n2026-01-03 10:23:04.257037-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc\n2026-01-03 10:23:04.257041-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:04.257096-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc\n2026-01-03 10:23:04.257159-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc\n2026-01-03 10:23:04.257163-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:04.257222-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc\n2026-01-03 10:23:04.257279-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc\n2026-01-03 10:23:04.257282-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:04.257335-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc\n2026-01-03 10:23:04.257389-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc\n2026-01-03 10:23:04.257393-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:04.257443-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc\n2026-01-03 10:23:04.257804-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64662) deny(1) file-read-metadata /etc\n2026-01-03 10:23:04.257807-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64662) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 24,
              "observer_schema_version": 1,
              "pid": 64662,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: metadata_runner(64662)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64662\")))",
              "process_name": "metadata_runner",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:lstat_/var",
              "start": "2026-01-03 10:23:01",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464584336,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:01",
          "observer_window_end": "2026-01-03 10:23:06",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":64665}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":64665}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464584.338594,
        "cmd_finished_at_unix_s": 1767464584.345877,
        "cmd_duration_s": 0.00728297233581543,
        "cmd_pid": 64665,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64665",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:02",
            "--end",
            "2026-01-03 10:23:06",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_both_plus_metadata_var.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64665",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1160,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:06",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64665,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64665)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64665\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:02",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464584447,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:02",
          "observer_window_end": "2026-01-03 10:23:06",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":64668}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":64668}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464584.448477,
        "cmd_finished_at_unix_s": 1767464584.455809,
        "cmd_duration_s": 0.0073320865631103516,
        "cmd_pid": 64668,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64668",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:02",
            "--end",
            "2026-01-03 10:23:06",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_both_plus_metadata_var.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64668",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1161,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:06",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64668,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64668)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64668\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:02",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464584560,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:02",
          "observer_window_end": "2026-01-03 10:23:06",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_canon_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":64671}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":64671}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464584.561595,
        "cmd_finished_at_unix_s": 1767464584.5688362,
        "cmd_duration_s": 0.007241249084472656,
        "cmd_pid": 64671,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64671",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:02",
            "--end",
            "2026-01-03 10:23:06",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_both_plus_metadata_var.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64671",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1168,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:06",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64671,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64671)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64671\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:02",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464584673,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:02",
          "observer_window_end": "2026-01-03 10:23:06",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":64674}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_both_plus_metadata_var.vfs_var_tmp_both_plus_metadata_var.runtime.sb\",\"pid\":64674}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_canon_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_canon_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464584.675055,
        "cmd_finished_at_unix_s": 1767464584.6822112,
        "cmd_duration_s": 0.0071561336517333984,
        "cmd_pid": 64674,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64674",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:02",
            "--end",
            "2026-01-03 10:23:06",
            "--row-id",
            "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_both_plus_metadata_var.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64674",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1169,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:06",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64674,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64674)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64674\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_both_plus_metadata_var:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:02",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464584794,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:02",
          "observer_window_end": "2026-01-03 10:23:06",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_var_tmp_data_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_var_tmp_data_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":64677}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":64677}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464584.796305,
        "cmd_finished_at_unix_s": 1767464584.803508,
        "cmd_duration_s": 0.007203102111816406,
        "cmd_pid": 64677,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64677",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:02",
            "--end",
            "2026-01-03 10:23:06",
            "--row-id",
            "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_data_only.read__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64677",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1726,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:04.873390-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64677) deny(1) file-read-metadata /var",
                "2026-01-03 10:23:04.906643-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64677) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:06",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:04.873390-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64677) deny(1) file-read-metadata /var\n2026-01-03 10:23:04.906643-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64677) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64677,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64677)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64677\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_data_only:read_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:02",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464584920,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:02",
          "observer_window_end": "2026-01-03 10:23:06",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":64680}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":64680}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464584.921461,
        "cmd_finished_at_unix_s": 1767464584.928705,
        "cmd_duration_s": 0.0072438716888427734,
        "cmd_pid": 64680,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64680",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:02",
            "--end",
            "2026-01-03 10:23:06",
            "--row-id",
            "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_data_only.write__var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64680",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1727,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:04.998556-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64680) deny(1) file-read-metadata /var",
                "2026-01-03 10:23:05.028128-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64680) deny(1) file-read-metadata /var"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:06",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:04.998556-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64680) deny(1) file-read-metadata /var\n2026-01-03 10:23:05.028128-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64680) deny(1) file-read-metadata /var",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64680,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64680)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64680\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_data_only:write_/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:02",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464585040,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:02",
          "observer_window_end": "2026-01-03 10:23:06",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":64683}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":64683}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464585.041497,
        "cmd_finished_at_unix_s": 1767464585.048733,
        "cmd_duration_s": 0.007236003875732422,
        "cmd_pid": 64683,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64683",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:03",
            "--end",
            "2026-01-03 10:23:07",
            "--row-id",
            "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_data_only.read__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64683",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1470,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:05.118942-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64683) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:07",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:05.118942-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64683) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64683,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64683)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64683\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_data_only:read_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:03",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464585161,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:03",
          "observer_window_end": "2026-01-03 10:23:07",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_canon_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":64686}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":64686}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464585.163441,
        "cmd_finished_at_unix_s": 1767464585.170528,
        "cmd_duration_s": 0.007086992263793945,
        "cmd_pid": 64686,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64686",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:03",
            "--end",
            "2026-01-03 10:23:07",
            "--row-id",
            "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_data_only.write__private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64686",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1473,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:05.240745-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64686) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:07",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:05.240745-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64686) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64686,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64686)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64686\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_data_only:write_/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:03",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464585283,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:03",
          "observer_window_end": "2026-01-03 10:23:07",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":64689}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":64689}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464585.2851882,
        "cmd_finished_at_unix_s": 1767464585.292371,
        "cmd_duration_s": 0.0071828365325927734,
        "cmd_pid": 64689,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64689",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:03",
            "--end",
            "2026-01-03 10:23:07",
            "--row-id",
            "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_data_only.read__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64689",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1490,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:05.362604-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64689) deny(1) file-read-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:07",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:05.362604-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64689) deny(1) file-read-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64689,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64689)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64689\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_var_tmp_data_only:read_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:03",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464585401,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:03",
          "observer_window_end": "2026-01-03 10:23:07",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expectation_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_canon_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb",
          "/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":64692}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_var_tmp_data_only.vfs_var_tmp_data_only.runtime.sb\",\"pid\":64692}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/var/tmp/vfs_canon_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464585.4033852,
        "cmd_finished_at_unix_s": 1767464585.410631,
        "cmd_duration_s": 0.007245779037475586,
        "cmd_pid": 64692,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64692",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:03",
            "--end",
            "2026-01-03 10:23:07",
            "--row-id",
            "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_var_tmp_data_only.write__System_Volumes_Data_private_var_tmp_vfs_canon_probe.observer.json",
          "log_write_error": null,
          "pid": "64692",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
          "correlation_id": null,
          "stdout_bytes": 1493,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:05.480877-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64692) deny(1) file-write-data /private/var/tmp/vfs_canon_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:07",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:05.480877-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64692) deny(1) file-write-data /private/var/tmp/vfs_canon_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64692,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64692)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64692\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_var_tmp_data_only:write_/System/Volumes/Data/private/var/tmp/vfs_canon_probe",
              "start": "2026-01-03 10:23:03",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464585524,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:03",
          "observer_window_end": "2026-01-03 10:23:07",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_etc_alias_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_alias_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_alias_only:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":64695}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":64695}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464585.5262778,
        "cmd_finished_at_unix_s": 1767464585.533401,
        "cmd_duration_s": 0.007123231887817383,
        "cmd_pid": 64695,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64695",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:03",
            "--end",
            "2026-01-03 10:23:07",
            "--row-id",
            "vfs_etc_alias_only:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_etc_alias_only.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "64695",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_alias_only:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1709,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:05.603334-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64695) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:05.635306-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64695) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:07",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:05.603334-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64695) deny(1) file-read-metadata /etc\n2026-01-03 10:23:05.635306-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64695) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64695,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64695)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64695\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_alias_only:read_/etc/hosts",
              "start": "2026-01-03 10:23:03",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464585647,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:03",
          "observer_window_end": "2026-01-03 10:23:07",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_alias_only:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":64698}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_alias_only.vfs_etc_alias_only.runtime.sb\",\"pid\":64698}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464585.648929,
        "cmd_finished_at_unix_s": 1767464585.656062,
        "cmd_duration_s": 0.007132768630981445,
        "cmd_pid": 64698,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64698",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:03",
            "--end",
            "2026-01-03 10:23:07",
            "--row-id",
            "vfs_etc_alias_only:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_etc_alias_only.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "64698",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_alias_only:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1425,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:05.726315-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64698) deny(1) file-read-data /private/etc/hosts"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:07",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:05.726315-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64698) deny(1) file-read-data /private/etc/hosts",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64698,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64698)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64698\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_alias_only:read_/private/etc/hosts",
              "start": "2026-01-03 10:23:03",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464585768,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:03",
          "observer_window_end": "2026-01-03 10:23:07",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_etc_private_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_private_only:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":64701}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":64701}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464585.770432,
        "cmd_finished_at_unix_s": 1767464585.777589,
        "cmd_duration_s": 0.007157087326049805,
        "cmd_pid": 64701,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64701",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:03",
            "--end",
            "2026-01-03 10:23:07",
            "--row-id",
            "vfs_etc_private_only:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_etc_private_only.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "64701",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_private_only:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1711,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:05.847512-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64701) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:05.880432-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64701) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:07",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:05.847512-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64701) deny(1) file-read-metadata /etc\n2026-01-03 10:23:05.880432-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64701) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64701,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64701)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64701\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_private_only:read_/etc/hosts",
              "start": "2026-01-03 10:23:03",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464585892,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:03",
          "observer_window_end": "2026-01-03 10:23:07",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_private_only:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":64704}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_private_only.vfs_etc_private_only.runtime.sb\",\"pid\":64704}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464585.8938,
        "cmd_finished_at_unix_s": 1767464585.900981,
        "cmd_duration_s": 0.007180929183959961,
        "cmd_pid": 64704,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64704",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:03",
            "--end",
            "2026-01-03 10:23:07",
            "--row-id",
            "vfs_etc_private_only:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_etc_private_only.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "64704",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_private_only:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1140,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:07",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64704,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64704)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64704\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_private_only:read_/private/etc/hosts",
              "start": "2026-01-03 10:23:03",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464586011,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:03",
          "observer_window_end": "2026-01-03 10:23:07",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_etc_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_both:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":64707}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":64707}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464586.013694,
        "cmd_finished_at_unix_s": 1767464586.020937,
        "cmd_duration_s": 0.007242918014526367,
        "cmd_pid": 64707,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64707",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:04",
            "--end",
            "2026-01-03 10:23:08",
            "--row-id",
            "vfs_etc_both:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_etc_both.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "64707",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1703,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:06.090864-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64707) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:06.119563-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64707) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:08",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:06.090864-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64707) deny(1) file-read-metadata /etc\n2026-01-03 10:23:06.119563-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64707) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64707,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64707)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64707\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both:read_/etc/hosts",
              "start": "2026-01-03 10:23:04",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464586133,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:04",
          "observer_window_end": "2026-01-03 10:23:08",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_both:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":64710}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":64710}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464586.1345978,
        "cmd_finished_at_unix_s": 1767464586.141817,
        "cmd_duration_s": 0.0072193145751953125,
        "cmd_pid": 64710,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64710",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:04",
            "--end",
            "2026-01-03 10:23:08",
            "--row-id",
            "vfs_etc_both:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_etc_both.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "64710",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1132,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:08",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64710,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64710)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64710\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both:read_/private/etc/hosts",
              "start": "2026-01-03 10:23:04",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464586249,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:04",
          "observer_window_end": "2026-01-03 10:23:08",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_etc/hosts",
        "expectation_id": "vfs_etc_both:read_openat_rootrel_etc/hosts",
        "operation": "file-read*",
        "path": "etc/hosts",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "etc/hosts"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":64713}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":64713}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopenat(root) target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464586.2513359,
        "cmd_finished_at_unix_s": 1767464586.258501,
        "cmd_duration_s": 0.007165193557739258,
        "cmd_pid": 64713,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64713",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:04",
            "--end",
            "2026-01-03 10:23:08",
            "--row-id",
            "vfs_etc_both:read_openat_rootrel_etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_etc_both.read_openat_rootrel_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "64713",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_openat_rootrel_etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1465,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:06.328768-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_rootrel_reader(64713) deny(1) file-read-metadata /etc"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:08",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:06.328768-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_openat_rootrel_reader(64713) deny(1) file-read-metadata /etc",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64713,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(64713)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64713\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_etc_both:read_openat_rootrel_etc/hosts",
              "start": "2026-01-03 10:23:04",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464586369,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:04",
          "observer_window_end": "2026-01-03 10:23:08",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_private/etc/hosts",
        "expectation_id": "vfs_etc_both:read_openat_rootrel_private/etc/hosts",
        "operation": "file-read*",
        "path": "private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb",
          "private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":64716}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both.vfs_etc_both.runtime.sb\",\"pid\":64716}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464586.370524,
        "cmd_finished_at_unix_s": 1767464586.377644,
        "cmd_duration_s": 0.0071201324462890625,
        "cmd_pid": 64716,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64716",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:04",
            "--end",
            "2026-01-03 10:23:08",
            "--row-id",
            "vfs_etc_both:read_openat_rootrel_private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_etc_both.read_openat_rootrel_private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "64716",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both:read_openat_rootrel_private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1176,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:08",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64716,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(64716)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64716\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_etc_both:read_openat_rootrel_private/etc/hosts",
              "start": "2026-01-03 10:23:04",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464586491,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:04",
          "observer_window_end": "2026-01-03 10:23:08",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_etc_both_plus_metadata_etc": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_etc_both_plus_metadata_etc.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/etc",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:lstat_/etc",
        "operation": "file-read-metadata",
        "path": "/etc",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "errno": 0,
              "operation": "file-read-metadata",
              "rc": 1,
              "decision": "deny",
              "token_mach_kr": 0,
              "canonical_flag_reason": "not_requested",
              "canonical_flag_used": false,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "argument": "/etc",
              "error": null,
              "check_type": 1073741825,
              "no_report": true,
              "tool": "seatbelt-callout",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "varargs_count": 1,
              "no_report_reason": null,
              "canonicalization": "raw",
              "token_status": "ok",
              "marker_schema_version": 2
            },
            {
              "errno": 0,
              "operation": "file-read-metadata",
              "rc": 1,
              "decision": "deny",
              "token_mach_kr": 0,
              "canonical_flag_reason": null,
              "canonical_flag_used": true,
              "stage": "pre_syscall",
              "api": "sandbox_check_by_audit_token",
              "argument": "/etc",
              "error": null,
              "check_type": 1610612737,
              "no_report": true,
              "tool": "seatbelt-callout",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "varargs_count": 1,
              "no_report_reason": null,
              "canonicalization": "canonical",
              "token_status": "ok",
              "marker_schema_version": 2
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/etc",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/etc",
          "--syscall",
          "lstat"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"errbuf\":null,\"err_class\":\"ok\",\"errno\":0,\"marker_schema_version\":1,\"api\":\"sandbox_init\",\"rc\":0,\"tool\":\"sbpl-apply\",\"err_class_source\":\"none\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/b45e4406-c756-4488-853e-c5a4d081adf4\\/runtime_profiles\\/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"mode\":\"sbpl\",\"pid\":64719,\"stage\":\"apply\"}\n{\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/b45e4406-c756-4488-853e-c5a4d081adf4\\/runtime_profiles\\/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"pid\":64719,\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"rc\":0,\"stage\":\"applied\"}\n{\"errno\":0,\"operation\":\"file-read-metadata\",\"rc\":1,\"decision\":\"deny\",\"token_mach_kr\":0,\"canonical_flag_reason\":\"not_requested\",\"canonical_flag_used\":false,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"argument\":\"\\/etc\",\"error\":null,\"check_type\":1073741825,\"no_report\":true,\"tool\":\"seatbelt-callout\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"varargs_count\":1,\"no_report_reason\":null,\"canonicalization\":\"raw\",\"token_status\":\"ok\",\"marker_schema_version\":2}\n{\"errno\":0,\"operation\":\"file-read-metadata\",\"rc\":1,\"decision\":\"deny\",\"token_mach_kr\":0,\"canonical_flag_reason\":null,\"canonical_flag_used\":true,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"argument\":\"\\/etc\",\"error\":null,\"check_type\":1610612737,\"no_report\":true,\"tool\":\"seatbelt-callout\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"varargs_count\":1,\"no_report_reason\":null,\"canonicalization\":\"canonical\",\"token_status\":\"ok\",\"marker_schema_version\":2}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 0,
          "errno_name": "OK",
          "message": "stat-ok",
          "op": "file-read-metadata",
          "path": "/etc",
          "status": "ok",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767464586.493213,
        "cmd_finished_at_unix_s": 1767464586.502756,
        "cmd_duration_s": 0.009543180465698242,
        "cmd_pid": 64719,
        "cmd_process_name": "metadata_runner",
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/etc",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64719",
            "--process-name",
            "metadata_runner",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:04",
            "--end",
            "2026-01-03 10:23:08",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:lstat_/etc"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_etc_both_plus_metadata_etc.lstat__etc.observer.json",
          "log_write_error": null,
          "pid": "64719",
          "process_name": "metadata_runner",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:lstat_/etc",
          "correlation_id": null,
          "stdout_bytes": 8531,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:06.571133-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) sysctl-read kern.maxfilesperproc",
                "2026-01-03 10:23:06.571719-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/api/runtime/native/metadata_runner",
                "2026-01-03 10:23:06.571727-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/api/runtime/native/metadata_runner",
                "2026-01-03 10:23:06.571985-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:06.572061-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 10:23:06.572068-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 10:23:06.572083-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-metadata /Users/achyland",
                "2026-01-03 10:23:06.572194-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:06.572232-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 10:23:06.572236-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 10:23:06.572359-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:06.572391-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 10:23:06.572395-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 10:23:06.572418-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:06.572452-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 10:23:06.572457-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 10:23:06.572478-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:06.572505-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 10:23:06.572509-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 10:23:06.572527-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:06.572553-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-data /private/etc/passwd",
                "2026-01-03 10:23:06.572558-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-metadata /private/etc/passwd",
                "2026-01-03 10:23:06.572685-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:08",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:06.571133-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) sysctl-read kern.maxfilesperproc\n2026-01-03 10:23:06.571719-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/api/runtime/native/metadata_runner\n2026-01-03 10:23:06.571727-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/api/runtime/native/metadata_runner\n2026-01-03 10:23:06.571985-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:06.572061-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-data /private/etc/passwd\n2026-01-03 10:23:06.572068-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 10:23:06.572083-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-metadata /Users/achyland\n2026-01-03 10:23:06.572194-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:06.572232-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-data /private/etc/passwd\n2026-01-03 10:23:06.572236-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 10:23:06.572359-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:06.572391-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-data /private/etc/passwd\n2026-01-03 10:23:06.572395-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 10:23:06.572418-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:06.572452-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-data /private/etc/passwd\n2026-01-03 10:23:06.572457-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 10:23:06.572478-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:06.572505-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-data /private/etc/passwd\n2026-01-03 10:23:06.572509-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 10:23:06.572527-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:06.572553-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-data /private/etc/passwd\n2026-01-03 10:23:06.572558-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-metadata /private/etc/passwd\n2026-01-03 10:23:06.572685-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64719) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 24,
              "observer_schema_version": 1,
              "pid": 64719,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: metadata_runner(64719)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64719\")))",
              "process_name": "metadata_runner",
              "row_id": "vfs_etc_both_plus_metadata_etc:lstat_/etc",
              "start": "2026-01-03 10:23:04",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464586616,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:04",
          "observer_window_end": "2026-01-03 10:23:08",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_etc/hosts",
        "operation": "file-read*",
        "path": "etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":64722}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":64722}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464586.618021,
        "cmd_finished_at_unix_s": 1767464586.625275,
        "cmd_duration_s": 0.007253885269165039,
        "cmd_pid": 64722,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64722",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:04",
            "--end",
            "2026-01-03 10:23:08",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_etc_both_plus_metadata_etc.read_openat_rootrel_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "64722",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1186,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:08",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64722,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(64722)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64722\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_etc/hosts",
              "start": "2026-01-03 10:23:04",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464586736,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:04",
          "observer_window_end": "2026-01-03 10:23:08",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_openat_rootrel_private/etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_private/etc/hosts",
        "operation": "file-read*",
        "path": "private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": null,
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": null,
            "apply_timing": null,
            "preexisting_sandbox_suspected": null,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_openat_rootrel_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":64725}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":64725}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464586.738094,
        "cmd_finished_at_unix_s": 1767464586.745267,
        "cmd_duration_s": 0.007172822952270508,
        "cmd_pid": 64725,
        "cmd_process_name": "sandbox_openat_rootrel_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64725",
            "--process-name",
            "sandbox_openat_rootrel_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:04",
            "--end",
            "2026-01-03 10:23:08",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_etc_both_plus_metadata_etc.read_openat_rootrel_private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "64725",
          "process_name": "sandbox_openat_rootrel_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1194,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:08",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64725,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_openat_rootrel_reader(64725)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64725\")))",
              "process_name": "sandbox_openat_rootrel_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_openat_rootrel_private/etc/hosts",
              "start": "2026-01-03 10:23:04",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464586866,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:04",
          "observer_window_end": "2026-01-03 10:23:08",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_/etc/hosts",
        "operation": "file-read*",
        "path": "/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":64728}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":64728}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464586.867934,
        "cmd_finished_at_unix_s": 1767464586.875103,
        "cmd_duration_s": 0.007169008255004883,
        "cmd_pid": 64728,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64728",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:04",
            "--end",
            "2026-01-03 10:23:08",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_etc_both_plus_metadata_etc.read__etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "64728",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1142,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:08",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64728,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64728)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64728\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_/etc/hosts",
              "start": "2026-01-03 10:23:04",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464586995,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:04",
          "observer_window_end": "2026-01-03 10:23:08",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/etc/hosts",
        "expectation_id": "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts",
        "operation": "file-read*",
        "path": "/private/etc/hosts",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/etc/hosts",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/etc/hosts",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/etc/hosts",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb",
          "/private/etc/hosts"
        ],
        "exit_code": 0,
        "stdout": "##\n# Host Database\n#\n# localhost is used to configure the loopback interface\n# when the system is booting.  Do not change this entry.\n##\n127.0.0.1\tlocalhost\n255.255.255.255\tbroadcasthost\n::1             localhost\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":64731}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_etc_both_plus_metadata_etc.vfs_etc_both_plus_metadata_etc.runtime.sb\",\"pid\":64731}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/etc/hosts\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464586.9971142,
        "cmd_finished_at_unix_s": 1767464587.004365,
        "cmd_duration_s": 0.007250785827636719,
        "cmd_pid": 64731,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/etc/hosts",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64731",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:04",
            "--end",
            "2026-01-03 10:23:09",
            "--row-id",
            "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_etc_both_plus_metadata_etc.read__private_etc_hosts.observer.json",
          "log_write_error": null,
          "pid": "64731",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:09",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64731,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64731)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64731\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_etc_both_plus_metadata_etc:read_/private/etc/hosts",
              "start": "2026-01-03 10:23:04",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464587121,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:04",
          "observer_window_end": "2026-01-03 10:23:09",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_firmlink_private_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_private_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":64734}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":64734}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464587.123252,
        "cmd_finished_at_unix_s": 1767464587.130666,
        "cmd_duration_s": 0.007414102554321289,
        "cmd_pid": 64734,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64734",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:05",
            "--end",
            "2026-01-03 10:23:09",
            "--row-id",
            "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_firmlink_private_only.read__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "64734",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1158,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:09",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64734,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64734)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64734\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_private_only:read_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 10:23:05",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464587229,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:05",
          "observer_window_end": "2026-01-03 10:23:09",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":64737}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":64737}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464587.230554,
        "cmd_finished_at_unix_s": 1767464587.237762,
        "cmd_duration_s": 0.0072078704833984375,
        "cmd_pid": 64737,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64737",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:05",
            "--end",
            "2026-01-03 10:23:09",
            "--row-id",
            "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_firmlink_private_only.write__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "64737",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1159,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:09",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64737,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64737)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64737\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_private_only:write_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 10:23:05",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464587337,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:05",
          "observer_window_end": "2026-01-03 10:23:09",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":64740}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":64740}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464587.338557,
        "cmd_finished_at_unix_s": 1767464587.345789,
        "cmd_duration_s": 0.007231950759887695,
        "cmd_pid": 64740,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64740",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:05",
            "--end",
            "2026-01-03 10:23:09",
            "--row-id",
            "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_firmlink_private_only.read__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "64740",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1178,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:09",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64740,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64740)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64740\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_private_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 10:23:05",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464587447,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:05",
          "observer_window_end": "2026-01-03 10:23:09",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "allow",
        "match": false,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":64743}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_private_only.vfs_firmlink_private_only.runtime.sb\",\"pid\":64743}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464587.4486542,
        "cmd_finished_at_unix_s": 1767464587.456061,
        "cmd_duration_s": 0.007406711578369141,
        "cmd_pid": 64743,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64743",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:05",
            "--end",
            "2026-01-03 10:23:09",
            "--row-id",
            "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_firmlink_private_only.write__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "64743",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1179,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:09",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64743,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64743)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64743\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_private_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 10:23:05",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464587560,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:05",
          "observer_window_end": "2026-01-03 10:23:09",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_firmlink_data_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_data_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":64746}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":64746}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464587.563002,
        "cmd_finished_at_unix_s": 1767464587.57032,
        "cmd_duration_s": 0.007317781448364258,
        "cmd_pid": 64746,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64746",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:05",
            "--end",
            "2026-01-03 10:23:09",
            "--row-id",
            "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_firmlink_data_only.read__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "64746",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1468,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:07.640641-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64746) deny(1) file-read-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:09",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:07.640641-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64746) deny(1) file-read-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64746,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64746)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64746\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_data_only:read_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 10:23:05",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464587674,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:05",
          "observer_window_end": "2026-01-03 10:23:09",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":64749}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":64749}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464587.675725,
        "cmd_finished_at_unix_s": 1767464587.682969,
        "cmd_duration_s": 0.007244110107421875,
        "cmd_pid": 64749,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64749",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:05",
            "--end",
            "2026-01-03 10:23:09",
            "--row-id",
            "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_firmlink_data_only.write__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "64749",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1471,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:07.753315-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64749) deny(1) file-write-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:09",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:07.753315-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64749) deny(1) file-write-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64749,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64749)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64749\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_data_only:write_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 10:23:05",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464587792,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:05",
          "observer_window_end": "2026-01-03 10:23:09",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":64752}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":64752}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464587.793636,
        "cmd_finished_at_unix_s": 1767464587.8009222,
        "cmd_duration_s": 0.00728607177734375,
        "cmd_pid": 64752,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64752",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:05",
            "--end",
            "2026-01-03 10:23:09",
            "--row-id",
            "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_firmlink_data_only.read__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "64752",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1488,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:07.871248-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64752) deny(1) file-read-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:09",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:07.871248-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64752) deny(1) file-read-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64752,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64752)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64752\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_data_only:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 10:23:05",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464587907,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:05",
          "observer_window_end": "2026-01-03 10:23:09",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":64755}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_data_only.vfs_firmlink_data_only.runtime.sb\",\"pid\":64755}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464587.908695,
        "cmd_finished_at_unix_s": 1767464587.916209,
        "cmd_duration_s": 0.007513999938964844,
        "cmd_pid": 64755,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64755",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:05",
            "--end",
            "2026-01-03 10:23:09",
            "--row-id",
            "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_firmlink_data_only.write__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "64755",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1491,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:07.986538-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64755) deny(1) file-write-data /private/tmp/vfs_firmlink_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:09",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:07.986538-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64755) deny(1) file-write-data /private/tmp/vfs_firmlink_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64755,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64755)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64755\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_data_only:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 10:23:05",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464588023,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:05",
          "observer_window_end": "2026-01-03 10:23:09",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_firmlink_both": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_firmlink_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":64758}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":64758}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464588.026043,
        "cmd_finished_at_unix_s": 1767464588.033323,
        "cmd_duration_s": 0.007280111312866211,
        "cmd_pid": 64758,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64758",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:06",
            "--end",
            "2026-01-03 10:23:10",
            "--row-id",
            "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_firmlink_both.read__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "64758",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1150,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:10",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64758,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64758)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64758\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_both:read_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 10:23:06",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464588133,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:06",
          "observer_window_end": "2026-01-03 10:23:10",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":64761}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":64761}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464588.134948,
        "cmd_finished_at_unix_s": 1767464588.142167,
        "cmd_duration_s": 0.007219076156616211,
        "cmd_pid": 64761,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64761",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:06",
            "--end",
            "2026-01-03 10:23:10",
            "--row-id",
            "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_firmlink_both.write__private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "64761",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1151,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:10",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64761,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64761)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64761\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_both:write_/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 10:23:06",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464588245,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:06",
          "observer_window_end": "2026-01-03 10:23:10",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-read*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_firmlink_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":64764}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":64764}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464588.246749,
        "cmd_finished_at_unix_s": 1767464588.254158,
        "cmd_duration_s": 0.007409095764160156,
        "cmd_pid": 64764,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64764",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:06",
            "--end",
            "2026-01-03 10:23:10",
            "--row-id",
            "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_firmlink_both.read__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "64764",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1170,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:10",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64764,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64764)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64764\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_firmlink_both:read_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 10:23:06",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464588358,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:06",
          "observer_window_end": "2026-01-03 10:23:10",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expectation_id": "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "operation": "file-write*",
        "path": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/vfs_firmlink_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb",
          "/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":64767}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_firmlink_both.vfs_firmlink_both.runtime.sb\",\"pid\":64767}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/System/Volumes/Data/private/tmp/vfs_firmlink_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/vfs_firmlink_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/vfs_firmlink_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464588.3601742,
        "cmd_finished_at_unix_s": 1767464588.367519,
        "cmd_duration_s": 0.007344722747802734,
        "cmd_pid": 64767,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64767",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:06",
            "--end",
            "2026-01-03 10:23:10",
            "--row-id",
            "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_firmlink_both.write__System_Volumes_Data_private_tmp_vfs_firmlink_probe.observer.json",
          "log_write_error": null,
          "pid": "64767",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
          "correlation_id": null,
          "stdout_bytes": 1171,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:10",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64767,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64767)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64767\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_firmlink_both:write_/System/Volumes/Data/private/tmp/vfs_firmlink_probe",
              "start": "2026-01-03 10:23:06",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464588471,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:06",
          "observer_window_end": "2026-01-03 10:23:10",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_link_var_tmp_only": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_var_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":64770}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":64770}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464588.47361,
        "cmd_finished_at_unix_s": 1767464588.480912,
        "cmd_duration_s": 0.007302045822143555,
        "cmd_pid": 64770,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64770",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:06",
            "--end",
            "2026-01-03 10:23:10",
            "--row-id",
            "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_link_var_tmp_only.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "64770",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1876,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:08.550927-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64770) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
                "2026-01-03 10:23:08.580188-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64770) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:10",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:08.550927-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64770) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp\n2026-01-03 10:23:08.580188-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64770) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64770,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64770)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64770\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_var_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 10:23:06",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464588587,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:06",
          "observer_window_end": "2026-01-03 10:23:10",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":64773}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":64773}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464588.589351,
        "cmd_finished_at_unix_s": 1767464588.596454,
        "cmd_duration_s": 0.00710296630859375,
        "cmd_pid": 64773,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64773",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:06",
            "--end",
            "2026-01-03 10:23:10",
            "--row-id",
            "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_link_var_tmp_only.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "64773",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1877,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:08.666476-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64773) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
                "2026-01-03 10:23:08.696585-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64773) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:10",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:08.666476-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64773) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp\n2026-01-03 10:23:08.696585-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64773) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64773,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64773)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64773\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_var_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 10:23:06",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464588705,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:06",
          "observer_window_end": "2026-01-03 10:23:10",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":64776}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":64776}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464588.706787,
        "cmd_finished_at_unix_s": 1767464588.714211,
        "cmd_duration_s": 0.007423877716064453,
        "cmd_pid": 64776,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64776",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:06",
            "--end",
            "2026-01-03 10:23:10",
            "--row-id",
            "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_link_var_tmp_only.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "64776",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1154,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:10",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64776,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64776)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64776\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_var_tmp_only:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 10:23:06",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464588822,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:06",
          "observer_window_end": "2026-01-03 10:23:10",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":64779}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_var_tmp_only.vfs_link_var_tmp_only.runtime.sb\",\"pid\":64779}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464588.824042,
        "cmd_finished_at_unix_s": 1767464588.831323,
        "cmd_duration_s": 0.007280826568603516,
        "cmd_pid": 64779,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64779",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:06",
            "--end",
            "2026-01-03 10:23:10",
            "--row-id",
            "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_link_var_tmp_only.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "64779",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1155,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:10",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64779,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64779)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64779\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_var_tmp_only:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 10:23:06",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464588941,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:06",
          "observer_window_end": "2026-01-03 10:23:10",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_link_private_tmp_only": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_private_tmp_only.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":64782}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":64782}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464588.943064,
        "cmd_finished_at_unix_s": 1767464588.950424,
        "cmd_duration_s": 0.007359981536865234,
        "cmd_pid": 64782,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64782",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:06",
            "--end",
            "2026-01-03 10:23:10",
            "--row-id",
            "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_link_private_tmp_only.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "64782",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1880,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:09.020443-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64782) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
                "2026-01-03 10:23:09.053905-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64782) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:10",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:09.020443-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64782) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp\n2026-01-03 10:23:09.053905-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64782) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64782,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64782)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64782\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_private_tmp_only:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 10:23:06",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464589057,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:06",
          "observer_window_end": "2026-01-03 10:23:10",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":64785}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":64785}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464589.0595021,
        "cmd_finished_at_unix_s": 1767464589.066752,
        "cmd_duration_s": 0.0072498321533203125,
        "cmd_pid": 64785,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64785",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:07",
            "--end",
            "2026-01-03 10:23:11",
            "--row-id",
            "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_link_private_tmp_only.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "64785",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1881,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:09.136773-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64785) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
                "2026-01-03 10:23:09.169435-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64785) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:11",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:09.136773-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64785) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp\n2026-01-03 10:23:09.169435-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64785) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64785,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64785)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64785\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_private_tmp_only:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 10:23:07",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464589172,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:07",
          "observer_window_end": "2026-01-03 10:23:11",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":64788}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":64788}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464589.1737459,
        "cmd_finished_at_unix_s": 1767464589.181057,
        "cmd_duration_s": 0.007311105728149414,
        "cmd_pid": 64788,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64788",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:07",
            "--end",
            "2026-01-03 10:23:11",
            "--row-id",
            "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_link_private_tmp_only.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "64788",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1471,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:09.251458-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64788) deny(1) file-read-data /private/var/tmp/vfs_link_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:11",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:09.251458-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64788) deny(1) file-read-data /private/var/tmp/vfs_link_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64788,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64788)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64788\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_private_tmp_only:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 10:23:07",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464589282,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:07",
          "observer_window_end": "2026-01-03 10:23:11",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":64791}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_private_tmp_only.vfs_link_private_tmp_only.runtime.sb\",\"pid\":64791}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464589.2844028,
        "cmd_finished_at_unix_s": 1767464589.2916448,
        "cmd_duration_s": 0.007241964340209961,
        "cmd_pid": 64791,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64791",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:07",
            "--end",
            "2026-01-03 10:23:11",
            "--row-id",
            "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_link_private_tmp_only.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "64791",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1474,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:09.362045-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64791) deny(1) file-write-data /private/var/tmp/vfs_link_probe"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:11",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:09.362045-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64791) deny(1) file-write-data /private/var/tmp/vfs_link_probe",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 2,
              "observer_schema_version": 1,
              "pid": 64791,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64791)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64791\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_private_tmp_only:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 10:23:07",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464589393,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:07",
          "observer_window_end": "2026-01-03 10:23:11",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_link_both": {
    "status": "partial",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_both.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":64794}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":64794}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464589.3953128,
        "cmd_finished_at_unix_s": 1767464589.402516,
        "cmd_duration_s": 0.007203102111816406,
        "cmd_pid": 64794,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64794",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:07",
            "--end",
            "2026-01-03 10:23:11",
            "--row-id",
            "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_link_both.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "64794",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1868,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:09.472562-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64794) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
                "2026-01-03 10:23:09.502199-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64794) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:11",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:09.472562-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_reader(64794) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp\n2026-01-03 10:23:09.502199-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_reader(64794) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64794,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64794)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64794\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 10:23:07",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464589503,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:07",
          "observer_window_end": "2026-01-03 10:23:11",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":64797}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":64797}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464589.505226,
        "cmd_finished_at_unix_s": 1767464589.512405,
        "cmd_duration_s": 0.0071790218353271484,
        "cmd_pid": 64797,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64797",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:07",
            "--end",
            "2026-01-03 10:23:11",
            "--row-id",
            "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_link_both.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "64797",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1869,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:09.582465-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64797) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
                "2026-01-03 10:23:09.612084-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64797) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:11",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:09.582465-0800  localhost kernel[0]: (Sandbox) Sandbox: sandbox_writer(64797) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp\n2026-01-03 10:23:09.612084-0800  localhost kernel[0]: (Sandbox) 2 duplicate reports for Sandbox: sandbox_writer(64797) deny(1) file-read-metadata /private/tmp/vfs_linkdir/to_var_tmp",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 3,
              "observer_schema_version": 1,
              "pid": 64797,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64797)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64797\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 10:23:07",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464589611,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:07",
          "observer_window_end": "2026-01-03 10:23:11",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":64800}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":64800}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464589.612573,
        "cmd_finished_at_unix_s": 1767464589.619833,
        "cmd_duration_s": 0.00726008415222168,
        "cmd_pid": 64800,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64800",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:07",
            "--end",
            "2026-01-03 10:23:11",
            "--row-id",
            "vfs_link_both:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_link_both.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "64800",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1146,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:11",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64800,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64800)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64800\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 10:23:07",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464589723,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:07",
          "observer_window_end": "2026-01-03 10:23:11",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":64803}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both.vfs_link_both.runtime.sb\",\"pid\":64803}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464589.724591,
        "cmd_finished_at_unix_s": 1767464589.731832,
        "cmd_duration_s": 0.007241010665893555,
        "cmd_pid": 64803,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64803",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:07",
            "--end",
            "2026-01-03 10:23:11",
            "--row-id",
            "vfs_link_both:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_link_both.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "64803",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1147,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:11",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64803,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64803)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64803\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 10:23:07",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464589834,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:07",
          "observer_window_end": "2026-01-03 10:23:11",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  },
  "vfs_link_both_plus_metadata_to_var_tmp": {
    "status": "ok",
    "profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
    "base_profile_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/sb/vfs_link_both_plus_metadata_to_var_tmp.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9",
      "input_kind": "sbpl_path",
      "input_ref": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "lstat_/private/tmp/vfs_linkdir/to_var_tmp",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp",
        "operation": "file-read-metadata",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "metadata_runner",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/metadata_runner/metadata_runner",
            "entrypoint_sha256": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5",
            "tool_build_id": "bb38e088b7b968286048a161f03d5e3f103c868dbc69cb6a53e84d7b71ef43e5"
          },
          "seatbelt_callouts": [
            {
              "stage": "pre_syscall",
              "canonical_flag_reason": "not_requested",
              "api": "sandbox_check_by_audit_token",
              "no_report": true,
              "canonical_flag_used": false,
              "token_mach_kr": 0,
              "errno": 0,
              "token_status": "ok",
              "filter_type_name": "unknown",
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "error": null,
              "operation": "file-read-metadata",
              "canonicalization": "raw",
              "no_report_reason": null,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
              "decision": "deny",
              "rc": 1,
              "filter_type": 1,
              "check_type": 1073741825,
              "varargs_count": 1
            },
            {
              "stage": "pre_syscall",
              "canonical_flag_reason": null,
              "api": "sandbox_check_by_audit_token",
              "no_report": true,
              "canonical_flag_used": true,
              "token_mach_kr": 0,
              "errno": 0,
              "token_status": "ok",
              "filter_type_name": "unknown",
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "error": null,
              "operation": "file-read-metadata",
              "canonicalization": "canonical",
              "no_report_reason": null,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
              "decision": "deny",
              "rc": 1,
              "filter_type": 1,
              "check_type": 1610612737,
              "varargs_count": 1
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-metadata",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/metadata_runner/metadata_runner",
          "--sbpl",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "--op",
          "file-read-metadata",
          "--path",
          "/private/tmp/vfs_linkdir/to_var_tmp",
          "--syscall",
          "lstat"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"pid\":64806,\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/b45e4406-c756-4488-853e-c5a4d081adf4\\/runtime_profiles\\/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"mode\":\"sbpl\",\"marker_schema_version\":1,\"stage\":\"apply\",\"rc\":0,\"err_class_source\":\"none\",\"errno\":0,\"tool\":\"sbpl-apply\",\"api\":\"sandbox_init\",\"err_class\":\"ok\",\"errbuf\":null}\n{\"mode\":\"sbpl\",\"profile\":\"\\/private\\/tmp\\/sandbox-lore-launchctl\\/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4\\/book\\/evidence\\/experiments\\/runtime-final-final\\/suites\\/vfs-canonicalization\\/out\\/b45e4406-c756-4488-853e-c5a4d081adf4\\/runtime_profiles\\/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"api\":\"sandbox_init\",\"pid\":64806,\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"rc\":0}\n{\"stage\":\"pre_syscall\",\"canonical_flag_reason\":\"not_requested\",\"api\":\"sandbox_check_by_audit_token\",\"no_report\":true,\"canonical_flag_used\":false,\"token_mach_kr\":0,\"errno\":0,\"token_status\":\"ok\",\"filter_type_name\":\"unknown\",\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"error\":null,\"operation\":\"file-read-metadata\",\"canonicalization\":\"raw\",\"no_report_reason\":null,\"argument\":\"\\/private\\/tmp\\/vfs_linkdir\\/to_var_tmp\",\"decision\":\"deny\",\"rc\":1,\"filter_type\":1,\"check_type\":1073741825,\"varargs_count\":1}\n{\"stage\":\"pre_syscall\",\"canonical_flag_reason\":null,\"api\":\"sandbox_check_by_audit_token\",\"no_report\":true,\"canonical_flag_used\":true,\"token_mach_kr\":0,\"errno\":0,\"token_status\":\"ok\",\"filter_type_name\":\"unknown\",\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"error\":null,\"operation\":\"file-read-metadata\",\"canonicalization\":\"canonical\",\"no_report_reason\":null,\"argument\":\"\\/private\\/tmp\\/vfs_linkdir\\/to_var_tmp\",\"decision\":\"deny\",\"rc\":1,\"filter_type\":1,\"check_type\":1610612737,\"varargs_count\":1}\n",
        "probe_details": {
          "apply_mode": "sbpl",
          "apply_rc": 0,
          "errno": 0,
          "errno_name": "OK",
          "message": "stat-ok",
          "op": "file-read-metadata",
          "path": "/private/tmp/vfs_linkdir/to_var_tmp",
          "status": "ok",
          "syscall": "lstat"
        },
        "cmd_started_at_unix_s": 1767464589.836402,
        "cmd_finished_at_unix_s": 1767464589.845824,
        "cmd_duration_s": 0.009422063827514648,
        "cmd_pid": 64806,
        "cmd_process_name": "metadata_runner",
        "sandbox_check_request": {
          "operation": "file-read-metadata",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64806",
            "--process-name",
            "metadata_runner",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:07",
            "--end",
            "2026-01-03 10:23:11",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_link_both_plus_metadata_to_var_tmp.lstat__private_tmp_vfs_linkdir_to_var_tmp.observer.json",
          "log_write_error": null,
          "pid": "64806",
          "process_name": "metadata_runner",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp",
          "correlation_id": null,
          "stdout_bytes": 8534,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [
                "2026-01-03 10:23:09.914527-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) sysctl-read kern.maxfilesperproc",
                "2026-01-03 10:23:09.915089-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/api/runtime/native/metadata_runner",
                "2026-01-03 10:23:09.915097-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/api/runtime/native/metadata_runner",
                "2026-01-03 10:23:09.915308-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:09.915340-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:09.915351-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:09.915353-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-metadata /Users/achyland",
                "2026-01-03 10:23:09.915426-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:09.915451-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:09.915595-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:09.915596-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:09.915625-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:09.915649-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:09.915650-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:09.915671-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:09.915693-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:09.915694-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:09.915713-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:09.915730-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:09.915731-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo",
                "2026-01-03 10:23:09.915750-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:09.915876-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc",
                "2026-01-03 10:23:09.915877-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist"
              ],
              "duration_ms": null,
              "end": "2026-01-03 10:23:11",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    \n2026-01-03 10:23:09.914527-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) sysctl-read kern.maxfilesperproc\n2026-01-03 10:23:09.915089-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-data /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/api/runtime/native/metadata_runner\n2026-01-03 10:23:09.915097-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-metadata /private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/api/runtime/native/metadata_runner\n2026-01-03 10:23:09.915308-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:09.915340-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc\n2026-01-03 10:23:09.915351-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc\n2026-01-03 10:23:09.915353-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-metadata /Users/achyland\n2026-01-03 10:23:09.915426-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:09.915451-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc\n2026-01-03 10:23:09.915595-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc\n2026-01-03 10:23:09.915596-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:09.915625-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc\n2026-01-03 10:23:09.915649-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc\n2026-01-03 10:23:09.915650-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:09.915671-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc\n2026-01-03 10:23:09.915693-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc\n2026-01-03 10:23:09.915694-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:09.915713-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc\n2026-01-03 10:23:09.915730-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc\n2026-01-03 10:23:09.915731-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) mach-lookup com.apple.system.opendirectoryd.libinfo\n2026-01-03 10:23:09.915750-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc\n2026-01-03 10:23:09.915876-0800  localhost kernel[0]: (Sandbox) 1 duplicate report for Sandbox: metadata_runner(64806) deny(1) file-read-metadata /etc\n2026-01-03 10:23:09.915877-0800  localhost kernel[0]: (Sandbox) Sandbox: metadata_runner(64806) deny(1) file-read-data /Library/Preferences/.GlobalPreferences.plist",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": true,
              "observed_lines": 24,
              "observer_schema_version": 1,
              "pid": 64806,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: metadata_runner(64806)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64806\")))",
              "process_name": "metadata_runner",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:lstat_/private/tmp/vfs_linkdir/to_var_tmp",
              "start": "2026-01-03 10:23:07",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464589945,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:07",
          "observer_window_end": "2026-01-03 10:23:11",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":64809}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":64809}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464589.947722,
        "cmd_finished_at_unix_s": 1767464589.955001,
        "cmd_duration_s": 0.007279157638549805,
        "cmd_pid": 64809,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64809",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:07",
            "--end",
            "2026-01-03 10:23:11",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_link_both_plus_metadata_to_var_tmp.read__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "64809",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1190,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:11",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64809,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64809)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64809\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 10:23:07",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464590060,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:07",
          "observer_window_end": "2026-01-03 10:23:11",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":64812}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":64812}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464590.061524,
        "cmd_finished_at_unix_s": 1767464590.068844,
        "cmd_duration_s": 0.0073201656341552734,
        "cmd_pid": 64812,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64812",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:08",
            "--end",
            "2026-01-03 10:23:12",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_link_both_plus_metadata_to_var_tmp.write__private_tmp_vfs_linkdir_to_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "64812",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1191,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:12",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64812,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64812)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64812\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/tmp/vfs_linkdir/to_var_tmp/vfs_link_probe",
              "start": "2026-01-03 10:23:08",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464590172,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:08",
          "observer_window_end": "2026-01-03 10:23:12",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "read_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe",
        "operation": "file-read*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b",
            "tool_build_id": "7273c5ae47b8db1b82a9d9849b8c6f68aa8d65f95a5c46e662d26dae06b9d93b"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "vfs-canonicalization vfs_link_probe\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":64815}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":64815}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464590.1736782,
        "cmd_finished_at_unix_s": 1767464590.1810691,
        "cmd_duration_s": 0.0073909759521484375,
        "cmd_pid": 64815,
        "cmd_process_name": "sandbox_reader",
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64815",
            "--process-name",
            "sandbox_reader",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:08",
            "--end",
            "2026-01-03 10:23:12",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_link_both_plus_metadata_to_var_tmp.read__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "64815",
          "process_name": "sandbox_reader",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1171,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:12",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64815,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_reader(64815)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64815\")))",
              "process_name": "sandbox_reader",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:read_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 10:23:08",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464590283,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:08",
          "observer_window_end": "2026-01-03 10:23:12",
          "observer_window_pad_s": 2.0
        }
      },
      {
        "name": "write_/private/var/tmp/vfs_link_probe",
        "expectation_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe",
        "operation": "file-write*",
        "path": "/private/var/tmp/vfs_link_probe",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89",
            "tool_build_id": "67b85716ea26b76abe9f798187e2e9cccc5a4f63e0d73aecf3e0874d10694b89"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1073741825,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "raw",
              "canonical_flag_used": false,
              "canonical_flag_reason": "not_requested",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            },
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 1,
              "filter_type_name": "unknown",
              "check_type": 1610612737,
              "varargs_count": 1,
              "argument": "/private/var/tmp/vfs_link_probe",
              "canonicalization": "canonical",
              "canonical_flag_used": true,
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null,
              "canonical_flag_reason": null
            }
          ],
          "intended_op_witnessed": true,
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 1,
            "filter_name": "path",
            "argument": "/private/var/tmp/vfs_link_probe",
            "canonicalization": "both"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": [],
            "preopen_hints": [],
            "preopen_detected": false
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/var/tmp/vfs_link_probe",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb",
          "/private/var/tmp/vfs_link_probe"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":64818}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.b45e4406-c756-4488-853e-c5a4d081adf4/book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/runtime_profiles/vfs_link_both_plus_metadata_to_var_tmp.vfs_link_both_plus_metadata_to_var_tmp.runtime.sb\",\"pid\":64818}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1073741825,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":1,\"filter_type_name\":\"unknown\",\"check_type\":1610612737,\"varargs_count\":1,\"argument\":\"/private/var/tmp/vfs_link_probe\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\nF_GETPATH:/private/var/tmp/vfs_link_probe\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/var/tmp/vfs_link_probe\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767464590.284707,
        "cmd_finished_at_unix_s": 1767464590.292045,
        "cmd_duration_s": 0.007338047027587891,
        "cmd_pid": 64818,
        "cmd_process_name": "sandbox_writer",
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 1,
          "filter_name": "path",
          "argument": "/private/var/tmp/vfs_link_probe",
          "canonicalization": "both"
        },
        "observer": {
          "command": [
            "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
            "--pid",
            "64818",
            "--process-name",
            "sandbox_writer",
            "--format",
            "json",
            "--start",
            "2026-01-03 10:23:08",
            "--end",
            "2026-01-03 10:23:12",
            "--row-id",
            "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe"
          ],
          "exit_code": 0,
          "stderr": "",
          "log_path": "book/evidence/experiments/runtime-final-final/suites/vfs-canonicalization/out/b45e4406-c756-4488-853e-c5a4d081adf4/observer/vfs_link_both_plus_metadata_to_var_tmp.write__private_var_tmp_vfs_link_probe.observer.json",
          "log_write_error": null,
          "pid": "64818",
          "process_name": "sandbox_writer",
          "last": "10s",
          "plan_id": null,
          "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe",
          "correlation_id": null,
          "stdout_bytes": 1172,
          "report": {
            "data": {
              "correlation_id": null,
              "deny_lines": [],
              "duration_ms": null,
              "end": "2026-01-03 10:23:12",
              "last": null,
              "layer_attribution": {
                "seatbelt": "observer_only"
              },
              "log_error": null,
              "log_rc": 0,
              "log_stderr": "",
              "log_stdout": "Timestamp                       (process)[PID]    ",
              "log_truncated": false,
              "mode": "show",
              "observed_deny": false,
              "observed_lines": 1,
              "observer_schema_version": 1,
              "pid": 64818,
              "plan_id": null,
              "predicate": "((eventMessage CONTAINS[c] \"Sandbox: sandbox_writer(64818)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"64818\")))",
              "process_name": "sandbox_writer",
              "row_id": "vfs_link_both_plus_metadata_to_var_tmp:write_/private/var/tmp/vfs_link_probe",
              "start": "2026-01-03 10:23:08",
              "stop_on_pid_exit": false
            },
            "generated_at_unix_ms": 1767464590393,
            "kind": "sandbox_log_observer_report",
            "result": {
              "errno": null,
              "error": null,
              "exit_code": 0,
              "normalized_outcome": null,
              "ok": true,
              "rc": null,
              "stderr": null,
              "stdout": null
            },
            "schema_version": 1
          },
          "report_error": null,
          "observer_window_mode": "range",
          "observer_window_start": "2026-01-03 10:23:08",
          "observer_window_end": "2026-01-03 10:23:12",
          "observer_window_pad_s": 2.0
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "b45e4406-c756-4488-853e-c5a4d081adf4"
  }
}