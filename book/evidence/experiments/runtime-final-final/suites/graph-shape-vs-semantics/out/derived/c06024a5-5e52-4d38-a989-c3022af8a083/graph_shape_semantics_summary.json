{
  "provenance": {
    "artifact_index": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/c06024a5-5e52-4d38-a989-c3022af8a083/artifact_index.json",
    "artifact_index_sha256": "869729780ba8f1d30888c18edcef07577914ee1066ba19f4ddc578b9aef5078f",
    "bundle_dir": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/c06024a5-5e52-4d38-a989-c3022af8a083",
    "consumption_receipt": "book/evidence/experiments/graph-shape-vs-semantics/out/derived/c06024a5-5e52-4d38-a989-c3022af8a083/consumption_receipt.json",
    "exports": {
      "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/c06024a5-5e52-4d38-a989-c3022af8a083/run_manifest.json",
      "runtime_results": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/c06024a5-5e52-4d38-a989-c3022af8a083/runtime_results.json"
    },
    "packet": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/promotion_packet.json",
    "run_id": "c06024a5-5e52-4d38-a989-c3022af8a083"
  },
  "schema_version": "graph-shape-vs-semantics.summary.v0",
  "summary": {
    "mach global-name literal vs regex variants": {
      "aligned_expectations": [
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "allow-cfprefsd",
          "expected": "allow",
          "profile_a": "adv:mach_simple_allow",
          "profile_b": "adv:mach_simple_variants"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "deny-bogus",
          "expected": "deny",
          "profile_a": "adv:mach_simple_allow",
          "profile_b": "adv:mach_simple_variants"
        }
      ],
      "mismatches": [],
      "profiles": [
        "adv:mach_simple_allow",
        "adv:mach_simple_variants"
      ]
    },
    "mach local-name literal vs regex variants": {
      "aligned_expectations": [
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "allow-cfprefsd-local",
          "expected": "allow",
          "profile_a": "adv:mach_local_literal",
          "profile_b": "adv:mach_local_regex"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "deny-bogus-local",
          "expected": "deny",
          "profile_a": "adv:mach_local_literal",
          "profile_b": "adv:mach_local_regex"
        }
      ],
      "mismatches": [],
      "profiles": [
        "adv:mach_local_literal",
        "adv:mach_local_regex"
      ]
    },
    "path_edges": {
      "mismatches": [
        {
          "actual": "deny",
          "command": [
            "book/evidence/experiments/runtime-final-final/suites/runtime-checks/sandbox_reader",
            "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/c06024a5-5e52-4d38-a989-c3022af8a083/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
            "/tmp/runtime-adv/edges/a"
          ],
          "exit_code": 2,
          "expectation_id": "adv:path_edges:allow-tmp",
          "expected": "allow",
          "match": false,
          "name": "allow-tmp",
          "operation": "file-read*",
          "path": "/tmp/runtime-adv/edges/a",
          "path_observation": {
            "observed_path": "/private/tmp/runtime-adv/edges/a",
            "observed_path_errno": null,
            "observed_path_nofirmlink": null,
            "observed_path_nofirmlink_errno": null,
            "observed_path_nofirmlink_source": "unsandboxed_unavailable",
            "observed_path_source": "unsandboxed_fd_path"
          },
          "probe_details": null,
          "runtime_result": {
            "apply_report": {
              "api": "sandbox_init",
              "err_class": "ok",
              "err_class_source": "none",
              "errbuf": null,
              "errno": 0,
              "rc": 0
            },
            "errno": 2,
            "failure_kind": "probe_nonzero_exit",
            "failure_stage": "probe",
            "runner_info": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "entrypoint": "sandbox_reader",
              "entrypoint_path": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/sandbox_reader",
              "entrypoint_sha256": "9e84e162afdadcdb5007b1fe978b4d6adfdef947911b319e494cf400e92890a1",
              "preexisting_sandbox_suspected": false,
              "tool_build_id": "9e84e162afdadcdb5007b1fe978b4d6adfdef947911b319e494cf400e92890a1"
            },
            "runtime_result_schema_version": 1,
            "seatbelt_callouts": null,
            "status": "errno",
            "tool_marker_schema_version": 2
          },
          "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.c06024a5-5e52-4d38-a989-c3022af8a083/book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/c06024a5-5e52-4d38-a989-c3022af8a083/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":20186}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.c06024a5-5e52-4d38-a989-c3022af8a083/book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/c06024a5-5e52-4d38-a989-c3022af8a083/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":20186}\nopen target: Operation not permitted\n",
          "stdout": "",
          "violation_summary": null
        },
        {
          "actual": "deny",
          "command": [
            "book/evidence/experiments/runtime-final-final/suites/runtime-checks/sandbox_reader",
            "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/c06024a5-5e52-4d38-a989-c3022af8a083/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
            "/tmp/runtime-adv/edges/okdir/item.txt"
          ],
          "exit_code": 2,
          "expectation_id": "adv:path_edges:allow-subpath",
          "expected": "allow",
          "match": false,
          "name": "allow-subpath",
          "operation": "file-read*",
          "path": "/tmp/runtime-adv/edges/okdir/item.txt",
          "path_observation": {
            "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
            "observed_path_errno": null,
            "observed_path_nofirmlink": null,
            "observed_path_nofirmlink_errno": null,
            "observed_path_nofirmlink_source": "unsandboxed_unavailable",
            "observed_path_source": "unsandboxed_fd_path"
          },
          "probe_details": null,
          "runtime_result": {
            "apply_report": {
              "api": "sandbox_init",
              "err_class": "ok",
              "err_class_source": "none",
              "errbuf": null,
              "errno": 0,
              "rc": 0
            },
            "errno": 2,
            "failure_kind": "probe_nonzero_exit",
            "failure_stage": "probe",
            "runner_info": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "entrypoint": "sandbox_reader",
              "entrypoint_path": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/sandbox_reader",
              "entrypoint_sha256": "9e84e162afdadcdb5007b1fe978b4d6adfdef947911b319e494cf400e92890a1",
              "preexisting_sandbox_suspected": false,
              "tool_build_id": "9e84e162afdadcdb5007b1fe978b4d6adfdef947911b319e494cf400e92890a1"
            },
            "runtime_result_schema_version": 1,
            "seatbelt_callouts": null,
            "status": "errno",
            "tool_marker_schema_version": 2
          },
          "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.c06024a5-5e52-4d38-a989-c3022af8a083/book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/c06024a5-5e52-4d38-a989-c3022af8a083/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":20188}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.c06024a5-5e52-4d38-a989-c3022af8a083/book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/c06024a5-5e52-4d38-a989-c3022af8a083/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":20188}\nopen target: Operation not permitted\n",
          "stdout": "",
          "violation_summary": null
        },
        {
          "actual": "deny",
          "command": [
            "book/evidence/experiments/runtime-final-final/suites/runtime-checks/sandbox_writer",
            "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/c06024a5-5e52-4d38-a989-c3022af8a083/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
            "/tmp/runtime-adv/edges/a"
          ],
          "exit_code": 2,
          "expectation_id": "adv:path_edges:write-tmp",
          "expected": "allow",
          "match": false,
          "name": "write-tmp",
          "operation": "file-write*",
          "path": "/tmp/runtime-adv/edges/a",
          "path_observation": {
            "observed_path": "/private/tmp/runtime-adv/edges/a",
            "observed_path_errno": null,
            "observed_path_nofirmlink": null,
            "observed_path_nofirmlink_errno": null,
            "observed_path_nofirmlink_source": "unsandboxed_unavailable",
            "observed_path_source": "unsandboxed_fd_path"
          },
          "probe_details": null,
          "runtime_result": {
            "apply_report": {
              "api": "sandbox_init",
              "err_class": "ok",
              "err_class_source": "none",
              "errbuf": null,
              "errno": 0,
              "rc": 0
            },
            "errno": 2,
            "failure_kind": "probe_nonzero_exit",
            "failure_stage": "probe",
            "runner_info": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "entrypoint": "sandbox_writer",
              "entrypoint_path": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/sandbox_writer",
              "entrypoint_sha256": "9259579f33774fb82cbb474d3b6acbdbd6c1ff064f53f2af2a91e1e390e33fe7",
              "preexisting_sandbox_suspected": false,
              "tool_build_id": "9259579f33774fb82cbb474d3b6acbdbd6c1ff064f53f2af2a91e1e390e33fe7"
            },
            "runtime_result_schema_version": 1,
            "seatbelt_callouts": null,
            "status": "errno",
            "tool_marker_schema_version": 2
          },
          "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.c06024a5-5e52-4d38-a989-c3022af8a083/book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/c06024a5-5e52-4d38-a989-c3022af8a083/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":20191}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.c06024a5-5e52-4d38-a989-c3022af8a083/book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/c06024a5-5e52-4d38-a989-c3022af8a083/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":20191}\nopen target: Operation not permitted\n",
          "stdout": "",
          "violation_summary": null
        },
        {
          "actual": "deny",
          "command": [
            "book/evidence/experiments/runtime-final-final/suites/runtime-checks/sandbox_writer",
            "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/c06024a5-5e52-4d38-a989-c3022af8a083/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
            "/tmp/runtime-adv/edges/okdir/item.txt"
          ],
          "exit_code": 2,
          "expectation_id": "adv:path_edges:write-subpath",
          "expected": "allow",
          "match": false,
          "name": "write-subpath",
          "operation": "file-write*",
          "path": "/tmp/runtime-adv/edges/okdir/item.txt",
          "path_observation": {
            "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
            "observed_path_errno": null,
            "observed_path_nofirmlink": null,
            "observed_path_nofirmlink_errno": null,
            "observed_path_nofirmlink_source": "unsandboxed_unavailable",
            "observed_path_source": "unsandboxed_fd_path"
          },
          "probe_details": null,
          "runtime_result": {
            "apply_report": {
              "api": "sandbox_init",
              "err_class": "ok",
              "err_class_source": "none",
              "errbuf": null,
              "errno": 0,
              "rc": 0
            },
            "errno": 2,
            "failure_kind": "probe_nonzero_exit",
            "failure_stage": "probe",
            "runner_info": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "entrypoint": "sandbox_writer",
              "entrypoint_path": "book/evidence/experiments/runtime-final-final/suites/runtime-checks/sandbox_writer",
              "entrypoint_sha256": "9259579f33774fb82cbb474d3b6acbdbd6c1ff064f53f2af2a91e1e390e33fe7",
              "preexisting_sandbox_suspected": false,
              "tool_build_id": "9259579f33774fb82cbb474d3b6acbdbd6c1ff064f53f2af2a91e1e390e33fe7"
            },
            "runtime_result_schema_version": 1,
            "seatbelt_callouts": null,
            "status": "errno",
            "tool_marker_schema_version": 2
          },
          "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.c06024a5-5e52-4d38-a989-c3022af8a083/book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/c06024a5-5e52-4d38-a989-c3022af8a083/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":20193}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.c06024a5-5e52-4d38-a989-c3022af8a083/book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/c06024a5-5e52-4d38-a989-c3022af8a083/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":20193}\nopen target: Operation not permitted\n",
          "stdout": "",
          "violation_summary": null
        }
      ],
      "note": "expected allow on /tmp variants denied (VFS canonicalization likely)",
      "profiles": [
        "adv:path_edges"
      ]
    },
    "structural variants of same intent (read/write)": {
      "aligned_expectations": [
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "allow-ok-deep",
          "expected": "allow",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "allow-ok-root",
          "expected": "allow",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "deny-blocked",
          "expected": "deny",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "deny-outside",
          "expected": "deny",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "write-blocked",
          "expected": "deny",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "write-ok-deep",
          "expected": "allow",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "write-ok-root",
          "expected": "allow",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "write-outside",
          "expected": "deny",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        }
      ],
      "mismatches": [],
      "profiles": [
        "adv:struct_flat",
        "adv:struct_nested"
      ]
    }
  },
  "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"
}
