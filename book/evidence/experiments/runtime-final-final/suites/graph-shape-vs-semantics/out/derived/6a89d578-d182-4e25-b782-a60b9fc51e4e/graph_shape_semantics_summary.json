{
  "provenance": {
    "artifact_index": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/artifact_index.json",
    "artifact_index_sha256": "ca42b807d991a436c258b3f8b7bc636234a8444c18b1f14e3f815fa9723c445a",
    "bundle_dir": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e",
    "consumption_receipt": "book/evidence/experiments/graph-shape-vs-semantics/out/derived/6a89d578-d182-4e25-b782-a60b9fc51e4e/consumption_receipt.json",
    "exports": {
      "path_witnesses": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/path_witnesses.json",
      "run_manifest": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/run_manifest.json",
      "runtime_results": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_results.json"
    },
    "packet": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/promotion_packet.json",
    "run_id": "6a89d578-d182-4e25-b782-a60b9fc51e4e"
  },
  "schema_version": "graph-shape-vs-semantics.summary.v0",
  "summary": {
    "mach global-name literal vs regex variants": {
      "aligned_expectations": [
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "allow-cfprefsd",
          "expected": "allow",
          "profile_a": "adv:mach_simple_allow",
          "profile_b": "adv:mach_simple_variants"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "deny-bogus",
          "expected": "deny",
          "profile_a": "adv:mach_simple_allow",
          "profile_b": "adv:mach_simple_variants"
        }
      ],
      "mismatches": [],
      "profiles": [
        "adv:mach_simple_allow",
        "adv:mach_simple_variants"
      ]
    },
    "mach local-name literal vs regex variants": {
      "aligned_expectations": [
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "allow-cfprefsd-local",
          "expected": "allow",
          "profile_a": "adv:mach_local_literal",
          "profile_b": "adv:mach_local_regex"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "deny-bogus-local",
          "expected": "deny",
          "profile_a": "adv:mach_local_literal",
          "profile_b": "adv:mach_local_regex"
        }
      ],
      "mismatches": [],
      "profiles": [
        "adv:mach_local_literal",
        "adv:mach_local_regex"
      ]
    },
    "path_edges": {
      "canonicalization_boundary": [
        {
          "expectation_id": "adv:path_edges:allow-tmp",
          "operation": "file-read*",
          "probe_name": "allow-tmp",
          "witness": {
            "lane": "baseline",
            "normalized_path": "/private/tmp/runtime-adv/edges/a",
            "normalized_path_source": "observed_path",
            "observed_path": "/private/tmp/runtime-adv/edges/a",
            "observed_path_source": "unsandboxed_fd_path",
            "requested_path": "/tmp/runtime-adv/edges/a",
            "scenario_id": "baseline:adv:path_edges:allow-tmp"
          }
        },
        {
          "expectation_id": "adv:path_edges:allow-subpath",
          "operation": "file-read*",
          "probe_name": "allow-subpath",
          "witness": {
            "lane": "baseline",
            "normalized_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
            "normalized_path_source": "observed_path",
            "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
            "observed_path_source": "unsandboxed_fd_path",
            "requested_path": "/tmp/runtime-adv/edges/okdir/item.txt",
            "scenario_id": "baseline:adv:path_edges:allow-subpath"
          }
        },
        {
          "expectation_id": "adv:path_edges:write-tmp",
          "operation": "file-write*",
          "probe_name": "write-tmp",
          "witness": {
            "lane": "baseline",
            "normalized_path": "/private/tmp/runtime-adv/edges/a",
            "normalized_path_source": "observed_path",
            "observed_path": "/private/tmp/runtime-adv/edges/a",
            "observed_path_source": "unsandboxed_fd_path",
            "requested_path": "/tmp/runtime-adv/edges/a",
            "scenario_id": "baseline:adv:path_edges:write-tmp"
          }
        },
        {
          "expectation_id": "adv:path_edges:write-subpath",
          "operation": "file-write*",
          "probe_name": "write-subpath",
          "witness": {
            "lane": "baseline",
            "normalized_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
            "normalized_path_source": "observed_path",
            "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
            "observed_path_source": "unsandboxed_fd_path",
            "requested_path": "/tmp/runtime-adv/edges/okdir/item.txt",
            "scenario_id": "baseline:adv:path_edges:write-subpath"
          }
        }
      ],
      "mismatches": [
        {
          "actual": "deny",
          "cmd_duration_s": 0.013767242431640625,
          "cmd_finished_at_unix_s": 1767253098.564474,
          "cmd_started_at_unix_s": 1767253098.5507069,
          "command": [
            "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
            "/tmp/runtime-adv/edges/a"
          ],
          "exit_code": 2,
          "expectation_id": "adv:path_edges:allow-tmp",
          "expected": "allow",
          "match": false,
          "name": "allow-tmp",
          "operation": "file-read*",
          "path": "/tmp/runtime-adv/edges/a",
          "path_observation": {
            "observed_path": "/private/tmp/runtime-adv/edges/a",
            "observed_path_errno": null,
            "observed_path_nofirmlink": null,
            "observed_path_nofirmlink_errno": null,
            "observed_path_nofirmlink_source": "unsandboxed_unavailable",
            "observed_path_source": "unsandboxed_fd_path"
          },
          "probe_details": null,
          "runtime_result": {
            "apply_report": {
              "api": "sandbox_init",
              "err_class": "ok",
              "err_class_source": "none",
              "errbuf": null,
              "errno": 0,
              "rc": 0
            },
            "errno": 2,
            "failure_kind": "probe_nonzero_exit",
            "failure_stage": "probe",
            "intended_op_witnessed": true,
            "resource_hygiene": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "close_fds": true,
              "pass_fds": [],
              "preexisting_sandbox_suspected": false
            },
            "runner_info": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "entrypoint": "sandbox_reader",
              "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
              "entrypoint_sha256": "b0263d3fd97fc9f2e0e14481ce2dd55cd514527a8da454b143bc342966a6b039",
              "preexisting_sandbox_suspected": false,
              "tool_build_id": "b0263d3fd97fc9f2e0e14481ce2dd55cd514527a8da454b143bc342966a6b039"
            },
            "runtime_result_schema_version": 1,
            "sandbox_check_request": {
              "argument": "/tmp/runtime-adv/edges/a",
              "canonicalization": "both",
              "filter_name": "path",
              "filter_type": 0,
              "operation": "file-read-data"
            },
            "seatbelt_callouts": [
              {
                "api": "sandbox_check",
                "argument": "/tmp/runtime-adv/edges/a",
                "canonical_flag_reason": "not_requested",
                "canonical_flag_used": false,
                "canonicalization": "raw",
                "check_type": 1073741824,
                "decision": "deny",
                "errno": 0,
                "filter_type": 0,
                "filter_type_name": "path",
                "marker_schema_version": 2,
                "no_report": true,
                "no_report_reason": null,
                "operation": "file-read-data",
                "rc": 1,
                "stage": "pre_syscall",
                "token_mach_kr": 0,
                "token_status": "pid",
                "tool": "seatbelt-callout",
                "varargs_count": 1
              },
              {
                "api": "sandbox_check",
                "argument": "/tmp/runtime-adv/edges/a",
                "canonical_flag_reason": null,
                "canonical_flag_used": true,
                "canonicalization": "canonical",
                "check_type": 1610612736,
                "decision": "deny",
                "errno": 0,
                "filter_type": 0,
                "filter_type_name": "path",
                "marker_schema_version": 2,
                "no_report": true,
                "no_report_reason": null,
                "operation": "file-read-data",
                "rc": 1,
                "stage": "pre_syscall",
                "token_mach_kr": 0,
                "token_status": "pid",
                "tool": "seatbelt-callout",
                "varargs_count": 1
              }
            ],
            "status": "errno",
            "tool_marker_schema_version": 2
          },
          "sandbox_check_request": {
            "argument": "/tmp/runtime-adv/edges/a",
            "canonicalization": "both",
            "filter_name": "path",
            "filter_type": 0,
            "operation": "file-read-data"
          },
          "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.6a89d578-d182-4e25-b782-a60b9fc51e4e/book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":68254}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.6a89d578-d182-4e25-b782-a60b9fc51e4e/book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":68254}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/a\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/a\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
          "stdout": "",
          "violation_summary": null
        },
        {
          "actual": "deny",
          "cmd_duration_s": 0.009605884552001953,
          "cmd_finished_at_unix_s": 1767253098.587359,
          "cmd_started_at_unix_s": 1767253098.577753,
          "command": [
            "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
            "/tmp/runtime-adv/edges/okdir/item.txt"
          ],
          "exit_code": 2,
          "expectation_id": "adv:path_edges:allow-subpath",
          "expected": "allow",
          "match": false,
          "name": "allow-subpath",
          "operation": "file-read*",
          "path": "/tmp/runtime-adv/edges/okdir/item.txt",
          "path_observation": {
            "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
            "observed_path_errno": null,
            "observed_path_nofirmlink": null,
            "observed_path_nofirmlink_errno": null,
            "observed_path_nofirmlink_source": "unsandboxed_unavailable",
            "observed_path_source": "unsandboxed_fd_path"
          },
          "probe_details": null,
          "runtime_result": {
            "apply_report": {
              "api": "sandbox_init",
              "err_class": "ok",
              "err_class_source": "none",
              "errbuf": null,
              "errno": 0,
              "rc": 0
            },
            "errno": 2,
            "failure_kind": "probe_nonzero_exit",
            "failure_stage": "probe",
            "intended_op_witnessed": true,
            "resource_hygiene": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "close_fds": true,
              "pass_fds": [],
              "preexisting_sandbox_suspected": false
            },
            "runner_info": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "entrypoint": "sandbox_reader",
              "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
              "entrypoint_sha256": "b0263d3fd97fc9f2e0e14481ce2dd55cd514527a8da454b143bc342966a6b039",
              "preexisting_sandbox_suspected": false,
              "tool_build_id": "b0263d3fd97fc9f2e0e14481ce2dd55cd514527a8da454b143bc342966a6b039"
            },
            "runtime_result_schema_version": 1,
            "sandbox_check_request": {
              "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
              "canonicalization": "both",
              "filter_name": "path",
              "filter_type": 0,
              "operation": "file-read-data"
            },
            "seatbelt_callouts": [
              {
                "api": "sandbox_check",
                "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
                "canonical_flag_reason": "not_requested",
                "canonical_flag_used": false,
                "canonicalization": "raw",
                "check_type": 1073741824,
                "decision": "deny",
                "errno": 0,
                "filter_type": 0,
                "filter_type_name": "path",
                "marker_schema_version": 2,
                "no_report": true,
                "no_report_reason": null,
                "operation": "file-read-data",
                "rc": 1,
                "stage": "pre_syscall",
                "token_mach_kr": 0,
                "token_status": "pid",
                "tool": "seatbelt-callout",
                "varargs_count": 1
              },
              {
                "api": "sandbox_check",
                "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
                "canonical_flag_reason": null,
                "canonical_flag_used": true,
                "canonicalization": "canonical",
                "check_type": 1610612736,
                "decision": "deny",
                "errno": 0,
                "filter_type": 0,
                "filter_type_name": "path",
                "marker_schema_version": 2,
                "no_report": true,
                "no_report_reason": null,
                "operation": "file-read-data",
                "rc": 1,
                "stage": "pre_syscall",
                "token_mach_kr": 0,
                "token_status": "pid",
                "tool": "seatbelt-callout",
                "varargs_count": 1
              }
            ],
            "status": "errno",
            "tool_marker_schema_version": 2
          },
          "sandbox_check_request": {
            "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
            "canonicalization": "both",
            "filter_name": "path",
            "filter_type": 0,
            "operation": "file-read-data"
          },
          "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.6a89d578-d182-4e25-b782-a60b9fc51e4e/book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":68256}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.6a89d578-d182-4e25-b782-a60b9fc51e4e/book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":68256}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/okdir/item.txt\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/okdir/item.txt\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
          "stdout": "",
          "violation_summary": null
        },
        {
          "actual": "deny",
          "cmd_duration_s": 0.1362628936767578,
          "cmd_finished_at_unix_s": 1767253098.741834,
          "cmd_started_at_unix_s": 1767253098.605571,
          "command": [
            "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
            "/tmp/runtime-adv/edges/a"
          ],
          "exit_code": 2,
          "expectation_id": "adv:path_edges:write-tmp",
          "expected": "allow",
          "match": false,
          "name": "write-tmp",
          "operation": "file-write*",
          "path": "/tmp/runtime-adv/edges/a",
          "path_observation": {
            "observed_path": "/private/tmp/runtime-adv/edges/a",
            "observed_path_errno": null,
            "observed_path_nofirmlink": null,
            "observed_path_nofirmlink_errno": null,
            "observed_path_nofirmlink_source": "unsandboxed_unavailable",
            "observed_path_source": "unsandboxed_fd_path"
          },
          "probe_details": null,
          "runtime_result": {
            "apply_report": {
              "api": "sandbox_init",
              "err_class": "ok",
              "err_class_source": "none",
              "errbuf": null,
              "errno": 0,
              "rc": 0
            },
            "errno": 2,
            "failure_kind": "probe_nonzero_exit",
            "failure_stage": "probe",
            "intended_op_witnessed": true,
            "resource_hygiene": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "close_fds": true,
              "pass_fds": [],
              "preexisting_sandbox_suspected": false
            },
            "runner_info": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "entrypoint": "sandbox_writer",
              "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
              "entrypoint_sha256": "bca9607e5b97dd94e5504077d92146524bc7a6c984b49f52886bc72711ec2e63",
              "preexisting_sandbox_suspected": false,
              "tool_build_id": "bca9607e5b97dd94e5504077d92146524bc7a6c984b49f52886bc72711ec2e63"
            },
            "runtime_result_schema_version": 1,
            "sandbox_check_request": {
              "argument": "/tmp/runtime-adv/edges/a",
              "canonicalization": "both",
              "filter_name": "path",
              "filter_type": 0,
              "operation": "file-write-data"
            },
            "seatbelt_callouts": [
              {
                "api": "sandbox_check",
                "argument": "/tmp/runtime-adv/edges/a",
                "canonical_flag_reason": "not_requested",
                "canonical_flag_used": false,
                "canonicalization": "raw",
                "check_type": 1073741824,
                "decision": "deny",
                "errno": 0,
                "filter_type": 0,
                "filter_type_name": "path",
                "marker_schema_version": 2,
                "no_report": true,
                "no_report_reason": null,
                "operation": "file-write-data",
                "rc": 1,
                "stage": "pre_syscall",
                "token_mach_kr": 0,
                "token_status": "pid",
                "tool": "seatbelt-callout",
                "varargs_count": 1
              },
              {
                "api": "sandbox_check",
                "argument": "/tmp/runtime-adv/edges/a",
                "canonical_flag_reason": null,
                "canonical_flag_used": true,
                "canonicalization": "canonical",
                "check_type": 1610612736,
                "decision": "deny",
                "errno": 0,
                "filter_type": 0,
                "filter_type_name": "path",
                "marker_schema_version": 2,
                "no_report": true,
                "no_report_reason": null,
                "operation": "file-write-data",
                "rc": 1,
                "stage": "pre_syscall",
                "token_mach_kr": 0,
                "token_status": "pid",
                "tool": "seatbelt-callout",
                "varargs_count": 1
              }
            ],
            "status": "errno",
            "tool_marker_schema_version": 2
          },
          "sandbox_check_request": {
            "argument": "/tmp/runtime-adv/edges/a",
            "canonicalization": "both",
            "filter_name": "path",
            "filter_type": 0,
            "operation": "file-write-data"
          },
          "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.6a89d578-d182-4e25-b782-a60b9fc51e4e/book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":68259}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.6a89d578-d182-4e25-b782-a60b9fc51e4e/book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":68259}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/a\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/a\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
          "stdout": "",
          "violation_summary": null
        },
        {
          "actual": "deny",
          "cmd_duration_s": 0.012621164321899414,
          "cmd_finished_at_unix_s": 1767253098.76756,
          "cmd_started_at_unix_s": 1767253098.7549388,
          "command": [
            "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
            "/tmp/runtime-adv/edges/okdir/item.txt"
          ],
          "exit_code": 2,
          "expectation_id": "adv:path_edges:write-subpath",
          "expected": "allow",
          "match": false,
          "name": "write-subpath",
          "operation": "file-write*",
          "path": "/tmp/runtime-adv/edges/okdir/item.txt",
          "path_observation": {
            "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
            "observed_path_errno": null,
            "observed_path_nofirmlink": null,
            "observed_path_nofirmlink_errno": null,
            "observed_path_nofirmlink_source": "unsandboxed_unavailable",
            "observed_path_source": "unsandboxed_fd_path"
          },
          "probe_details": null,
          "runtime_result": {
            "apply_report": {
              "api": "sandbox_init",
              "err_class": "ok",
              "err_class_source": "none",
              "errbuf": null,
              "errno": 0,
              "rc": 0
            },
            "errno": 2,
            "failure_kind": "probe_nonzero_exit",
            "failure_stage": "probe",
            "intended_op_witnessed": true,
            "resource_hygiene": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "close_fds": true,
              "pass_fds": [],
              "preexisting_sandbox_suspected": false
            },
            "runner_info": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "entrypoint": "sandbox_writer",
              "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
              "entrypoint_sha256": "bca9607e5b97dd94e5504077d92146524bc7a6c984b49f52886bc72711ec2e63",
              "preexisting_sandbox_suspected": false,
              "tool_build_id": "bca9607e5b97dd94e5504077d92146524bc7a6c984b49f52886bc72711ec2e63"
            },
            "runtime_result_schema_version": 1,
            "sandbox_check_request": {
              "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
              "canonicalization": "both",
              "filter_name": "path",
              "filter_type": 0,
              "operation": "file-write-data"
            },
            "seatbelt_callouts": [
              {
                "api": "sandbox_check",
                "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
                "canonical_flag_reason": "not_requested",
                "canonical_flag_used": false,
                "canonicalization": "raw",
                "check_type": 1073741824,
                "decision": "deny",
                "errno": 0,
                "filter_type": 0,
                "filter_type_name": "path",
                "marker_schema_version": 2,
                "no_report": true,
                "no_report_reason": null,
                "operation": "file-write-data",
                "rc": 1,
                "stage": "pre_syscall",
                "token_mach_kr": 0,
                "token_status": "pid",
                "tool": "seatbelt-callout",
                "varargs_count": 1
              },
              {
                "api": "sandbox_check",
                "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
                "canonical_flag_reason": null,
                "canonical_flag_used": true,
                "canonicalization": "canonical",
                "check_type": 1610612736,
                "decision": "deny",
                "errno": 0,
                "filter_type": 0,
                "filter_type_name": "path",
                "marker_schema_version": 2,
                "no_report": true,
                "no_report_reason": null,
                "operation": "file-write-data",
                "rc": 1,
                "stage": "pre_syscall",
                "token_mach_kr": 0,
                "token_status": "pid",
                "tool": "seatbelt-callout",
                "varargs_count": 1
              }
            ],
            "status": "errno",
            "tool_marker_schema_version": 2
          },
          "sandbox_check_request": {
            "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
            "canonicalization": "both",
            "filter_name": "path",
            "filter_type": 0,
            "operation": "file-write-data"
          },
          "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.6a89d578-d182-4e25-b782-a60b9fc51e4e/book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":68261}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.6a89d578-d182-4e25-b782-a60b9fc51e4e/book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":68261}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/okdir/item.txt\",\"canonicalization\":\"raw\",\"canonical_flag_used\":false,\"canonical_flag_reason\":\"not_requested\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1610612736,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/okdir/item.txt\",\"canonicalization\":\"canonical\",\"canonical_flag_used\":true,\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
          "stdout": "",
          "violation_summary": null
        }
      ],
      "note": "path-edge evaluation uses witness-backed canonicalization equivalence",
      "profiles": [
        "adv:path_edges"
      ],
      "unresolved_mismatches": [],
      "witness_source": "book/evidence/experiments/runtime-final-final/suites/runtime-adversarial/out/6a89d578-d182-4e25-b782-a60b9fc51e4e/path_witnesses.json"
    },
    "structural variants of same intent (read/write)": {
      "aligned_expectations": [
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "allow-ok-deep",
          "expected": "allow",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "allow-ok-root",
          "expected": "allow",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "deny-blocked",
          "expected": "deny",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "deny-outside",
          "expected": "deny",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "write-blocked",
          "expected": "deny",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "write-ok-deep",
          "expected": "allow",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "write-ok-root",
          "expected": "allow",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "write-outside",
          "expected": "deny",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        }
      ],
      "mismatches": [],
      "profiles": [
        "adv:struct_flat",
        "adv:struct_nested"
      ]
    }
  },
  "world_id": "sonoma-14.4.1-23E224-arm64-dyld-a3a840f9"
}
