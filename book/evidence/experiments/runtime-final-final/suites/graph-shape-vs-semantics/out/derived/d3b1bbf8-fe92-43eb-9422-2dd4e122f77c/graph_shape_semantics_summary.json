{
  "provenance": {
    "artifact_index": "book/evidence/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/artifact_index.json",
    "artifact_index_sha256": "7c33c5d5b63622eb148373b7c847ab2f3af6b5702bfba021751589ef063eab8d",
    "bundle_dir": "book/evidence/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c",
    "consumption_receipt": "book/evidence/experiments/graph-shape-vs-semantics/out/derived/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/consumption_receipt.json",
    "exports": {
      "path_witnesses": "book/evidence/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/path_witnesses.json",
      "run_manifest": "book/evidence/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/run_manifest.json",
      "runtime_results": "book/evidence/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_results.json"
    },
    "packet": "book/evidence/experiments/runtime-adversarial/out/packets/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c.promotion_packet.json",
    "run_id": "d3b1bbf8-fe92-43eb-9422-2dd4e122f77c"
  },
  "schema_version": "graph-shape-vs-semantics.summary.v0",
  "summary": {
    "mach global-name literal vs regex variants": {
      "aligned_expectations": [
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "allow-cfprefsd",
          "expected": "allow",
          "profile_a": "adv:mach_simple_allow",
          "profile_b": "adv:mach_simple_variants"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "deny-bogus",
          "expected": "deny",
          "profile_a": "adv:mach_simple_allow",
          "profile_b": "adv:mach_simple_variants"
        }
      ],
      "mismatches": [],
      "profiles": [
        "adv:mach_simple_allow",
        "adv:mach_simple_variants"
      ]
    },
    "mach local-name literal vs regex variants": {
      "aligned_expectations": [
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "allow-cfprefsd-local",
          "expected": "allow",
          "profile_a": "adv:mach_local_literal",
          "profile_b": "adv:mach_local_regex"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "deny-bogus-local",
          "expected": "deny",
          "profile_a": "adv:mach_local_literal",
          "profile_b": "adv:mach_local_regex"
        }
      ],
      "mismatches": [],
      "profiles": [
        "adv:mach_local_literal",
        "adv:mach_local_regex"
      ]
    },
    "path_edges": {
      "canonicalization_boundary": [
        {
          "expectation_id": "adv:path_edges:allow-tmp",
          "operation": "file-read*",
          "probe_name": "allow-tmp",
          "witness": {
            "lane": "baseline",
            "normalized_path": "/private/tmp/runtime-adv/edges/a",
            "normalized_path_source": "observed_path",
            "observed_path": "/private/tmp/runtime-adv/edges/a",
            "observed_path_source": "unsandboxed_fd_path",
            "requested_path": "/tmp/runtime-adv/edges/a",
            "scenario_id": "baseline:adv:path_edges:allow-tmp"
          }
        },
        {
          "expectation_id": "adv:path_edges:allow-subpath",
          "operation": "file-read*",
          "probe_name": "allow-subpath",
          "witness": {
            "lane": "baseline",
            "normalized_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
            "normalized_path_source": "observed_path",
            "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
            "observed_path_source": "unsandboxed_fd_path",
            "requested_path": "/tmp/runtime-adv/edges/okdir/item.txt",
            "scenario_id": "baseline:adv:path_edges:allow-subpath"
          }
        },
        {
          "expectation_id": "adv:path_edges:write-tmp",
          "operation": "file-write*",
          "probe_name": "write-tmp",
          "witness": {
            "lane": "baseline",
            "normalized_path": "/private/tmp/runtime-adv/edges/a",
            "normalized_path_source": "observed_path",
            "observed_path": "/private/tmp/runtime-adv/edges/a",
            "observed_path_source": "unsandboxed_fd_path",
            "requested_path": "/tmp/runtime-adv/edges/a",
            "scenario_id": "baseline:adv:path_edges:write-tmp"
          }
        },
        {
          "expectation_id": "adv:path_edges:write-subpath",
          "operation": "file-write*",
          "probe_name": "write-subpath",
          "witness": {
            "lane": "baseline",
            "normalized_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
            "normalized_path_source": "observed_path",
            "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
            "observed_path_source": "unsandboxed_fd_path",
            "requested_path": "/tmp/runtime-adv/edges/okdir/item.txt",
            "scenario_id": "baseline:adv:path_edges:write-subpath"
          }
        }
      ],
      "mismatches": [
        {
          "actual": "deny",
          "cmd_duration_s": 0.016287803649902344,
          "cmd_finished_at_unix_s": 1767248742.990187,
          "cmd_started_at_unix_s": 1767248742.9738991,
          "command": [
            "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "book/evidence/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
            "/tmp/runtime-adv/edges/a"
          ],
          "exit_code": 2,
          "expectation_id": "adv:path_edges:allow-tmp",
          "expected": "allow",
          "match": false,
          "name": "allow-tmp",
          "operation": "file-read*",
          "path": "/tmp/runtime-adv/edges/a",
          "path_observation": {
            "observed_path": "/private/tmp/runtime-adv/edges/a",
            "observed_path_errno": null,
            "observed_path_nofirmlink": null,
            "observed_path_nofirmlink_errno": null,
            "observed_path_nofirmlink_source": "unsandboxed_unavailable",
            "observed_path_source": "unsandboxed_fd_path"
          },
          "probe_details": null,
          "runtime_result": {
            "apply_report": {
              "api": "sandbox_init",
              "err_class": "ok",
              "err_class_source": "none",
              "errbuf": null,
              "errno": 0,
              "rc": 0
            },
            "errno": 2,
            "failure_kind": "probe_nonzero_exit",
            "failure_stage": "probe",
            "resource_hygiene": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "close_fds": true,
              "pass_fds": [],
              "preexisting_sandbox_suspected": false
            },
            "runner_info": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "entrypoint": "sandbox_reader",
              "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
              "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
              "preexisting_sandbox_suspected": false,
              "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
            },
            "runtime_result_schema_version": 1,
            "sandbox_check_request": {
              "argument": "/tmp/runtime-adv/edges/a",
              "filter_name": "path",
              "filter_type": 0,
              "operation": "file-read-data"
            },
            "seatbelt_callouts": [
              {
                "api": "sandbox_check",
                "argument": "/tmp/runtime-adv/edges/a",
                "check_type": 1073741824,
                "decision": "deny",
                "errno": 0,
                "filter_type": 0,
                "filter_type_name": "path",
                "marker_schema_version": 2,
                "no_report": true,
                "no_report_reason": null,
                "operation": "file-read-data",
                "rc": 1,
                "stage": "pre_syscall",
                "token_mach_kr": 0,
                "token_status": "pid",
                "tool": "seatbelt-callout",
                "varargs_count": 1
              }
            ],
            "status": "errno",
            "tool_marker_schema_version": 2
          },
          "sandbox_check_request": {
            "argument": "/tmp/runtime-adv/edges/a",
            "filter_name": "path",
            "filter_type": 0,
            "operation": "file-read-data"
          },
          "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97975}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97975}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/a\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
          "stdout": "",
          "violation_summary": null
        },
        {
          "actual": "deny",
          "cmd_duration_s": 0.013224363327026367,
          "cmd_finished_at_unix_s": 1767248743.0321972,
          "cmd_started_at_unix_s": 1767248743.0189729,
          "command": [
            "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "book/evidence/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
            "/tmp/runtime-adv/edges/okdir/item.txt"
          ],
          "exit_code": 2,
          "expectation_id": "adv:path_edges:allow-subpath",
          "expected": "allow",
          "match": false,
          "name": "allow-subpath",
          "operation": "file-read*",
          "path": "/tmp/runtime-adv/edges/okdir/item.txt",
          "path_observation": {
            "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
            "observed_path_errno": null,
            "observed_path_nofirmlink": null,
            "observed_path_nofirmlink_errno": null,
            "observed_path_nofirmlink_source": "unsandboxed_unavailable",
            "observed_path_source": "unsandboxed_fd_path"
          },
          "probe_details": null,
          "runtime_result": {
            "apply_report": {
              "api": "sandbox_init",
              "err_class": "ok",
              "err_class_source": "none",
              "errbuf": null,
              "errno": 0,
              "rc": 0
            },
            "errno": 2,
            "failure_kind": "probe_nonzero_exit",
            "failure_stage": "probe",
            "resource_hygiene": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "close_fds": true,
              "pass_fds": [],
              "preexisting_sandbox_suspected": false
            },
            "runner_info": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "entrypoint": "sandbox_reader",
              "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
              "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
              "preexisting_sandbox_suspected": false,
              "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
            },
            "runtime_result_schema_version": 1,
            "sandbox_check_request": {
              "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
              "filter_name": "path",
              "filter_type": 0,
              "operation": "file-read-data"
            },
            "seatbelt_callouts": [
              {
                "api": "sandbox_check",
                "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
                "check_type": 1073741824,
                "decision": "deny",
                "errno": 0,
                "filter_type": 0,
                "filter_type_name": "path",
                "marker_schema_version": 2,
                "no_report": true,
                "no_report_reason": null,
                "operation": "file-read-data",
                "rc": 1,
                "stage": "pre_syscall",
                "token_mach_kr": 0,
                "token_status": "pid",
                "tool": "seatbelt-callout",
                "varargs_count": 1
              }
            ],
            "status": "errno",
            "tool_marker_schema_version": 2
          },
          "sandbox_check_request": {
            "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
            "filter_name": "path",
            "filter_type": 0,
            "operation": "file-read-data"
          },
          "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97977}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97977}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/okdir/item.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
          "stdout": "",
          "violation_summary": null
        },
        {
          "actual": "deny",
          "cmd_duration_s": 0.21692895889282227,
          "cmd_finished_at_unix_s": 1767248743.268909,
          "cmd_started_at_unix_s": 1767248743.05198,
          "command": [
            "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "book/evidence/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
            "/tmp/runtime-adv/edges/a"
          ],
          "exit_code": 2,
          "expectation_id": "adv:path_edges:write-tmp",
          "expected": "allow",
          "match": false,
          "name": "write-tmp",
          "operation": "file-write*",
          "path": "/tmp/runtime-adv/edges/a",
          "path_observation": {
            "observed_path": "/private/tmp/runtime-adv/edges/a",
            "observed_path_errno": null,
            "observed_path_nofirmlink": null,
            "observed_path_nofirmlink_errno": null,
            "observed_path_nofirmlink_source": "unsandboxed_unavailable",
            "observed_path_source": "unsandboxed_fd_path"
          },
          "probe_details": null,
          "runtime_result": {
            "apply_report": {
              "api": "sandbox_init",
              "err_class": "ok",
              "err_class_source": "none",
              "errbuf": null,
              "errno": 0,
              "rc": 0
            },
            "errno": 2,
            "failure_kind": "probe_nonzero_exit",
            "failure_stage": "probe",
            "resource_hygiene": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "close_fds": true,
              "pass_fds": [],
              "preexisting_sandbox_suspected": false
            },
            "runner_info": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "entrypoint": "sandbox_writer",
              "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
              "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
              "preexisting_sandbox_suspected": false,
              "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
            },
            "runtime_result_schema_version": 1,
            "sandbox_check_request": {
              "argument": "/tmp/runtime-adv/edges/a",
              "filter_name": "path",
              "filter_type": 0,
              "operation": "file-write-data"
            },
            "seatbelt_callouts": [
              {
                "api": "sandbox_check",
                "argument": "/tmp/runtime-adv/edges/a",
                "check_type": 1073741824,
                "decision": "deny",
                "errno": 0,
                "filter_type": 0,
                "filter_type_name": "path",
                "marker_schema_version": 2,
                "no_report": true,
                "no_report_reason": null,
                "operation": "file-write-data",
                "rc": 1,
                "stage": "pre_syscall",
                "token_mach_kr": 0,
                "token_status": "pid",
                "tool": "seatbelt-callout",
                "varargs_count": 1
              }
            ],
            "status": "errno",
            "tool_marker_schema_version": 2
          },
          "sandbox_check_request": {
            "argument": "/tmp/runtime-adv/edges/a",
            "filter_name": "path",
            "filter_type": 0,
            "operation": "file-write-data"
          },
          "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97980}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97980}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/a\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
          "stdout": "",
          "violation_summary": null
        },
        {
          "actual": "deny",
          "cmd_duration_s": 0.009332895278930664,
          "cmd_finished_at_unix_s": 1767248743.292136,
          "cmd_started_at_unix_s": 1767248743.282803,
          "command": [
            "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "book/evidence/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
            "/tmp/runtime-adv/edges/okdir/item.txt"
          ],
          "exit_code": 2,
          "expectation_id": "adv:path_edges:write-subpath",
          "expected": "allow",
          "match": false,
          "name": "write-subpath",
          "operation": "file-write*",
          "path": "/tmp/runtime-adv/edges/okdir/item.txt",
          "path_observation": {
            "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
            "observed_path_errno": null,
            "observed_path_nofirmlink": null,
            "observed_path_nofirmlink_errno": null,
            "observed_path_nofirmlink_source": "unsandboxed_unavailable",
            "observed_path_source": "unsandboxed_fd_path"
          },
          "probe_details": null,
          "runtime_result": {
            "apply_report": {
              "api": "sandbox_init",
              "err_class": "ok",
              "err_class_source": "none",
              "errbuf": null,
              "errno": 0,
              "rc": 0
            },
            "errno": 2,
            "failure_kind": "probe_nonzero_exit",
            "failure_stage": "probe",
            "resource_hygiene": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "close_fds": true,
              "pass_fds": [],
              "preexisting_sandbox_suspected": false
            },
            "runner_info": {
              "apply_model": "self_apply",
              "apply_timing": "pre_syscall",
              "entrypoint": "sandbox_writer",
              "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
              "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
              "preexisting_sandbox_suspected": false,
              "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
            },
            "runtime_result_schema_version": 1,
            "sandbox_check_request": {
              "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
              "filter_name": "path",
              "filter_type": 0,
              "operation": "file-write-data"
            },
            "seatbelt_callouts": [
              {
                "api": "sandbox_check",
                "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
                "check_type": 1073741824,
                "decision": "deny",
                "errno": 0,
                "filter_type": 0,
                "filter_type_name": "path",
                "marker_schema_version": 2,
                "no_report": true,
                "no_report_reason": null,
                "operation": "file-write-data",
                "rc": 1,
                "stage": "pre_syscall",
                "token_mach_kr": 0,
                "token_status": "pid",
                "tool": "seatbelt-callout",
                "varargs_count": 1
              }
            ],
            "status": "errno",
            "tool_marker_schema_version": 2
          },
          "sandbox_check_request": {
            "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
            "filter_name": "path",
            "filter_type": 0,
            "operation": "file-write-data"
          },
          "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97982}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97982}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/okdir/item.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
          "stdout": "",
          "violation_summary": null
        }
      ],
      "note": "path-edge evaluation uses witness-backed canonicalization equivalence",
      "profiles": [
        "adv:path_edges"
      ],
      "unresolved_mismatches": [],
      "witness_source": "book/evidence/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/path_witnesses.json"
    },
    "structural variants of same intent (read/write)": {
      "aligned_expectations": [
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "allow-ok-deep",
          "expected": "allow",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "allow-ok-root",
          "expected": "allow",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "deny-blocked",
          "expected": "deny",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "deny-outside",
          "expected": "deny",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "write-blocked",
          "expected": "deny",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "write-ok-deep",
          "expected": "allow",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "allow",
          "actual_b": "allow",
          "both_match": true,
          "expectation_id": "write-ok-root",
          "expected": "allow",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        },
        {
          "actual_a": "deny",
          "actual_b": "deny",
          "both_match": true,
          "expectation_id": "write-outside",
          "expected": "deny",
          "profile_a": "adv:struct_flat",
          "profile_b": "adv:struct_nested"
        }
      ],
      "mismatches": [],
      "profiles": [
        "adv:struct_flat",
        "adv:struct_nested"
      ]
    }
  },
  "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
}
