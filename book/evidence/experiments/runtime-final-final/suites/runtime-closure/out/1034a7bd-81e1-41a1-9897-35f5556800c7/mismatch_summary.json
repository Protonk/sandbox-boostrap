{
  "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
  "generated_by": "book/api/runtime/execution/workflow.py",
  "mismatches": [
    {
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "profile_id": "runtime-closure:file:v2_alias_literals",
      "expectation_id": "runtime-closure:file:v2_alias_literals:etc_hosts_alias",
      "operation": "file-read*",
      "path": "/etc/hosts",
      "expected": "allow",
      "actual": "deny",
      "mismatch_type": "unexpected_deny",
      "violation_summary": null,
      "notes": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v2_alias_literals.runtime-closure_file_v2_alias_literals.runtime.sb\",\"pid\":62595}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v2_alias_literals.runtime-closure_file_v2_alias_literals.runtime.sb\",\"pid\":62595}\nopen target: Operation not permitted\n"
    },
    {
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "profile_id": "runtime-closure:file:v2_alias_literals",
      "expectation_id": "runtime-closure:file:v2_alias_literals:tmp_alias",
      "operation": "file-read*",
      "path": "/tmp/foo",
      "expected": "allow",
      "actual": "deny",
      "mismatch_type": "unexpected_deny",
      "violation_summary": null,
      "notes": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v2_alias_literals.runtime-closure_file_v2_alias_literals.runtime.sb\",\"pid\":62598}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v2_alias_literals.runtime-closure_file_v2_alias_literals.runtime.sb\",\"pid\":62598}\nopen target: Operation not permitted\n"
    },
    {
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "profile_id": "runtime-closure:file:v2_private_literals",
      "expectation_id": "runtime-closure:file:v2_private_literals:etc_hosts_data",
      "operation": "file-read*",
      "path": "/System/Volumes/Data/private/etc/hosts",
      "expected": "deny",
      "actual": "allow",
      "mismatch_type": "unexpected_allow",
      "violation_summary": null,
      "notes": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v2_private_literals.runtime-closure_file_v2_private_literals.runtime.sb\",\"pid\":62603}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v2_private_literals.runtime-closure_file_v2_private_literals.runtime.sb\",\"pid\":62603}\nF_GETPATH:/private/etc/hosts\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/etc/hosts\n"
    },
    {
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "profile_id": "runtime-closure:file:v2_private_literals",
      "expectation_id": "runtime-closure:file:v2_private_literals:tmp_alias",
      "operation": "file-read*",
      "path": "/tmp/foo",
      "expected": "deny",
      "actual": "allow",
      "mismatch_type": "unexpected_allow",
      "violation_summary": null,
      "notes": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v2_private_literals.runtime-closure_file_v2_private_literals.runtime.sb\",\"pid\":62604}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v2_private_literals.runtime-closure_file_v2_private_literals.runtime.sb\",\"pid\":62604}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n"
    },
    {
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "profile_id": "runtime-closure:file:v2_private_literals",
      "expectation_id": "runtime-closure:file:v2_private_literals:tmp_data",
      "operation": "file-read*",
      "path": "/System/Volumes/Data/private/tmp/foo",
      "expected": "deny",
      "actual": "allow",
      "mismatch_type": "unexpected_allow",
      "violation_summary": null,
      "notes": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v2_private_literals.runtime-closure_file_v2_private_literals.runtime.sb\",\"pid\":62606}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v2_private_literals.runtime-closure_file_v2_private_literals.runtime.sb\",\"pid\":62606}\nF_GETPATH:/private/tmp/foo\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/foo\n"
    },
    {
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "profile_id": "runtime-closure:file:v2_data_literals",
      "expectation_id": "runtime-closure:file:v2_data_literals:etc_hosts_data",
      "operation": "file-read*",
      "path": "/System/Volumes/Data/private/etc/hosts",
      "expected": "allow",
      "actual": "deny",
      "mismatch_type": "unexpected_deny",
      "violation_summary": null,
      "notes": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v2_data_literals.runtime-closure_file_v2_data_literals.runtime.sb\",\"pid\":62609}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v2_data_literals.runtime-closure_file_v2_data_literals.runtime.sb\",\"pid\":62609}\nopen target: Operation not permitted\n"
    },
    {
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "profile_id": "runtime-closure:file:v2_data_literals",
      "expectation_id": "runtime-closure:file:v2_data_literals:tmp_data",
      "operation": "file-read*",
      "path": "/System/Volumes/Data/private/tmp/foo",
      "expected": "allow",
      "actual": "deny",
      "mismatch_type": "unexpected_deny",
      "violation_summary": null,
      "notes": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v2_data_literals.runtime-closure_file_v2_data_literals.runtime.sb\",\"pid\":62612}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v2_data_literals.runtime-closure_file_v2_data_literals.runtime.sb\",\"pid\":62612}\nopen target: Operation not permitted\n"
    },
    {
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "profile_id": "runtime-closure:iokit:v5_service_only",
      "expectation_id": "runtime-closure:iokit:v5_service_only:iosurface_root",
      "operation": "iokit-open-service",
      "path": "IOSurfaceRoot",
      "expected": "allow",
      "actual": "deny",
      "mismatch_type": "apply_gate",
      "violation_summary": null,
      "notes": "sandbox initialization failed: report modifier does not apply to deny action\n\nBacktrace: \n<input string>:9:4:\n\t(iokit-user-client-class \"IOSurfaceRootUserClient\")\n\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":-1,\"errno\":0,\"errbuf\":\"report modifier does not apply to deny action\\n\\nBacktrace: \\n<input string>:9:4:\\n\\t(iokit-user-client-class \\\"IOSurfaceRootUserClient\\\")\\n\",\"err_class\":\"unknown\",\"err_class_source\":\"errbuf_present\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v5_iokit_service_only.runtime-closure_iokit_v5_service_only.runtime.sb\",\"pid\":62615}\nsandbox_init failed: report modifier does not apply to deny action\n\nBacktrace: \n<input string>:9:4:\n\t(iokit-user-client-class \"IOSurfaceRootUserClient\")\n\n"
    },
    {
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "profile_id": "runtime-closure:iokit:v6_user_client_only",
      "expectation_id": "runtime-closure:iokit:v6_user_client_only:iosurface_root",
      "operation": "iokit-open-service",
      "path": "IOSurfaceRoot",
      "expected": "allow",
      "actual": "deny",
      "mismatch_type": "apply_gate",
      "violation_summary": null,
      "notes": "sandbox initialization failed: report modifier does not apply to deny action\n\nBacktrace: \n<input string>:9:4:\n\t(iokit-registry-entry-class \"IOSurfaceRoot\")\n\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":-1,\"errno\":0,\"errbuf\":\"report modifier does not apply to deny action\\n\\nBacktrace: \\n<input string>:9:4:\\n\\t(iokit-registry-entry-class \\\"IOSurfaceRoot\\\")\\n\",\"err_class\":\"unknown\",\"err_class_source\":\"errbuf_present\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v6_iokit_user_client_only.runtime-closure_iokit_v6_user_client_only.runtime.sb\",\"pid\":62616}\nsandbox_init failed: report modifier does not apply to deny action\n\nBacktrace: \n<input string>:9:4:\n\t(iokit-registry-entry-class \"IOSurfaceRoot\")\n\n"
    },
    {
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "profile_id": "runtime-closure:iokit:v7_service_user_client_both",
      "expectation_id": "runtime-closure:iokit:v7_service_user_client_both:iosurface_root",
      "operation": "iokit-open-service",
      "path": "IOSurfaceRoot",
      "expected": "allow",
      "actual": "deny",
      "mismatch_type": "unexpected_deny",
      "violation_summary": "EPERM",
      "notes": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v7_iokit_service_user_client_both.runtime-closure_iokit_v7_service_user_client_both.runtime.sb\",\"pid\":62617}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.1034a7bd-81e1-41a1-9897-35f5556800c7/book/evidence/experiments/runtime-final-final/suites/runtime-closure/out/1034a7bd-81e1-41a1-9897-35f5556800c7/runtime_profiles/v7_iokit_service_user_client_both.runtime-closure_iokit_v7_service_user_client_both.runtime.sb\",\"pid\":62617}\n"
    }
  ],
  "counts": {
    "unexpected_deny": 5,
    "unexpected_allow": 3,
    "apply_gate": 2
  }
}