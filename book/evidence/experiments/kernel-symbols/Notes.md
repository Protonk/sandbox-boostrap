# Notes

- Ghidra outputs for kernel symbols/strings are relocated to `book/evidence/experiments/kernel-symbols/out/<build>/kernel-symbols/`.
- Use the connector helper `run_task.py kernel-symbols --exec` to regenerate; defaults include ARM64 processor and the disable-x86 pre-script.
- Keep using `--process-existing --no-analysis` for downstream scripts to avoid rerunning analyzers.
- Target extraction: `targets.json` (generated Dec 2 2025) under `out/14.4.1-23E224/kernel-symbols/` lists key sandbox-related strings/symbols:
  - Primary strings: `0x-7fffdf3a68` (`com.apple.kext.AppleMatch`), `0x-7fffdf10f0` and `0x-7ffd22d6e0` (`com.apple.security.sandbox`).
  - Sample mac_policy symbols: `_mac_policy_addto_labellist`, `_mac_policy_init*`, `_mac_policy_list*` at `0x-7ffc3fceaf` .. `0x-7ffc3fce10`.
- Data-define run (Dec 2): `run_data_define.py --address addr:0xffffff800020ef10 --process-existing --no-analysis --timeout 900` produced `data_refs.json` with the `com.apple.security.sandbox` TEXT string defined, zero callers/xrefs (as expected under no-analysis).
- Data-define Track A (no-analysis) batch (Dec 2): ran all 11 targets from `targets.json` with `--process-existing --no-analysis`; all returned with zero callers. `data_refs.json` overwritten each time.
- Data-define Track B (analysis) on `addr:0xffffff800020ef10` (Dec 2): re-ran without `--no-analysis` (~59s). Result still shows the string defined with zero callers (no refs surfaced even with analysis). Logged pcode warnings but run succeeded.
- String-refs run (Dec 2): `run_task.py kernel-string-refs --process-existing --exec` captured three string hits (two `com.apple.security.sandbox`, one `com.apple.kext.AppleMatch`), zero symbol hits, zero external libraries. References lists are empty. Output copied to `out/14.4.1-23E224/kernel-string-refs/string_references.json` (error.log in dumps reflects a pre-fix run).
- String-refs broadened sweep (Dec 3): `run_task.py kernel-string-refs --process-existing --no-analysis --exec` with `all`, symbol substrings (`sandbox`, `mac_policy`, `seatbelt`) and extra string queries. Result: 918 string hits, 0 symbol hits, 0 externals; queries list includes the explicit sandbox/AppleMatch terms plus extras (`AppleSandbox`, `policy`, `mac policy`, `seat belt`). Output stored at `out/14.4.1-23E224/kernel-string-refs/string_references.json`.
- Notable string hits from the broadened sweep (addresses are KC-relative signed form): `0x-7fffdf3a68 com.apple.kext.AppleMatch`, `0x-7fffdf10f0 com.apple.security.sandbox`, `0x-7fff3b4d71 sandbox`, `0x-7ffe53900e com.apple.security.app-sandbox`, plus assorted task_policy/dyldPolicy strings.
- Data-define re-runs (Dec 3) with correct `addr:` form on unsigned addresses (converted from signed KC): `addr:0xffffff800020ef10`, `addr:0xffffff800020c598`, `addr:0xffffff8002dd2920` using `--process-existing --no-analysis`. `data_refs.json` currently reflects the last target (`0x-7ffd22d6e0` / `com.apple.security.sandbox`) with `data_type: string`, `callers: []`.
- Op-table refresh (Dec 3): `run_task.py kernel-op-table --process-existing --no-analysis --exec` wrote 33 candidates; mirrored to `out/14.4.1-23E224/op_table_candidates.json` for cross-reference.
