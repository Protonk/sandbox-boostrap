{
  "description": "Bucket-level runtime checks.",
  "plan": {
    "apply_preflight_profile": "book/experiments/hardened-runtime/sb/apply_preflight_allow.sb",
    "controls": {
      "baseline": true
    },
    "lanes": {
      "baseline": true,
      "oracle": true,
      "scenario": true
    },
    "plan_id": "runtime-checks.v1",
    "profiles": [
      "bucket4:v1_read",
      "bucket5:v11_read_subpath",
      "runtime:allow_all",
      "runtime:metafilter_any",
      "runtime:strict_1",
      "sys:airlock",
      "sys:bsd"
    ],
    "registry_id": "runtime-checks",
    "schema_version": "runtime-tools.plan.v0.1",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  "probes": {
    "probes": {
      "allow_all|file-read*|/etc/hosts": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "allow",
        "expected_predicates": [
          "/etc/hosts"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "read_/etc/hosts",
        "operation": "file-read*",
        "probe_id": "allow_all|file-read*|/etc/hosts",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/etc/hosts"
      },
      "allow_all|file-read*|/tmp/sbpl_rt/read.txt": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "allow",
        "expected_predicates": [
          "/tmp/sbpl_rt/read.txt"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "read_/tmp/sbpl_rt/read.txt",
        "operation": "file-read*",
        "probe_id": "allow_all|file-read*|/tmp/sbpl_rt/read.txt",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/tmp/sbpl_rt/read.txt"
      },
      "allow_all|file-write*|/tmp/sbpl_rt/write.txt": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "allow",
        "expected_predicates": [
          "/tmp/sbpl_rt/write.txt"
        ],
        "expected_primary_ops": [
          "file-write*"
        ],
        "name": "write_/tmp/sbpl_rt/write.txt",
        "operation": "file-write*",
        "probe_id": "allow_all|file-write*|/tmp/sbpl_rt/write.txt",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/tmp/sbpl_rt/write.txt"
      },
      "bucket4:v1_read:read_/etc/hosts": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "allow",
        "expected_predicates": [
          "/etc/hosts"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "read_/etc/hosts",
        "operation": "file-read*",
        "probe_id": "bucket4:v1_read:read_/etc/hosts",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/etc/hosts"
      },
      "bucket4:v1_read:read_/tmp/foo": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "allow",
        "expected_predicates": [
          "/tmp/foo"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "read_/tmp/foo",
        "operation": "file-read*",
        "probe_id": "bucket4:v1_read:read_/tmp/foo",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/tmp/foo"
      },
      "bucket4:v1_read:write_/etc/hosts": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "deny",
        "expected_predicates": [
          "/etc/hosts"
        ],
        "expected_primary_ops": [
          "file-write*"
        ],
        "name": "write_/etc/hosts",
        "operation": "file-write*",
        "probe_id": "bucket4:v1_read:write_/etc/hosts",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/etc/hosts"
      },
      "bucket5:v11_read_subpath:read_/tmp/bar": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "deny",
        "expected_predicates": [
          "/tmp/bar"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "read_/tmp/bar",
        "operation": "file-read*",
        "probe_id": "bucket5:v11_read_subpath:read_/tmp/bar",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/tmp/bar"
      },
      "bucket5:v11_read_subpath:read_/tmp/foo": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "allow",
        "expected_predicates": [
          "/tmp/foo"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "read_/tmp/foo",
        "operation": "file-read*",
        "probe_id": "bucket5:v11_read_subpath:read_/tmp/foo",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/tmp/foo"
      },
      "bucket5:v11_read_subpath:write_/tmp/foo": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "deny",
        "expected_predicates": [
          "/tmp/foo"
        ],
        "expected_primary_ops": [
          "file-write*"
        ],
        "name": "write_/tmp/foo",
        "operation": "file-write*",
        "probe_id": "bucket5:v11_read_subpath:write_/tmp/foo",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/tmp/foo"
      },
      "metafilter_any|file-read*|/tmp/bar.txt": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "allow",
        "expected_predicates": [
          "/tmp/bar.txt"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "read_bar",
        "operation": "file-read*",
        "probe_id": "metafilter_any|file-read*|/tmp/bar.txt",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/tmp/bar.txt"
      },
      "metafilter_any|file-read*|/tmp/baz.txt": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "deny",
        "expected_predicates": [
          "/tmp/baz.txt"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "read_baz",
        "operation": "file-read*",
        "probe_id": "metafilter_any|file-read*|/tmp/baz.txt",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/tmp/baz.txt"
      },
      "metafilter_any|file-read*|/tmp/foo.txt": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "allow",
        "expected_predicates": [
          "/tmp/foo.txt"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "read_foo",
        "operation": "file-read*",
        "probe_id": "metafilter_any|file-read*|/tmp/foo.txt",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/tmp/foo.txt"
      },
      "metafilter_any|file-read*|/tmp/qux.txt": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "allow",
        "expected_predicates": [
          "/tmp/qux.txt"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "read_other",
        "operation": "file-read*",
        "probe_id": "metafilter_any|file-read*|/tmp/qux.txt",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/tmp/qux.txt"
      },
      "metafilter_any|file-write*|/tmp/baz.txt": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "deny",
        "expected_predicates": [
          "/tmp/baz.txt"
        ],
        "expected_primary_ops": [
          "file-write*"
        ],
        "name": "write_baz",
        "operation": "file-write*",
        "probe_id": "metafilter_any|file-write*|/tmp/baz.txt",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/tmp/baz.txt"
      },
      "runtime:strict_1:read_hosts": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "deny",
        "expected_predicates": [
          "/etc/hosts"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "read_hosts",
        "operation": "file-read*",
        "probe_id": "runtime:strict_1:read_hosts",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/etc/hosts"
      },
      "runtime:strict_1:read_ok": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "allow",
        "expected_predicates": [
          "/private/tmp/strict_ok/allow.txt"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "read_ok",
        "operation": "file-read*",
        "probe_id": "runtime:strict_1:read_ok",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/private/tmp/strict_ok/allow.txt"
      },
      "runtime:strict_1:write_hosts": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "deny",
        "expected_predicates": [
          "/etc/hosts"
        ],
        "expected_primary_ops": [
          "file-write*"
        ],
        "name": "write_hosts",
        "operation": "file-write*",
        "probe_id": "runtime:strict_1:write_hosts",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/etc/hosts"
      },
      "runtime:strict_1:write_ok": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "allow",
        "expected_predicates": [
          "/private/tmp/strict_ok/allow.txt"
        ],
        "expected_primary_ops": [
          "file-write*"
        ],
        "name": "write_ok",
        "operation": "file-write*",
        "probe_id": "runtime:strict_1:write_ok",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/private/tmp/strict_ok/allow.txt"
      },
      "sys:airlock:read_/etc/hosts": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "deny",
        "expected_predicates": [
          "/etc/hosts"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "read_/etc/hosts",
        "operation": "file-read*",
        "probe_id": "sys:airlock:read_/etc/hosts",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/etc/hosts"
      },
      "sys:airlock:read_/tmp/foo": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "deny",
        "expected_predicates": [
          "/tmp/foo"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "read_/tmp/foo",
        "operation": "file-read*",
        "probe_id": "sys:airlock:read_/tmp/foo",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/tmp/foo"
      },
      "sys:airlock:write_/etc/hosts": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "deny",
        "expected_predicates": [
          "/etc/hosts"
        ],
        "expected_primary_ops": [
          "file-write*"
        ],
        "name": "write_/etc/hosts",
        "operation": "file-write*",
        "probe_id": "sys:airlock:write_/etc/hosts",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/etc/hosts"
      },
      "sys:airlock:write_/tmp/foo": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "deny",
        "expected_predicates": [
          "/tmp/foo"
        ],
        "expected_primary_ops": [
          "file-write*"
        ],
        "name": "write_/tmp/foo",
        "operation": "file-write*",
        "probe_id": "sys:airlock:write_/tmp/foo",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/tmp/foo"
      },
      "sys:bsd:read_/etc/hosts": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "deny",
        "expected_predicates": [
          "/etc/hosts"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "read_/etc/hosts",
        "operation": "file-read*",
        "probe_id": "sys:bsd:read_/etc/hosts",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/etc/hosts"
      },
      "sys:bsd:read_/tmp/foo": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "deny",
        "expected_predicates": [
          "/tmp/foo"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "read_/tmp/foo",
        "operation": "file-read*",
        "probe_id": "sys:bsd:read_/tmp/foo",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/tmp/foo"
      },
      "sys:bsd:write_/etc/hosts": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "deny",
        "expected_predicates": [
          "/etc/hosts"
        ],
        "expected_primary_ops": [
          "file-write*"
        ],
        "name": "write_/etc/hosts",
        "operation": "file-write*",
        "probe_id": "sys:bsd:write_/etc/hosts",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/etc/hosts"
      },
      "sys:bsd:write_/tmp/foo": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "deny",
        "expected_predicates": [
          "/tmp/foo"
        ],
        "expected_primary_ops": [
          "file-write*"
        ],
        "name": "write_/tmp/foo",
        "operation": "file-write*",
        "probe_id": "sys:bsd:write_/tmp/foo",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/tmp/foo"
      }
    },
    "registry_id": "runtime-checks",
    "schema_version": "runtime-tools.probe_registry.v0.2",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  "profiles": {
    "profiles": {
      "bucket4:v1_read": {
        "family": null,
        "key_specific_rules": [],
        "mode": "sbpl",
        "notes": "Baseline bucket-4 profile: allow file-read* only.",
        "probe_refs": [
          "bucket4:v1_read:read_/etc/hosts",
          "bucket4:v1_read:write_/etc/hosts",
          "bucket4:v1_read:read_/tmp/foo"
        ],
        "profile_id": "bucket4:v1_read",
        "profile_path": "book/experiments/op-table-operation/sb/v1_read.sb",
        "semantic_group": null
      },
      "bucket5:v11_read_subpath": {
        "family": null,
        "key_specific_rules": [
          "(allow file-read* (subpath \"/private/tmp/foo\"))"
        ],
        "mode": "sbpl",
        "notes": "Bucket-5 subpath profile: allow read under /tmp/foo; deny other reads/writes.",
        "probe_refs": [
          "bucket5:v11_read_subpath:read_/tmp/foo",
          "bucket5:v11_read_subpath:read_/tmp/bar",
          "bucket5:v11_read_subpath:write_/tmp/foo"
        ],
        "profile_id": "bucket5:v11_read_subpath",
        "profile_path": "book/experiments/op-table-operation/sb/v11_read_subpath.sb",
        "semantic_group": null
      },
      "runtime:allow_all": {
        "family": null,
        "key_specific_rules": [],
        "mode": "blob",
        "notes": "allow default; should allow all file read/write",
        "probe_refs": [
          "allow_all|file-read*|/etc/hosts",
          "allow_all|file-read*|/tmp/sbpl_rt/read.txt",
          "allow_all|file-write*|/tmp/sbpl_rt/write.txt"
        ],
        "profile_id": "runtime:allow_all",
        "profile_path": "book/profiles/golden-triple/allow_all.sb.bin",
        "semantic_group": null
      },
      "runtime:metafilter_any": {
        "family": null,
        "key_specific_rules": [
          "(deny file-read* (literal \"/private/tmp/baz.txt\"))",
          "(deny file-write* (literal \"/private/tmp/baz.txt\"))"
        ],
        "mode": "sbpl",
        "notes": "require-any literal foo/bar; deny baz.",
        "probe_refs": [
          "metafilter_any|file-read*|/tmp/foo.txt",
          "metafilter_any|file-read*|/tmp/bar.txt",
          "metafilter_any|file-read*|/tmp/qux.txt",
          "metafilter_any|file-read*|/tmp/baz.txt",
          "metafilter_any|file-write*|/tmp/baz.txt"
        ],
        "profile_id": "runtime:metafilter_any",
        "profile_path": "book/experiments/sbpl-graph-runtime/profiles/metafilter_any.sb",
        "semantic_group": null
      },
      "runtime:strict_1": {
        "family": null,
        "key_specific_rules": [],
        "mode": "sbpl",
        "notes": "Strict deny-default profile with minimal allow-set for helper liveness.",
        "probe_refs": [
          "runtime:strict_1:read_ok",
          "runtime:strict_1:write_ok",
          "runtime:strict_1:read_hosts",
          "runtime:strict_1:write_hosts"
        ],
        "profile_id": "runtime:strict_1",
        "profile_path": "book/experiments/runtime-checks/strict_1.sb",
        "semantic_group": null
      },
      "sys:airlock": {
        "family": null,
        "key_specific_rules": [],
        "mode": "sbpl",
        "notes": "Platform-only profile expected to fail apply on this host; preflight is enforced so runners do not attempt apply under a generic harness identity.",
        "probe_refs": [
          "sys:airlock:read_/etc/hosts",
          "sys:airlock:write_/etc/hosts",
          "sys:airlock:read_/tmp/foo",
          "sys:airlock:write_/tmp/foo"
        ],
        "profile_id": "sys:airlock",
        "profile_path": "/System/Library/Sandbox/Profiles/airlock.sb",
        "semantic_group": null
      },
      "sys:bsd": {
        "family": null,
        "key_specific_rules": [],
        "mode": "sbpl",
        "notes": "System bsd profile via SBPL (no platform blob entitlements); observed denies on this host.",
        "probe_refs": [
          "sys:bsd:read_/etc/hosts",
          "sys:bsd:write_/etc/hosts",
          "sys:bsd:read_/tmp/foo",
          "sys:bsd:write_/tmp/foo"
        ],
        "profile_id": "sys:bsd",
        "profile_path": "/System/Library/Sandbox/Profiles/bsd.sb",
        "semantic_group": null
      }
    },
    "registry_id": "runtime-checks",
    "schema_version": "runtime-tools.profile_registry.v0.2",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  "registry_id": "runtime-checks",
  "schema_version": "runtime-tools.plan_template.v0.1",
  "template_id": "runtime-checks",
  "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
}
