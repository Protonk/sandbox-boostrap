{
  "description": "Minimal runtime slice for probe-op-structure anchors.",
  "plan": {
    "apply_preflight_profile": "book/experiments/hardened-runtime/sb/apply_preflight_allow.sb",
    "controls": {
      "baseline": true
    },
    "lanes": {
      "baseline": true,
      "oracle": true,
      "scenario": true
    },
    "notes": "Minimal runtime slice to test anchor-backed file, mach, and IOKit probes under the shared runtime harness.",
    "plan_id": "probe-op-structure.runtime.v1",
    "profiles": [
      "probe-op-structure:file:v1_file_require_any",
      "probe-op-structure:mach:v3_mach_global_local",
      "probe-op-structure:iokit:v5_iokit_class_property"
    ],
    "registry_id": "probe-op-structure",
    "schema_version": "runtime-tools.plan.v0.1",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  "probes": {
    "probes": {
      "probe-op-structure:file:v1_file_require_any:etc_hosts": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "allow",
        "expected_predicates": [
          "/etc/hosts"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "etc_hosts",
        "operation": "file-read*",
        "probe_id": "probe-op-structure:file:v1_file_require_any:etc_hosts",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/etc/hosts"
      },
      "probe-op-structure:file:v1_file_require_any:tmp_foo": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "expected": "allow",
        "expected_predicates": [
          "/tmp/foo"
        ],
        "expected_primary_ops": [
          "file-read*"
        ],
        "name": "tmp_foo",
        "operation": "file-read*",
        "probe_id": "probe-op-structure:file:v1_file_require_any:tmp_foo",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "/tmp/foo"
      },
      "probe-op-structure:iokit:v5_iokit_class_property:iousb_host_interface": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "driver": "sandbox_iokit_probe",
        "expected": "allow",
        "expected_predicates": [
          "IOUSBHostInterface"
        ],
        "expected_primary_ops": [
          "iokit-open-service"
        ],
        "name": "iousb_host_interface",
        "operation": "iokit-open-service",
        "probe_id": "probe-op-structure:iokit:v5_iokit_class_property:iousb_host_interface",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "IOUSBHostInterface"
      },
      "probe-op-structure:mach:v3_mach_global_local:cfprefsd_agent": {
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ],
        "driver": "sandbox_mach_probe",
        "expected": "allow",
        "expected_predicates": [
          "com.apple.cfprefsd.agent"
        ],
        "expected_primary_ops": [
          "mach-lookup"
        ],
        "name": "cfprefsd_agent",
        "operation": "mach-lookup",
        "probe_id": "probe-op-structure:mach:v3_mach_global_local:cfprefsd_agent",
        "supports_lanes": {
          "baseline": true,
          "oracle": true,
          "scenario": true
        },
        "target": "com.apple.cfprefsd.agent"
      }
    },
    "registry_id": "probe-op-structure",
    "schema_version": "runtime-tools.probe_registry.v0.2",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  "profiles": {
    "profiles": {
      "probe-op-structure:file:v1_file_require_any": {
        "family": "file-read",
        "key_specific_rules": [],
        "mode": "sbpl",
        "notes": "Anchor-focused file-read* probes for /tmp/foo and /etc/hosts.",
        "probe_refs": [
          "probe-op-structure:file:v1_file_require_any:tmp_foo",
          "probe-op-structure:file:v1_file_require_any:etc_hosts"
        ],
        "profile_id": "probe-op-structure:file:v1_file_require_any",
        "profile_path": "book/experiments/probe-op-structure/sb/v1_file_require_any.sb",
        "semantic_group": "file-read:anchor-check"
      },
      "probe-op-structure:iokit:v5_iokit_class_property": {
        "family": "iokit-open-service",
        "key_specific_rules": [
          "(allow mach-task-special-port-get)",
          "(allow mach-bootstrap)"
        ],
        "mode": "sbpl",
        "notes": "IOKit class/property probe under deny-default with bootstrap allowances.",
        "probe_refs": [
          "probe-op-structure:iokit:v5_iokit_class_property:iousb_host_interface"
        ],
        "profile_id": "probe-op-structure:iokit:v5_iokit_class_property",
        "profile_path": "book/experiments/probe-op-structure/sb/v5_iokit_class_property.sb",
        "semantic_group": "iokit:anchor-check"
      },
      "probe-op-structure:mach:v3_mach_global_local": {
        "family": "mach-lookup",
        "key_specific_rules": [
          "(allow mach-task-special-port-get)",
          "(allow mach-bootstrap)"
        ],
        "mode": "sbpl",
        "notes": "Add bootstrap allowances so mach-lookup probes can run under deny-default SBPL.",
        "probe_refs": [
          "probe-op-structure:mach:v3_mach_global_local:cfprefsd_agent"
        ],
        "profile_id": "probe-op-structure:mach:v3_mach_global_local",
        "profile_path": "book/experiments/probe-op-structure/sb/v3_mach_global_local.sb",
        "semantic_group": "mach:anchor-check"
      }
    },
    "registry_id": "probe-op-structure",
    "schema_version": "runtime-tools.profile_registry.v0.2",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  "registry_id": "probe-op-structure",
  "schema_version": "runtime-tools.plan_template.v0.1",
  "template_id": "probe-op-structure",
  "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
}
