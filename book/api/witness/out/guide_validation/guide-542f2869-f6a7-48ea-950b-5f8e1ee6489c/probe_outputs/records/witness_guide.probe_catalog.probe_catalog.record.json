{
  "capture_sandbox_logs": false,
  "command": [
    "book/tools/witness/PolicyWitness.app/Contents/MacOS/policy-witness",
    "xpc",
    "run",
    "--profile",
    "minimal",
    "--plan-id",
    "witness:guide",
    "--row-id",
    "probe_catalog",
    "probe_catalog"
  ],
  "correlation_id": null,
  "duration_s": 0.029147863388061523,
  "entrypoint": "book/tools/witness/PolicyWitness.app/Contents/MacOS/policy-witness",
  "evidence_tier": "mapped",
  "exit_code": 0,
  "finished_at_unix_s": 1767213318.284864,
  "lifecycle": {
    "correlation_id": "52178E74-2020-4456-8B22-56C382581147",
    "evidence_tier": "mapped",
    "file_path": null,
    "plan_id": "witness:guide",
    "process_name": "ProbeService_minimal",
    "profile_id": "minimal",
    "row_id": "probe_catalog",
    "service_id": "com.yourteam.policy-witness.ProbeService_minimal",
    "service_pid": "95218",
    "tmp_dir": "/Users/achyland/Library/Containers/com.yourteam.policy-witness.ProbeService_minimal/Data/tmp/"
  },
  "log_path": "book/api/witness/out/guide_validation/guide-542f2869-f6a7-48ea-950b-5f8e1ee6489c/probe_outputs/logs/witness_guide.probe_catalog.probe_catalog.json",
  "log_write_error": null,
  "observer": {
    "command": [
      "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
      "--pid",
      "95218",
      "--process-name",
      "ProbeService_minimal",
      "--format",
      "json",
      "--start",
      "2025-12-31 12:35:16",
      "--end",
      "2025-12-31 12:35:20",
      "--plan-id",
      "witness:guide",
      "--row-id",
      "probe_catalog",
      "--correlation-id",
      "52178E74-2020-4456-8B22-56C382581147"
    ],
    "correlation_id": "52178E74-2020-4456-8B22-56C382581147",
    "exit_code": 0,
    "last": "10s",
    "log_path": "book/api/witness/out/guide_validation/guide-542f2869-f6a7-48ea-950b-5f8e1ee6489c/probe_outputs/logs/observer/witness_guide.probe_catalog.probe_catalog.json.observer.json",
    "log_write_error": null,
    "observer_window_end": "2025-12-31 12:35:20",
    "observer_window_mode": "range",
    "observer_window_pad_s": 2.0,
    "observer_window_start": "2025-12-31 12:35:16",
    "pid": "95218",
    "plan_id": "witness:guide",
    "process_name": "ProbeService_minimal",
    "report": {
      "data": {
        "correlation_id": "52178E74-2020-4456-8B22-56C382581147",
        "deny_lines": [],
        "duration_ms": null,
        "end": "2025-12-31 12:35:20",
        "last": null,
        "layer_attribution": {
          "seatbelt": "observer_only"
        },
        "log_error": null,
        "log_rc": 0,
        "log_stderr": "",
        "log_stdout": "Timestamp                       (process)[PID]    ",
        "log_truncated": false,
        "mode": "show",
        "observed_deny": false,
        "observed_lines": 1,
        "observer_schema_version": 1,
        "pid": 95218,
        "plan_id": "witness:guide",
        "predicate": "((eventMessage CONTAINS[c] \"Sandbox: ProbeService_minimal(95218)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"95218\")))",
        "process_name": "ProbeService_minimal",
        "row_id": "probe_catalog",
        "start": "2025-12-31 12:35:16",
        "stop_on_pid_exit": false
      },
      "generated_at_unix_ms": 1767213318804,
      "kind": "sandbox_log_observer_report",
      "result": {
        "errno": null,
        "error": null,
        "exit_code": 0,
        "normalized_outcome": null,
        "ok": true,
        "rc": null,
        "stderr": null,
        "stdout": null
      },
      "schema_version": 1
    },
    "report_error": null,
    "row_id": "probe_catalog",
    "stderr": "",
    "stdout_bytes": 1166
  },
  "observer_log_path": "book/api/witness/out/guide_validation/guide-542f2869-f6a7-48ea-950b-5f8e1ee6489c/probe_outputs/logs/observer/witness_guide.probe_catalog.probe_catalog.json.observer.json",
  "observer_status": "ok",
  "plan_id": "witness:guide",
  "probe_args": [],
  "probe_error": null,
  "probe_id": "probe_catalog",
  "probe_timeout_s": 25.0,
  "profile_id": "minimal",
  "record_write_error": null,
  "row_id": "probe_catalog",
  "service_id": null,
  "started_at_unix_s": 1767213318.255716,
  "stderr": "",
  "stdout": "{\"data\":{\"argv\":[],\"correlation_id\":\"52178E74-2020-4456-8B22-56C382581147\",\"details\":{\"bundle_id\":\"com.yourteam.policy-witness.ProbeService_minimal\",\"correlation_id\":\"52178E74-2020-4456-8B22-56C382581147\",\"cwd\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.policy-witness.ProbeService_minimal\\/Data\",\"home_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.policy-witness.ProbeService_minimal\\/Data\",\"pid\":\"95218\",\"probe_count\":\"20\",\"probe_family\":\"probe_catalog\",\"probe_pid\":\"95218\",\"process_name\":\"ProbeService_minimal\",\"service_pid\":\"95218\",\"session_token\":\"F80DF2F4-D4A9-4592-9E41-512A41115915\",\"tmp_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.policy-witness.ProbeService_minimal\\/Data\\/tmp\\/\"},\"ended_at_iso8601\":\"2025-12-31T20:35:18.282Z\",\"normalized_outcome\":\"ok\",\"plan_id\":\"witness:guide\",\"probe_id\":\"probe_catalog\",\"rc\":0,\"row_id\":\"probe_catalog\",\"schema_version\":1,\"service_build\":\"2\",\"service_bundle_id\":\"com.yourteam.policy-witness.ProbeService_minimal\",\"service_name\":\"ProbeService_minimal\",\"service_version\":\"2.0.0\",\"started_at_iso8601\":\"2025-12-31T20:35:18.281Z\",\"stderr\":\"\",\"stdout\":\"{\\\"generated_at_iso8601\\\":\\\"2025-12-31T20:35:18Z\\\",\\\"probes\\\":[{\\\"entitlement_hints\\\":[\\\"none (observer)\\\"],\\\"examples\\\":[\\\"probe_catalog\\\"],\\\"notes\\\":[\\\"Outputs JSON in RunProbeResponse.stdout.\\\",\\\"Use <probe-id> --help for per-probe usage.\\\"],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"probe_catalog\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"emit a JSON catalog of available probes\\\",\\\"usage\\\":\\\"probe_catalog\\\"},{\\\"entitlement_hints\\\":[\\\"none (observer)\\\"],\\\"examples\\\":[\\\"world_shape\\\"],\\\"notes\\\":[\\\"Reports HOME\\\\\\/TMP\\\\\\/CWD and containerization signals.\\\"],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"world_shape\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"report containerization and world shape metadata\\\",\\\"usage\\\":\\\"world_shape\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.network.client\\\"],\\\"examples\\\":[\\\"network_tcp_connect --host 1.1.1.1 --port 443\\\"],\\\"notes\\\":[],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"network_tcp_connect\\\",\\\"required_args\\\":[\\\"--host <ipv4>\\\",\\\"--port <1..65535>\\\"],\\\"summary\\\":\\\"attempt a TCP connect to an IPv4 host:port\\\",\\\"usage\\\":\\\"network_tcp_connect --host <ipv4> --port <1..65535>\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.files.downloads.read-write\\\"],\\\"examples\\\":[\\\"downloads_rw\\\",\\\"downloads_rw --name demo.txt\\\"],\\\"notes\\\":[\\\"Writes under Downloads\\\\\\/policy-witness-harness.\\\"],\\\"optional_args\\\":[\\\"--name <file-name>\\\"],\\\"probe_id\\\":\\\"downloads_rw\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"read\\\\\\/write\\\\\\/remove a file under Downloads\\\\\\/policy-witness-harness\\\",\\\"usage\\\":\\\"downloads_rw [--name <file-name>]\\\"},{\\\"entitlement_hints\\\":[\\\"path-dependent (file access entitlements)\\\"],\\\"examples\\\":[\\\"fs_op --op stat --path-class downloads\\\",\\\"fs_op --op create --path-class tmp --target run_dir\\\"],\\\"notes\\\":[\\\"Destructive direct-path ops are refused unless you use --path-class\\\\\\/--target (or a path under *\\\\\\/policy-witness-harness\\\\\\/*) or set --allow-unsafe-path.\\\",\\\"Use --no-cleanup to keep harness artifacts after rename\\\\\\/truncate for update_file_by_fileid experiments.\\\"],\\\"optional_args\\\":[\\\"--target <base|harness_dir|run_dir|specimen_file>\\\",\\\"--name <file-name>\\\",\\\"--to <path> | --to-path <path> | --to-name <file-name>\\\",\\\"--max-entries <n>\\\",\\\"--allow-unsafe-path\\\",\\\"--no-cleanup\\\"],\\\"probe_id\\\":\\\"fs_op\\\",\\\"required_args\\\":[\\\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\\",\\\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\\\"],\\\"summary\\\":\\\"parameterized filesystem operations\\\",\\\"usage\\\":\\\"fs_op --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\\\n      (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n      [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\\\n      [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path] [--no-cleanup]\\\"},{\\\"entitlement_hints\\\":[\\\"path-dependent (file access entitlements)\\\"],\\\"examples\\\":[\\\"fs_op_wait --op open_read --path-class tmp --wait-fifo \\\\\\/tmp\\\\\\/pw-wait.fifo\\\",\\\"fs_op_wait --op stat --path \\\\\\/tmp\\\\\\/target --wait-exists \\\\\\/tmp\\\\\\/trigger --wait-timeout-ms 60000\\\"],\\\"notes\\\":[\\\"Blocks until the wait trigger is satisfied, then runs fs_op.\\\",\\\"--wait-interval-ms is only used with --wait-exists.\\\"],\\\"optional_args\\\":[\\\"--target <base|harness_dir|run_dir|specimen_file>\\\",\\\"--name <file-name>\\\",\\\"--to <path> | --to-path <path> | --to-name <file-name>\\\",\\\"--max-entries <n>\\\",\\\"--allow-unsafe-path\\\",\\\"--no-cleanup\\\",\\\"--wait-timeout-ms <n>\\\",\\\"--wait-interval-ms <n>\\\"],\\\"probe_id\\\":\\\"fs_op_wait\\\",\\\"required_args\\\":[\\\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\\",\\\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\\\",\\\"--wait-fifo <path> | --wait-exists <path>\\\"],\\\"summary\\\":\\\"wait for a trigger, then run fs_op\\\",\\\"usage\\\":\\\"fs_op_wait --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\\\n          (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n          [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\\\n          [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path] [--no-cleanup]\\\\n          (--wait-fifo <path> | --wait-exists <path>) [--wait-timeout-ms <n>] [--wait-interval-ms <n>]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.network.client\\\"],\\\"examples\\\":[\\\"net_op --op getaddrinfo --host example.com\\\",\\\"net_op --op tcp_connect --host 127.0.0.1 --port 80\\\"],\\\"notes\\\":[\\\"--port is required for tcp_connect and udp_send.\\\"],\\\"optional_args\\\":[\\\"--port <1..65535>\\\",\\\"--numeric\\\"],\\\"probe_id\\\":\\\"net_op\\\",\\\"required_args\\\":[\\\"--op <getaddrinfo|tcp_connect|udp_send>\\\",\\\"--host <host>\\\"],\\\"summary\\\":\\\"parameterized network operations\\\",\\\"usage\\\":\\\"net_op --op <getaddrinfo|tcp_connect|udp_send> --host <host> [--port <1..65535>] [--numeric]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.cs.disable-library-validation\\\",\\\"com.apple.security.cs.allow-dyld-environment-variables (if you rely on DYLD_*)\\\"],\\\"examples\\\":[\\\"dlopen_external --path \\\\\\/path\\\\\\/to\\\\\\/testdylib.dylib\\\"],\\\"notes\\\":[\\\"Executes dylib initializers; this is not a passive probe.\\\",\\\"Use a signed dylib (see tests\\\\\\/fixtures\\\\\\/TestDylib).\\\"],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"dlopen_external\\\",\\\"required_args\\\":[\\\"--path <abs> (or PW_DLOPEN_PATH)\\\"],\\\"summary\\\":\\\"dlopen a signed dylib by absolute path\\\",\\\"usage\\\":\\\"dlopen_external --path <abs> (or set PW_DLOPEN_PATH)\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.cs.allow-jit\\\"],\\\"examples\\\":[\\\"jit_map_jit\\\",\\\"jit_map_jit --size 65536\\\"],\\\"notes\\\":[\\\"Reports errno on MAP_JIT failure.\\\"],\\\"optional_args\\\":[\\\"--size <bytes> (default: 16384)\\\"],\\\"probe_id\\\":\\\"jit_map_jit\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"attempt mmap with MAP_JIT\\\",\\\"usage\\\":\\\"jit_map_jit [--size <bytes>]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.cs.allow-unsigned-executable-memory\\\"],\\\"examples\\\":[\\\"jit_rwx_legacy\\\",\\\"jit_rwx_legacy --size 65536\\\"],\\\"notes\\\":[\\\"Reports errno on RWX mmap failure.\\\"],\\\"optional_args\\\":[\\\"--size <bytes> (default: 16384)\\\"],\\\"probe_id\\\":\\\"jit_rwx_legacy\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"attempt mmap with RWX permissions (legacy)\\\",\\\"usage\\\":\\\"jit_rwx_legacy [--size <bytes>]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.files.bookmarks.app-scope\\\",\\\"com.apple.security.files.user-selected.read-only\\\",\\\"com.apple.security.files.user-selected.read-write\\\"],\\\"examples\\\":[\\\"bookmark_op --bookmark-b64 <b64> --op stat\\\",\\\"bookmark_op --bookmark-path \\\\\\/tmp\\\\\\/token.txt --op open_read --relative file.txt\\\"],\\\"notes\\\":[\\\"Uses ScopedBookmarksAgent IPC for security-scoped bookmarks.\\\",\\\"Treat bookmark tokens as scoped to the creating code identity (bundle id\\\\\\/team id); resolving under a different profile\\\\\\/service may fail even if entitlements are present.\\\"],\\\"optional_args\\\":[\\\"--relative <rel>\\\",\\\"--op <fs_op-op> (default: stat)\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"bookmark_op\\\",\\\"required_args\\\":[\\\"--bookmark-b64 <base64> | --bookmark-path <path>\\\"],\\\"summary\\\":\\\"resolve a bookmark token and run a filesystem op against it\\\",\\\"usage\\\":\\\"bookmark_op --bookmark-b64 <base64> | --bookmark-path <path>\\\\n            [--relative <rel>] [--op <fs_op-op>] [--allow-unsafe-path]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.files.bookmarks.app-scope\\\",\\\"com.apple.security.files.user-selected.read-only\\\",\\\"com.apple.security.files.user-selected.read-write\\\"],\\\"examples\\\":[\\\"bookmark_make --path \\\\\\/Users\\\\\\/me\\\\\\/Downloads\\\",\\\"bookmark_make --path \\\\\\/Users\\\\\\/me\\\\\\/Downloads --read-only\\\"],\\\"notes\\\":[\\\"Security-scoped bookmarks use ScopedBookmarksAgent IPC.\\\",\\\"Bookmark tokens are not expected to be portable across service identities; prefer make+resolve within the same profile\\\\\\/service.\\\"],\\\"optional_args\\\":[\\\"--no-security-scope\\\",\\\"--read-only\\\",\\\"--allow-missing\\\"],\\\"probe_id\\\":\\\"bookmark_make\\\",\\\"required_args\\\":[\\\"--path <abs>\\\"],\\\"summary\\\":\\\"create a security-scoped bookmark token for a path\\\",\\\"usage\\\":\\\"bookmark_make --path <abs> [--no-security-scope] [--read-only] [--allow-missing]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.files.bookmarks.app-scope\\\",\\\"com.apple.security.files.user-selected.read-only\\\",\\\"com.apple.security.files.user-selected.read-write\\\"],\\\"examples\\\":[\\\"bookmark_roundtrip --path \\\\\\/Users\\\\\\/me\\\\\\/Downloads --op stat\\\",\\\"bookmark_roundtrip --path \\\\\\/Users\\\\\\/me\\\\\\/Downloads --op open_read --relative file.txt\\\"],\\\"notes\\\":[\\\"Returns the bookmark token in stdout and the fs_op result in details.\\\",\\\"This is the most deterministic bookmark workflow because create+resolve happen under the same service identity.\\\"],\\\"optional_args\\\":[\\\"--op <fs_op-op> (default: stat)\\\",\\\"--relative <rel>\\\",\\\"--no-security-scope\\\",\\\"--read-only\\\",\\\"--allow-missing\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"bookmark_roundtrip\\\",\\\"required_args\\\":[\\\"--path <abs>\\\"],\\\"summary\\\":\\\"create a bookmark token and immediately resolve + run a filesystem op\\\",\\\"usage\\\":\\\"bookmark_roundtrip --path <abs> [--op <fs_op-op>] [--relative <rel>] [--no-security-scope] [--read-only] [--allow-missing] [--allow-unsafe-path]\\\"},{\\\"entitlement_hints\\\":[\\\"none (observer)\\\"],\\\"examples\\\":[\\\"capabilities_snapshot\\\"],\\\"notes\\\":[\\\"Includes entitlement presence booleans and standard directory paths.\\\"],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"capabilities_snapshot\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"report entitlements and resolved standard directories\\\",\\\"usage\\\":\\\"capabilities_snapshot\\\"},{\\\"entitlement_hints\\\":[\\\"none (observer \\\\\\/ instrumentation target)\\\"],\\\"examples\\\":[\\\"sandbox_check --operation file-read-data\\\",\\\"sandbox_check --operation file-read-data --path \\\\\\/etc\\\\\\/hosts\\\",\\\"sandbox_check --operation mach-lookup --repeat 10\\\"],\\\"notes\\\":[\\\"This does not perform the operation; it only calls sandbox_check() so attach\\\\\\/hook tooling can observe libsystem_sandbox activity.\\\",\\\"If --path is provided, the probe passes a guessed filter type for a path argument; treat the return code as informational, not authoritative.\\\"],\\\"optional_args\\\":[\\\"--path <abs>\\\",\\\"--repeat <n> (default: 1)\\\"],\\\"probe_id\\\":\\\"sandbox_check\\\",\\\"required_args\\\":[\\\"--operation <sandbox-op>\\\"],\\\"summary\\\":\\\"call sandbox_check() in libsystem_sandbox (hook calibration)\\\",\\\"usage\\\":\\\"sandbox_check --operation <sandbox-op> [--path <abs>] [--repeat <n>]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.temporary-exception.sbpl (allow file-issue-extension for extension class)\\\"],\\\"examples\\\":[\\\"sandbox_extension --op issue_file --class com.apple.app-sandbox.read --path \\\\\\/etc\\\\\\/hosts --allow-unsafe-path\\\",\\\"sandbox_extension --op issue_file --class com.apple.app-sandbox.read --path-class tmp --target specimen_file --name pw_extension.txt --create\\\",\\\"sandbox_extension --op issue_file_to_pid --pid self --class com.apple.app-sandbox.read --path \\\\\\/etc\\\\\\/hosts --allow-unsafe-path\\\",\\\"sandbox_extension --op issue_extension --path-class tmp --target specimen_file --name pw_extension.txt --create\\\",\\\"sandbox_extension --op issue_fs_extension --flags 8 --path \\\\\\/etc\\\\\\/hosts --allow-unsafe-path\\\",\\\"sandbox_extension --op consume --token <token> --token-format full\\\",\\\"sandbox_extension --op consume --token <token> --call-variant token_second --call-symbol sandbox_consume_extension\\\",\\\"sandbox_extension --op consume --token <token> --call-variant token_and_ptr --call-symbol sandbox_consume_fs_extension\\\",\\\"sandbox_extension --op release --handle <i64>\\\",\\\"sandbox_extension --op release_file --token <token>\\\",\\\"sandbox_extension --op update_file --path \\\\\\/etc\\\\\\/hosts --flags 0 --allow-unsafe-path\\\",\\\"sandbox_extension --op update_file_rename_delta --class com.apple.app-sandbox.read --path \\\\\\/Users\\\\\\/me\\\\\\/Desktop\\\\\\/pw_old.txt --new-path \\\\\\/Users\\\\\\/me\\\\\\/Desktop\\\\\\/pw_new.txt --wait-for-external-rename --allow-unsafe-path\\\",\\\"sandbox_extension --op update_file_by_fileid --token <token> --path \\\\\\/etc\\\\\\/hosts --flags 0\\\",\\\"sandbox_extension --op update_file_by_fileid --token <token> --file-id <u64> --selector 2 --call-variant payload_ptr_selector\\\",\\\"sandbox_extension --op update_file_by_fileid_sweep --class com.apple.app-sandbox.read --path-class tmp --target specimen_file --name pw_sweep.txt --create --selectors 0,1,2\\\",\\\"sandbox_extension --op update_file_by_fileid_delta --class com.apple.app-sandbox.read --path-class tmp --target specimen_file --name pw_delta.txt --create --selector 2 --payload-source st_dev\\\",\\\"sandbox_extension --op issue_file --class com.apple.app-sandbox.read --path \\\\\\/etc\\\\\\/hosts --allow-unsafe-path --introspect\\\"],\\\"notes\\\":[\\\"issue_file returns the token in stdout and in details.token.\\\",\\\"issue_file_to_pid issues a token scoped to another process via sandbox_extension_issue_file_to_process_by_pid.\\\",\\\"issue_extension\\\\\\/issue_fs_extension\\\\\\/issue_fs_rw_extension are thin wrappers around sandbox_extension_issue_file.\\\",\\\"Direct-path issuance outside *\\\\\\/policy-witness-harness\\\\\\/* is refused unless you pass --allow-unsafe-path.\\\",\\\"If consume\\\\\\/release fails with invalid-token style errors, try --token-format prefix (uses the substring before the first ';').\\\",\\\"consume returns a (typically positive) i64 handle in stdout + details.consume_handle when sandbox_extension_consume(handle) is usable.\\\",\\\"release prefers --handle from a prior consume; token-based release variants are supported for experimentation only.\\\",\\\"Consume\\\\\\/release auto-tries common symbols\\\\\\/variants when --call-symbol is not set; use --call-symbol\\\\\\/--call-variant to pin behavior.\\\",\\\"release_file calls sandbox_extension_release_file with the provided token only.\\\",\\\"update_file passes path + flags into sandbox_extension_update_file; update_file_by_fileid is experimental and supports multiple ABI variants, including pointer-based forms.\\\",\\\"update_file_rename_delta runs issue+consume on --path, waits for a host-side rename to --new-path, then compares update_file_by_fileid candidates vs update_file() for restoring access to --new-path.\\\",\\\"update_file_rename_delta stops early with normalized_outcome=dest_preexisted if --new-path already exists at probe start.\\\",\\\"payload_ptr_selector uses an 8-byte payload buffer + selector and forces field2 to 0 (Sonoma 14.4.1 ABI).\\\",\\\"If update_file_by_fileid returns invalid-arg\\\\\\/Bad address, try --call-variant payload_ptr_selector and a selector of 0\\\\\\/1\\\\\\/2.\\\",\\\"update_file_by_fileid_sweep issues+consumes a token and runs payload_ptr_selector across candidate payloads (stat + handle-derived; optionally token fields) and selectors.\\\",\\\"update_file_by_fileid_delta runs an atomic replace and records open + sandbox_check transitions before\\\\\\/after the update call (use this to define a measurable access delta).\\\",\\\"Wrapper symbols use specific variants: sandbox_consume_extension=token_second, sandbox_consume_fs_extension=token_and_ptr, sandbox_release_fs_extension=one_arg.\\\"],\\\"optional_args\\\":[\\\"--class <extension-class> (required for issue_file\\\\\\/issue_file_to_pid\\\\\\/update_file_rename_delta\\\\\\/update_file_by_fileid_delta)\\\",\\\"--pid <int|self> (required for issue_file_to_pid)\\\",\\\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches> (required for issue_file\\\\\\/issue_file_to_pid\\\\\\/issue_*\\\\\\/update_file\\\\\\/update_file_by_fileid_delta)\\\",\\\"--new-path <abs> (required for update_file_rename_delta)\\\",\\\"--file-id <u64> (required for update_file_by_fileid unless --path is provided)\\\",\\\"--selector <u64> (update_file_by_fileid selectors; default: 2 for update_file_by_fileid_delta\\\\\\/update_file_rename_delta)\\\",\\\"--selectors <u64,u64,...> (default: 0,1,2; update_file_by_fileid_sweep)\\\",\\\"--payload <u64> (update_file_by_fileid_delta; overrides --payload-source)\\\",\\\"--payload-source <st_dev|st_ino|handle_low32|handle_high32|handle_xor32> (default: st_dev; update_file_by_fileid_delta)\\\",\\\"--sandbox-op <sandbox-op> (default: file-read-data; update_file_by_fileid_delta sandbox_check oracle)\\\",\\\"--skip-update (update_file_by_fileid_delta control arm: measure without calling update)\\\",\\\"--no-cleanup (update_file_by_fileid_delta\\\\\\/update_file_rename_delta: do not call sandbox_extension_release(handle))\\\",\\\"--wait-for-external-replace (update_file_by_fileid_delta: wait for inode change instead of doing an in-sandbox replace)\\\",\\\"--wait-for-external-rename (update_file_rename_delta: wait for a host-side rename from --path to --new-path)\\\",\\\"--wait-timeout-ms <n> (default: 30000; update_file_by_fileid_delta\\\\\\/update_file_rename_delta)\\\",\\\"--wait-interval-ms <n> (default: 50; update_file_by_fileid_delta\\\\\\/update_file_rename_delta)\\\",\\\"--include-token-fields (update_file_by_fileid_sweep: parse numeric token segments as candidate payloads)\\\",\\\"--target <base|harness_dir|run_dir|specimen_file> (default: specimen_file)\\\",\\\"--name <filename>\\\",\\\"--flags <int> (default: 0; issue_file\\\\\\/issue_fs_extension\\\\\\/update_file\\\\\\/update_file_by_fileid\\\\\\/update_file_by_fileid_delta or consume\\\\\\/release with two_arg)\\\",\\\"--create (create a harness file\\\\\\/dir for issue_file\\\\\\/update_file_by_fileid_delta if missing)\\\",\\\"--allow-unsafe-path\\\",\\\"--introspect (emit symbol presence + image path in details)\\\",\\\"--token <token> (required for consume\\\\\\/release_file\\\\\\/update_file_by_fileid; optional for release)\\\",\\\"--handle <i64> (preferred for release; from a prior consume)\\\",\\\"--token-format <full|prefix> (default: full; consume\\\\\\/release\\\\\\/update_file_by_fileid)\\\",\\\"--call-symbol <symbol> (override consume\\\\\\/release symbol; advanced)\\\",\\\"--call-variant <handle_one_arg|one_arg|two_arg|token_second|token_and_ptr|token_fileid|fileid_token|fileid_ptr_token|token_ptr_fileid|fileid_ptr_selector|payload_ptr_selector|auto> (default: auto; consume\\\\\\/release\\\\\\/update_file_by_fileid)\\\"],\\\"probe_id\\\":\\\"sandbox_extension\\\",\\\"required_args\\\":[\\\"--op <issue_file|issue_file_to_pid|issue_extension|issue_fs_extension|issue_fs_rw_extension|consume|release|release_file|update_file|update_file_rename_delta|update_file_by_fileid|update_file_by_fileid_sweep|update_file_by_fileid_delta>\\\"],\\\"summary\\\":\\\"issue\\\\\\/consume\\\\\\/release sandbox file extensions\\\",\\\"usage\\\":\\\"\\\\tsandbox_extension --op issue_file --class <extension-class>\\\\n\\\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n\\\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n\\\\t                 [--flags <int>] [--create] [--allow-unsafe-path] [--introspect]\\\\n\\\\tsandbox_extension --op issue_file_to_pid --pid <int|self> --class <extension-class>\\\\n\\\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n\\\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n\\\\t                 [--flags <int>] [--create] [--allow-unsafe-path] [--introspect]\\\\n\\\\tsandbox_extension --op issue_extension\\\\n\\\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n\\\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n\\\\t                 [--create] [--allow-unsafe-path] [--introspect]\\\\n\\\\tsandbox_extension --op issue_fs_extension [--flags <int>]\\\\n\\\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n\\\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n\\\\t                 [--create] [--allow-unsafe-path] [--introspect]\\\\n\\\\t\\\\tsandbox_extension --op issue_fs_rw_extension\\\\n\\\\t\\\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n\\\\t\\\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n\\\\t\\\\t                 [--create] [--allow-unsafe-path] [--introspect]\\\\n\\\\t\\\\tsandbox_extension --op consume --token <token> [--token-format <full|prefix>]\\\\n\\\\t\\\\t                 [--call-symbol <symbol>] [--call-variant <handle_one_arg|one_arg|two_arg|token_second|token_and_ptr|auto>] [--flags <int>] [--introspect]\\\\n\\\\t\\\\tsandbox_extension --op release [--handle <i64>] [--token <token> --token-format <full|prefix>]\\\\n\\\\t\\\\t                 [--call-symbol <symbol>] [--call-variant <handle_one_arg|one_arg|two_arg|token_and_ptr|auto>] [--flags <int>] [--introspect]\\\\n\\\\t\\\\tsandbox_extension --op release_file --token <token> [--token-format <full|prefix>]\\\\n\\\\t\\\\t                 [--introspect]\\\\n\\\\tsandbox_extension --op update_file (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n\\\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n\\\\t                 [--flags <int>] [--allow-unsafe-path] [--introspect]\\\\n\\\\t\\\\tsandbox_extension --op update_file_rename_delta --class <extension-class>\\\\n\\\\t\\\\t                 --path <abs> --new-path <abs>\\\\n\\\\t\\\\t                 [--flags <int>] [--selector <u64>] [--allow-unsafe-path]\\\\n\\\\t\\\\t                 [--wait-for-external-rename] [--wait-timeout-ms <n>] [--wait-interval-ms <n>]\\\\n\\\\t\\\\t                 [--no-cleanup] [--introspect]\\\\n\\\\t\\\\tsandbox_extension --op update_file_by_fileid --token <token> (--file-id <u64> | --path <abs>)\\\\n\\\\t\\\\t                 [--flags <int>] [--selector <u64>] [--call-variant <token_fileid|fileid_token|fileid_ptr_token|token_ptr_fileid|fileid_ptr_selector|payload_ptr_selector|auto>] [--introspect]\\\\n\\\\t\\\\tsandbox_extension --op update_file_by_fileid_sweep --class <extension-class>\\\\n\\\\t\\\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n\\\\t\\\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n\\\\t                 [--flags <int>] [--create] [--allow-unsafe-path]\\\\n\\\\t                 [--selectors <u64,u64,...>] [--include-token-fields] [--no-cleanup] [--introspect]\\\\n\\\\tsandbox_extension --op update_file_by_fileid_delta --class <extension-class>\\\\n\\\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n\\\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n\\\\t                 [--flags <int>] [--selector <u64>] [--create] [--allow-unsafe-path]\\\\n\\\\t                 [--payload <u64> | --payload-source <st_dev|st_ino|handle_low32|handle_high32|handle_xor32>]\\\\n\\\\t                 [--sandbox-op <sandbox-op>] [--skip-update] [--no-cleanup]\\\\n\\\\t                 [--wait-for-external-replace] [--wait-timeout-ms <n>] [--wait-interval-ms <n>] [--introspect]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.temporary-exception.sbpl (needed for sandbox_extension issue_file in dynamic_extension)\\\"],\\\"examples\\\":[\\\"inherit_child --scenario dynamic_extension --path \\\\\\/private\\\\\\/var\\\\\\/db\\\\\\/launchd.db\\\\\\/com.apple.launchd\\\\\\/overrides.plist --allow-unsafe-path\\\",\\\"inherit_child --scenario matrix_basic --path-class tmp --target specimen_file --name pw_child.txt --create\\\",\\\"inherit_child --scenario bookmark_ferry --path-class documents --target specimen_file --name pw_child.txt --create\\\",\\\"inherit_child --scenario inherit_bad_entitlements\\\"],\\\"notes\\\":[\\\"Spawns the bundled pw-inherit-child helper using posix_spawn and an event bus + rights bus (SCM_RIGHTS).\\\",\\\"Emits a structured witness payload under RunProbeResponse.witness.\\\",\\\"dynamic_extension uses sandbox extension issuance for parent-only acquisition; matrix_basic skips tokens.\\\",\\\"bookmark_ferry passes security-scoped bookmark bytes over the event bus; bookmark resolution is identity-sensitive, so the spawned helper must share the service bundle id.\\\",\\\"lineage_basic spawns a grandchild.\\\"],\\\"optional_args\\\":[\\\"--scenario <bookmark_ferry|dynamic_extension|inherit_bad_entitlements|lineage_basic|matrix_basic> (default: dynamic_extension)\\\",\\\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\\\",\\\"--target <base|harness_dir|run_dir|specimen_file> (default: specimen_file)\\\",\\\"--name <filename>\\\",\\\"--create (create a harness file\\\\\\/dir for the target if missing)\\\",\\\"--allow-unsafe-path\\\",\\\"--bookmark-move (bookmark_ferry only; move target after bookmark creation)\\\",\\\"--bookmark-invalid (bookmark_ferry only; send invalid bookmark payload bytes)\\\",\\\"--stop-on-entry (child raises SIGSTOP early for debugger attach)\\\",\\\"--stop-on-deny (child raises SIGSTOP on EPERM\\\\\\/EACCES)\\\",\\\"--stop-auto-resume (parent sends SIGCONT after child stop)\\\",\\\"--protocol-bad-cap-id (inject a bad cap_id for protocol tests)\\\"],\\\"probe_id\\\":\\\"inherit_child\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"capability ferry matrix: parent acquires, child attempts acquire vs use\\\",\\\"usage\\\":\\\"inherit_child [--scenario <bookmark_ferry|dynamic_extension|inherit_bad_entitlements|lineage_basic|matrix_basic>]\\\\n              [--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>]\\\\n              [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n              [--create] [--allow-unsafe-path]\\\\n              [--stop-on-entry] [--stop-on-deny] [--stop-auto-resume]\\\\n              [--bookmark-move] [--bookmark-invalid] [--protocol-bad-cap-id]\\\"},{\\\"entitlement_hints\\\":[\\\"none (containerization evidence)\\\"],\\\"examples\\\":[\\\"userdefaults_op --op read --key example\\\",\\\"userdefaults_op --op write --key example --value 1\\\"],\\\"notes\\\":[\\\"Useful for observing containerized preferences paths.\\\"],\\\"optional_args\\\":[\\\"--op <read|write|remove|sync> (default: read)\\\",\\\"--key <k>\\\",\\\"--value <v>\\\",\\\"--suite <suite>\\\"],\\\"probe_id\\\":\\\"userdefaults_op\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"read\\\\\\/write\\\\\\/remove\\\\\\/sync a UserDefaults key\\\",\\\"usage\\\":\\\"userdefaults_op --op <read|write|remove|sync> [--key <k>] [--value <v>] [--suite <suite>]\\\"},{\\\"entitlement_hints\\\":[\\\"path-dependent (file access entitlements)\\\"],\\\"examples\\\":[\\\"fs_xattr --op get --path \\\\\\/tmp\\\\\\/file --name com.apple.quarantine\\\",\\\"fs_xattr --op list --path \\\\\\/tmp\\\\\\/file\\\"],\\\"notes\\\":[\\\"xattr writes are refused outside harness paths unless --allow-write or --allow-unsafe-path is set.\\\"],\\\"optional_args\\\":[\\\"--name <xattr>\\\",\\\"--value <v>\\\",\\\"--allow-write\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"fs_xattr\\\",\\\"required_args\\\":[\\\"--op <get|list|set|remove>\\\",\\\"--path <abs>\\\"],\\\"summary\\\":\\\"get\\\\\\/list\\\\\\/set\\\\\\/remove extended attributes\\\",\\\"usage\\\":\\\"fs_xattr --op <get|list|set|remove> --path <abs> [--name <xattr>] [--value <v>] [--allow-write] [--allow-unsafe-path]\\\"},{\\\"entitlement_hints\\\":[\\\"path-dependent (file access entitlements)\\\"],\\\"examples\\\":[\\\"fs_coordinated_op --op read --path-class documents\\\",\\\"fs_coordinated_op --op write --path-class tmp --target run_dir\\\"],\\\"notes\\\":[\\\"Coordinated writes to direct paths are refused unless you use --path-class\\\\\\/--target (or a path under *\\\\\\/policy-witness-harness\\\\\\/*) or set --allow-unsafe-path.\\\"],\\\"optional_args\\\":[\\\"--target <base|harness_dir|run_dir|specimen_file>\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"fs_coordinated_op\\\",\\\"required_args\\\":[\\\"--op <read|write>\\\",\\\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\\\"],\\\"summary\\\":\\\"NSFileCoordinator mediated read\\\\\\/write\\\",\\\"usage\\\":\\\"fs_coordinated_op --op <read|write> (--path <abs> | --path-class <...>) [--target <...>] [--allow-unsafe-path]\\\"}],\\\"schema_version\\\":1,\\\"trace_symbols\\\":[{\\\"probe_id\\\":\\\"fs_op\\\",\\\"symbols\\\":[\\\"pw_probe_fs_op\\\"]},{\\\"probe_id\\\":\\\"fs_op_wait\\\",\\\"symbols\\\":[\\\"pw_probe_fs_op_wait\\\"]},{\\\"probe_id\\\":\\\"net_op\\\",\\\"symbols\\\":[\\\"pw_probe_net_op\\\"]},{\\\"probe_id\\\":\\\"dlopen_external\\\",\\\"symbols\\\":[\\\"pw_probe_dlopen_external\\\"]},{\\\"probe_id\\\":\\\"jit_map_jit\\\",\\\"symbols\\\":[\\\"pw_probe_jit_map_jit\\\"]},{\\\"probe_id\\\":\\\"jit_rwx_legacy\\\",\\\"symbols\\\":[\\\"pw_probe_jit_rwx_legacy\\\"]},{\\\"probe_id\\\":\\\"sandbox_check\\\",\\\"symbols\\\":[\\\"pw_probe_sandbox_check\\\"]},{\\\"probe_id\\\":\\\"sandbox_extension\\\",\\\"symbols\\\":[\\\"pw_probe_sandbox_extension\\\"]},{\\\"probe_id\\\":\\\"inherit_child\\\",\\\"symbols\\\":[\\\"pw_probe_inherit_child\\\"]}]}\",\"thread_id\":\"5635\"},\"generated_at_unix_ms\":1767213318283,\"kind\":\"probe_response\",\"result\":{\"exit_code\":0,\"normalized_outcome\":\"ok\",\"ok\":true,\"rc\":0,\"stdout\":\"{\\\"generated_at_iso8601\\\":\\\"2025-12-31T20:35:18Z\\\",\\\"probes\\\":[{\\\"entitlement_hints\\\":[\\\"none (observer)\\\"],\\\"examples\\\":[\\\"probe_catalog\\\"],\\\"notes\\\":[\\\"Outputs JSON in RunProbeResponse.stdout.\\\",\\\"Use <probe-id> --help for per-probe usage.\\\"],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"probe_catalog\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"emit a JSON catalog of available probes\\\",\\\"usage\\\":\\\"probe_catalog\\\"},{\\\"entitlement_hints\\\":[\\\"none (observer)\\\"],\\\"examples\\\":[\\\"world_shape\\\"],\\\"notes\\\":[\\\"Reports HOME\\\\\\/TMP\\\\\\/CWD and containerization signals.\\\"],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"world_shape\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"report containerization and world shape metadata\\\",\\\"usage\\\":\\\"world_shape\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.network.client\\\"],\\\"examples\\\":[\\\"network_tcp_connect --host 1.1.1.1 --port 443\\\"],\\\"notes\\\":[],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"network_tcp_connect\\\",\\\"required_args\\\":[\\\"--host <ipv4>\\\",\\\"--port <1..65535>\\\"],\\\"summary\\\":\\\"attempt a TCP connect to an IPv4 host:port\\\",\\\"usage\\\":\\\"network_tcp_connect --host <ipv4> --port <1..65535>\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.files.downloads.read-write\\\"],\\\"examples\\\":[\\\"downloads_rw\\\",\\\"downloads_rw --name demo.txt\\\"],\\\"notes\\\":[\\\"Writes under Downloads\\\\\\/policy-witness-harness.\\\"],\\\"optional_args\\\":[\\\"--name <file-name>\\\"],\\\"probe_id\\\":\\\"downloads_rw\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"read\\\\\\/write\\\\\\/remove a file under Downloads\\\\\\/policy-witness-harness\\\",\\\"usage\\\":\\\"downloads_rw [--name <file-name>]\\\"},{\\\"entitlement_hints\\\":[\\\"path-dependent (file access entitlements)\\\"],\\\"examples\\\":[\\\"fs_op --op stat --path-class downloads\\\",\\\"fs_op --op create --path-class tmp --target run_dir\\\"],\\\"notes\\\":[\\\"Destructive direct-path ops are refused unless you use --path-class\\\\\\/--target (or a path under *\\\\\\/policy-witness-harness\\\\\\/*) or set --allow-unsafe-path.\\\",\\\"Use --no-cleanup to keep harness artifacts after rename\\\\\\/truncate for update_file_by_fileid experiments.\\\"],\\\"optional_args\\\":[\\\"--target <base|harness_dir|run_dir|specimen_file>\\\",\\\"--name <file-name>\\\",\\\"--to <path> | --to-path <path> | --to-name <file-name>\\\",\\\"--max-entries <n>\\\",\\\"--allow-unsafe-path\\\",\\\"--no-cleanup\\\"],\\\"probe_id\\\":\\\"fs_op\\\",\\\"required_args\\\":[\\\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\\",\\\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\\\"],\\\"summary\\\":\\\"parameterized filesystem operations\\\",\\\"usage\\\":\\\"fs_op --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\\\n      (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n      [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\\\n      [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path] [--no-cleanup]\\\"},{\\\"entitlement_hints\\\":[\\\"path-dependent (file access entitlements)\\\"],\\\"examples\\\":[\\\"fs_op_wait --op open_read --path-class tmp --wait-fifo \\\\\\/tmp\\\\\\/pw-wait.fifo\\\",\\\"fs_op_wait --op stat --path \\\\\\/tmp\\\\\\/target --wait-exists \\\\\\/tmp\\\\\\/trigger --wait-timeout-ms 60000\\\"],\\\"notes\\\":[\\\"Blocks until the wait trigger is satisfied, then runs fs_op.\\\",\\\"--wait-interval-ms is only used with --wait-exists.\\\"],\\\"optional_args\\\":[\\\"--target <base|harness_dir|run_dir|specimen_file>\\\",\\\"--name <file-name>\\\",\\\"--to <path> | --to-path <path> | --to-name <file-name>\\\",\\\"--max-entries <n>\\\",\\\"--allow-unsafe-path\\\",\\\"--no-cleanup\\\",\\\"--wait-timeout-ms <n>\\\",\\\"--wait-interval-ms <n>\\\"],\\\"probe_id\\\":\\\"fs_op_wait\\\",\\\"required_args\\\":[\\\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\\",\\\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\\\",\\\"--wait-fifo <path> | --wait-exists <path>\\\"],\\\"summary\\\":\\\"wait for a trigger, then run fs_op\\\",\\\"usage\\\":\\\"fs_op_wait --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\\\n          (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n          [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\\\n          [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path] [--no-cleanup]\\\\n          (--wait-fifo <path> | --wait-exists <path>) [--wait-timeout-ms <n>] [--wait-interval-ms <n>]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.network.client\\\"],\\\"examples\\\":[\\\"net_op --op getaddrinfo --host example.com\\\",\\\"net_op --op tcp_connect --host 127.0.0.1 --port 80\\\"],\\\"notes\\\":[\\\"--port is required for tcp_connect and udp_send.\\\"],\\\"optional_args\\\":[\\\"--port <1..65535>\\\",\\\"--numeric\\\"],\\\"probe_id\\\":\\\"net_op\\\",\\\"required_args\\\":[\\\"--op <getaddrinfo|tcp_connect|udp_send>\\\",\\\"--host <host>\\\"],\\\"summary\\\":\\\"parameterized network operations\\\",\\\"usage\\\":\\\"net_op --op <getaddrinfo|tcp_connect|udp_send> --host <host> [--port <1..65535>] [--numeric]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.cs.disable-library-validation\\\",\\\"com.apple.security.cs.allow-dyld-environment-variables (if you rely on DYLD_*)\\\"],\\\"examples\\\":[\\\"dlopen_external --path \\\\\\/path\\\\\\/to\\\\\\/testdylib.dylib\\\"],\\\"notes\\\":[\\\"Executes dylib initializers; this is not a passive probe.\\\",\\\"Use a signed dylib (see tests\\\\\\/fixtures\\\\\\/TestDylib).\\\"],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"dlopen_external\\\",\\\"required_args\\\":[\\\"--path <abs> (or PW_DLOPEN_PATH)\\\"],\\\"summary\\\":\\\"dlopen a signed dylib by absolute path\\\",\\\"usage\\\":\\\"dlopen_external --path <abs> (or set PW_DLOPEN_PATH)\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.cs.allow-jit\\\"],\\\"examples\\\":[\\\"jit_map_jit\\\",\\\"jit_map_jit --size 65536\\\"],\\\"notes\\\":[\\\"Reports errno on MAP_JIT failure.\\\"],\\\"optional_args\\\":[\\\"--size <bytes> (default: 16384)\\\"],\\\"probe_id\\\":\\\"jit_map_jit\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"attempt mmap with MAP_JIT\\\",\\\"usage\\\":\\\"jit_map_jit [--size <bytes>]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.cs.allow-unsigned-executable-memory\\\"],\\\"examples\\\":[\\\"jit_rwx_legacy\\\",\\\"jit_rwx_legacy --size 65536\\\"],\\\"notes\\\":[\\\"Reports errno on RWX mmap failure.\\\"],\\\"optional_args\\\":[\\\"--size <bytes> (default: 16384)\\\"],\\\"probe_id\\\":\\\"jit_rwx_legacy\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"attempt mmap with RWX permissions (legacy)\\\",\\\"usage\\\":\\\"jit_rwx_legacy [--size <bytes>]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.files.bookmarks.app-scope\\\",\\\"com.apple.security.files.user-selected.read-only\\\",\\\"com.apple.security.files.user-selected.read-write\\\"],\\\"examples\\\":[\\\"bookmark_op --bookmark-b64 <b64> --op stat\\\",\\\"bookmark_op --bookmark-path \\\\\\/tmp\\\\\\/token.txt --op open_read --relative file.txt\\\"],\\\"notes\\\":[\\\"Uses ScopedBookmarksAgent IPC for security-scoped bookmarks.\\\",\\\"Treat bookmark tokens as scoped to the creating code identity (bundle id\\\\\\/team id); resolving under a different profile\\\\\\/service may fail even if entitlements are present.\\\"],\\\"optional_args\\\":[\\\"--relative <rel>\\\",\\\"--op <fs_op-op> (default: stat)\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"bookmark_op\\\",\\\"required_args\\\":[\\\"--bookmark-b64 <base64> | --bookmark-path <path>\\\"],\\\"summary\\\":\\\"resolve a bookmark token and run a filesystem op against it\\\",\\\"usage\\\":\\\"bookmark_op --bookmark-b64 <base64> | --bookmark-path <path>\\\\n            [--relative <rel>] [--op <fs_op-op>] [--allow-unsafe-path]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.files.bookmarks.app-scope\\\",\\\"com.apple.security.files.user-selected.read-only\\\",\\\"com.apple.security.files.user-selected.read-write\\\"],\\\"examples\\\":[\\\"bookmark_make --path \\\\\\/Users\\\\\\/me\\\\\\/Downloads\\\",\\\"bookmark_make --path \\\\\\/Users\\\\\\/me\\\\\\/Downloads --read-only\\\"],\\\"notes\\\":[\\\"Security-scoped bookmarks use ScopedBookmarksAgent IPC.\\\",\\\"Bookmark tokens are not expected to be portable across service identities; prefer make+resolve within the same profile\\\\\\/service.\\\"],\\\"optional_args\\\":[\\\"--no-security-scope\\\",\\\"--read-only\\\",\\\"--allow-missing\\\"],\\\"probe_id\\\":\\\"bookmark_make\\\",\\\"required_args\\\":[\\\"--path <abs>\\\"],\\\"summary\\\":\\\"create a security-scoped bookmark token for a path\\\",\\\"usage\\\":\\\"bookmark_make --path <abs> [--no-security-scope] [--read-only] [--allow-missing]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.files.bookmarks.app-scope\\\",\\\"com.apple.security.files.user-selected.read-only\\\",\\\"com.apple.security.files.user-selected.read-write\\\"],\\\"examples\\\":[\\\"bookmark_roundtrip --path \\\\\\/Users\\\\\\/me\\\\\\/Downloads --op stat\\\",\\\"bookmark_roundtrip --path \\\\\\/Users\\\\\\/me\\\\\\/Downloads --op open_read --relative file.txt\\\"],\\\"notes\\\":[\\\"Returns the bookmark token in stdout and the fs_op result in details.\\\",\\\"This is the most deterministic bookmark workflow because create+resolve happen under the same service identity.\\\"],\\\"optional_args\\\":[\\\"--op <fs_op-op> (default: stat)\\\",\\\"--relative <rel>\\\",\\\"--no-security-scope\\\",\\\"--read-only\\\",\\\"--allow-missing\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"bookmark_roundtrip\\\",\\\"required_args\\\":[\\\"--path <abs>\\\"],\\\"summary\\\":\\\"create a bookmark token and immediately resolve + run a filesystem op\\\",\\\"usage\\\":\\\"bookmark_roundtrip --path <abs> [--op <fs_op-op>] [--relative <rel>] [--no-security-scope] [--read-only] [--allow-missing] [--allow-unsafe-path]\\\"},{\\\"entitlement_hints\\\":[\\\"none (observer)\\\"],\\\"examples\\\":[\\\"capabilities_snapshot\\\"],\\\"notes\\\":[\\\"Includes entitlement presence booleans and standard directory paths.\\\"],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"capabilities_snapshot\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"report entitlements and resolved standard directories\\\",\\\"usage\\\":\\\"capabilities_snapshot\\\"},{\\\"entitlement_hints\\\":[\\\"none (observer \\\\\\/ instrumentation target)\\\"],\\\"examples\\\":[\\\"sandbox_check --operation file-read-data\\\",\\\"sandbox_check --operation file-read-data --path \\\\\\/etc\\\\\\/hosts\\\",\\\"sandbox_check --operation mach-lookup --repeat 10\\\"],\\\"notes\\\":[\\\"This does not perform the operation; it only calls sandbox_check() so attach\\\\\\/hook tooling can observe libsystem_sandbox activity.\\\",\\\"If --path is provided, the probe passes a guessed filter type for a path argument; treat the return code as informational, not authoritative.\\\"],\\\"optional_args\\\":[\\\"--path <abs>\\\",\\\"--repeat <n> (default: 1)\\\"],\\\"probe_id\\\":\\\"sandbox_check\\\",\\\"required_args\\\":[\\\"--operation <sandbox-op>\\\"],\\\"summary\\\":\\\"call sandbox_check() in libsystem_sandbox (hook calibration)\\\",\\\"usage\\\":\\\"sandbox_check --operation <sandbox-op> [--path <abs>] [--repeat <n>]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.temporary-exception.sbpl (allow file-issue-extension for extension class)\\\"],\\\"examples\\\":[\\\"sandbox_extension --op issue_file --class com.apple.app-sandbox.read --path \\\\\\/etc\\\\\\/hosts --allow-unsafe-path\\\",\\\"sandbox_extension --op issue_file --class com.apple.app-sandbox.read --path-class tmp --target specimen_file --name pw_extension.txt --create\\\",\\\"sandbox_extension --op issue_file_to_pid --pid self --class com.apple.app-sandbox.read --path \\\\\\/etc\\\\\\/hosts --allow-unsafe-path\\\",\\\"sandbox_extension --op issue_extension --path-class tmp --target specimen_file --name pw_extension.txt --create\\\",\\\"sandbox_extension --op issue_fs_extension --flags 8 --path \\\\\\/etc\\\\\\/hosts --allow-unsafe-path\\\",\\\"sandbox_extension --op consume --token <token> --token-format full\\\",\\\"sandbox_extension --op consume --token <token> --call-variant token_second --call-symbol sandbox_consume_extension\\\",\\\"sandbox_extension --op consume --token <token> --call-variant token_and_ptr --call-symbol sandbox_consume_fs_extension\\\",\\\"sandbox_extension --op release --handle <i64>\\\",\\\"sandbox_extension --op release_file --token <token>\\\",\\\"sandbox_extension --op update_file --path \\\\\\/etc\\\\\\/hosts --flags 0 --allow-unsafe-path\\\",\\\"sandbox_extension --op update_file_rename_delta --class com.apple.app-sandbox.read --path \\\\\\/Users\\\\\\/me\\\\\\/Desktop\\\\\\/pw_old.txt --new-path \\\\\\/Users\\\\\\/me\\\\\\/Desktop\\\\\\/pw_new.txt --wait-for-external-rename --allow-unsafe-path\\\",\\\"sandbox_extension --op update_file_by_fileid --token <token> --path \\\\\\/etc\\\\\\/hosts --flags 0\\\",\\\"sandbox_extension --op update_file_by_fileid --token <token> --file-id <u64> --selector 2 --call-variant payload_ptr_selector\\\",\\\"sandbox_extension --op update_file_by_fileid_sweep --class com.apple.app-sandbox.read --path-class tmp --target specimen_file --name pw_sweep.txt --create --selectors 0,1,2\\\",\\\"sandbox_extension --op update_file_by_fileid_delta --class com.apple.app-sandbox.read --path-class tmp --target specimen_file --name pw_delta.txt --create --selector 2 --payload-source st_dev\\\",\\\"sandbox_extension --op issue_file --class com.apple.app-sandbox.read --path \\\\\\/etc\\\\\\/hosts --allow-unsafe-path --introspect\\\"],\\\"notes\\\":[\\\"issue_file returns the token in stdout and in details.token.\\\",\\\"issue_file_to_pid issues a token scoped to another process via sandbox_extension_issue_file_to_process_by_pid.\\\",\\\"issue_extension\\\\\\/issue_fs_extension\\\\\\/issue_fs_rw_extension are thin wrappers around sandbox_extension_issue_file.\\\",\\\"Direct-path issuance outside *\\\\\\/policy-witness-harness\\\\\\/* is refused unless you pass --allow-unsafe-path.\\\",\\\"If consume\\\\\\/release fails with invalid-token style errors, try --token-format prefix (uses the substring before the first ';').\\\",\\\"consume returns a (typically positive) i64 handle in stdout + details.consume_handle when sandbox_extension_consume(handle) is usable.\\\",\\\"release prefers --handle from a prior consume; token-based release variants are supported for experimentation only.\\\",\\\"Consume\\\\\\/release auto-tries common symbols\\\\\\/variants when --call-symbol is not set; use --call-symbol\\\\\\/--call-variant to pin behavior.\\\",\\\"release_file calls sandbox_extension_release_file with the provided token only.\\\",\\\"update_file passes path + flags into sandbox_extension_update_file; update_file_by_fileid is experimental and supports multiple ABI variants, including pointer-based forms.\\\",\\\"update_file_rename_delta runs issue+consume on --path, waits for a host-side rename to --new-path, then compares update_file_by_fileid candidates vs update_file() for restoring access to --new-path.\\\",\\\"update_file_rename_delta stops early with normalized_outcome=dest_preexisted if --new-path already exists at probe start.\\\",\\\"payload_ptr_selector uses an 8-byte payload buffer + selector and forces field2 to 0 (Sonoma 14.4.1 ABI).\\\",\\\"If update_file_by_fileid returns invalid-arg\\\\\\/Bad address, try --call-variant payload_ptr_selector and a selector of 0\\\\\\/1\\\\\\/2.\\\",\\\"update_file_by_fileid_sweep issues+consumes a token and runs payload_ptr_selector across candidate payloads (stat + handle-derived; optionally token fields) and selectors.\\\",\\\"update_file_by_fileid_delta runs an atomic replace and records open + sandbox_check transitions before\\\\\\/after the update call (use this to define a measurable access delta).\\\",\\\"Wrapper symbols use specific variants: sandbox_consume_extension=token_second, sandbox_consume_fs_extension=token_and_ptr, sandbox_release_fs_extension=one_arg.\\\"],\\\"optional_args\\\":[\\\"--class <extension-class> (required for issue_file\\\\\\/issue_file_to_pid\\\\\\/update_file_rename_delta\\\\\\/update_file_by_fileid_delta)\\\",\\\"--pid <int|self> (required for issue_file_to_pid)\\\",\\\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches> (required for issue_file\\\\\\/issue_file_to_pid\\\\\\/issue_*\\\\\\/update_file\\\\\\/update_file_by_fileid_delta)\\\",\\\"--new-path <abs> (required for update_file_rename_delta)\\\",\\\"--file-id <u64> (required for update_file_by_fileid unless --path is provided)\\\",\\\"--selector <u64> (update_file_by_fileid selectors; default: 2 for update_file_by_fileid_delta\\\\\\/update_file_rename_delta)\\\",\\\"--selectors <u64,u64,...> (default: 0,1,2; update_file_by_fileid_sweep)\\\",\\\"--payload <u64> (update_file_by_fileid_delta; overrides --payload-source)\\\",\\\"--payload-source <st_dev|st_ino|handle_low32|handle_high32|handle_xor32> (default: st_dev; update_file_by_fileid_delta)\\\",\\\"--sandbox-op <sandbox-op> (default: file-read-data; update_file_by_fileid_delta sandbox_check oracle)\\\",\\\"--skip-update (update_file_by_fileid_delta control arm: measure without calling update)\\\",\\\"--no-cleanup (update_file_by_fileid_delta\\\\\\/update_file_rename_delta: do not call sandbox_extension_release(handle))\\\",\\\"--wait-for-external-replace (update_file_by_fileid_delta: wait for inode change instead of doing an in-sandbox replace)\\\",\\\"--wait-for-external-rename (update_file_rename_delta: wait for a host-side rename from --path to --new-path)\\\",\\\"--wait-timeout-ms <n> (default: 30000; update_file_by_fileid_delta\\\\\\/update_file_rename_delta)\\\",\\\"--wait-interval-ms <n> (default: 50; update_file_by_fileid_delta\\\\\\/update_file_rename_delta)\\\",\\\"--include-token-fields (update_file_by_fileid_sweep: parse numeric token segments as candidate payloads)\\\",\\\"--target <base|harness_dir|run_dir|specimen_file> (default: specimen_file)\\\",\\\"--name <filename>\\\",\\\"--flags <int> (default: 0; issue_file\\\\\\/issue_fs_extension\\\\\\/update_file\\\\\\/update_file_by_fileid\\\\\\/update_file_by_fileid_delta or consume\\\\\\/release with two_arg)\\\",\\\"--create (create a harness file\\\\\\/dir for issue_file\\\\\\/update_file_by_fileid_delta if missing)\\\",\\\"--allow-unsafe-path\\\",\\\"--introspect (emit symbol presence + image path in details)\\\",\\\"--token <token> (required for consume\\\\\\/release_file\\\\\\/update_file_by_fileid; optional for release)\\\",\\\"--handle <i64> (preferred for release; from a prior consume)\\\",\\\"--token-format <full|prefix> (default: full; consume\\\\\\/release\\\\\\/update_file_by_fileid)\\\",\\\"--call-symbol <symbol> (override consume\\\\\\/release symbol; advanced)\\\",\\\"--call-variant <handle_one_arg|one_arg|two_arg|token_second|token_and_ptr|token_fileid|fileid_token|fileid_ptr_token|token_ptr_fileid|fileid_ptr_selector|payload_ptr_selector|auto> (default: auto; consume\\\\\\/release\\\\\\/update_file_by_fileid)\\\"],\\\"probe_id\\\":\\\"sandbox_extension\\\",\\\"required_args\\\":[\\\"--op <issue_file|issue_file_to_pid|issue_extension|issue_fs_extension|issue_fs_rw_extension|consume|release|release_file|update_file|update_file_rename_delta|update_file_by_fileid|update_file_by_fileid_sweep|update_file_by_fileid_delta>\\\"],\\\"summary\\\":\\\"issue\\\\\\/consume\\\\\\/release sandbox file extensions\\\",\\\"usage\\\":\\\"\\\\tsandbox_extension --op issue_file --class <extension-class>\\\\n\\\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n\\\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n\\\\t                 [--flags <int>] [--create] [--allow-unsafe-path] [--introspect]\\\\n\\\\tsandbox_extension --op issue_file_to_pid --pid <int|self> --class <extension-class>\\\\n\\\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n\\\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n\\\\t                 [--flags <int>] [--create] [--allow-unsafe-path] [--introspect]\\\\n\\\\tsandbox_extension --op issue_extension\\\\n\\\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n\\\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n\\\\t                 [--create] [--allow-unsafe-path] [--introspect]\\\\n\\\\tsandbox_extension --op issue_fs_extension [--flags <int>]\\\\n\\\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n\\\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n\\\\t                 [--create] [--allow-unsafe-path] [--introspect]\\\\n\\\\t\\\\tsandbox_extension --op issue_fs_rw_extension\\\\n\\\\t\\\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n\\\\t\\\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n\\\\t\\\\t                 [--create] [--allow-unsafe-path] [--introspect]\\\\n\\\\t\\\\tsandbox_extension --op consume --token <token> [--token-format <full|prefix>]\\\\n\\\\t\\\\t                 [--call-symbol <symbol>] [--call-variant <handle_one_arg|one_arg|two_arg|token_second|token_and_ptr|auto>] [--flags <int>] [--introspect]\\\\n\\\\t\\\\tsandbox_extension --op release [--handle <i64>] [--token <token> --token-format <full|prefix>]\\\\n\\\\t\\\\t                 [--call-symbol <symbol>] [--call-variant <handle_one_arg|one_arg|two_arg|token_and_ptr|auto>] [--flags <int>] [--introspect]\\\\n\\\\t\\\\tsandbox_extension --op release_file --token <token> [--token-format <full|prefix>]\\\\n\\\\t\\\\t                 [--introspect]\\\\n\\\\tsandbox_extension --op update_file (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n\\\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n\\\\t                 [--flags <int>] [--allow-unsafe-path] [--introspect]\\\\n\\\\t\\\\tsandbox_extension --op update_file_rename_delta --class <extension-class>\\\\n\\\\t\\\\t                 --path <abs> --new-path <abs>\\\\n\\\\t\\\\t                 [--flags <int>] [--selector <u64>] [--allow-unsafe-path]\\\\n\\\\t\\\\t                 [--wait-for-external-rename] [--wait-timeout-ms <n>] [--wait-interval-ms <n>]\\\\n\\\\t\\\\t                 [--no-cleanup] [--introspect]\\\\n\\\\t\\\\tsandbox_extension --op update_file_by_fileid --token <token> (--file-id <u64> | --path <abs>)\\\\n\\\\t\\\\t                 [--flags <int>] [--selector <u64>] [--call-variant <token_fileid|fileid_token|fileid_ptr_token|token_ptr_fileid|fileid_ptr_selector|payload_ptr_selector|auto>] [--introspect]\\\\n\\\\t\\\\tsandbox_extension --op update_file_by_fileid_sweep --class <extension-class>\\\\n\\\\t\\\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n\\\\t\\\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n\\\\t                 [--flags <int>] [--create] [--allow-unsafe-path]\\\\n\\\\t                 [--selectors <u64,u64,...>] [--include-token-fields] [--no-cleanup] [--introspect]\\\\n\\\\tsandbox_extension --op update_file_by_fileid_delta --class <extension-class>\\\\n\\\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n\\\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n\\\\t                 [--flags <int>] [--selector <u64>] [--create] [--allow-unsafe-path]\\\\n\\\\t                 [--payload <u64> | --payload-source <st_dev|st_ino|handle_low32|handle_high32|handle_xor32>]\\\\n\\\\t                 [--sandbox-op <sandbox-op>] [--skip-update] [--no-cleanup]\\\\n\\\\t                 [--wait-for-external-replace] [--wait-timeout-ms <n>] [--wait-interval-ms <n>] [--introspect]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.temporary-exception.sbpl (needed for sandbox_extension issue_file in dynamic_extension)\\\"],\\\"examples\\\":[\\\"inherit_child --scenario dynamic_extension --path \\\\\\/private\\\\\\/var\\\\\\/db\\\\\\/launchd.db\\\\\\/com.apple.launchd\\\\\\/overrides.plist --allow-unsafe-path\\\",\\\"inherit_child --scenario matrix_basic --path-class tmp --target specimen_file --name pw_child.txt --create\\\",\\\"inherit_child --scenario bookmark_ferry --path-class documents --target specimen_file --name pw_child.txt --create\\\",\\\"inherit_child --scenario inherit_bad_entitlements\\\"],\\\"notes\\\":[\\\"Spawns the bundled pw-inherit-child helper using posix_spawn and an event bus + rights bus (SCM_RIGHTS).\\\",\\\"Emits a structured witness payload under RunProbeResponse.witness.\\\",\\\"dynamic_extension uses sandbox extension issuance for parent-only acquisition; matrix_basic skips tokens.\\\",\\\"bookmark_ferry passes security-scoped bookmark bytes over the event bus; bookmark resolution is identity-sensitive, so the spawned helper must share the service bundle id.\\\",\\\"lineage_basic spawns a grandchild.\\\"],\\\"optional_args\\\":[\\\"--scenario <bookmark_ferry|dynamic_extension|inherit_bad_entitlements|lineage_basic|matrix_basic> (default: dynamic_extension)\\\",\\\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\\\",\\\"--target <base|harness_dir|run_dir|specimen_file> (default: specimen_file)\\\",\\\"--name <filename>\\\",\\\"--create (create a harness file\\\\\\/dir for the target if missing)\\\",\\\"--allow-unsafe-path\\\",\\\"--bookmark-move (bookmark_ferry only; move target after bookmark creation)\\\",\\\"--bookmark-invalid (bookmark_ferry only; send invalid bookmark payload bytes)\\\",\\\"--stop-on-entry (child raises SIGSTOP early for debugger attach)\\\",\\\"--stop-on-deny (child raises SIGSTOP on EPERM\\\\\\/EACCES)\\\",\\\"--stop-auto-resume (parent sends SIGCONT after child stop)\\\",\\\"--protocol-bad-cap-id (inject a bad cap_id for protocol tests)\\\"],\\\"probe_id\\\":\\\"inherit_child\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"capability ferry matrix: parent acquires, child attempts acquire vs use\\\",\\\"usage\\\":\\\"inherit_child [--scenario <bookmark_ferry|dynamic_extension|inherit_bad_entitlements|lineage_basic|matrix_basic>]\\\\n              [--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>]\\\\n              [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\\\n              [--create] [--allow-unsafe-path]\\\\n              [--stop-on-entry] [--stop-on-deny] [--stop-auto-resume]\\\\n              [--bookmark-move] [--bookmark-invalid] [--protocol-bad-cap-id]\\\"},{\\\"entitlement_hints\\\":[\\\"none (containerization evidence)\\\"],\\\"examples\\\":[\\\"userdefaults_op --op read --key example\\\",\\\"userdefaults_op --op write --key example --value 1\\\"],\\\"notes\\\":[\\\"Useful for observing containerized preferences paths.\\\"],\\\"optional_args\\\":[\\\"--op <read|write|remove|sync> (default: read)\\\",\\\"--key <k>\\\",\\\"--value <v>\\\",\\\"--suite <suite>\\\"],\\\"probe_id\\\":\\\"userdefaults_op\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"read\\\\\\/write\\\\\\/remove\\\\\\/sync a UserDefaults key\\\",\\\"usage\\\":\\\"userdefaults_op --op <read|write|remove|sync> [--key <k>] [--value <v>] [--suite <suite>]\\\"},{\\\"entitlement_hints\\\":[\\\"path-dependent (file access entitlements)\\\"],\\\"examples\\\":[\\\"fs_xattr --op get --path \\\\\\/tmp\\\\\\/file --name com.apple.quarantine\\\",\\\"fs_xattr --op list --path \\\\\\/tmp\\\\\\/file\\\"],\\\"notes\\\":[\\\"xattr writes are refused outside harness paths unless --allow-write or --allow-unsafe-path is set.\\\"],\\\"optional_args\\\":[\\\"--name <xattr>\\\",\\\"--value <v>\\\",\\\"--allow-write\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"fs_xattr\\\",\\\"required_args\\\":[\\\"--op <get|list|set|remove>\\\",\\\"--path <abs>\\\"],\\\"summary\\\":\\\"get\\\\\\/list\\\\\\/set\\\\\\/remove extended attributes\\\",\\\"usage\\\":\\\"fs_xattr --op <get|list|set|remove> --path <abs> [--name <xattr>] [--value <v>] [--allow-write] [--allow-unsafe-path]\\\"},{\\\"entitlement_hints\\\":[\\\"path-dependent (file access entitlements)\\\"],\\\"examples\\\":[\\\"fs_coordinated_op --op read --path-class documents\\\",\\\"fs_coordinated_op --op write --path-class tmp --target run_dir\\\"],\\\"notes\\\":[\\\"Coordinated writes to direct paths are refused unless you use --path-class\\\\\\/--target (or a path under *\\\\\\/policy-witness-harness\\\\\\/*) or set --allow-unsafe-path.\\\"],\\\"optional_args\\\":[\\\"--target <base|harness_dir|run_dir|specimen_file>\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"fs_coordinated_op\\\",\\\"required_args\\\":[\\\"--op <read|write>\\\",\\\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\\\"],\\\"summary\\\":\\\"NSFileCoordinator mediated read\\\\\\/write\\\",\\\"usage\\\":\\\"fs_coordinated_op --op <read|write> (--path <abs> | --path-class <...>) [--target <...>] [--allow-unsafe-path]\\\"}],\\\"schema_version\\\":1,\\\"trace_symbols\\\":[{\\\"probe_id\\\":\\\"fs_op\\\",\\\"symbols\\\":[\\\"pw_probe_fs_op\\\"]},{\\\"probe_id\\\":\\\"fs_op_wait\\\",\\\"symbols\\\":[\\\"pw_probe_fs_op_wait\\\"]},{\\\"probe_id\\\":\\\"net_op\\\",\\\"symbols\\\":[\\\"pw_probe_net_op\\\"]},{\\\"probe_id\\\":\\\"dlopen_external\\\",\\\"symbols\\\":[\\\"pw_probe_dlopen_external\\\"]},{\\\"probe_id\\\":\\\"jit_map_jit\\\",\\\"symbols\\\":[\\\"pw_probe_jit_map_jit\\\"]},{\\\"probe_id\\\":\\\"jit_rwx_legacy\\\",\\\"symbols\\\":[\\\"pw_probe_jit_rwx_legacy\\\"]},{\\\"probe_id\\\":\\\"sandbox_check\\\",\\\"symbols\\\":[\\\"pw_probe_sandbox_check\\\"]},{\\\"probe_id\\\":\\\"sandbox_extension\\\",\\\"symbols\\\":[\\\"pw_probe_sandbox_extension\\\"]},{\\\"probe_id\\\":\\\"inherit_child\\\",\\\"symbols\\\":[\\\"pw_probe_inherit_child\\\"]}]}\"},\"schema_version\":1}\n",
  "stdout_json": {
    "data": {
      "argv": [],
      "correlation_id": "52178E74-2020-4456-8B22-56C382581147",
      "details": {
        "bundle_id": "com.yourteam.policy-witness.ProbeService_minimal",
        "correlation_id": "52178E74-2020-4456-8B22-56C382581147",
        "cwd": "/Users/achyland/Library/Containers/com.yourteam.policy-witness.ProbeService_minimal/Data",
        "home_dir": "/Users/achyland/Library/Containers/com.yourteam.policy-witness.ProbeService_minimal/Data",
        "pid": "95218",
        "probe_count": "20",
        "probe_family": "probe_catalog",
        "probe_pid": "95218",
        "process_name": "ProbeService_minimal",
        "service_pid": "95218",
        "session_token": "F80DF2F4-D4A9-4592-9E41-512A41115915",
        "tmp_dir": "/Users/achyland/Library/Containers/com.yourteam.policy-witness.ProbeService_minimal/Data/tmp/"
      },
      "ended_at_iso8601": "2025-12-31T20:35:18.282Z",
      "normalized_outcome": "ok",
      "plan_id": "witness:guide",
      "probe_id": "probe_catalog",
      "rc": 0,
      "row_id": "probe_catalog",
      "schema_version": 1,
      "service_build": "2",
      "service_bundle_id": "com.yourteam.policy-witness.ProbeService_minimal",
      "service_name": "ProbeService_minimal",
      "service_version": "2.0.0",
      "started_at_iso8601": "2025-12-31T20:35:18.281Z",
      "stderr": "",
      "stdout": "{\"generated_at_iso8601\":\"2025-12-31T20:35:18Z\",\"probes\":[{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"probe_catalog\"],\"notes\":[\"Outputs JSON in RunProbeResponse.stdout.\",\"Use <probe-id> --help for per-probe usage.\"],\"optional_args\":[],\"probe_id\":\"probe_catalog\",\"required_args\":[],\"summary\":\"emit a JSON catalog of available probes\",\"usage\":\"probe_catalog\"},{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"world_shape\"],\"notes\":[\"Reports HOME\\/TMP\\/CWD and containerization signals.\"],\"optional_args\":[],\"probe_id\":\"world_shape\",\"required_args\":[],\"summary\":\"report containerization and world shape metadata\",\"usage\":\"world_shape\"},{\"entitlement_hints\":[\"com.apple.security.network.client\"],\"examples\":[\"network_tcp_connect --host 1.1.1.1 --port 443\"],\"notes\":[],\"optional_args\":[],\"probe_id\":\"network_tcp_connect\",\"required_args\":[\"--host <ipv4>\",\"--port <1..65535>\"],\"summary\":\"attempt a TCP connect to an IPv4 host:port\",\"usage\":\"network_tcp_connect --host <ipv4> --port <1..65535>\"},{\"entitlement_hints\":[\"com.apple.security.files.downloads.read-write\"],\"examples\":[\"downloads_rw\",\"downloads_rw --name demo.txt\"],\"notes\":[\"Writes under Downloads\\/policy-witness-harness.\"],\"optional_args\":[\"--name <file-name>\"],\"probe_id\":\"downloads_rw\",\"required_args\":[],\"summary\":\"read\\/write\\/remove a file under Downloads\\/policy-witness-harness\",\"usage\":\"downloads_rw [--name <file-name>]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_op --op stat --path-class downloads\",\"fs_op --op create --path-class tmp --target run_dir\"],\"notes\":[\"Destructive direct-path ops are refused unless you use --path-class\\/--target (or a path under *\\/policy-witness-harness\\/*) or set --allow-unsafe-path.\",\"Use --no-cleanup to keep harness artifacts after rename\\/truncate for update_file_by_fileid experiments.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--name <file-name>\",\"--to <path> | --to-path <path> | --to-name <file-name>\",\"--max-entries <n>\",\"--allow-unsafe-path\",\"--no-cleanup\"],\"probe_id\":\"fs_op\",\"required_args\":[\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\"],\"summary\":\"parameterized filesystem operations\",\"usage\":\"fs_op --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\n      (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n      [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\n      [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path] [--no-cleanup]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_op_wait --op open_read --path-class tmp --wait-fifo \\/tmp\\/pw-wait.fifo\",\"fs_op_wait --op stat --path \\/tmp\\/target --wait-exists \\/tmp\\/trigger --wait-timeout-ms 60000\"],\"notes\":[\"Blocks until the wait trigger is satisfied, then runs fs_op.\",\"--wait-interval-ms is only used with --wait-exists.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--name <file-name>\",\"--to <path> | --to-path <path> | --to-name <file-name>\",\"--max-entries <n>\",\"--allow-unsafe-path\",\"--no-cleanup\",\"--wait-timeout-ms <n>\",\"--wait-interval-ms <n>\"],\"probe_id\":\"fs_op_wait\",\"required_args\":[\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\",\"--wait-fifo <path> | --wait-exists <path>\"],\"summary\":\"wait for a trigger, then run fs_op\",\"usage\":\"fs_op_wait --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\n          (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n          [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\n          [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path] [--no-cleanup]\\n          (--wait-fifo <path> | --wait-exists <path>) [--wait-timeout-ms <n>] [--wait-interval-ms <n>]\"},{\"entitlement_hints\":[\"com.apple.security.network.client\"],\"examples\":[\"net_op --op getaddrinfo --host example.com\",\"net_op --op tcp_connect --host 127.0.0.1 --port 80\"],\"notes\":[\"--port is required for tcp_connect and udp_send.\"],\"optional_args\":[\"--port <1..65535>\",\"--numeric\"],\"probe_id\":\"net_op\",\"required_args\":[\"--op <getaddrinfo|tcp_connect|udp_send>\",\"--host <host>\"],\"summary\":\"parameterized network operations\",\"usage\":\"net_op --op <getaddrinfo|tcp_connect|udp_send> --host <host> [--port <1..65535>] [--numeric]\"},{\"entitlement_hints\":[\"com.apple.security.cs.disable-library-validation\",\"com.apple.security.cs.allow-dyld-environment-variables (if you rely on DYLD_*)\"],\"examples\":[\"dlopen_external --path \\/path\\/to\\/testdylib.dylib\"],\"notes\":[\"Executes dylib initializers; this is not a passive probe.\",\"Use a signed dylib (see tests\\/fixtures\\/TestDylib).\"],\"optional_args\":[],\"probe_id\":\"dlopen_external\",\"required_args\":[\"--path <abs> (or PW_DLOPEN_PATH)\"],\"summary\":\"dlopen a signed dylib by absolute path\",\"usage\":\"dlopen_external --path <abs> (or set PW_DLOPEN_PATH)\"},{\"entitlement_hints\":[\"com.apple.security.cs.allow-jit\"],\"examples\":[\"jit_map_jit\",\"jit_map_jit --size 65536\"],\"notes\":[\"Reports errno on MAP_JIT failure.\"],\"optional_args\":[\"--size <bytes> (default: 16384)\"],\"probe_id\":\"jit_map_jit\",\"required_args\":[],\"summary\":\"attempt mmap with MAP_JIT\",\"usage\":\"jit_map_jit [--size <bytes>]\"},{\"entitlement_hints\":[\"com.apple.security.cs.allow-unsigned-executable-memory\"],\"examples\":[\"jit_rwx_legacy\",\"jit_rwx_legacy --size 65536\"],\"notes\":[\"Reports errno on RWX mmap failure.\"],\"optional_args\":[\"--size <bytes> (default: 16384)\"],\"probe_id\":\"jit_rwx_legacy\",\"required_args\":[],\"summary\":\"attempt mmap with RWX permissions (legacy)\",\"usage\":\"jit_rwx_legacy [--size <bytes>]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_op --bookmark-b64 <b64> --op stat\",\"bookmark_op --bookmark-path \\/tmp\\/token.txt --op open_read --relative file.txt\"],\"notes\":[\"Uses ScopedBookmarksAgent IPC for security-scoped bookmarks.\",\"Treat bookmark tokens as scoped to the creating code identity (bundle id\\/team id); resolving under a different profile\\/service may fail even if entitlements are present.\"],\"optional_args\":[\"--relative <rel>\",\"--op <fs_op-op> (default: stat)\",\"--allow-unsafe-path\"],\"probe_id\":\"bookmark_op\",\"required_args\":[\"--bookmark-b64 <base64> | --bookmark-path <path>\"],\"summary\":\"resolve a bookmark token and run a filesystem op against it\",\"usage\":\"bookmark_op --bookmark-b64 <base64> | --bookmark-path <path>\\n            [--relative <rel>] [--op <fs_op-op>] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_make --path \\/Users\\/me\\/Downloads\",\"bookmark_make --path \\/Users\\/me\\/Downloads --read-only\"],\"notes\":[\"Security-scoped bookmarks use ScopedBookmarksAgent IPC.\",\"Bookmark tokens are not expected to be portable across service identities; prefer make+resolve within the same profile\\/service.\"],\"optional_args\":[\"--no-security-scope\",\"--read-only\",\"--allow-missing\"],\"probe_id\":\"bookmark_make\",\"required_args\":[\"--path <abs>\"],\"summary\":\"create a security-scoped bookmark token for a path\",\"usage\":\"bookmark_make --path <abs> [--no-security-scope] [--read-only] [--allow-missing]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_roundtrip --path \\/Users\\/me\\/Downloads --op stat\",\"bookmark_roundtrip --path \\/Users\\/me\\/Downloads --op open_read --relative file.txt\"],\"notes\":[\"Returns the bookmark token in stdout and the fs_op result in details.\",\"This is the most deterministic bookmark workflow because create+resolve happen under the same service identity.\"],\"optional_args\":[\"--op <fs_op-op> (default: stat)\",\"--relative <rel>\",\"--no-security-scope\",\"--read-only\",\"--allow-missing\",\"--allow-unsafe-path\"],\"probe_id\":\"bookmark_roundtrip\",\"required_args\":[\"--path <abs>\"],\"summary\":\"create a bookmark token and immediately resolve + run a filesystem op\",\"usage\":\"bookmark_roundtrip --path <abs> [--op <fs_op-op>] [--relative <rel>] [--no-security-scope] [--read-only] [--allow-missing] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"capabilities_snapshot\"],\"notes\":[\"Includes entitlement presence booleans and standard directory paths.\"],\"optional_args\":[],\"probe_id\":\"capabilities_snapshot\",\"required_args\":[],\"summary\":\"report entitlements and resolved standard directories\",\"usage\":\"capabilities_snapshot\"},{\"entitlement_hints\":[\"none (observer \\/ instrumentation target)\"],\"examples\":[\"sandbox_check --operation file-read-data\",\"sandbox_check --operation file-read-data --path \\/etc\\/hosts\",\"sandbox_check --operation mach-lookup --repeat 10\"],\"notes\":[\"This does not perform the operation; it only calls sandbox_check() so attach\\/hook tooling can observe libsystem_sandbox activity.\",\"If --path is provided, the probe passes a guessed filter type for a path argument; treat the return code as informational, not authoritative.\"],\"optional_args\":[\"--path <abs>\",\"--repeat <n> (default: 1)\"],\"probe_id\":\"sandbox_check\",\"required_args\":[\"--operation <sandbox-op>\"],\"summary\":\"call sandbox_check() in libsystem_sandbox (hook calibration)\",\"usage\":\"sandbox_check --operation <sandbox-op> [--path <abs>] [--repeat <n>]\"},{\"entitlement_hints\":[\"com.apple.security.temporary-exception.sbpl (allow file-issue-extension for extension class)\"],\"examples\":[\"sandbox_extension --op issue_file --class com.apple.app-sandbox.read --path \\/etc\\/hosts --allow-unsafe-path\",\"sandbox_extension --op issue_file --class com.apple.app-sandbox.read --path-class tmp --target specimen_file --name pw_extension.txt --create\",\"sandbox_extension --op issue_file_to_pid --pid self --class com.apple.app-sandbox.read --path \\/etc\\/hosts --allow-unsafe-path\",\"sandbox_extension --op issue_extension --path-class tmp --target specimen_file --name pw_extension.txt --create\",\"sandbox_extension --op issue_fs_extension --flags 8 --path \\/etc\\/hosts --allow-unsafe-path\",\"sandbox_extension --op consume --token <token> --token-format full\",\"sandbox_extension --op consume --token <token> --call-variant token_second --call-symbol sandbox_consume_extension\",\"sandbox_extension --op consume --token <token> --call-variant token_and_ptr --call-symbol sandbox_consume_fs_extension\",\"sandbox_extension --op release --handle <i64>\",\"sandbox_extension --op release_file --token <token>\",\"sandbox_extension --op update_file --path \\/etc\\/hosts --flags 0 --allow-unsafe-path\",\"sandbox_extension --op update_file_rename_delta --class com.apple.app-sandbox.read --path \\/Users\\/me\\/Desktop\\/pw_old.txt --new-path \\/Users\\/me\\/Desktop\\/pw_new.txt --wait-for-external-rename --allow-unsafe-path\",\"sandbox_extension --op update_file_by_fileid --token <token> --path \\/etc\\/hosts --flags 0\",\"sandbox_extension --op update_file_by_fileid --token <token> --file-id <u64> --selector 2 --call-variant payload_ptr_selector\",\"sandbox_extension --op update_file_by_fileid_sweep --class com.apple.app-sandbox.read --path-class tmp --target specimen_file --name pw_sweep.txt --create --selectors 0,1,2\",\"sandbox_extension --op update_file_by_fileid_delta --class com.apple.app-sandbox.read --path-class tmp --target specimen_file --name pw_delta.txt --create --selector 2 --payload-source st_dev\",\"sandbox_extension --op issue_file --class com.apple.app-sandbox.read --path \\/etc\\/hosts --allow-unsafe-path --introspect\"],\"notes\":[\"issue_file returns the token in stdout and in details.token.\",\"issue_file_to_pid issues a token scoped to another process via sandbox_extension_issue_file_to_process_by_pid.\",\"issue_extension\\/issue_fs_extension\\/issue_fs_rw_extension are thin wrappers around sandbox_extension_issue_file.\",\"Direct-path issuance outside *\\/policy-witness-harness\\/* is refused unless you pass --allow-unsafe-path.\",\"If consume\\/release fails with invalid-token style errors, try --token-format prefix (uses the substring before the first ';').\",\"consume returns a (typically positive) i64 handle in stdout + details.consume_handle when sandbox_extension_consume(handle) is usable.\",\"release prefers --handle from a prior consume; token-based release variants are supported for experimentation only.\",\"Consume\\/release auto-tries common symbols\\/variants when --call-symbol is not set; use --call-symbol\\/--call-variant to pin behavior.\",\"release_file calls sandbox_extension_release_file with the provided token only.\",\"update_file passes path + flags into sandbox_extension_update_file; update_file_by_fileid is experimental and supports multiple ABI variants, including pointer-based forms.\",\"update_file_rename_delta runs issue+consume on --path, waits for a host-side rename to --new-path, then compares update_file_by_fileid candidates vs update_file() for restoring access to --new-path.\",\"update_file_rename_delta stops early with normalized_outcome=dest_preexisted if --new-path already exists at probe start.\",\"payload_ptr_selector uses an 8-byte payload buffer + selector and forces field2 to 0 (Sonoma 14.4.1 ABI).\",\"If update_file_by_fileid returns invalid-arg\\/Bad address, try --call-variant payload_ptr_selector and a selector of 0\\/1\\/2.\",\"update_file_by_fileid_sweep issues+consumes a token and runs payload_ptr_selector across candidate payloads (stat + handle-derived; optionally token fields) and selectors.\",\"update_file_by_fileid_delta runs an atomic replace and records open + sandbox_check transitions before\\/after the update call (use this to define a measurable access delta).\",\"Wrapper symbols use specific variants: sandbox_consume_extension=token_second, sandbox_consume_fs_extension=token_and_ptr, sandbox_release_fs_extension=one_arg.\"],\"optional_args\":[\"--class <extension-class> (required for issue_file\\/issue_file_to_pid\\/update_file_rename_delta\\/update_file_by_fileid_delta)\",\"--pid <int|self> (required for issue_file_to_pid)\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches> (required for issue_file\\/issue_file_to_pid\\/issue_*\\/update_file\\/update_file_by_fileid_delta)\",\"--new-path <abs> (required for update_file_rename_delta)\",\"--file-id <u64> (required for update_file_by_fileid unless --path is provided)\",\"--selector <u64> (update_file_by_fileid selectors; default: 2 for update_file_by_fileid_delta\\/update_file_rename_delta)\",\"--selectors <u64,u64,...> (default: 0,1,2; update_file_by_fileid_sweep)\",\"--payload <u64> (update_file_by_fileid_delta; overrides --payload-source)\",\"--payload-source <st_dev|st_ino|handle_low32|handle_high32|handle_xor32> (default: st_dev; update_file_by_fileid_delta)\",\"--sandbox-op <sandbox-op> (default: file-read-data; update_file_by_fileid_delta sandbox_check oracle)\",\"--skip-update (update_file_by_fileid_delta control arm: measure without calling update)\",\"--no-cleanup (update_file_by_fileid_delta\\/update_file_rename_delta: do not call sandbox_extension_release(handle))\",\"--wait-for-external-replace (update_file_by_fileid_delta: wait for inode change instead of doing an in-sandbox replace)\",\"--wait-for-external-rename (update_file_rename_delta: wait for a host-side rename from --path to --new-path)\",\"--wait-timeout-ms <n> (default: 30000; update_file_by_fileid_delta\\/update_file_rename_delta)\",\"--wait-interval-ms <n> (default: 50; update_file_by_fileid_delta\\/update_file_rename_delta)\",\"--include-token-fields (update_file_by_fileid_sweep: parse numeric token segments as candidate payloads)\",\"--target <base|harness_dir|run_dir|specimen_file> (default: specimen_file)\",\"--name <filename>\",\"--flags <int> (default: 0; issue_file\\/issue_fs_extension\\/update_file\\/update_file_by_fileid\\/update_file_by_fileid_delta or consume\\/release with two_arg)\",\"--create (create a harness file\\/dir for issue_file\\/update_file_by_fileid_delta if missing)\",\"--allow-unsafe-path\",\"--introspect (emit symbol presence + image path in details)\",\"--token <token> (required for consume\\/release_file\\/update_file_by_fileid; optional for release)\",\"--handle <i64> (preferred for release; from a prior consume)\",\"--token-format <full|prefix> (default: full; consume\\/release\\/update_file_by_fileid)\",\"--call-symbol <symbol> (override consume\\/release symbol; advanced)\",\"--call-variant <handle_one_arg|one_arg|two_arg|token_second|token_and_ptr|token_fileid|fileid_token|fileid_ptr_token|token_ptr_fileid|fileid_ptr_selector|payload_ptr_selector|auto> (default: auto; consume\\/release\\/update_file_by_fileid)\"],\"probe_id\":\"sandbox_extension\",\"required_args\":[\"--op <issue_file|issue_file_to_pid|issue_extension|issue_fs_extension|issue_fs_rw_extension|consume|release|release_file|update_file|update_file_rename_delta|update_file_by_fileid|update_file_by_fileid_sweep|update_file_by_fileid_delta>\"],\"summary\":\"issue\\/consume\\/release sandbox file extensions\",\"usage\":\"\\tsandbox_extension --op issue_file --class <extension-class>\\n\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n\\t                 [--flags <int>] [--create] [--allow-unsafe-path] [--introspect]\\n\\tsandbox_extension --op issue_file_to_pid --pid <int|self> --class <extension-class>\\n\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n\\t                 [--flags <int>] [--create] [--allow-unsafe-path] [--introspect]\\n\\tsandbox_extension --op issue_extension\\n\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n\\t                 [--create] [--allow-unsafe-path] [--introspect]\\n\\tsandbox_extension --op issue_fs_extension [--flags <int>]\\n\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n\\t                 [--create] [--allow-unsafe-path] [--introspect]\\n\\t\\tsandbox_extension --op issue_fs_rw_extension\\n\\t\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n\\t\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n\\t\\t                 [--create] [--allow-unsafe-path] [--introspect]\\n\\t\\tsandbox_extension --op consume --token <token> [--token-format <full|prefix>]\\n\\t\\t                 [--call-symbol <symbol>] [--call-variant <handle_one_arg|one_arg|two_arg|token_second|token_and_ptr|auto>] [--flags <int>] [--introspect]\\n\\t\\tsandbox_extension --op release [--handle <i64>] [--token <token> --token-format <full|prefix>]\\n\\t\\t                 [--call-symbol <symbol>] [--call-variant <handle_one_arg|one_arg|two_arg|token_and_ptr|auto>] [--flags <int>] [--introspect]\\n\\t\\tsandbox_extension --op release_file --token <token> [--token-format <full|prefix>]\\n\\t\\t                 [--introspect]\\n\\tsandbox_extension --op update_file (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n\\t                 [--flags <int>] [--allow-unsafe-path] [--introspect]\\n\\t\\tsandbox_extension --op update_file_rename_delta --class <extension-class>\\n\\t\\t                 --path <abs> --new-path <abs>\\n\\t\\t                 [--flags <int>] [--selector <u64>] [--allow-unsafe-path]\\n\\t\\t                 [--wait-for-external-rename] [--wait-timeout-ms <n>] [--wait-interval-ms <n>]\\n\\t\\t                 [--no-cleanup] [--introspect]\\n\\t\\tsandbox_extension --op update_file_by_fileid --token <token> (--file-id <u64> | --path <abs>)\\n\\t\\t                 [--flags <int>] [--selector <u64>] [--call-variant <token_fileid|fileid_token|fileid_ptr_token|token_ptr_fileid|fileid_ptr_selector|payload_ptr_selector|auto>] [--introspect]\\n\\t\\tsandbox_extension --op update_file_by_fileid_sweep --class <extension-class>\\n\\t\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n\\t\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n\\t                 [--flags <int>] [--create] [--allow-unsafe-path]\\n\\t                 [--selectors <u64,u64,...>] [--include-token-fields] [--no-cleanup] [--introspect]\\n\\tsandbox_extension --op update_file_by_fileid_delta --class <extension-class>\\n\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n\\t                 [--flags <int>] [--selector <u64>] [--create] [--allow-unsafe-path]\\n\\t                 [--payload <u64> | --payload-source <st_dev|st_ino|handle_low32|handle_high32|handle_xor32>]\\n\\t                 [--sandbox-op <sandbox-op>] [--skip-update] [--no-cleanup]\\n\\t                 [--wait-for-external-replace] [--wait-timeout-ms <n>] [--wait-interval-ms <n>] [--introspect]\"},{\"entitlement_hints\":[\"com.apple.security.temporary-exception.sbpl (needed for sandbox_extension issue_file in dynamic_extension)\"],\"examples\":[\"inherit_child --scenario dynamic_extension --path \\/private\\/var\\/db\\/launchd.db\\/com.apple.launchd\\/overrides.plist --allow-unsafe-path\",\"inherit_child --scenario matrix_basic --path-class tmp --target specimen_file --name pw_child.txt --create\",\"inherit_child --scenario bookmark_ferry --path-class documents --target specimen_file --name pw_child.txt --create\",\"inherit_child --scenario inherit_bad_entitlements\"],\"notes\":[\"Spawns the bundled pw-inherit-child helper using posix_spawn and an event bus + rights bus (SCM_RIGHTS).\",\"Emits a structured witness payload under RunProbeResponse.witness.\",\"dynamic_extension uses sandbox extension issuance for parent-only acquisition; matrix_basic skips tokens.\",\"bookmark_ferry passes security-scoped bookmark bytes over the event bus; bookmark resolution is identity-sensitive, so the spawned helper must share the service bundle id.\",\"lineage_basic spawns a grandchild.\"],\"optional_args\":[\"--scenario <bookmark_ferry|dynamic_extension|inherit_bad_entitlements|lineage_basic|matrix_basic> (default: dynamic_extension)\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\",\"--target <base|harness_dir|run_dir|specimen_file> (default: specimen_file)\",\"--name <filename>\",\"--create (create a harness file\\/dir for the target if missing)\",\"--allow-unsafe-path\",\"--bookmark-move (bookmark_ferry only; move target after bookmark creation)\",\"--bookmark-invalid (bookmark_ferry only; send invalid bookmark payload bytes)\",\"--stop-on-entry (child raises SIGSTOP early for debugger attach)\",\"--stop-on-deny (child raises SIGSTOP on EPERM\\/EACCES)\",\"--stop-auto-resume (parent sends SIGCONT after child stop)\",\"--protocol-bad-cap-id (inject a bad cap_id for protocol tests)\"],\"probe_id\":\"inherit_child\",\"required_args\":[],\"summary\":\"capability ferry matrix: parent acquires, child attempts acquire vs use\",\"usage\":\"inherit_child [--scenario <bookmark_ferry|dynamic_extension|inherit_bad_entitlements|lineage_basic|matrix_basic>]\\n              [--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>]\\n              [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n              [--create] [--allow-unsafe-path]\\n              [--stop-on-entry] [--stop-on-deny] [--stop-auto-resume]\\n              [--bookmark-move] [--bookmark-invalid] [--protocol-bad-cap-id]\"},{\"entitlement_hints\":[\"none (containerization evidence)\"],\"examples\":[\"userdefaults_op --op read --key example\",\"userdefaults_op --op write --key example --value 1\"],\"notes\":[\"Useful for observing containerized preferences paths.\"],\"optional_args\":[\"--op <read|write|remove|sync> (default: read)\",\"--key <k>\",\"--value <v>\",\"--suite <suite>\"],\"probe_id\":\"userdefaults_op\",\"required_args\":[],\"summary\":\"read\\/write\\/remove\\/sync a UserDefaults key\",\"usage\":\"userdefaults_op --op <read|write|remove|sync> [--key <k>] [--value <v>] [--suite <suite>]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_xattr --op get --path \\/tmp\\/file --name com.apple.quarantine\",\"fs_xattr --op list --path \\/tmp\\/file\"],\"notes\":[\"xattr writes are refused outside harness paths unless --allow-write or --allow-unsafe-path is set.\"],\"optional_args\":[\"--name <xattr>\",\"--value <v>\",\"--allow-write\",\"--allow-unsafe-path\"],\"probe_id\":\"fs_xattr\",\"required_args\":[\"--op <get|list|set|remove>\",\"--path <abs>\"],\"summary\":\"get\\/list\\/set\\/remove extended attributes\",\"usage\":\"fs_xattr --op <get|list|set|remove> --path <abs> [--name <xattr>] [--value <v>] [--allow-write] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_coordinated_op --op read --path-class documents\",\"fs_coordinated_op --op write --path-class tmp --target run_dir\"],\"notes\":[\"Coordinated writes to direct paths are refused unless you use --path-class\\/--target (or a path under *\\/policy-witness-harness\\/*) or set --allow-unsafe-path.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--allow-unsafe-path\"],\"probe_id\":\"fs_coordinated_op\",\"required_args\":[\"--op <read|write>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\"],\"summary\":\"NSFileCoordinator mediated read\\/write\",\"usage\":\"fs_coordinated_op --op <read|write> (--path <abs> | --path-class <...>) [--target <...>] [--allow-unsafe-path]\"}],\"schema_version\":1,\"trace_symbols\":[{\"probe_id\":\"fs_op\",\"symbols\":[\"pw_probe_fs_op\"]},{\"probe_id\":\"fs_op_wait\",\"symbols\":[\"pw_probe_fs_op_wait\"]},{\"probe_id\":\"net_op\",\"symbols\":[\"pw_probe_net_op\"]},{\"probe_id\":\"dlopen_external\",\"symbols\":[\"pw_probe_dlopen_external\"]},{\"probe_id\":\"jit_map_jit\",\"symbols\":[\"pw_probe_jit_map_jit\"]},{\"probe_id\":\"jit_rwx_legacy\",\"symbols\":[\"pw_probe_jit_rwx_legacy\"]},{\"probe_id\":\"sandbox_check\",\"symbols\":[\"pw_probe_sandbox_check\"]},{\"probe_id\":\"sandbox_extension\",\"symbols\":[\"pw_probe_sandbox_extension\"]},{\"probe_id\":\"inherit_child\",\"symbols\":[\"pw_probe_inherit_child\"]}]}",
      "thread_id": "5635"
    },
    "generated_at_unix_ms": 1767213318283,
    "kind": "probe_response",
    "result": {
      "exit_code": 0,
      "normalized_outcome": "ok",
      "ok": true,
      "rc": 0,
      "stdout": "{\"generated_at_iso8601\":\"2025-12-31T20:35:18Z\",\"probes\":[{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"probe_catalog\"],\"notes\":[\"Outputs JSON in RunProbeResponse.stdout.\",\"Use <probe-id> --help for per-probe usage.\"],\"optional_args\":[],\"probe_id\":\"probe_catalog\",\"required_args\":[],\"summary\":\"emit a JSON catalog of available probes\",\"usage\":\"probe_catalog\"},{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"world_shape\"],\"notes\":[\"Reports HOME\\/TMP\\/CWD and containerization signals.\"],\"optional_args\":[],\"probe_id\":\"world_shape\",\"required_args\":[],\"summary\":\"report containerization and world shape metadata\",\"usage\":\"world_shape\"},{\"entitlement_hints\":[\"com.apple.security.network.client\"],\"examples\":[\"network_tcp_connect --host 1.1.1.1 --port 443\"],\"notes\":[],\"optional_args\":[],\"probe_id\":\"network_tcp_connect\",\"required_args\":[\"--host <ipv4>\",\"--port <1..65535>\"],\"summary\":\"attempt a TCP connect to an IPv4 host:port\",\"usage\":\"network_tcp_connect --host <ipv4> --port <1..65535>\"},{\"entitlement_hints\":[\"com.apple.security.files.downloads.read-write\"],\"examples\":[\"downloads_rw\",\"downloads_rw --name demo.txt\"],\"notes\":[\"Writes under Downloads\\/policy-witness-harness.\"],\"optional_args\":[\"--name <file-name>\"],\"probe_id\":\"downloads_rw\",\"required_args\":[],\"summary\":\"read\\/write\\/remove a file under Downloads\\/policy-witness-harness\",\"usage\":\"downloads_rw [--name <file-name>]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_op --op stat --path-class downloads\",\"fs_op --op create --path-class tmp --target run_dir\"],\"notes\":[\"Destructive direct-path ops are refused unless you use --path-class\\/--target (or a path under *\\/policy-witness-harness\\/*) or set --allow-unsafe-path.\",\"Use --no-cleanup to keep harness artifacts after rename\\/truncate for update_file_by_fileid experiments.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--name <file-name>\",\"--to <path> | --to-path <path> | --to-name <file-name>\",\"--max-entries <n>\",\"--allow-unsafe-path\",\"--no-cleanup\"],\"probe_id\":\"fs_op\",\"required_args\":[\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\"],\"summary\":\"parameterized filesystem operations\",\"usage\":\"fs_op --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\n      (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n      [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\n      [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path] [--no-cleanup]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_op_wait --op open_read --path-class tmp --wait-fifo \\/tmp\\/pw-wait.fifo\",\"fs_op_wait --op stat --path \\/tmp\\/target --wait-exists \\/tmp\\/trigger --wait-timeout-ms 60000\"],\"notes\":[\"Blocks until the wait trigger is satisfied, then runs fs_op.\",\"--wait-interval-ms is only used with --wait-exists.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--name <file-name>\",\"--to <path> | --to-path <path> | --to-name <file-name>\",\"--max-entries <n>\",\"--allow-unsafe-path\",\"--no-cleanup\",\"--wait-timeout-ms <n>\",\"--wait-interval-ms <n>\"],\"probe_id\":\"fs_op_wait\",\"required_args\":[\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\",\"--wait-fifo <path> | --wait-exists <path>\"],\"summary\":\"wait for a trigger, then run fs_op\",\"usage\":\"fs_op_wait --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\n          (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n          [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\n          [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path] [--no-cleanup]\\n          (--wait-fifo <path> | --wait-exists <path>) [--wait-timeout-ms <n>] [--wait-interval-ms <n>]\"},{\"entitlement_hints\":[\"com.apple.security.network.client\"],\"examples\":[\"net_op --op getaddrinfo --host example.com\",\"net_op --op tcp_connect --host 127.0.0.1 --port 80\"],\"notes\":[\"--port is required for tcp_connect and udp_send.\"],\"optional_args\":[\"--port <1..65535>\",\"--numeric\"],\"probe_id\":\"net_op\",\"required_args\":[\"--op <getaddrinfo|tcp_connect|udp_send>\",\"--host <host>\"],\"summary\":\"parameterized network operations\",\"usage\":\"net_op --op <getaddrinfo|tcp_connect|udp_send> --host <host> [--port <1..65535>] [--numeric]\"},{\"entitlement_hints\":[\"com.apple.security.cs.disable-library-validation\",\"com.apple.security.cs.allow-dyld-environment-variables (if you rely on DYLD_*)\"],\"examples\":[\"dlopen_external --path \\/path\\/to\\/testdylib.dylib\"],\"notes\":[\"Executes dylib initializers; this is not a passive probe.\",\"Use a signed dylib (see tests\\/fixtures\\/TestDylib).\"],\"optional_args\":[],\"probe_id\":\"dlopen_external\",\"required_args\":[\"--path <abs> (or PW_DLOPEN_PATH)\"],\"summary\":\"dlopen a signed dylib by absolute path\",\"usage\":\"dlopen_external --path <abs> (or set PW_DLOPEN_PATH)\"},{\"entitlement_hints\":[\"com.apple.security.cs.allow-jit\"],\"examples\":[\"jit_map_jit\",\"jit_map_jit --size 65536\"],\"notes\":[\"Reports errno on MAP_JIT failure.\"],\"optional_args\":[\"--size <bytes> (default: 16384)\"],\"probe_id\":\"jit_map_jit\",\"required_args\":[],\"summary\":\"attempt mmap with MAP_JIT\",\"usage\":\"jit_map_jit [--size <bytes>]\"},{\"entitlement_hints\":[\"com.apple.security.cs.allow-unsigned-executable-memory\"],\"examples\":[\"jit_rwx_legacy\",\"jit_rwx_legacy --size 65536\"],\"notes\":[\"Reports errno on RWX mmap failure.\"],\"optional_args\":[\"--size <bytes> (default: 16384)\"],\"probe_id\":\"jit_rwx_legacy\",\"required_args\":[],\"summary\":\"attempt mmap with RWX permissions (legacy)\",\"usage\":\"jit_rwx_legacy [--size <bytes>]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_op --bookmark-b64 <b64> --op stat\",\"bookmark_op --bookmark-path \\/tmp\\/token.txt --op open_read --relative file.txt\"],\"notes\":[\"Uses ScopedBookmarksAgent IPC for security-scoped bookmarks.\",\"Treat bookmark tokens as scoped to the creating code identity (bundle id\\/team id); resolving under a different profile\\/service may fail even if entitlements are present.\"],\"optional_args\":[\"--relative <rel>\",\"--op <fs_op-op> (default: stat)\",\"--allow-unsafe-path\"],\"probe_id\":\"bookmark_op\",\"required_args\":[\"--bookmark-b64 <base64> | --bookmark-path <path>\"],\"summary\":\"resolve a bookmark token and run a filesystem op against it\",\"usage\":\"bookmark_op --bookmark-b64 <base64> | --bookmark-path <path>\\n            [--relative <rel>] [--op <fs_op-op>] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_make --path \\/Users\\/me\\/Downloads\",\"bookmark_make --path \\/Users\\/me\\/Downloads --read-only\"],\"notes\":[\"Security-scoped bookmarks use ScopedBookmarksAgent IPC.\",\"Bookmark tokens are not expected to be portable across service identities; prefer make+resolve within the same profile\\/service.\"],\"optional_args\":[\"--no-security-scope\",\"--read-only\",\"--allow-missing\"],\"probe_id\":\"bookmark_make\",\"required_args\":[\"--path <abs>\"],\"summary\":\"create a security-scoped bookmark token for a path\",\"usage\":\"bookmark_make --path <abs> [--no-security-scope] [--read-only] [--allow-missing]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_roundtrip --path \\/Users\\/me\\/Downloads --op stat\",\"bookmark_roundtrip --path \\/Users\\/me\\/Downloads --op open_read --relative file.txt\"],\"notes\":[\"Returns the bookmark token in stdout and the fs_op result in details.\",\"This is the most deterministic bookmark workflow because create+resolve happen under the same service identity.\"],\"optional_args\":[\"--op <fs_op-op> (default: stat)\",\"--relative <rel>\",\"--no-security-scope\",\"--read-only\",\"--allow-missing\",\"--allow-unsafe-path\"],\"probe_id\":\"bookmark_roundtrip\",\"required_args\":[\"--path <abs>\"],\"summary\":\"create a bookmark token and immediately resolve + run a filesystem op\",\"usage\":\"bookmark_roundtrip --path <abs> [--op <fs_op-op>] [--relative <rel>] [--no-security-scope] [--read-only] [--allow-missing] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"capabilities_snapshot\"],\"notes\":[\"Includes entitlement presence booleans and standard directory paths.\"],\"optional_args\":[],\"probe_id\":\"capabilities_snapshot\",\"required_args\":[],\"summary\":\"report entitlements and resolved standard directories\",\"usage\":\"capabilities_snapshot\"},{\"entitlement_hints\":[\"none (observer \\/ instrumentation target)\"],\"examples\":[\"sandbox_check --operation file-read-data\",\"sandbox_check --operation file-read-data --path \\/etc\\/hosts\",\"sandbox_check --operation mach-lookup --repeat 10\"],\"notes\":[\"This does not perform the operation; it only calls sandbox_check() so attach\\/hook tooling can observe libsystem_sandbox activity.\",\"If --path is provided, the probe passes a guessed filter type for a path argument; treat the return code as informational, not authoritative.\"],\"optional_args\":[\"--path <abs>\",\"--repeat <n> (default: 1)\"],\"probe_id\":\"sandbox_check\",\"required_args\":[\"--operation <sandbox-op>\"],\"summary\":\"call sandbox_check() in libsystem_sandbox (hook calibration)\",\"usage\":\"sandbox_check --operation <sandbox-op> [--path <abs>] [--repeat <n>]\"},{\"entitlement_hints\":[\"com.apple.security.temporary-exception.sbpl (allow file-issue-extension for extension class)\"],\"examples\":[\"sandbox_extension --op issue_file --class com.apple.app-sandbox.read --path \\/etc\\/hosts --allow-unsafe-path\",\"sandbox_extension --op issue_file --class com.apple.app-sandbox.read --path-class tmp --target specimen_file --name pw_extension.txt --create\",\"sandbox_extension --op issue_file_to_pid --pid self --class com.apple.app-sandbox.read --path \\/etc\\/hosts --allow-unsafe-path\",\"sandbox_extension --op issue_extension --path-class tmp --target specimen_file --name pw_extension.txt --create\",\"sandbox_extension --op issue_fs_extension --flags 8 --path \\/etc\\/hosts --allow-unsafe-path\",\"sandbox_extension --op consume --token <token> --token-format full\",\"sandbox_extension --op consume --token <token> --call-variant token_second --call-symbol sandbox_consume_extension\",\"sandbox_extension --op consume --token <token> --call-variant token_and_ptr --call-symbol sandbox_consume_fs_extension\",\"sandbox_extension --op release --handle <i64>\",\"sandbox_extension --op release_file --token <token>\",\"sandbox_extension --op update_file --path \\/etc\\/hosts --flags 0 --allow-unsafe-path\",\"sandbox_extension --op update_file_rename_delta --class com.apple.app-sandbox.read --path \\/Users\\/me\\/Desktop\\/pw_old.txt --new-path \\/Users\\/me\\/Desktop\\/pw_new.txt --wait-for-external-rename --allow-unsafe-path\",\"sandbox_extension --op update_file_by_fileid --token <token> --path \\/etc\\/hosts --flags 0\",\"sandbox_extension --op update_file_by_fileid --token <token> --file-id <u64> --selector 2 --call-variant payload_ptr_selector\",\"sandbox_extension --op update_file_by_fileid_sweep --class com.apple.app-sandbox.read --path-class tmp --target specimen_file --name pw_sweep.txt --create --selectors 0,1,2\",\"sandbox_extension --op update_file_by_fileid_delta --class com.apple.app-sandbox.read --path-class tmp --target specimen_file --name pw_delta.txt --create --selector 2 --payload-source st_dev\",\"sandbox_extension --op issue_file --class com.apple.app-sandbox.read --path \\/etc\\/hosts --allow-unsafe-path --introspect\"],\"notes\":[\"issue_file returns the token in stdout and in details.token.\",\"issue_file_to_pid issues a token scoped to another process via sandbox_extension_issue_file_to_process_by_pid.\",\"issue_extension\\/issue_fs_extension\\/issue_fs_rw_extension are thin wrappers around sandbox_extension_issue_file.\",\"Direct-path issuance outside *\\/policy-witness-harness\\/* is refused unless you pass --allow-unsafe-path.\",\"If consume\\/release fails with invalid-token style errors, try --token-format prefix (uses the substring before the first ';').\",\"consume returns a (typically positive) i64 handle in stdout + details.consume_handle when sandbox_extension_consume(handle) is usable.\",\"release prefers --handle from a prior consume; token-based release variants are supported for experimentation only.\",\"Consume\\/release auto-tries common symbols\\/variants when --call-symbol is not set; use --call-symbol\\/--call-variant to pin behavior.\",\"release_file calls sandbox_extension_release_file with the provided token only.\",\"update_file passes path + flags into sandbox_extension_update_file; update_file_by_fileid is experimental and supports multiple ABI variants, including pointer-based forms.\",\"update_file_rename_delta runs issue+consume on --path, waits for a host-side rename to --new-path, then compares update_file_by_fileid candidates vs update_file() for restoring access to --new-path.\",\"update_file_rename_delta stops early with normalized_outcome=dest_preexisted if --new-path already exists at probe start.\",\"payload_ptr_selector uses an 8-byte payload buffer + selector and forces field2 to 0 (Sonoma 14.4.1 ABI).\",\"If update_file_by_fileid returns invalid-arg\\/Bad address, try --call-variant payload_ptr_selector and a selector of 0\\/1\\/2.\",\"update_file_by_fileid_sweep issues+consumes a token and runs payload_ptr_selector across candidate payloads (stat + handle-derived; optionally token fields) and selectors.\",\"update_file_by_fileid_delta runs an atomic replace and records open + sandbox_check transitions before\\/after the update call (use this to define a measurable access delta).\",\"Wrapper symbols use specific variants: sandbox_consume_extension=token_second, sandbox_consume_fs_extension=token_and_ptr, sandbox_release_fs_extension=one_arg.\"],\"optional_args\":[\"--class <extension-class> (required for issue_file\\/issue_file_to_pid\\/update_file_rename_delta\\/update_file_by_fileid_delta)\",\"--pid <int|self> (required for issue_file_to_pid)\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches> (required for issue_file\\/issue_file_to_pid\\/issue_*\\/update_file\\/update_file_by_fileid_delta)\",\"--new-path <abs> (required for update_file_rename_delta)\",\"--file-id <u64> (required for update_file_by_fileid unless --path is provided)\",\"--selector <u64> (update_file_by_fileid selectors; default: 2 for update_file_by_fileid_delta\\/update_file_rename_delta)\",\"--selectors <u64,u64,...> (default: 0,1,2; update_file_by_fileid_sweep)\",\"--payload <u64> (update_file_by_fileid_delta; overrides --payload-source)\",\"--payload-source <st_dev|st_ino|handle_low32|handle_high32|handle_xor32> (default: st_dev; update_file_by_fileid_delta)\",\"--sandbox-op <sandbox-op> (default: file-read-data; update_file_by_fileid_delta sandbox_check oracle)\",\"--skip-update (update_file_by_fileid_delta control arm: measure without calling update)\",\"--no-cleanup (update_file_by_fileid_delta\\/update_file_rename_delta: do not call sandbox_extension_release(handle))\",\"--wait-for-external-replace (update_file_by_fileid_delta: wait for inode change instead of doing an in-sandbox replace)\",\"--wait-for-external-rename (update_file_rename_delta: wait for a host-side rename from --path to --new-path)\",\"--wait-timeout-ms <n> (default: 30000; update_file_by_fileid_delta\\/update_file_rename_delta)\",\"--wait-interval-ms <n> (default: 50; update_file_by_fileid_delta\\/update_file_rename_delta)\",\"--include-token-fields (update_file_by_fileid_sweep: parse numeric token segments as candidate payloads)\",\"--target <base|harness_dir|run_dir|specimen_file> (default: specimen_file)\",\"--name <filename>\",\"--flags <int> (default: 0; issue_file\\/issue_fs_extension\\/update_file\\/update_file_by_fileid\\/update_file_by_fileid_delta or consume\\/release with two_arg)\",\"--create (create a harness file\\/dir for issue_file\\/update_file_by_fileid_delta if missing)\",\"--allow-unsafe-path\",\"--introspect (emit symbol presence + image path in details)\",\"--token <token> (required for consume\\/release_file\\/update_file_by_fileid; optional for release)\",\"--handle <i64> (preferred for release; from a prior consume)\",\"--token-format <full|prefix> (default: full; consume\\/release\\/update_file_by_fileid)\",\"--call-symbol <symbol> (override consume\\/release symbol; advanced)\",\"--call-variant <handle_one_arg|one_arg|two_arg|token_second|token_and_ptr|token_fileid|fileid_token|fileid_ptr_token|token_ptr_fileid|fileid_ptr_selector|payload_ptr_selector|auto> (default: auto; consume\\/release\\/update_file_by_fileid)\"],\"probe_id\":\"sandbox_extension\",\"required_args\":[\"--op <issue_file|issue_file_to_pid|issue_extension|issue_fs_extension|issue_fs_rw_extension|consume|release|release_file|update_file|update_file_rename_delta|update_file_by_fileid|update_file_by_fileid_sweep|update_file_by_fileid_delta>\"],\"summary\":\"issue\\/consume\\/release sandbox file extensions\",\"usage\":\"\\tsandbox_extension --op issue_file --class <extension-class>\\n\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n\\t                 [--flags <int>] [--create] [--allow-unsafe-path] [--introspect]\\n\\tsandbox_extension --op issue_file_to_pid --pid <int|self> --class <extension-class>\\n\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n\\t                 [--flags <int>] [--create] [--allow-unsafe-path] [--introspect]\\n\\tsandbox_extension --op issue_extension\\n\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n\\t                 [--create] [--allow-unsafe-path] [--introspect]\\n\\tsandbox_extension --op issue_fs_extension [--flags <int>]\\n\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n\\t                 [--create] [--allow-unsafe-path] [--introspect]\\n\\t\\tsandbox_extension --op issue_fs_rw_extension\\n\\t\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n\\t\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n\\t\\t                 [--create] [--allow-unsafe-path] [--introspect]\\n\\t\\tsandbox_extension --op consume --token <token> [--token-format <full|prefix>]\\n\\t\\t                 [--call-symbol <symbol>] [--call-variant <handle_one_arg|one_arg|two_arg|token_second|token_and_ptr|auto>] [--flags <int>] [--introspect]\\n\\t\\tsandbox_extension --op release [--handle <i64>] [--token <token> --token-format <full|prefix>]\\n\\t\\t                 [--call-symbol <symbol>] [--call-variant <handle_one_arg|one_arg|two_arg|token_and_ptr|auto>] [--flags <int>] [--introspect]\\n\\t\\tsandbox_extension --op release_file --token <token> [--token-format <full|prefix>]\\n\\t\\t                 [--introspect]\\n\\tsandbox_extension --op update_file (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n\\t                 [--flags <int>] [--allow-unsafe-path] [--introspect]\\n\\t\\tsandbox_extension --op update_file_rename_delta --class <extension-class>\\n\\t\\t                 --path <abs> --new-path <abs>\\n\\t\\t                 [--flags <int>] [--selector <u64>] [--allow-unsafe-path]\\n\\t\\t                 [--wait-for-external-rename] [--wait-timeout-ms <n>] [--wait-interval-ms <n>]\\n\\t\\t                 [--no-cleanup] [--introspect]\\n\\t\\tsandbox_extension --op update_file_by_fileid --token <token> (--file-id <u64> | --path <abs>)\\n\\t\\t                 [--flags <int>] [--selector <u64>] [--call-variant <token_fileid|fileid_token|fileid_ptr_token|token_ptr_fileid|fileid_ptr_selector|payload_ptr_selector|auto>] [--introspect]\\n\\t\\tsandbox_extension --op update_file_by_fileid_sweep --class <extension-class>\\n\\t\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n\\t\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n\\t                 [--flags <int>] [--create] [--allow-unsafe-path]\\n\\t                 [--selectors <u64,u64,...>] [--include-token-fields] [--no-cleanup] [--introspect]\\n\\tsandbox_extension --op update_file_by_fileid_delta --class <extension-class>\\n\\t                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n\\t                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n\\t                 [--flags <int>] [--selector <u64>] [--create] [--allow-unsafe-path]\\n\\t                 [--payload <u64> | --payload-source <st_dev|st_ino|handle_low32|handle_high32|handle_xor32>]\\n\\t                 [--sandbox-op <sandbox-op>] [--skip-update] [--no-cleanup]\\n\\t                 [--wait-for-external-replace] [--wait-timeout-ms <n>] [--wait-interval-ms <n>] [--introspect]\"},{\"entitlement_hints\":[\"com.apple.security.temporary-exception.sbpl (needed for sandbox_extension issue_file in dynamic_extension)\"],\"examples\":[\"inherit_child --scenario dynamic_extension --path \\/private\\/var\\/db\\/launchd.db\\/com.apple.launchd\\/overrides.plist --allow-unsafe-path\",\"inherit_child --scenario matrix_basic --path-class tmp --target specimen_file --name pw_child.txt --create\",\"inherit_child --scenario bookmark_ferry --path-class documents --target specimen_file --name pw_child.txt --create\",\"inherit_child --scenario inherit_bad_entitlements\"],\"notes\":[\"Spawns the bundled pw-inherit-child helper using posix_spawn and an event bus + rights bus (SCM_RIGHTS).\",\"Emits a structured witness payload under RunProbeResponse.witness.\",\"dynamic_extension uses sandbox extension issuance for parent-only acquisition; matrix_basic skips tokens.\",\"bookmark_ferry passes security-scoped bookmark bytes over the event bus; bookmark resolution is identity-sensitive, so the spawned helper must share the service bundle id.\",\"lineage_basic spawns a grandchild.\"],\"optional_args\":[\"--scenario <bookmark_ferry|dynamic_extension|inherit_bad_entitlements|lineage_basic|matrix_basic> (default: dynamic_extension)\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\",\"--target <base|harness_dir|run_dir|specimen_file> (default: specimen_file)\",\"--name <filename>\",\"--create (create a harness file\\/dir for the target if missing)\",\"--allow-unsafe-path\",\"--bookmark-move (bookmark_ferry only; move target after bookmark creation)\",\"--bookmark-invalid (bookmark_ferry only; send invalid bookmark payload bytes)\",\"--stop-on-entry (child raises SIGSTOP early for debugger attach)\",\"--stop-on-deny (child raises SIGSTOP on EPERM\\/EACCES)\",\"--stop-auto-resume (parent sends SIGCONT after child stop)\",\"--protocol-bad-cap-id (inject a bad cap_id for protocol tests)\"],\"probe_id\":\"inherit_child\",\"required_args\":[],\"summary\":\"capability ferry matrix: parent acquires, child attempts acquire vs use\",\"usage\":\"inherit_child [--scenario <bookmark_ferry|dynamic_extension|inherit_bad_entitlements|lineage_basic|matrix_basic>]\\n              [--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>]\\n              [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n              [--create] [--allow-unsafe-path]\\n              [--stop-on-entry] [--stop-on-deny] [--stop-auto-resume]\\n              [--bookmark-move] [--bookmark-invalid] [--protocol-bad-cap-id]\"},{\"entitlement_hints\":[\"none (containerization evidence)\"],\"examples\":[\"userdefaults_op --op read --key example\",\"userdefaults_op --op write --key example --value 1\"],\"notes\":[\"Useful for observing containerized preferences paths.\"],\"optional_args\":[\"--op <read|write|remove|sync> (default: read)\",\"--key <k>\",\"--value <v>\",\"--suite <suite>\"],\"probe_id\":\"userdefaults_op\",\"required_args\":[],\"summary\":\"read\\/write\\/remove\\/sync a UserDefaults key\",\"usage\":\"userdefaults_op --op <read|write|remove|sync> [--key <k>] [--value <v>] [--suite <suite>]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_xattr --op get --path \\/tmp\\/file --name com.apple.quarantine\",\"fs_xattr --op list --path \\/tmp\\/file\"],\"notes\":[\"xattr writes are refused outside harness paths unless --allow-write or --allow-unsafe-path is set.\"],\"optional_args\":[\"--name <xattr>\",\"--value <v>\",\"--allow-write\",\"--allow-unsafe-path\"],\"probe_id\":\"fs_xattr\",\"required_args\":[\"--op <get|list|set|remove>\",\"--path <abs>\"],\"summary\":\"get\\/list\\/set\\/remove extended attributes\",\"usage\":\"fs_xattr --op <get|list|set|remove> --path <abs> [--name <xattr>] [--value <v>] [--allow-write] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_coordinated_op --op read --path-class documents\",\"fs_coordinated_op --op write --path-class tmp --target run_dir\"],\"notes\":[\"Coordinated writes to direct paths are refused unless you use --path-class\\/--target (or a path under *\\/policy-witness-harness\\/*) or set --allow-unsafe-path.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--allow-unsafe-path\"],\"probe_id\":\"fs_coordinated_op\",\"required_args\":[\"--op <read|write>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\"],\"summary\":\"NSFileCoordinator mediated read\\/write\",\"usage\":\"fs_coordinated_op --op <read|write> (--path <abs> | --path-class <...>) [--target <...>] [--allow-unsafe-path]\"}],\"schema_version\":1,\"trace_symbols\":[{\"probe_id\":\"fs_op\",\"symbols\":[\"pw_probe_fs_op\"]},{\"probe_id\":\"fs_op_wait\",\"symbols\":[\"pw_probe_fs_op_wait\"]},{\"probe_id\":\"net_op\",\"symbols\":[\"pw_probe_net_op\"]},{\"probe_id\":\"dlopen_external\",\"symbols\":[\"pw_probe_dlopen_external\"]},{\"probe_id\":\"jit_map_jit\",\"symbols\":[\"pw_probe_jit_map_jit\"]},{\"probe_id\":\"jit_rwx_legacy\",\"symbols\":[\"pw_probe_jit_rwx_legacy\"]},{\"probe_id\":\"sandbox_check\",\"symbols\":[\"pw_probe_sandbox_check\"]},{\"probe_id\":\"sandbox_extension\",\"symbols\":[\"pw_probe_sandbox_extension\"]},{\"probe_id\":\"inherit_child\",\"symbols\":[\"pw_probe_inherit_child\"]}]}"
    },
    "schema_version": 1
  },
  "stdout_json_error": null,
  "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
}
