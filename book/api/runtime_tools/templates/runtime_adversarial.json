{
  "schema_version": "runtime-tools.plan_template.v0.1",
  "template_id": "runtime-adversarial",
  "description": "Adversarial runtime probes and controls.",
  "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
  "registry_id": "runtime-adversarial",
  "plan": {
    "schema_version": "runtime-tools.plan.v0.1",
    "plan_id": "runtime-adversarial.v1",
    "registry_id": "runtime-adversarial",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
    "profiles": [
      "adv:flow_divert_partial_tcp",
      "adv:flow_divert_require_all_tcp",
      "adv:mach_local_literal",
      "adv:mach_local_regex",
      "adv:mach_simple_allow",
      "adv:mach_simple_variants",
      "adv:net_outbound_allow",
      "adv:net_outbound_deny",
      "adv:path_alias",
      "adv:path_edges",
      "adv:struct_flat",
      "adv:struct_nested"
    ],
    "lanes": {
      "baseline": true,
      "scenario": true,
      "oracle": true
    },
    "controls": {
      "baseline": true
    },
    "apply_preflight_profile": "book/experiments/runtime-adversarial/sb/apply_preflight_allow.sb"
  },
  "probes": {
    "schema_version": "runtime-tools.probe_registry.v0.1",
    "registry_id": "runtime-adversarial",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
    "probes": {
      "adv:struct_flat:allow-ok-root": {
        "probe_id": "adv:struct_flat:allow-ok-root",
        "name": "allow-ok-root",
        "operation": "file-read*",
        "target": "/tmp/runtime-adv/struct/ok/allowed.txt",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-read*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/struct/ok/allowed.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:struct_flat:allow-ok-deep": {
        "probe_id": "adv:struct_flat:allow-ok-deep",
        "name": "allow-ok-deep",
        "operation": "file-read*",
        "target": "/tmp/runtime-adv/struct/ok/deep/nested.txt",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-read*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/struct/ok/deep/nested.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:struct_flat:deny-blocked": {
        "probe_id": "adv:struct_flat:deny-blocked",
        "name": "deny-blocked",
        "operation": "file-read*",
        "target": "/tmp/runtime-adv/struct/blocked.txt",
        "expected": "deny",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-read*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/struct/blocked.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:struct_flat:deny-outside": {
        "probe_id": "adv:struct_flat:deny-outside",
        "name": "deny-outside",
        "operation": "file-read*",
        "target": "/tmp/runtime-adv/struct/outside.txt",
        "expected": "deny",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-read*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/struct/outside.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:struct_flat:write-ok-root": {
        "probe_id": "adv:struct_flat:write-ok-root",
        "name": "write-ok-root",
        "operation": "file-write*",
        "target": "/tmp/runtime-adv/struct/ok/allowed.txt",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-write*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/struct/ok/allowed.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:struct_flat:write-ok-deep": {
        "probe_id": "adv:struct_flat:write-ok-deep",
        "name": "write-ok-deep",
        "operation": "file-write*",
        "target": "/tmp/runtime-adv/struct/ok/deep/nested.txt",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-write*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/struct/ok/deep/nested.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:struct_flat:write-blocked": {
        "probe_id": "adv:struct_flat:write-blocked",
        "name": "write-blocked",
        "operation": "file-write*",
        "target": "/tmp/runtime-adv/struct/blocked.txt",
        "expected": "deny",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-write*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/struct/blocked.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:struct_flat:write-outside": {
        "probe_id": "adv:struct_flat:write-outside",
        "name": "write-outside",
        "operation": "file-write*",
        "target": "/tmp/runtime-adv/struct/outside.txt",
        "expected": "deny",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-write*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/struct/outside.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:struct_nested:allow-ok-root": {
        "probe_id": "adv:struct_nested:allow-ok-root",
        "name": "allow-ok-root",
        "operation": "file-read*",
        "target": "/tmp/runtime-adv/struct/ok/allowed.txt",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-read*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/struct/ok/allowed.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:struct_nested:allow-ok-deep": {
        "probe_id": "adv:struct_nested:allow-ok-deep",
        "name": "allow-ok-deep",
        "operation": "file-read*",
        "target": "/tmp/runtime-adv/struct/ok/deep/nested.txt",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-read*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/struct/ok/deep/nested.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:struct_nested:deny-blocked": {
        "probe_id": "adv:struct_nested:deny-blocked",
        "name": "deny-blocked",
        "operation": "file-read*",
        "target": "/tmp/runtime-adv/struct/blocked.txt",
        "expected": "deny",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-read*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/struct/blocked.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:struct_nested:deny-outside": {
        "probe_id": "adv:struct_nested:deny-outside",
        "name": "deny-outside",
        "operation": "file-read*",
        "target": "/tmp/runtime-adv/struct/outside.txt",
        "expected": "deny",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-read*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/struct/outside.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:struct_nested:write-ok-root": {
        "probe_id": "adv:struct_nested:write-ok-root",
        "name": "write-ok-root",
        "operation": "file-write*",
        "target": "/tmp/runtime-adv/struct/ok/allowed.txt",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-write*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/struct/ok/allowed.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:struct_nested:write-ok-deep": {
        "probe_id": "adv:struct_nested:write-ok-deep",
        "name": "write-ok-deep",
        "operation": "file-write*",
        "target": "/tmp/runtime-adv/struct/ok/deep/nested.txt",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-write*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/struct/ok/deep/nested.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:struct_nested:write-blocked": {
        "probe_id": "adv:struct_nested:write-blocked",
        "name": "write-blocked",
        "operation": "file-write*",
        "target": "/tmp/runtime-adv/struct/blocked.txt",
        "expected": "deny",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-write*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/struct/blocked.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:struct_nested:write-outside": {
        "probe_id": "adv:struct_nested:write-outside",
        "name": "write-outside",
        "operation": "file-write*",
        "target": "/tmp/runtime-adv/struct/outside.txt",
        "expected": "deny",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-write*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/struct/outside.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:path_edges:allow-tmp": {
        "probe_id": "adv:path_edges:allow-tmp",
        "name": "allow-tmp",
        "operation": "file-read*",
        "target": "/tmp/runtime-adv/edges/a",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-read*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/edges/a"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:path_edges:deny-private": {
        "probe_id": "adv:path_edges:deny-private",
        "name": "deny-private",
        "operation": "file-read*",
        "target": "/private/tmp/runtime-adv/edges/a",
        "expected": "deny",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-read*"
        ],
        "expected_predicates": [
          "/private/tmp/runtime-adv/edges/a"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:path_edges:allow-subpath": {
        "probe_id": "adv:path_edges:allow-subpath",
        "name": "allow-subpath",
        "operation": "file-read*",
        "target": "/tmp/runtime-adv/edges/okdir/item.txt",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-read*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/edges/okdir/item.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:path_edges:allow-subpath-normalized": {
        "probe_id": "adv:path_edges:allow-subpath-normalized",
        "name": "allow-subpath-normalized",
        "operation": "file-read*",
        "target": "/private/tmp/runtime-adv/edges/okdir/item.txt",
        "expected": "deny",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-read*"
        ],
        "expected_predicates": [
          "/private/tmp/runtime-adv/edges/okdir/item.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:path_edges:deny-dotdot": {
        "probe_id": "adv:path_edges:deny-dotdot",
        "name": "deny-dotdot",
        "operation": "file-read*",
        "target": "/tmp/runtime-adv/edges/okdir/../blocked.txt",
        "expected": "deny",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-read*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/edges/okdir/../blocked.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:path_edges:write-tmp": {
        "probe_id": "adv:path_edges:write-tmp",
        "name": "write-tmp",
        "operation": "file-write*",
        "target": "/tmp/runtime-adv/edges/a",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-write*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/edges/a"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:path_edges:write-private": {
        "probe_id": "adv:path_edges:write-private",
        "name": "write-private",
        "operation": "file-write*",
        "target": "/private/tmp/runtime-adv/edges/a",
        "expected": "deny",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-write*"
        ],
        "expected_predicates": [
          "/private/tmp/runtime-adv/edges/a"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:path_edges:write-subpath": {
        "probe_id": "adv:path_edges:write-subpath",
        "name": "write-subpath",
        "operation": "file-write*",
        "target": "/tmp/runtime-adv/edges/okdir/item.txt",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-write*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/edges/okdir/item.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:path_edges:write-dotdot": {
        "probe_id": "adv:path_edges:write-dotdot",
        "name": "write-dotdot",
        "operation": "file-write*",
        "target": "/tmp/runtime-adv/edges/okdir/../blocked.txt",
        "expected": "deny",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-write*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/edges/okdir/../blocked.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:path_alias:alias-tmp": {
        "probe_id": "adv:path_alias:alias-tmp",
        "name": "alias-tmp",
        "operation": "file-read*",
        "target": "/tmp/runtime-adv/alias/allow.txt",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-read*"
        ],
        "expected_predicates": [
          "/tmp/runtime-adv/alias/allow.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:path_alias:alias-private": {
        "probe_id": "adv:path_alias:alias-private",
        "name": "alias-private",
        "operation": "file-read*",
        "target": "/private/tmp/runtime-adv/alias/allow.txt",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "file-read*"
        ],
        "expected_predicates": [
          "/private/tmp/runtime-adv/alias/allow.txt"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:mach_simple_allow:allow-cfprefsd": {
        "probe_id": "adv:mach_simple_allow:allow-cfprefsd",
        "name": "allow-cfprefsd",
        "operation": "mach-lookup",
        "target": "com.apple.cfprefsd.agent",
        "expected": "allow",
        "driver": "sandbox_mach_probe",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "mach-lookup"
        ],
        "expected_predicates": [
          "com.apple.cfprefsd.agent"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:mach_simple_allow:deny-bogus": {
        "probe_id": "adv:mach_simple_allow:deny-bogus",
        "name": "deny-bogus",
        "operation": "mach-lookup",
        "target": "com.apple.sandboxadversarial.fake",
        "expected": "deny",
        "driver": "sandbox_mach_probe",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "mach-lookup"
        ],
        "expected_predicates": [
          "com.apple.sandboxadversarial.fake"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:mach_simple_variants:allow-cfprefsd": {
        "probe_id": "adv:mach_simple_variants:allow-cfprefsd",
        "name": "allow-cfprefsd",
        "operation": "mach-lookup",
        "target": "com.apple.cfprefsd.agent",
        "expected": "allow",
        "driver": "sandbox_mach_probe",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "mach-lookup"
        ],
        "expected_predicates": [
          "com.apple.cfprefsd.agent"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:mach_simple_variants:deny-bogus": {
        "probe_id": "adv:mach_simple_variants:deny-bogus",
        "name": "deny-bogus",
        "operation": "mach-lookup",
        "target": "com.apple.sandboxadversarial.fake",
        "expected": "deny",
        "driver": "sandbox_mach_probe",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "mach-lookup"
        ],
        "expected_predicates": [
          "com.apple.sandboxadversarial.fake"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:mach_local_literal:allow-cfprefsd-local": {
        "probe_id": "adv:mach_local_literal:allow-cfprefsd-local",
        "name": "allow-cfprefsd-local",
        "operation": "mach-lookup",
        "target": "com.apple.cfprefsd.agent",
        "expected": "allow",
        "driver": "sandbox_mach_probe",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "mach-lookup"
        ],
        "expected_predicates": [
          "com.apple.cfprefsd.agent"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:mach_local_literal:deny-bogus-local": {
        "probe_id": "adv:mach_local_literal:deny-bogus-local",
        "name": "deny-bogus-local",
        "operation": "mach-lookup",
        "target": "com.apple.sandboxadversarial.fake",
        "expected": "deny",
        "driver": "sandbox_mach_probe",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "mach-lookup"
        ],
        "expected_predicates": [
          "com.apple.sandboxadversarial.fake"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:mach_local_regex:allow-cfprefsd-local": {
        "probe_id": "adv:mach_local_regex:allow-cfprefsd-local",
        "name": "allow-cfprefsd-local",
        "operation": "mach-lookup",
        "target": "com.apple.cfprefsd.agent",
        "expected": "allow",
        "driver": "sandbox_mach_probe",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "mach-lookup"
        ],
        "expected_predicates": [
          "com.apple.cfprefsd.agent"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:mach_local_regex:deny-bogus-local": {
        "probe_id": "adv:mach_local_regex:deny-bogus-local",
        "name": "deny-bogus-local",
        "operation": "mach-lookup",
        "target": "com.apple.sandboxadversarial.fake",
        "expected": "deny",
        "driver": "sandbox_mach_probe",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "mach-lookup"
        ],
        "expected_predicates": [
          "com.apple.sandboxadversarial.fake"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:net_outbound_allow:tcp-loopback": {
        "probe_id": "adv:net_outbound_allow:tcp-loopback",
        "name": "tcp-loopback",
        "operation": "network-outbound",
        "target": "127.0.0.1:62646",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "network-outbound"
        ],
        "expected_predicates": [
          "127.0.0.1:62646"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:net_outbound_allow:tcp-loopback-2": {
        "probe_id": "adv:net_outbound_allow:tcp-loopback-2",
        "name": "tcp-loopback-2",
        "operation": "network-outbound",
        "target": "127.0.0.1:62647",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "network-outbound"
        ],
        "expected_predicates": [
          "127.0.0.1:62647"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:net_outbound_deny:tcp-loopback": {
        "probe_id": "adv:net_outbound_deny:tcp-loopback",
        "name": "tcp-loopback",
        "operation": "network-outbound",
        "target": "127.0.0.1:62646",
        "expected": "deny",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "network-outbound"
        ],
        "expected_predicates": [
          "127.0.0.1:62646"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:net_outbound_deny:tcp-loopback-2": {
        "probe_id": "adv:net_outbound_deny:tcp-loopback-2",
        "name": "tcp-loopback-2",
        "operation": "network-outbound",
        "target": "127.0.0.1:62647",
        "expected": "deny",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "network-outbound"
        ],
        "expected_predicates": [
          "127.0.0.1:62647"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:flow_divert_require_all_tcp:tcp-loopback": {
        "probe_id": "adv:flow_divert_require_all_tcp:tcp-loopback",
        "name": "tcp-loopback",
        "operation": "network-outbound",
        "target": "127.0.0.1:62646",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "network-outbound"
        ],
        "expected_predicates": [
          "127.0.0.1:62646"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:flow_divert_require_all_tcp:tcp-loopback-2": {
        "probe_id": "adv:flow_divert_require_all_tcp:tcp-loopback-2",
        "name": "tcp-loopback-2",
        "operation": "network-outbound",
        "target": "127.0.0.1:62647",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "network-outbound"
        ],
        "expected_predicates": [
          "127.0.0.1:62647"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:flow_divert_partial_tcp:tcp-loopback": {
        "probe_id": "adv:flow_divert_partial_tcp:tcp-loopback",
        "name": "tcp-loopback",
        "operation": "network-outbound",
        "target": "127.0.0.1:62646",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "network-outbound"
        ],
        "expected_predicates": [
          "127.0.0.1:62646"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      },
      "adv:flow_divert_partial_tcp:tcp-loopback-2": {
        "probe_id": "adv:flow_divert_partial_tcp:tcp-loopback-2",
        "name": "tcp-loopback-2",
        "operation": "network-outbound",
        "target": "127.0.0.1:62647",
        "expected": "allow",
        "supports_lanes": {
          "baseline": true,
          "scenario": true,
          "oracle": true
        },
        "expected_primary_ops": [
          "network-outbound"
        ],
        "expected_predicates": [
          "127.0.0.1:62647"
        ],
        "capabilities_required": [],
        "controls_supported": [
          "baseline",
          "allow_default",
          "deny_default"
        ]
      }
    }
  },
  "profiles": {
    "schema_version": "runtime-tools.profile_registry.v0.1",
    "registry_id": "runtime-adversarial",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
    "profiles": {
      "adv:struct_flat": {
        "profile_id": "adv:struct_flat",
        "profile_path": "book/experiments/runtime-adversarial/sb/struct_flat.sb",
        "mode": "sbpl",
        "family": "structural_variants",
        "semantic_group": "structural:file-read-subpath",
        "probe_refs": [
          "adv:struct_flat:allow-ok-root",
          "adv:struct_flat:allow-ok-deep",
          "adv:struct_flat:deny-blocked",
          "adv:struct_flat:deny-outside",
          "adv:struct_flat:write-ok-root",
          "adv:struct_flat:write-ok-deep",
          "adv:struct_flat:write-blocked",
          "adv:struct_flat:write-outside"
        ],
        "notes": null
      },
      "adv:struct_nested": {
        "profile_id": "adv:struct_nested",
        "profile_path": "book/experiments/runtime-adversarial/sb/struct_nested.sb",
        "mode": "sbpl",
        "family": "structural_variants",
        "semantic_group": "structural:file-read-subpath",
        "probe_refs": [
          "adv:struct_nested:allow-ok-root",
          "adv:struct_nested:allow-ok-deep",
          "adv:struct_nested:deny-blocked",
          "adv:struct_nested:deny-outside",
          "adv:struct_nested:write-ok-root",
          "adv:struct_nested:write-ok-deep",
          "adv:struct_nested:write-blocked",
          "adv:struct_nested:write-outside"
        ],
        "notes": null
      },
      "adv:path_edges": {
        "profile_id": "adv:path_edges",
        "profile_path": "book/experiments/runtime-adversarial/sb/path_edges.sb",
        "mode": "sbpl",
        "family": "path_edges",
        "semantic_group": "paths:literal-vs-normalized",
        "probe_refs": [
          "adv:path_edges:allow-tmp",
          "adv:path_edges:deny-private",
          "adv:path_edges:allow-subpath",
          "adv:path_edges:allow-subpath-normalized",
          "adv:path_edges:deny-dotdot",
          "adv:path_edges:write-tmp",
          "adv:path_edges:write-private",
          "adv:path_edges:write-subpath",
          "adv:path_edges:write-dotdot"
        ],
        "notes": null
      },
      "adv:path_alias": {
        "profile_id": "adv:path_alias",
        "profile_path": "book/experiments/runtime-adversarial/sb/path_alias.sb",
        "mode": "sbpl",
        "family": "path_alias",
        "semantic_group": "paths:alias-canonicalization",
        "probe_refs": [
          "adv:path_alias:alias-tmp",
          "adv:path_alias:alias-private"
        ],
        "notes": null
      },
      "adv:mach_simple_allow": {
        "profile_id": "adv:mach_simple_allow",
        "profile_path": "book/experiments/runtime-adversarial/sb/mach_simple_allow.sb",
        "mode": "sbpl",
        "family": "mach_variants",
        "semantic_group": "mach:global-name-allow",
        "probe_refs": [
          "adv:mach_simple_allow:allow-cfprefsd",
          "adv:mach_simple_allow:deny-bogus"
        ],
        "notes": null
      },
      "adv:mach_simple_variants": {
        "profile_id": "adv:mach_simple_variants",
        "profile_path": "book/experiments/runtime-adversarial/sb/mach_simple_variants.sb",
        "mode": "sbpl",
        "family": "mach_variants",
        "semantic_group": "mach:global-name-allow",
        "probe_refs": [
          "adv:mach_simple_variants:allow-cfprefsd",
          "adv:mach_simple_variants:deny-bogus"
        ],
        "notes": null
      },
      "adv:mach_local_literal": {
        "profile_id": "adv:mach_local_literal",
        "profile_path": "book/experiments/runtime-adversarial/sb/mach_local_literal.sb",
        "mode": "sbpl",
        "family": "mach_local",
        "semantic_group": "mach:local-name-allow",
        "probe_refs": [
          "adv:mach_local_literal:allow-cfprefsd-local",
          "adv:mach_local_literal:deny-bogus-local"
        ],
        "notes": null
      },
      "adv:mach_local_regex": {
        "profile_id": "adv:mach_local_regex",
        "profile_path": "book/experiments/runtime-adversarial/sb/mach_local_regex.sb",
        "mode": "sbpl",
        "family": "mach_local",
        "semantic_group": "mach:local-name-allow",
        "probe_refs": [
          "adv:mach_local_regex:allow-cfprefsd-local",
          "adv:mach_local_regex:deny-bogus-local"
        ],
        "notes": null
      },
      "adv:net_outbound_allow": {
        "profile_id": "adv:net_outbound_allow",
        "profile_path": "book/experiments/runtime-adversarial/sb/net_outbound_allow.sb",
        "mode": "sbpl",
        "family": "network",
        "semantic_group": "network:outbound-allow",
        "probe_refs": [
          "adv:net_outbound_allow:tcp-loopback",
          "adv:net_outbound_allow:tcp-loopback-2"
        ],
        "notes": null
      },
      "adv:net_outbound_deny": {
        "profile_id": "adv:net_outbound_deny",
        "profile_path": "book/experiments/runtime-adversarial/sb/net_outbound_deny.sb",
        "mode": "sbpl",
        "family": "network",
        "semantic_group": "network:outbound-deny",
        "probe_refs": [
          "adv:net_outbound_deny:tcp-loopback",
          "adv:net_outbound_deny:tcp-loopback-2"
        ],
        "notes": null
      },
      "adv:flow_divert_require_all_tcp": {
        "profile_id": "adv:flow_divert_require_all_tcp",
        "profile_path": "book/experiments/runtime-adversarial/sb/flow_divert_require_all_tcp.sb",
        "mode": "sbpl",
        "family": "network",
        "semantic_group": "network:flow-divert-require-all",
        "probe_refs": [
          "adv:flow_divert_require_all_tcp:tcp-loopback",
          "adv:flow_divert_require_all_tcp:tcp-loopback-2"
        ],
        "notes": null
      },
      "adv:flow_divert_partial_tcp": {
        "profile_id": "adv:flow_divert_partial_tcp",
        "profile_path": "book/experiments/runtime-adversarial/sb/flow_divert_partial_tcp.sb",
        "mode": "sbpl",
        "family": "network",
        "semantic_group": "network:flow-divert-partial",
        "probe_refs": [
          "adv:flow_divert_partial_tcp:tcp-loopback",
          "adv:flow_divert_partial_tcp:tcp-loopback-2"
        ],
        "notes": null
      }
    }
  }
}