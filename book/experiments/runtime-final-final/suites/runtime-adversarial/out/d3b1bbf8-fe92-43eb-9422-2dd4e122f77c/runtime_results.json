{
  "adv:flow_divert_partial_tcp": {
    "status": "ok",
    "profile_path": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/flow_divert_partial_tcp.adv_flow_divert_partial_tcp.runtime.sb",
    "base_profile_path": "book/experiments/runtime-adversarial/sb/flow_divert_partial_tcp.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/flow_divert_partial_tcp.adv_flow_divert_partial_tcp.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "tcp-loopback",
        "expectation_id": "adv:flow_divert_partial_tcp:tcp-loopback",
        "operation": "network-outbound",
        "path": "127.0.0.1:62646",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_runner",
            "apply_model": "exec_wrapper",
            "apply_timing": "pre_exec",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_runner",
            "entrypoint_sha256": "7820fa45440400aa64e61fccbb869ac6a1433fc9eb00ff9541dcb4fbbdcc0a62",
            "tool_build_id": "7820fa45440400aa64e61fccbb869ac6a1433fc9eb00ff9541dcb4fbbdcc0a62"
          },
          "seatbelt_callouts": null,
          "sandbox_check_request": null,
          "resource_hygiene": {
            "apply_model": "exec_wrapper",
            "apply_timing": "pre_exec",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_runner",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/flow_divert_partial_tcp.adv_flow_divert_partial_tcp.runtime.sb",
          "--",
          "/usr/bin/nc",
          "-z",
          "-w",
          "2",
          "127.0.0.1",
          "62646"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/flow_divert_partial_tcp.adv_flow_divert_partial_tcp.runtime.sb\",\"pid\":97957}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/flow_divert_partial_tcp.adv_flow_divert_partial_tcp.runtime.sb\",\"pid\":97957}\nConnection to 127.0.0.1 port 62646 [tcp/*] succeeded!\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.321585,
        "cmd_finished_at_unix_s": 1767248742.364649,
        "cmd_duration_s": 0.043064117431640625,
        "listener": {
          "host": "127.0.0.1",
          "port": 62646,
          "status": "ok",
          "error": null,
          "precheck": {
            "status": "ok",
            "error": null
          },
          "accept_count": 2
        }
      },
      {
        "name": "tcp-loopback-2",
        "expectation_id": "adv:flow_divert_partial_tcp:tcp-loopback-2",
        "operation": "network-outbound",
        "path": "127.0.0.1:62647",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_runner",
            "apply_model": "exec_wrapper",
            "apply_timing": "pre_exec",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_runner",
            "entrypoint_sha256": "7820fa45440400aa64e61fccbb869ac6a1433fc9eb00ff9541dcb4fbbdcc0a62",
            "tool_build_id": "7820fa45440400aa64e61fccbb869ac6a1433fc9eb00ff9541dcb4fbbdcc0a62"
          },
          "seatbelt_callouts": null,
          "sandbox_check_request": null,
          "resource_hygiene": {
            "apply_model": "exec_wrapper",
            "apply_timing": "pre_exec",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_runner",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/flow_divert_partial_tcp.adv_flow_divert_partial_tcp.runtime.sb",
          "--",
          "/usr/bin/nc",
          "-z",
          "-w",
          "2",
          "127.0.0.1",
          "62647"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/flow_divert_partial_tcp.adv_flow_divert_partial_tcp.runtime.sb\",\"pid\":97958}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/flow_divert_partial_tcp.adv_flow_divert_partial_tcp.runtime.sb\",\"pid\":97958}\nConnection to 127.0.0.1 port 62647 [tcp/*] succeeded!\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.36571,
        "cmd_finished_at_unix_s": 1767248742.386104,
        "cmd_duration_s": 0.020394086837768555,
        "listener": {
          "host": "127.0.0.1",
          "port": 62647,
          "status": "ok",
          "error": null,
          "precheck": {
            "status": "ok",
            "error": null
          },
          "accept_count": 2
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "d3b1bbf8-fe92-43eb-9422-2dd4e122f77c"
  },
  "adv:flow_divert_require_all_tcp": {
    "status": "ok",
    "profile_path": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/flow_divert_require_all_tcp.adv_flow_divert_require_all_tcp.runtime.sb",
    "base_profile_path": "book/experiments/runtime-adversarial/sb/flow_divert_require_all_tcp.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/flow_divert_require_all_tcp.adv_flow_divert_require_all_tcp.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "tcp-loopback",
        "expectation_id": "adv:flow_divert_require_all_tcp:tcp-loopback",
        "operation": "network-outbound",
        "path": "127.0.0.1:62646",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_runner",
            "apply_model": "exec_wrapper",
            "apply_timing": "pre_exec",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_runner",
            "entrypoint_sha256": "7820fa45440400aa64e61fccbb869ac6a1433fc9eb00ff9541dcb4fbbdcc0a62",
            "tool_build_id": "7820fa45440400aa64e61fccbb869ac6a1433fc9eb00ff9541dcb4fbbdcc0a62"
          },
          "seatbelt_callouts": null,
          "sandbox_check_request": null,
          "resource_hygiene": {
            "apply_model": "exec_wrapper",
            "apply_timing": "pre_exec",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_runner",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/flow_divert_require_all_tcp.adv_flow_divert_require_all_tcp.runtime.sb",
          "--",
          "/usr/bin/nc",
          "-z",
          "-w",
          "2",
          "127.0.0.1",
          "62646"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/flow_divert_require_all_tcp.adv_flow_divert_require_all_tcp.runtime.sb\",\"pid\":97959}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/flow_divert_require_all_tcp.adv_flow_divert_require_all_tcp.runtime.sb\",\"pid\":97959}\nConnection to 127.0.0.1 port 62646 [tcp/*] succeeded!\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.388242,
        "cmd_finished_at_unix_s": 1767248742.403779,
        "cmd_duration_s": 0.015537023544311523,
        "listener": {
          "host": "127.0.0.1",
          "port": 62646,
          "status": "ok",
          "error": null,
          "precheck": {
            "status": "ok",
            "error": null
          },
          "accept_count": 2
        }
      },
      {
        "name": "tcp-loopback-2",
        "expectation_id": "adv:flow_divert_require_all_tcp:tcp-loopback-2",
        "operation": "network-outbound",
        "path": "127.0.0.1:62647",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_runner",
            "apply_model": "exec_wrapper",
            "apply_timing": "pre_exec",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_runner",
            "entrypoint_sha256": "7820fa45440400aa64e61fccbb869ac6a1433fc9eb00ff9541dcb4fbbdcc0a62",
            "tool_build_id": "7820fa45440400aa64e61fccbb869ac6a1433fc9eb00ff9541dcb4fbbdcc0a62"
          },
          "seatbelt_callouts": null,
          "sandbox_check_request": null,
          "resource_hygiene": {
            "apply_model": "exec_wrapper",
            "apply_timing": "pre_exec",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_runner",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/flow_divert_require_all_tcp.adv_flow_divert_require_all_tcp.runtime.sb",
          "--",
          "/usr/bin/nc",
          "-z",
          "-w",
          "2",
          "127.0.0.1",
          "62647"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/flow_divert_require_all_tcp.adv_flow_divert_require_all_tcp.runtime.sb\",\"pid\":97960}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/flow_divert_require_all_tcp.adv_flow_divert_require_all_tcp.runtime.sb\",\"pid\":97960}\nConnection to 127.0.0.1 port 62647 [tcp/*] succeeded!\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.404414,
        "cmd_finished_at_unix_s": 1767248742.417814,
        "cmd_duration_s": 0.013400077819824219,
        "listener": {
          "host": "127.0.0.1",
          "port": 62647,
          "status": "ok",
          "error": null,
          "precheck": {
            "status": "ok",
            "error": null
          },
          "accept_count": 2
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "d3b1bbf8-fe92-43eb-9422-2dd4e122f77c"
  },
  "adv:mach_local_literal": {
    "status": "ok",
    "profile_path": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_local_literal.adv_mach_local_literal.runtime.sb",
    "base_profile_path": "book/experiments/runtime-adversarial/sb/mach_local_literal.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_local_literal.adv_mach_local_literal.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "allow-cfprefsd-local",
        "expectation_id": "adv:mach_local_literal:allow-cfprefsd-local",
        "operation": "mach-lookup",
        "path": "com.apple.cfprefsd.agent",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_mach_probe",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/probes/sandbox_mach_probe",
            "entrypoint_sha256": "90df45ada10852c0254dcc37ce684616699b5c63564e192d3ef123e583998d8e",
            "tool_build_id": "90df45ada10852c0254dcc37ce684616699b5c63564e192d3ef123e583998d8e"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "mach-lookup",
              "filter_type": 6,
              "filter_type_name": "local-name",
              "check_type": 1073741830,
              "varargs_count": 1,
              "argument": "com.apple.cfprefsd.agent",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "mach-lookup",
            "filter_type": 6,
            "filter_name": "local-name",
            "argument": "com.apple.cfprefsd.agent"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/probes/sandbox_mach_probe",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_local_literal.adv_mach_local_literal.runtime.sb",
          "com.apple.cfprefsd.agent"
        ],
        "exit_code": 0,
        "stdout": "{\"kr\":0}\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_local_literal.adv_mach_local_literal.runtime.sb\",\"pid\":97961}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_local_literal.adv_mach_local_literal.runtime.sb\",\"pid\":97961}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"mach-lookup\",\"filter_type\":6,\"filter_type_name\":\"local-name\",\"check_type\":1073741830,\"varargs_count\":1,\"argument\":\"com.apple.cfprefsd.agent\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.419323,
        "cmd_finished_at_unix_s": 1767248742.613868,
        "cmd_duration_s": 0.19454503059387207,
        "sandbox_check_request": {
          "operation": "mach-lookup",
          "filter_type": 6,
          "filter_name": "local-name",
          "argument": "com.apple.cfprefsd.agent"
        }
      },
      {
        "name": "deny-bogus-local",
        "expectation_id": "adv:mach_local_literal:deny-bogus-local",
        "operation": "mach-lookup",
        "path": "com.apple.sandboxadversarial.fake",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 1,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_mach_probe",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/probes/sandbox_mach_probe",
            "entrypoint_sha256": "90df45ada10852c0254dcc37ce684616699b5c63564e192d3ef123e583998d8e",
            "tool_build_id": "90df45ada10852c0254dcc37ce684616699b5c63564e192d3ef123e583998d8e"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "mach-lookup",
              "filter_type": 6,
              "filter_type_name": "local-name",
              "check_type": 1073741830,
              "varargs_count": 1,
              "argument": "com.apple.sandboxadversarial.fake",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "mach-lookup",
            "filter_type": 6,
            "filter_name": "local-name",
            "argument": "com.apple.sandboxadversarial.fake"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": "EPERM",
        "command": [
          "book/api/runtime/native/probes/sandbox_mach_probe",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_local_literal.adv_mach_local_literal.runtime.sb",
          "com.apple.sandboxadversarial.fake"
        ],
        "exit_code": 1,
        "stdout": "{\"kr\":1102}\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_local_literal.adv_mach_local_literal.runtime.sb\",\"pid\":97962}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_local_literal.adv_mach_local_literal.runtime.sb\",\"pid\":97962}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"mach-lookup\",\"filter_type\":6,\"filter_type_name\":\"local-name\",\"check_type\":1073741830,\"varargs_count\":1,\"argument\":\"com.apple.sandboxadversarial.fake\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.615273,
        "cmd_finished_at_unix_s": 1767248742.632284,
        "cmd_duration_s": 0.017010927200317383,
        "sandbox_check_request": {
          "operation": "mach-lookup",
          "filter_type": 6,
          "filter_name": "local-name",
          "argument": "com.apple.sandboxadversarial.fake"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "d3b1bbf8-fe92-43eb-9422-2dd4e122f77c"
  },
  "adv:mach_local_regex": {
    "status": "ok",
    "profile_path": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_local_regex.adv_mach_local_regex.runtime.sb",
    "base_profile_path": "book/experiments/runtime-adversarial/sb/mach_local_regex.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_local_regex.adv_mach_local_regex.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "allow-cfprefsd-local",
        "expectation_id": "adv:mach_local_regex:allow-cfprefsd-local",
        "operation": "mach-lookup",
        "path": "com.apple.cfprefsd.agent",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_mach_probe",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/probes/sandbox_mach_probe",
            "entrypoint_sha256": "90df45ada10852c0254dcc37ce684616699b5c63564e192d3ef123e583998d8e",
            "tool_build_id": "90df45ada10852c0254dcc37ce684616699b5c63564e192d3ef123e583998d8e"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "mach-lookup",
              "filter_type": 6,
              "filter_type_name": "local-name",
              "check_type": 1073741830,
              "varargs_count": 1,
              "argument": "com.apple.cfprefsd.agent",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "mach-lookup",
            "filter_type": 6,
            "filter_name": "local-name",
            "argument": "com.apple.cfprefsd.agent"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/probes/sandbox_mach_probe",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_local_regex.adv_mach_local_regex.runtime.sb",
          "com.apple.cfprefsd.agent"
        ],
        "exit_code": 0,
        "stdout": "{\"kr\":0}\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_local_regex.adv_mach_local_regex.runtime.sb\",\"pid\":97963}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_local_regex.adv_mach_local_regex.runtime.sb\",\"pid\":97963}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"mach-lookup\",\"filter_type\":6,\"filter_type_name\":\"local-name\",\"check_type\":1073741830,\"varargs_count\":1,\"argument\":\"com.apple.cfprefsd.agent\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.634082,
        "cmd_finished_at_unix_s": 1767248742.6462872,
        "cmd_duration_s": 0.012205123901367188,
        "sandbox_check_request": {
          "operation": "mach-lookup",
          "filter_type": 6,
          "filter_name": "local-name",
          "argument": "com.apple.cfprefsd.agent"
        }
      },
      {
        "name": "deny-bogus-local",
        "expectation_id": "adv:mach_local_regex:deny-bogus-local",
        "operation": "mach-lookup",
        "path": "com.apple.sandboxadversarial.fake",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 1,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_mach_probe",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/probes/sandbox_mach_probe",
            "entrypoint_sha256": "90df45ada10852c0254dcc37ce684616699b5c63564e192d3ef123e583998d8e",
            "tool_build_id": "90df45ada10852c0254dcc37ce684616699b5c63564e192d3ef123e583998d8e"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "mach-lookup",
              "filter_type": 6,
              "filter_type_name": "local-name",
              "check_type": 1073741830,
              "varargs_count": 1,
              "argument": "com.apple.sandboxadversarial.fake",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "mach-lookup",
            "filter_type": 6,
            "filter_name": "local-name",
            "argument": "com.apple.sandboxadversarial.fake"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": "EPERM",
        "command": [
          "book/api/runtime/native/probes/sandbox_mach_probe",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_local_regex.adv_mach_local_regex.runtime.sb",
          "com.apple.sandboxadversarial.fake"
        ],
        "exit_code": 1,
        "stdout": "{\"kr\":1102}\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_local_regex.adv_mach_local_regex.runtime.sb\",\"pid\":97964}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_local_regex.adv_mach_local_regex.runtime.sb\",\"pid\":97964}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"mach-lookup\",\"filter_type\":6,\"filter_type_name\":\"local-name\",\"check_type\":1073741830,\"varargs_count\":1,\"argument\":\"com.apple.sandboxadversarial.fake\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.6468768,
        "cmd_finished_at_unix_s": 1767248742.657047,
        "cmd_duration_s": 0.010170221328735352,
        "sandbox_check_request": {
          "operation": "mach-lookup",
          "filter_type": 6,
          "filter_name": "local-name",
          "argument": "com.apple.sandboxadversarial.fake"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "d3b1bbf8-fe92-43eb-9422-2dd4e122f77c"
  },
  "adv:mach_simple_allow": {
    "status": "ok",
    "profile_path": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_simple_allow.adv_mach_simple_allow.runtime.sb",
    "base_profile_path": "book/experiments/runtime-adversarial/sb/mach_simple_allow.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_simple_allow.adv_mach_simple_allow.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "allow-cfprefsd",
        "expectation_id": "adv:mach_simple_allow:allow-cfprefsd",
        "operation": "mach-lookup",
        "path": "com.apple.cfprefsd.agent",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_mach_probe",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/probes/sandbox_mach_probe",
            "entrypoint_sha256": "90df45ada10852c0254dcc37ce684616699b5c63564e192d3ef123e583998d8e",
            "tool_build_id": "90df45ada10852c0254dcc37ce684616699b5c63564e192d3ef123e583998d8e"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "mach-lookup",
              "filter_type": 5,
              "filter_type_name": "global-name",
              "check_type": 1073741829,
              "varargs_count": 1,
              "argument": "com.apple.cfprefsd.agent",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "mach-lookup",
            "filter_type": 5,
            "filter_name": "global-name",
            "argument": "com.apple.cfprefsd.agent"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/probes/sandbox_mach_probe",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_simple_allow.adv_mach_simple_allow.runtime.sb",
          "com.apple.cfprefsd.agent"
        ],
        "exit_code": 0,
        "stdout": "{\"kr\":0}\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_simple_allow.adv_mach_simple_allow.runtime.sb\",\"pid\":97965}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_simple_allow.adv_mach_simple_allow.runtime.sb\",\"pid\":97965}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"mach-lookup\",\"filter_type\":5,\"filter_type_name\":\"global-name\",\"check_type\":1073741829,\"varargs_count\":1,\"argument\":\"com.apple.cfprefsd.agent\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.6585479,
        "cmd_finished_at_unix_s": 1767248742.667563,
        "cmd_duration_s": 0.009015083312988281,
        "sandbox_check_request": {
          "operation": "mach-lookup",
          "filter_type": 5,
          "filter_name": "global-name",
          "argument": "com.apple.cfprefsd.agent"
        }
      },
      {
        "name": "deny-bogus",
        "expectation_id": "adv:mach_simple_allow:deny-bogus",
        "operation": "mach-lookup",
        "path": "com.apple.sandboxadversarial.fake",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 1,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_mach_probe",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/probes/sandbox_mach_probe",
            "entrypoint_sha256": "90df45ada10852c0254dcc37ce684616699b5c63564e192d3ef123e583998d8e",
            "tool_build_id": "90df45ada10852c0254dcc37ce684616699b5c63564e192d3ef123e583998d8e"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "mach-lookup",
              "filter_type": 5,
              "filter_type_name": "global-name",
              "check_type": 1073741829,
              "varargs_count": 1,
              "argument": "com.apple.sandboxadversarial.fake",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "mach-lookup",
            "filter_type": 5,
            "filter_name": "global-name",
            "argument": "com.apple.sandboxadversarial.fake"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": "EPERM",
        "command": [
          "book/api/runtime/native/probes/sandbox_mach_probe",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_simple_allow.adv_mach_simple_allow.runtime.sb",
          "com.apple.sandboxadversarial.fake"
        ],
        "exit_code": 1,
        "stdout": "{\"kr\":1100}\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_simple_allow.adv_mach_simple_allow.runtime.sb\",\"pid\":97966}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_simple_allow.adv_mach_simple_allow.runtime.sb\",\"pid\":97966}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"mach-lookup\",\"filter_type\":5,\"filter_type_name\":\"global-name\",\"check_type\":1073741829,\"varargs_count\":1,\"argument\":\"com.apple.sandboxadversarial.fake\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.668056,
        "cmd_finished_at_unix_s": 1767248742.6761,
        "cmd_duration_s": 0.008044004440307617,
        "sandbox_check_request": {
          "operation": "mach-lookup",
          "filter_type": 5,
          "filter_name": "global-name",
          "argument": "com.apple.sandboxadversarial.fake"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "d3b1bbf8-fe92-43eb-9422-2dd4e122f77c"
  },
  "adv:mach_simple_variants": {
    "status": "ok",
    "profile_path": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_simple_variants.adv_mach_simple_variants.runtime.sb",
    "base_profile_path": "book/experiments/runtime-adversarial/sb/mach_simple_variants.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_simple_variants.adv_mach_simple_variants.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "allow-cfprefsd",
        "expectation_id": "adv:mach_simple_variants:allow-cfprefsd",
        "operation": "mach-lookup",
        "path": "com.apple.cfprefsd.agent",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_mach_probe",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/probes/sandbox_mach_probe",
            "entrypoint_sha256": "90df45ada10852c0254dcc37ce684616699b5c63564e192d3ef123e583998d8e",
            "tool_build_id": "90df45ada10852c0254dcc37ce684616699b5c63564e192d3ef123e583998d8e"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "mach-lookup",
              "filter_type": 5,
              "filter_type_name": "global-name",
              "check_type": 1073741829,
              "varargs_count": 1,
              "argument": "com.apple.cfprefsd.agent",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "mach-lookup",
            "filter_type": 5,
            "filter_name": "global-name",
            "argument": "com.apple.cfprefsd.agent"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/probes/sandbox_mach_probe",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_simple_variants.adv_mach_simple_variants.runtime.sb",
          "com.apple.cfprefsd.agent"
        ],
        "exit_code": 0,
        "stdout": "{\"kr\":0}\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_simple_variants.adv_mach_simple_variants.runtime.sb\",\"pid\":97967}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_simple_variants.adv_mach_simple_variants.runtime.sb\",\"pid\":97967}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"mach-lookup\",\"filter_type\":5,\"filter_type_name\":\"global-name\",\"check_type\":1073741829,\"varargs_count\":1,\"argument\":\"com.apple.cfprefsd.agent\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.6773162,
        "cmd_finished_at_unix_s": 1767248742.684603,
        "cmd_duration_s": 0.007286787033081055,
        "sandbox_check_request": {
          "operation": "mach-lookup",
          "filter_type": 5,
          "filter_name": "global-name",
          "argument": "com.apple.cfprefsd.agent"
        }
      },
      {
        "name": "deny-bogus",
        "expectation_id": "adv:mach_simple_variants:deny-bogus",
        "operation": "mach-lookup",
        "path": "com.apple.sandboxadversarial.fake",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 1,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_mach_probe",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/probes/sandbox_mach_probe",
            "entrypoint_sha256": "90df45ada10852c0254dcc37ce684616699b5c63564e192d3ef123e583998d8e",
            "tool_build_id": "90df45ada10852c0254dcc37ce684616699b5c63564e192d3ef123e583998d8e"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "mach-lookup",
              "filter_type": 5,
              "filter_type_name": "global-name",
              "check_type": 1073741829,
              "varargs_count": 1,
              "argument": "com.apple.sandboxadversarial.fake",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 0,
              "errno": 0,
              "decision": "allow",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "mach-lookup",
            "filter_type": 5,
            "filter_name": "global-name",
            "argument": "com.apple.sandboxadversarial.fake"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": "EPERM",
        "command": [
          "book/api/runtime/native/probes/sandbox_mach_probe",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_simple_variants.adv_mach_simple_variants.runtime.sb",
          "com.apple.sandboxadversarial.fake"
        ],
        "exit_code": 1,
        "stdout": "{\"kr\":1100}\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_simple_variants.adv_mach_simple_variants.runtime.sb\",\"pid\":97968}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/mach_simple_variants.adv_mach_simple_variants.runtime.sb\",\"pid\":97968}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"mach-lookup\",\"filter_type\":5,\"filter_type_name\":\"global-name\",\"check_type\":1073741829,\"varargs_count\":1,\"argument\":\"com.apple.sandboxadversarial.fake\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.684999,
        "cmd_finished_at_unix_s": 1767248742.691691,
        "cmd_duration_s": 0.006691932678222656,
        "sandbox_check_request": {
          "operation": "mach-lookup",
          "filter_type": 5,
          "filter_name": "global-name",
          "argument": "com.apple.sandboxadversarial.fake"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "d3b1bbf8-fe92-43eb-9422-2dd4e122f77c"
  },
  "adv:net_outbound_allow": {
    "status": "ok",
    "profile_path": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/net_outbound_allow.adv_net_outbound_allow.runtime.sb",
    "base_profile_path": "book/experiments/runtime-adversarial/sb/net_outbound_allow.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/net_outbound_allow.adv_net_outbound_allow.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "tcp-loopback",
        "expectation_id": "adv:net_outbound_allow:tcp-loopback",
        "operation": "network-outbound",
        "path": "127.0.0.1:62646",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_runner",
            "apply_model": "exec_wrapper",
            "apply_timing": "pre_exec",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_runner",
            "entrypoint_sha256": "7820fa45440400aa64e61fccbb869ac6a1433fc9eb00ff9541dcb4fbbdcc0a62",
            "tool_build_id": "7820fa45440400aa64e61fccbb869ac6a1433fc9eb00ff9541dcb4fbbdcc0a62"
          },
          "seatbelt_callouts": null,
          "sandbox_check_request": null,
          "resource_hygiene": {
            "apply_model": "exec_wrapper",
            "apply_timing": "pre_exec",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_runner",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/net_outbound_allow.adv_net_outbound_allow.runtime.sb",
          "--",
          "/usr/bin/nc",
          "-z",
          "-w",
          "2",
          "127.0.0.1",
          "62646"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/net_outbound_allow.adv_net_outbound_allow.runtime.sb\",\"pid\":97969}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/net_outbound_allow.adv_net_outbound_allow.runtime.sb\",\"pid\":97969}\nConnection to 127.0.0.1 port 62646 [tcp/*] succeeded!\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.692765,
        "cmd_finished_at_unix_s": 1767248742.705036,
        "cmd_duration_s": 0.012270927429199219,
        "listener": {
          "host": "127.0.0.1",
          "port": 62646,
          "status": "ok",
          "error": null,
          "precheck": {
            "status": "ok",
            "error": null
          },
          "accept_count": 2
        }
      },
      {
        "name": "tcp-loopback-2",
        "expectation_id": "adv:net_outbound_allow:tcp-loopback-2",
        "operation": "network-outbound",
        "path": "127.0.0.1:62647",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_runner",
            "apply_model": "exec_wrapper",
            "apply_timing": "pre_exec",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_runner",
            "entrypoint_sha256": "7820fa45440400aa64e61fccbb869ac6a1433fc9eb00ff9541dcb4fbbdcc0a62",
            "tool_build_id": "7820fa45440400aa64e61fccbb869ac6a1433fc9eb00ff9541dcb4fbbdcc0a62"
          },
          "seatbelt_callouts": null,
          "sandbox_check_request": null,
          "resource_hygiene": {
            "apply_model": "exec_wrapper",
            "apply_timing": "pre_exec",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_runner",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/net_outbound_allow.adv_net_outbound_allow.runtime.sb",
          "--",
          "/usr/bin/nc",
          "-z",
          "-w",
          "2",
          "127.0.0.1",
          "62647"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/net_outbound_allow.adv_net_outbound_allow.runtime.sb\",\"pid\":97970}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/net_outbound_allow.adv_net_outbound_allow.runtime.sb\",\"pid\":97970}\nConnection to 127.0.0.1 port 62647 [tcp/*] succeeded!\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.705546,
        "cmd_finished_at_unix_s": 1767248742.7174468,
        "cmd_duration_s": 0.011900901794433594,
        "listener": {
          "host": "127.0.0.1",
          "port": 62647,
          "status": "ok",
          "error": null,
          "precheck": {
            "status": "ok",
            "error": null
          },
          "accept_count": 2
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "d3b1bbf8-fe92-43eb-9422-2dd4e122f77c"
  },
  "adv:net_outbound_deny": {
    "status": "ok",
    "profile_path": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/net_outbound_deny.adv_net_outbound_deny.runtime.sb",
    "base_profile_path": "book/experiments/runtime-adversarial/sb/net_outbound_deny.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/net_outbound_deny.adv_net_outbound_deny.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "tcp-loopback",
        "expectation_id": "adv:net_outbound_deny:tcp-loopback",
        "operation": "network-outbound",
        "path": "127.0.0.1:62646",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 1,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_runner",
            "apply_model": "exec_wrapper",
            "apply_timing": "pre_exec",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_runner",
            "entrypoint_sha256": "7820fa45440400aa64e61fccbb869ac6a1433fc9eb00ff9541dcb4fbbdcc0a62",
            "tool_build_id": "7820fa45440400aa64e61fccbb869ac6a1433fc9eb00ff9541dcb4fbbdcc0a62"
          },
          "seatbelt_callouts": null,
          "sandbox_check_request": null,
          "resource_hygiene": {
            "apply_model": "exec_wrapper",
            "apply_timing": "pre_exec",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": "EPERM",
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_runner",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/net_outbound_deny.adv_net_outbound_deny.runtime.sb",
          "--",
          "/usr/bin/nc",
          "-z",
          "-w",
          "2",
          "127.0.0.1",
          "62646"
        ],
        "exit_code": 1,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/net_outbound_deny.adv_net_outbound_deny.runtime.sb\",\"pid\":97971}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/net_outbound_deny.adv_net_outbound_deny.runtime.sb\",\"pid\":97971}\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.718708,
        "cmd_finished_at_unix_s": 1767248742.7276149,
        "cmd_duration_s": 0.008906841278076172,
        "listener": {
          "host": "127.0.0.1",
          "port": 62646,
          "status": "ok",
          "error": null,
          "precheck": {
            "status": "ok",
            "error": null
          },
          "accept_count": 1
        }
      },
      {
        "name": "tcp-loopback-2",
        "expectation_id": "adv:net_outbound_deny:tcp-loopback-2",
        "operation": "network-outbound",
        "path": "127.0.0.1:62647",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 1,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_runner",
            "apply_model": "exec_wrapper",
            "apply_timing": "pre_exec",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_runner",
            "entrypoint_sha256": "7820fa45440400aa64e61fccbb869ac6a1433fc9eb00ff9541dcb4fbbdcc0a62",
            "tool_build_id": "7820fa45440400aa64e61fccbb869ac6a1433fc9eb00ff9541dcb4fbbdcc0a62"
          },
          "seatbelt_callouts": null,
          "sandbox_check_request": null,
          "resource_hygiene": {
            "apply_model": "exec_wrapper",
            "apply_timing": "pre_exec",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": "EPERM",
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_runner",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/net_outbound_deny.adv_net_outbound_deny.runtime.sb",
          "--",
          "/usr/bin/nc",
          "-z",
          "-w",
          "2",
          "127.0.0.1",
          "62647"
        ],
        "exit_code": 1,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/net_outbound_deny.adv_net_outbound_deny.runtime.sb\",\"pid\":97972}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/net_outbound_deny.adv_net_outbound_deny.runtime.sb\",\"pid\":97972}\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.728122,
        "cmd_finished_at_unix_s": 1767248742.7373,
        "cmd_duration_s": 0.009177923202514648,
        "listener": {
          "host": "127.0.0.1",
          "port": 62647,
          "status": "ok",
          "error": null,
          "precheck": {
            "status": "ok",
            "error": null
          },
          "accept_count": 1
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "d3b1bbf8-fe92-43eb-9422-2dd4e122f77c"
  },
  "adv:path_alias": {
    "status": "ok",
    "profile_path": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_alias.adv_path_alias.runtime.sb",
    "base_profile_path": "book/experiments/runtime-adversarial/sb/path_alias.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_alias.adv_path_alias.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "alias-tmp",
        "expectation_id": "adv:path_alias:alias-tmp",
        "operation": "file-read*",
        "path": "/tmp/runtime-adv/alias/allow.txt",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/alias/allow.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/alias/allow.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/alias/allow.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_alias.adv_path_alias.runtime.sb",
          "/tmp/runtime-adv/alias/allow.txt"
        ],
        "exit_code": 0,
        "stdout": "runtime-adv fixture for /tmp/runtime-adv/alias/allow.txt\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_alias.adv_path_alias.runtime.sb\",\"pid\":97973}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_alias.adv_path_alias.runtime.sb\",\"pid\":97973}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/alias/allow.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/alias/allow.txt\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/alias/allow.txt\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.738522,
        "cmd_finished_at_unix_s": 1767248742.954348,
        "cmd_duration_s": 0.21582603454589844,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/alias/allow.txt"
        }
      },
      {
        "name": "alias-private",
        "expectation_id": "adv:path_alias:alias-private",
        "operation": "file-read*",
        "path": "/private/tmp/runtime-adv/alias/allow.txt",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/runtime-adv/alias/allow.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/runtime-adv/alias/allow.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/alias/allow.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_alias.adv_path_alias.runtime.sb",
          "/private/tmp/runtime-adv/alias/allow.txt"
        ],
        "exit_code": 0,
        "stdout": "runtime-adv fixture for /tmp/runtime-adv/alias/allow.txt\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_alias.adv_path_alias.runtime.sb\",\"pid\":97974}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_alias.adv_path_alias.runtime.sb\",\"pid\":97974}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/runtime-adv/alias/allow.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/alias/allow.txt\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/alias/allow.txt\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.955667,
        "cmd_finished_at_unix_s": 1767248742.9718442,
        "cmd_duration_s": 0.01617717742919922,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/runtime-adv/alias/allow.txt"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "d3b1bbf8-fe92-43eb-9422-2dd4e122f77c"
  },
  "adv:path_edges": {
    "status": "partial",
    "profile_path": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
    "base_profile_path": "book/experiments/runtime-adversarial/sb/path_edges.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "allow-tmp",
        "expectation_id": "adv:path_edges:allow-tmp",
        "operation": "file-read*",
        "path": "/tmp/runtime-adv/edges/a",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/edges/a",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/edges/a"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/a",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
          "/tmp/runtime-adv/edges/a"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97975}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97975}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/a\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.9738991,
        "cmd_finished_at_unix_s": 1767248742.990187,
        "cmd_duration_s": 0.016287803649902344,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/edges/a"
        }
      },
      {
        "name": "deny-private",
        "expectation_id": "adv:path_edges:deny-private",
        "operation": "file-read*",
        "path": "/private/tmp/runtime-adv/edges/a",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/runtime-adv/edges/a",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/runtime-adv/edges/a"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/a",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
          "/private/tmp/runtime-adv/edges/a"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97976}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97976}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/runtime-adv/edges/a\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248742.9911602,
        "cmd_finished_at_unix_s": 1767248743.017838,
        "cmd_duration_s": 0.026677846908569336,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/runtime-adv/edges/a"
        }
      },
      {
        "name": "allow-subpath",
        "expectation_id": "adv:path_edges:allow-subpath",
        "operation": "file-read*",
        "path": "/tmp/runtime-adv/edges/okdir/item.txt",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/edges/okdir/item.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
          "/tmp/runtime-adv/edges/okdir/item.txt"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97977}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97977}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/okdir/item.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.0189729,
        "cmd_finished_at_unix_s": 1767248743.0321972,
        "cmd_duration_s": 0.013224363327026367,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/edges/okdir/item.txt"
        }
      },
      {
        "name": "allow-subpath-normalized",
        "expectation_id": "adv:path_edges:allow-subpath-normalized",
        "operation": "file-read*",
        "path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/runtime-adv/edges/okdir/item.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/runtime-adv/edges/okdir/item.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
          "/private/tmp/runtime-adv/edges/okdir/item.txt"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97978}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97978}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/runtime-adv/edges/okdir/item.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.032702,
        "cmd_finished_at_unix_s": 1767248743.0418391,
        "cmd_duration_s": 0.009137153625488281,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/runtime-adv/edges/okdir/item.txt"
        }
      },
      {
        "name": "deny-dotdot",
        "expectation_id": "adv:path_edges:deny-dotdot",
        "operation": "file-read*",
        "path": "/tmp/runtime-adv/edges/okdir/../blocked.txt",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/edges/okdir/../blocked.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/edges/okdir/../blocked.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/blocked.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
          "/tmp/runtime-adv/edges/okdir/../blocked.txt"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97979}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97979}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/okdir/../blocked.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.0425138,
        "cmd_finished_at_unix_s": 1767248743.051489,
        "cmd_duration_s": 0.00897526741027832,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/edges/okdir/../blocked.txt"
        }
      },
      {
        "name": "write-tmp",
        "expectation_id": "adv:path_edges:write-tmp",
        "operation": "file-write*",
        "path": "/tmp/runtime-adv/edges/a",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
            "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/edges/a",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/edges/a"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/a",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
          "/tmp/runtime-adv/edges/a"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97980}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97980}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/a\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.05198,
        "cmd_finished_at_unix_s": 1767248743.268909,
        "cmd_duration_s": 0.21692895889282227,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/edges/a"
        }
      },
      {
        "name": "write-private",
        "expectation_id": "adv:path_edges:write-private",
        "operation": "file-write*",
        "path": "/private/tmp/runtime-adv/edges/a",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
            "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/runtime-adv/edges/a",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/runtime-adv/edges/a"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/a",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
          "/private/tmp/runtime-adv/edges/a"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97981}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97981}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/runtime-adv/edges/a\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.270015,
        "cmd_finished_at_unix_s": 1767248743.282284,
        "cmd_duration_s": 0.012269020080566406,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/runtime-adv/edges/a"
        }
      },
      {
        "name": "write-subpath",
        "expectation_id": "adv:path_edges:write-subpath",
        "operation": "file-write*",
        "path": "/tmp/runtime-adv/edges/okdir/item.txt",
        "expected": "allow",
        "actual": "deny",
        "match": false,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
            "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/edges/okdir/item.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
          "/tmp/runtime-adv/edges/okdir/item.txt"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97982}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97982}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/okdir/item.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.282803,
        "cmd_finished_at_unix_s": 1767248743.292136,
        "cmd_duration_s": 0.009332895278930664,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/edges/okdir/item.txt"
        }
      },
      {
        "name": "write-dotdot",
        "expectation_id": "adv:path_edges:write-dotdot",
        "operation": "file-write*",
        "path": "/tmp/runtime-adv/edges/okdir/../blocked.txt",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
            "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/edges/okdir/../blocked.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/edges/okdir/../blocked.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/blocked.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb",
          "/tmp/runtime-adv/edges/okdir/../blocked.txt"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97983}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges.adv_path_edges.runtime.sb\",\"pid\":97983}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/okdir/../blocked.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.292692,
        "cmd_finished_at_unix_s": 1767248743.302607,
        "cmd_duration_s": 0.00991511344909668,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/edges/okdir/../blocked.txt"
        }
      }
    ],
    "notes": "runtime results diverged from expected allow/deny matrix",
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "d3b1bbf8-fe92-43eb-9422-2dd4e122f77c"
  },
  "adv:struct_flat": {
    "status": "ok",
    "profile_path": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb",
    "base_profile_path": "book/experiments/runtime-adversarial/sb/struct_flat.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "allow-ok-root",
        "expectation_id": "adv:struct_flat:allow-ok-root",
        "operation": "file-read*",
        "path": "/tmp/runtime-adv/struct/ok/allowed.txt",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/struct/ok/allowed.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/struct/ok/allowed.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/struct/ok/allowed.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb",
          "/tmp/runtime-adv/struct/ok/allowed.txt"
        ],
        "exit_code": 0,
        "stdout": "runtime-adv fixture for /tmp/runtime-adv/struct/ok/allowed.txt\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb\",\"pid\":97984}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb\",\"pid\":97984}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/struct/ok/allowed.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/struct/ok/allowed.txt\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/struct/ok/allowed.txt\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.304907,
        "cmd_finished_at_unix_s": 1767248743.314028,
        "cmd_duration_s": 0.009120941162109375,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/struct/ok/allowed.txt"
        }
      },
      {
        "name": "allow-ok-deep",
        "expectation_id": "adv:struct_flat:allow-ok-deep",
        "operation": "file-read*",
        "path": "/tmp/runtime-adv/struct/ok/deep/nested.txt",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/struct/ok/deep/nested.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/struct/ok/deep/nested.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/struct/ok/deep/nested.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb",
          "/tmp/runtime-adv/struct/ok/deep/nested.txt"
        ],
        "exit_code": 0,
        "stdout": "runtime-adv fixture for /tmp/runtime-adv/struct/ok/deep/nested.txt\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb\",\"pid\":97985}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb\",\"pid\":97985}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/struct/ok/deep/nested.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/struct/ok/deep/nested.txt\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/struct/ok/deep/nested.txt\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.31458,
        "cmd_finished_at_unix_s": 1767248743.324374,
        "cmd_duration_s": 0.009793996810913086,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/struct/ok/deep/nested.txt"
        }
      },
      {
        "name": "deny-blocked",
        "expectation_id": "adv:struct_flat:deny-blocked",
        "operation": "file-read*",
        "path": "/tmp/runtime-adv/struct/blocked.txt",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/struct/blocked.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/struct/blocked.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/struct/blocked.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb",
          "/tmp/runtime-adv/struct/blocked.txt"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb\",\"pid\":97986}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb\",\"pid\":97986}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/struct/blocked.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.325015,
        "cmd_finished_at_unix_s": 1767248743.333735,
        "cmd_duration_s": 0.008719921112060547,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/struct/blocked.txt"
        }
      },
      {
        "name": "deny-outside",
        "expectation_id": "adv:struct_flat:deny-outside",
        "operation": "file-read*",
        "path": "/tmp/runtime-adv/struct/outside.txt",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/struct/outside.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/struct/outside.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/struct/outside.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb",
          "/tmp/runtime-adv/struct/outside.txt"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb\",\"pid\":97987}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb\",\"pid\":97987}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/struct/outside.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.334431,
        "cmd_finished_at_unix_s": 1767248743.343065,
        "cmd_duration_s": 0.008634090423583984,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/struct/outside.txt"
        }
      },
      {
        "name": "write-ok-root",
        "expectation_id": "adv:struct_flat:write-ok-root",
        "operation": "file-write*",
        "path": "/tmp/runtime-adv/struct/ok/allowed.txt",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
            "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/struct/ok/allowed.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/struct/ok/allowed.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/struct/ok/allowed.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb",
          "/tmp/runtime-adv/struct/ok/allowed.txt"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb\",\"pid\":97988}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb\",\"pid\":97988}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/struct/ok/allowed.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/struct/ok/allowed.txt\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/struct/ok/allowed.txt\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.343578,
        "cmd_finished_at_unix_s": 1767248743.35266,
        "cmd_duration_s": 0.009081840515136719,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/struct/ok/allowed.txt"
        }
      },
      {
        "name": "write-ok-deep",
        "expectation_id": "adv:struct_flat:write-ok-deep",
        "operation": "file-write*",
        "path": "/tmp/runtime-adv/struct/ok/deep/nested.txt",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
            "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/struct/ok/deep/nested.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/struct/ok/deep/nested.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/struct/ok/deep/nested.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb",
          "/tmp/runtime-adv/struct/ok/deep/nested.txt"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb\",\"pid\":97989}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb\",\"pid\":97989}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/struct/ok/deep/nested.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/struct/ok/deep/nested.txt\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/struct/ok/deep/nested.txt\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.353142,
        "cmd_finished_at_unix_s": 1767248743.3611991,
        "cmd_duration_s": 0.008057117462158203,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/struct/ok/deep/nested.txt"
        }
      },
      {
        "name": "write-blocked",
        "expectation_id": "adv:struct_flat:write-blocked",
        "operation": "file-write*",
        "path": "/tmp/runtime-adv/struct/blocked.txt",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
            "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/struct/blocked.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/struct/blocked.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/struct/blocked.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb",
          "/tmp/runtime-adv/struct/blocked.txt"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb\",\"pid\":97990}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb\",\"pid\":97990}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/struct/blocked.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.361619,
        "cmd_finished_at_unix_s": 1767248743.369358,
        "cmd_duration_s": 0.007739067077636719,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/struct/blocked.txt"
        }
      },
      {
        "name": "write-outside",
        "expectation_id": "adv:struct_flat:write-outside",
        "operation": "file-write*",
        "path": "/tmp/runtime-adv/struct/outside.txt",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
            "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/struct/outside.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/struct/outside.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/struct/outside.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb",
          "/tmp/runtime-adv/struct/outside.txt"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb\",\"pid\":97991}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_flat.adv_struct_flat.runtime.sb\",\"pid\":97991}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/struct/outside.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.369833,
        "cmd_finished_at_unix_s": 1767248743.377176,
        "cmd_duration_s": 0.0073430538177490234,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/struct/outside.txt"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "d3b1bbf8-fe92-43eb-9422-2dd4e122f77c"
  },
  "adv:struct_nested": {
    "status": "ok",
    "profile_path": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb",
    "base_profile_path": "book/experiments/runtime-adversarial/sb/struct_nested.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "allow-ok-root",
        "expectation_id": "adv:struct_nested:allow-ok-root",
        "operation": "file-read*",
        "path": "/tmp/runtime-adv/struct/ok/allowed.txt",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/struct/ok/allowed.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/struct/ok/allowed.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/struct/ok/allowed.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb",
          "/tmp/runtime-adv/struct/ok/allowed.txt"
        ],
        "exit_code": 0,
        "stdout": "runtime-adv fixture for /tmp/runtime-adv/struct/ok/allowed.txt\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb\",\"pid\":97992}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb\",\"pid\":97992}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/struct/ok/allowed.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/struct/ok/allowed.txt\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/struct/ok/allowed.txt\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.3785431,
        "cmd_finished_at_unix_s": 1767248743.3862882,
        "cmd_duration_s": 0.007745027542114258,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/struct/ok/allowed.txt"
        }
      },
      {
        "name": "allow-ok-deep",
        "expectation_id": "adv:struct_nested:allow-ok-deep",
        "operation": "file-read*",
        "path": "/tmp/runtime-adv/struct/ok/deep/nested.txt",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/struct/ok/deep/nested.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/struct/ok/deep/nested.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/struct/ok/deep/nested.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb",
          "/tmp/runtime-adv/struct/ok/deep/nested.txt"
        ],
        "exit_code": 0,
        "stdout": "runtime-adv fixture for /tmp/runtime-adv/struct/ok/deep/nested.txt\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb\",\"pid\":97993}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb\",\"pid\":97993}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/struct/ok/deep/nested.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/struct/ok/deep/nested.txt\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/struct/ok/deep/nested.txt\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.3867369,
        "cmd_finished_at_unix_s": 1767248743.39394,
        "cmd_duration_s": 0.007203102111816406,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/struct/ok/deep/nested.txt"
        }
      },
      {
        "name": "deny-blocked",
        "expectation_id": "adv:struct_nested:deny-blocked",
        "operation": "file-read*",
        "path": "/tmp/runtime-adv/struct/blocked.txt",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/struct/blocked.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/struct/blocked.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/struct/blocked.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb",
          "/tmp/runtime-adv/struct/blocked.txt"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb\",\"pid\":97994}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb\",\"pid\":97994}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/struct/blocked.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.394376,
        "cmd_finished_at_unix_s": 1767248743.40191,
        "cmd_duration_s": 0.007534027099609375,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/struct/blocked.txt"
        }
      },
      {
        "name": "deny-outside",
        "expectation_id": "adv:struct_nested:deny-outside",
        "operation": "file-read*",
        "path": "/tmp/runtime-adv/struct/outside.txt",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/struct/outside.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/struct/outside.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/struct/outside.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb",
          "/tmp/runtime-adv/struct/outside.txt"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb\",\"pid\":97995}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb\",\"pid\":97995}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/struct/outside.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.4023302,
        "cmd_finished_at_unix_s": 1767248743.409626,
        "cmd_duration_s": 0.007295846939086914,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/struct/outside.txt"
        }
      },
      {
        "name": "write-ok-root",
        "expectation_id": "adv:struct_nested:write-ok-root",
        "operation": "file-write*",
        "path": "/tmp/runtime-adv/struct/ok/allowed.txt",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
            "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/struct/ok/allowed.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/struct/ok/allowed.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/struct/ok/allowed.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb",
          "/tmp/runtime-adv/struct/ok/allowed.txt"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb\",\"pid\":97996}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb\",\"pid\":97996}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/struct/ok/allowed.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/struct/ok/allowed.txt\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/struct/ok/allowed.txt\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.410058,
        "cmd_finished_at_unix_s": 1767248743.4179351,
        "cmd_duration_s": 0.007877111434936523,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/struct/ok/allowed.txt"
        }
      },
      {
        "name": "write-ok-deep",
        "expectation_id": "adv:struct_nested:write-ok-deep",
        "operation": "file-write*",
        "path": "/tmp/runtime-adv/struct/ok/deep/nested.txt",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
            "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/struct/ok/deep/nested.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/struct/ok/deep/nested.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/struct/ok/deep/nested.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb",
          "/tmp/runtime-adv/struct/ok/deep/nested.txt"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb\",\"pid\":97997}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb\",\"pid\":97997}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/struct/ok/deep/nested.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/struct/ok/deep/nested.txt\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/struct/ok/deep/nested.txt\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.4183831,
        "cmd_finished_at_unix_s": 1767248743.4260962,
        "cmd_duration_s": 0.0077130794525146484,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/struct/ok/deep/nested.txt"
        }
      },
      {
        "name": "write-blocked",
        "expectation_id": "adv:struct_nested:write-blocked",
        "operation": "file-write*",
        "path": "/tmp/runtime-adv/struct/blocked.txt",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
            "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/struct/blocked.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/struct/blocked.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/struct/blocked.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb",
          "/tmp/runtime-adv/struct/blocked.txt"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb\",\"pid\":97998}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb\",\"pid\":97998}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/struct/blocked.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.4265459,
        "cmd_finished_at_unix_s": 1767248743.4343522,
        "cmd_duration_s": 0.007806301116943359,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/struct/blocked.txt"
        }
      },
      {
        "name": "write-outside",
        "expectation_id": "adv:struct_nested:write-outside",
        "operation": "file-write*",
        "path": "/tmp/runtime-adv/struct/outside.txt",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
            "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/struct/outside.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/struct/outside.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/struct/outside.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb",
          "/tmp/runtime-adv/struct/outside.txt"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb\",\"pid\":97999}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/struct_nested.adv_struct_nested.runtime.sb\",\"pid\":97999}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/struct/outside.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.4348118,
        "cmd_finished_at_unix_s": 1767248743.442351,
        "cmd_duration_s": 0.007539272308349609,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/struct/outside.txt"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "d3b1bbf8-fe92-43eb-9422-2dd4e122f77c"
  },
  "adv:path_edges_private": {
    "status": "ok",
    "profile_path": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb",
    "base_profile_path": "book/experiments/runtime-adversarial/sb/path_edges_private.sb",
    "preflight": {
      "tool": "book/tools/preflight",
      "preflight_schema_version": 1,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb",
      "classification": "no_known_apply_gate_signature",
      "signature": null,
      "findings": []
    },
    "probes": [
      {
        "name": "allow-private",
        "expectation_id": "adv:path_edges_private:allow-private",
        "operation": "file-read*",
        "path": "/private/tmp/runtime-adv/edges/a",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/runtime-adv/edges/a",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/runtime-adv/edges/a"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/a",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb",
          "/private/tmp/runtime-adv/edges/a"
        ],
        "exit_code": 0,
        "stdout": "runtime-adv fixture for /tmp/runtime-adv/edges/a\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98000}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98000}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/runtime-adv/edges/a\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/edges/a\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/edges/a\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.44408,
        "cmd_finished_at_unix_s": 1767248743.451995,
        "cmd_duration_s": 0.00791478157043457,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/runtime-adv/edges/a"
        }
      },
      {
        "name": "allow-private-subpath",
        "expectation_id": "adv:path_edges_private:allow-private-subpath",
        "operation": "file-read*",
        "path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/runtime-adv/edges/okdir/item.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/runtime-adv/edges/okdir/item.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb",
          "/private/tmp/runtime-adv/edges/okdir/item.txt"
        ],
        "exit_code": 0,
        "stdout": "runtime-adv fixture for /tmp/runtime-adv/edges/okdir/item.txt\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98001}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98001}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/runtime-adv/edges/okdir/item.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/edges/okdir/item.txt\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/edges/okdir/item.txt\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.45247,
        "cmd_finished_at_unix_s": 1767248743.4598348,
        "cmd_duration_s": 0.007364749908447266,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/runtime-adv/edges/okdir/item.txt"
        }
      },
      {
        "name": "allow-tmp",
        "expectation_id": "adv:path_edges_private:allow-tmp",
        "operation": "file-read*",
        "path": "/tmp/runtime-adv/edges/a",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/edges/a",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/edges/a"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/a",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb",
          "/tmp/runtime-adv/edges/a"
        ],
        "exit_code": 0,
        "stdout": "runtime-adv fixture for /tmp/runtime-adv/edges/a\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98002}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98002}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/a\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/edges/a\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/edges/a\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.460198,
        "cmd_finished_at_unix_s": 1767248743.467469,
        "cmd_duration_s": 0.0072710514068603516,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/edges/a"
        }
      },
      {
        "name": "allow-tmp-subpath",
        "expectation_id": "adv:path_edges_private:allow-tmp-subpath",
        "operation": "file-read*",
        "path": "/tmp/runtime-adv/edges/okdir/item.txt",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/edges/okdir/item.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb",
          "/tmp/runtime-adv/edges/okdir/item.txt"
        ],
        "exit_code": 0,
        "stdout": "runtime-adv fixture for /tmp/runtime-adv/edges/okdir/item.txt\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\nruntime-check\n",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98003}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98003}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/okdir/item.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/edges/okdir/item.txt\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/edges/okdir/item.txt\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.467959,
        "cmd_finished_at_unix_s": 1767248743.475252,
        "cmd_duration_s": 0.007292985916137695,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/edges/okdir/item.txt"
        }
      },
      {
        "name": "deny-dotdot",
        "expectation_id": "adv:path_edges_private:deny-dotdot",
        "operation": "file-read*",
        "path": "/private/tmp/runtime-adv/edges/okdir/../blocked.txt",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_reader",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_reader",
            "entrypoint_sha256": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15",
            "tool_build_id": "83bb1dcc3f78e430be04ce95b32d2e4bea893260ab4b1eb4219c9be8d161db15"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-read-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/runtime-adv/edges/okdir/../blocked.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-read-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/runtime-adv/edges/okdir/../blocked.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/blocked.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_reader",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb",
          "/private/tmp/runtime-adv/edges/okdir/../blocked.txt"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98004}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98004}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-read-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/runtime-adv/edges/okdir/../blocked.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.475635,
        "cmd_finished_at_unix_s": 1767248743.4825358,
        "cmd_duration_s": 0.006900787353515625,
        "sandbox_check_request": {
          "operation": "file-read-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/runtime-adv/edges/okdir/../blocked.txt"
        }
      },
      {
        "name": "write-private",
        "expectation_id": "adv:path_edges_private:write-private",
        "operation": "file-write*",
        "path": "/private/tmp/runtime-adv/edges/a",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
            "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/runtime-adv/edges/a",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/runtime-adv/edges/a"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/a",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb",
          "/private/tmp/runtime-adv/edges/a"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98005}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98005}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/runtime-adv/edges/a\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/edges/a\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/edges/a\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.482933,
        "cmd_finished_at_unix_s": 1767248743.490716,
        "cmd_duration_s": 0.007782936096191406,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/runtime-adv/edges/a"
        }
      },
      {
        "name": "write-private-subpath",
        "expectation_id": "adv:path_edges_private:write-private-subpath",
        "operation": "file-write*",
        "path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
            "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/runtime-adv/edges/okdir/item.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/runtime-adv/edges/okdir/item.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb",
          "/private/tmp/runtime-adv/edges/okdir/item.txt"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98006}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98006}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/runtime-adv/edges/okdir/item.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/edges/okdir/item.txt\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/edges/okdir/item.txt\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.4911401,
        "cmd_finished_at_unix_s": 1767248743.4980638,
        "cmd_duration_s": 0.006923675537109375,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/runtime-adv/edges/okdir/item.txt"
        }
      },
      {
        "name": "write-tmp",
        "expectation_id": "adv:path_edges_private:write-tmp",
        "operation": "file-write*",
        "path": "/tmp/runtime-adv/edges/a",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
            "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/edges/a",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/edges/a"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/a",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb",
          "/tmp/runtime-adv/edges/a"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98007}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98007}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/a\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/edges/a\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/edges/a\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.498441,
        "cmd_finished_at_unix_s": 1767248743.50575,
        "cmd_duration_s": 0.0073089599609375,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/edges/a"
        }
      },
      {
        "name": "write-tmp-subpath",
        "expectation_id": "adv:path_edges_private:write-tmp-subpath",
        "operation": "file-write*",
        "path": "/tmp/runtime-adv/edges/okdir/item.txt",
        "expected": "allow",
        "actual": "allow",
        "match": true,
        "runtime_result": {
          "status": "success",
          "errno": null,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": null,
          "failure_kind": null,
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
            "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/tmp/runtime-adv/edges/okdir/item.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/tmp/runtime-adv/edges/okdir/item.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb",
          "/tmp/runtime-adv/edges/okdir/item.txt"
        ],
        "exit_code": 0,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98008}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98008}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/tmp/runtime-adv/edges/okdir/item.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nF_GETPATH:/private/tmp/runtime-adv/edges/okdir/item.txt\nF_GETPATH_NOFIRMLINK:/System/Volumes/Data/private/tmp/runtime-adv/edges/okdir/item.txt\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.506189,
        "cmd_finished_at_unix_s": 1767248743.513272,
        "cmd_duration_s": 0.007082939147949219,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/tmp/runtime-adv/edges/okdir/item.txt"
        }
      },
      {
        "name": "write-dotdot",
        "expectation_id": "adv:path_edges_private:write-dotdot",
        "operation": "file-write*",
        "path": "/private/tmp/runtime-adv/edges/okdir/../blocked.txt",
        "expected": "deny",
        "actual": "deny",
        "match": true,
        "runtime_result": {
          "status": "errno",
          "errno": 2,
          "runtime_result_schema_version": 1,
          "tool_marker_schema_version": 2,
          "failure_stage": "probe",
          "failure_kind": "probe_nonzero_exit",
          "apply_report": {
            "api": "sandbox_init",
            "rc": 0,
            "errno": 0,
            "errbuf": null,
            "err_class": "ok",
            "err_class_source": "none"
          },
          "runner_info": {
            "entrypoint": "sandbox_writer",
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "entrypoint_path": "book/api/runtime/native/sandbox_runner/sandbox_writer",
            "entrypoint_sha256": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433",
            "tool_build_id": "c1a3e997a50e7877d795abb0468d0121cfbf06159dfb0e6c7bb9eecbfa69c433"
          },
          "seatbelt_callouts": [
            {
              "tool": "seatbelt-callout",
              "marker_schema_version": 2,
              "stage": "pre_syscall",
              "api": "sandbox_check",
              "operation": "file-write-data",
              "filter_type": 0,
              "filter_type_name": "path",
              "check_type": 1073741824,
              "varargs_count": 1,
              "argument": "/private/tmp/runtime-adv/edges/okdir/../blocked.txt",
              "no_report": true,
              "token_status": "pid",
              "token_mach_kr": 0,
              "rc": 1,
              "errno": 0,
              "decision": "deny",
              "no_report_reason": null
            }
          ],
          "sandbox_check_request": {
            "operation": "file-write-data",
            "filter_type": 0,
            "filter_name": "path",
            "argument": "/private/tmp/runtime-adv/edges/okdir/../blocked.txt"
          },
          "resource_hygiene": {
            "apply_model": "self_apply",
            "apply_timing": "pre_syscall",
            "preexisting_sandbox_suspected": false,
            "close_fds": true,
            "pass_fds": []
          }
        },
        "violation_summary": null,
        "path_observation": {
          "observed_path": "/private/tmp/runtime-adv/edges/blocked.txt",
          "observed_path_source": "unsandboxed_fd_path",
          "observed_path_errno": null,
          "observed_path_nofirmlink": null,
          "observed_path_nofirmlink_source": "unsandboxed_unavailable",
          "observed_path_nofirmlink_errno": null
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_writer",
          "book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb",
          "/private/tmp/runtime-adv/edges/okdir/../blocked.txt"
        ],
        "exit_code": 2,
        "stdout": "",
        "stderr": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98009}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/book/experiments/runtime-adversarial/out/d3b1bbf8-fe92-43eb-9422-2dd4e122f77c/runtime_profiles/path_edges_private.adv_path_edges_private.runtime.sb\",\"pid\":98009}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check\",\"operation\":\"file-write-data\",\"filter_type\":0,\"filter_type_name\":\"path\",\"check_type\":1073741824,\"varargs_count\":1,\"argument\":\"/private/tmp/runtime-adv/edges/okdir/../blocked.txt\",\"no_report\":true,\"token_status\":\"pid\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\nopen target: Operation not permitted\n",
        "probe_details": null,
        "cmd_started_at_unix_s": 1767248743.513671,
        "cmd_finished_at_unix_s": 1767248743.521129,
        "cmd_duration_s": 0.0074579715728759766,
        "sandbox_check_request": {
          "operation": "file-write-data",
          "filter_type": 0,
          "filter_name": "path",
          "argument": "/private/tmp/runtime-adv/edges/okdir/../blocked.txt"
        }
      }
    ],
    "schema_version": "runtime-tools.runtime_results.v0.1",
    "run_id": "d3b1bbf8-fe92-43eb-9422-2dd4e122f77c"
  }
}