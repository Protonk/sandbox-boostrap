{
  "bundle": null,
  "capture_sandbox_logs": false,
  "command": [
    "book/tools/witness/PolicyWitness.app/Contents/MacOS/policy-witness",
    "xpc",
    "run",
    "--profile",
    "minimal",
    "--plan-id",
    "policywitness-deny-atlas:smoke:smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3",
    "--row-id",
    "minimal.fs_op_listdir_home_documents",
    "fs_op",
    "--op",
    "listdir",
    "--path",
    "/Users/achyland/Documents",
    "--allow-unsafe-path"
  ],
  "correlation_id": null,
  "duration_s": 0.05328488349914551,
  "entrypoint": "book/tools/witness/PolicyWitness.app/Contents/MacOS/policy-witness",
  "evidence_tier": "mapped",
  "exit_code": 1,
  "finished_at_unix_s": 1767228281.910918,
  "lifecycle": {
    "correlation_id": "9F5DF0B9-86E9-4099-92A8-85F0AB1B40D3",
    "evidence_tier": "mapped",
    "file_path": "/Users/achyland/Documents",
    "plan_id": "policywitness-deny-atlas:smoke:smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3",
    "process_name": "ProbeService_minimal",
    "profile_id": "minimal",
    "row_id": "minimal.fs_op_listdir_home_documents",
    "service_id": "com.yourteam.policy-witness.ProbeService_minimal",
    "service_pid": "78001",
    "tmp_dir": "/Users/achyland/Library/Containers/com.yourteam.policy-witness.ProbeService_minimal/Data/tmp/"
  },
  "log_path": "book/experiments/policywitness-deny-atlas/out/smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3/logs/policywitness-deny-atlas_smoke_smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3.minimal.fs_op_listdir_home_documents.fs_op.json",
  "log_write_error": null,
  "observer": {
    "command": [
      "book/tools/witness/PolicyWitness.app/Contents/MacOS/sandbox-log-observer",
      "--pid",
      "78001",
      "--process-name",
      "ProbeService_minimal",
      "--format",
      "json",
      "--start",
      "2025-12-31 16:44:39",
      "--end",
      "2025-12-31 16:44:43",
      "--plan-id",
      "policywitness-deny-atlas:smoke:smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3",
      "--row-id",
      "minimal.fs_op_listdir_home_documents",
      "--correlation-id",
      "9F5DF0B9-86E9-4099-92A8-85F0AB1B40D3"
    ],
    "correlation_id": "9F5DF0B9-86E9-4099-92A8-85F0AB1B40D3",
    "exit_code": 0,
    "last": "10s",
    "log_path": "book/experiments/policywitness-deny-atlas/out/smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3/logs/observer/policywitness-deny-atlas_smoke_smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3.minimal.fs_op_listdir_home_documents.fs_op.json.observer.json",
    "log_write_error": null,
    "observer_window_end": "2025-12-31 16:44:43",
    "observer_window_mode": "range",
    "observer_window_pad_s": 2.0,
    "observer_window_start": "2025-12-31 16:44:39",
    "pid": "78001",
    "plan_id": "policywitness-deny-atlas:smoke:smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3",
    "process_name": "ProbeService_minimal",
    "report": {
      "data": {
        "correlation_id": "9F5DF0B9-86E9-4099-92A8-85F0AB1B40D3",
        "deny_lines": [],
        "duration_ms": null,
        "end": "2025-12-31 16:44:43",
        "last": null,
        "layer_attribution": {
          "seatbelt": "observer_only"
        },
        "log_error": null,
        "log_rc": 0,
        "log_stderr": "",
        "log_stdout": "Timestamp                       (process)[PID]    ",
        "log_truncated": false,
        "mode": "show",
        "observed_deny": false,
        "observed_lines": 1,
        "observer_schema_version": 1,
        "pid": 78001,
        "plan_id": "policywitness-deny-atlas:smoke:smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3",
        "predicate": "((eventMessage CONTAINS[c] \"Sandbox: ProbeService_minimal(78001)\") OR ((eventMessage CONTAINS[c] \"deny\") AND (eventMessage CONTAINS[c] \"78001\")))",
        "process_name": "ProbeService_minimal",
        "row_id": "minimal.fs_op_listdir_home_documents",
        "start": "2025-12-31 16:44:39",
        "stop_on_pid_exit": false
      },
      "generated_at_unix_ms": 1767228282186,
      "kind": "sandbox_log_observer_report",
      "result": {
        "errno": null,
        "error": null,
        "exit_code": 0,
        "normalized_outcome": null,
        "ok": true,
        "rc": null,
        "stderr": null,
        "stdout": null
      },
      "schema_version": 1
    },
    "report_error": null,
    "row_id": "minimal.fs_op_listdir_home_documents",
    "stderr": "",
    "stdout_bytes": 1249
  },
  "observer_log_path": "book/experiments/policywitness-deny-atlas/out/smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3/logs/observer/policywitness-deny-atlas_smoke_smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3.minimal.fs_op_listdir_home_documents.fs_op.json.observer.json",
  "observer_status": "ok",
  "plan_id": "policywitness-deny-atlas:smoke:smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3",
  "probe_args": [
    "--op",
    "listdir",
    "--path",
    "/Users/achyland/Documents",
    "--allow-unsafe-path"
  ],
  "probe_error": null,
  "probe_id": "fs_op",
  "probe_timeout_s": 25.0,
  "profile_id": "minimal",
  "record_write_error": null,
  "row_id": "minimal.fs_op_listdir_home_documents",
  "runner_info": {
    "entrypoint": "policy-witness",
    "entrypoint_path": "book/tools/witness/PolicyWitness.app/Contents/MacOS/policy-witness",
    "entrypoint_sha256": "70932a56ecb32fc5e87b70ee3c144c200c3377d2bbdc288739ea385177aa4b24",
    "tool_build_id": "70932a56ecb32fc5e87b70ee3c144c200c3377d2bbdc288739ea385177aa4b24"
  },
  "service_id": null,
  "started_at_unix_s": 1767228281.857633,
  "stderr": "",
  "stdout": "{\"data\":{\"argv\":[\"--op\",\"listdir\",\"--path\",\"\\/Users\\/achyland\\/Documents\",\"--allow-unsafe-path\"],\"correlation_id\":\"9F5DF0B9-86E9-4099-92A8-85F0AB1B40D3\",\"details\":{\"base_dir\":\"\",\"bundle_id\":\"com.yourteam.policy-witness.ProbeService_minimal\",\"cleanup_mode\":\"default\",\"correlation_id\":\"9F5DF0B9-86E9-4099-92A8-85F0AB1B40D3\",\"cwd\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.policy-witness.ProbeService_minimal\\/Data\",\"duration_ms\":\"4\",\"file_path\":\"\\/Users\\/achyland\\/Documents\",\"harness_dir\":\"\",\"home_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.policy-witness.ProbeService_minimal\\/Data\",\"op\":\"listdir\",\"path_class\":\"\",\"path_mode\":\"direct_path\",\"pid\":\"78001\",\"probe_family\":\"fs_op\",\"probe_pid\":\"78001\",\"process_name\":\"ProbeService_minimal\",\"run_dir\":\"\",\"service_pid\":\"78001\",\"session_token\":\"9C2847C2-CDFE-4D73-B2F9-68A0DA7C8F67\",\"target\":\"base\",\"tmp_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.policy-witness.ProbeService_minimal\\/Data\\/tmp\\/\"},\"ended_at_iso8601\":\"2026-01-01T00:44:41.906Z\",\"errno\":1,\"error\":\"Error Domain=NSCocoaErrorDomain Code=257 \\\"The file \u201cDocuments\u201d couldn\u2019t be opened because you don\u2019t have permission to view it.\\\" UserInfo={NSUserStringVariant=(\\n    Folder\\n), NSURL=file:\\/\\/\\/Users\\/achyland\\/Documents, NSFilePath=\\/Users\\/achyland\\/Documents, NSUnderlyingError=0x6000001e80c0 {Error Domain=NSPOSIXErrorDomain Code=1 \\\"Operation not permitted\\\"}}\",\"normalized_outcome\":\"permission_error\",\"plan_id\":\"policywitness-deny-atlas:smoke:smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3\",\"probe_id\":\"fs_op\",\"rc\":1,\"row_id\":\"minimal.fs_op_listdir_home_documents\",\"schema_version\":1,\"service_build\":\"2\",\"service_bundle_id\":\"com.yourteam.policy-witness.ProbeService_minimal\",\"service_name\":\"ProbeService_minimal\",\"service_version\":\"2.0.0\",\"started_at_iso8601\":\"2026-01-01T00:44:41.902Z\",\"stderr\":\"\",\"stdout\":\"\",\"thread_id\":\"4355\"},\"generated_at_unix_ms\":1767228281908,\"kind\":\"probe_response\",\"result\":{\"errno\":1,\"error\":\"Error Domain=NSCocoaErrorDomain Code=257 \\\"The file \u201cDocuments\u201d couldn\u2019t be opened because you don\u2019t have permission to view it.\\\" UserInfo={NSUserStringVariant=(\\n    Folder\\n), NSURL=file:\\/\\/\\/Users\\/achyland\\/Documents, NSFilePath=\\/Users\\/achyland\\/Documents, NSUnderlyingError=0x6000001e80c0 {Error Domain=NSPOSIXErrorDomain Code=1 \\\"Operation not permitted\\\"}}\",\"exit_code\":1,\"normalized_outcome\":\"permission_error\",\"ok\":false,\"rc\":1},\"schema_version\":1}\n",
  "stdout_json": {
    "data": {
      "argv": [
        "--op",
        "listdir",
        "--path",
        "/Users/achyland/Documents",
        "--allow-unsafe-path"
      ],
      "correlation_id": "9F5DF0B9-86E9-4099-92A8-85F0AB1B40D3",
      "details": {
        "base_dir": "",
        "bundle_id": "com.yourteam.policy-witness.ProbeService_minimal",
        "cleanup_mode": "default",
        "correlation_id": "9F5DF0B9-86E9-4099-92A8-85F0AB1B40D3",
        "cwd": "/Users/achyland/Library/Containers/com.yourteam.policy-witness.ProbeService_minimal/Data",
        "duration_ms": "4",
        "file_path": "/Users/achyland/Documents",
        "harness_dir": "",
        "home_dir": "/Users/achyland/Library/Containers/com.yourteam.policy-witness.ProbeService_minimal/Data",
        "op": "listdir",
        "path_class": "",
        "path_mode": "direct_path",
        "pid": "78001",
        "probe_family": "fs_op",
        "probe_pid": "78001",
        "process_name": "ProbeService_minimal",
        "run_dir": "",
        "service_pid": "78001",
        "session_token": "9C2847C2-CDFE-4D73-B2F9-68A0DA7C8F67",
        "target": "base",
        "tmp_dir": "/Users/achyland/Library/Containers/com.yourteam.policy-witness.ProbeService_minimal/Data/tmp/"
      },
      "ended_at_iso8601": "2026-01-01T00:44:41.906Z",
      "errno": 1,
      "error": "Error Domain=NSCocoaErrorDomain Code=257 \"The file \u201cDocuments\u201d couldn\u2019t be opened because you don\u2019t have permission to view it.\" UserInfo={NSUserStringVariant=(\n    Folder\n), NSURL=file:///Users/achyland/Documents, NSFilePath=/Users/achyland/Documents, NSUnderlyingError=0x6000001e80c0 {Error Domain=NSPOSIXErrorDomain Code=1 \"Operation not permitted\"}}",
      "normalized_outcome": "permission_error",
      "plan_id": "policywitness-deny-atlas:smoke:smoke-162aeb4f-6e86-4ff7-a664-73f923e642e3",
      "probe_id": "fs_op",
      "rc": 1,
      "row_id": "minimal.fs_op_listdir_home_documents",
      "schema_version": 1,
      "service_build": "2",
      "service_bundle_id": "com.yourteam.policy-witness.ProbeService_minimal",
      "service_name": "ProbeService_minimal",
      "service_version": "2.0.0",
      "started_at_iso8601": "2026-01-01T00:44:41.902Z",
      "stderr": "",
      "stdout": "",
      "thread_id": "4355"
    },
    "generated_at_unix_ms": 1767228281908,
    "kind": "probe_response",
    "result": {
      "errno": 1,
      "error": "Error Domain=NSCocoaErrorDomain Code=257 \"The file \u201cDocuments\u201d couldn\u2019t be opened because you don\u2019t have permission to view it.\" UserInfo={NSUserStringVariant=(\n    Folder\n), NSURL=file:///Users/achyland/Documents, NSFilePath=/Users/achyland/Documents, NSUnderlyingError=0x6000001e80c0 {Error Domain=NSPOSIXErrorDomain Code=1 \"Operation not permitted\"}}",
      "exit_code": 1,
      "normalized_outcome": "permission_error",
      "ok": false,
      "rc": 1
    },
    "schema_version": 1
  },
  "stdout_json_error": null,
  "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
}
