{"data":{"correlation_id":"frida-testing:ej-frida.f4f3f252-74d1-4bf7-a10c-3ba1940896df","event":"session_ready","message":"session opened","pid":54323,"plan_id":"frida-testing:ej-frida","service_bundle_id":"com.yourteam.entitlement-jail.ProbeService_fully_injectable_extensions","service_name":"ProbeService_fully_injectable_extensions","session_token":"89AC77C7-3237-4EBA-B89B-0B82679E3F78","wait_mode":"fifo","wait_path":"\/Users\/achyland\/Library\/Containers\/com.yourteam.entitlement-jail.ProbeService_fully_injectable_extensions\/Data\/tmp\/entitlement-jail-session\/wait.B40DA5F4-820E-40E2-84B8-C5EAC785EA87.fifo"},"generated_at_unix_ms":1766856873052,"kind":"xpc_session_event","result":{"exit_code":0,"normalized_outcome":"ok","ok":true,"rc":0},"schema_version":2}
{"data":{"correlation_id":"frida-testing:ej-frida.f4f3f252-74d1-4bf7-a10c-3ba1940896df","event":"wait_ready","message":"wait configured","pid":54323,"plan_id":"frida-testing:ej-frida","service_bundle_id":"com.yourteam.entitlement-jail.ProbeService_fully_injectable_extensions","service_name":"ProbeService_fully_injectable_extensions","session_token":"89AC77C7-3237-4EBA-B89B-0B82679E3F78","wait_mode":"fifo","wait_path":"\/Users\/achyland\/Library\/Containers\/com.yourteam.entitlement-jail.ProbeService_fully_injectable_extensions\/Data\/tmp\/entitlement-jail-session\/wait.B40DA5F4-820E-40E2-84B8-C5EAC785EA87.fifo"},"generated_at_unix_ms":1766856873052,"kind":"xpc_session_event","result":{"exit_code":0,"normalized_outcome":"ok","ok":true,"rc":0},"schema_version":2}
{"data":{"correlation_id":"frida-testing:ej-frida.f4f3f252-74d1-4bf7-a10c-3ba1940896df","event":"trigger_received","pid":54323,"plan_id":"frida-testing:ej-frida","service_bundle_id":"com.yourteam.entitlement-jail.ProbeService_fully_injectable_extensions","service_name":"ProbeService_fully_injectable_extensions","session_token":"89AC77C7-3237-4EBA-B89B-0B82679E3F78","trigger_bytes":1,"wait_mode":"fifo","wait_path":"\/Users\/achyland\/Library\/Containers\/com.yourteam.entitlement-jail.ProbeService_fully_injectable_extensions\/Data\/tmp\/entitlement-jail-session\/wait.B40DA5F4-820E-40E2-84B8-C5EAC785EA87.fifo"},"generated_at_unix_ms":1766856873765,"kind":"xpc_session_event","result":{"exit_code":0,"normalized_outcome":"ok","ok":true,"rc":0},"schema_version":2}
{"data":{"correlation_id":"frida-testing:ej-frida.f4f3f252-74d1-4bf7-a10c-3ba1940896df","event":"probe_starting","pid":54323,"plan_id":"frida-testing:ej-frida","probe_argv":[],"probe_id":"probe_catalog","service_bundle_id":"com.yourteam.entitlement-jail.ProbeService_fully_injectable_extensions","service_name":"ProbeService_fully_injectable_extensions","session_token":"89AC77C7-3237-4EBA-B89B-0B82679E3F78","wait_mode":"fifo","wait_path":"\/Users\/achyland\/Library\/Containers\/com.yourteam.entitlement-jail.ProbeService_fully_injectable_extensions\/Data\/tmp\/entitlement-jail-session\/wait.B40DA5F4-820E-40E2-84B8-C5EAC785EA87.fifo"},"generated_at_unix_ms":1766856873765,"kind":"xpc_session_event","result":{"exit_code":0,"normalized_outcome":"ok","ok":true,"rc":0},"schema_version":2}
{"data":{"correlation_id":"frida-testing:ej-frida.f4f3f252-74d1-4bf7-a10c-3ba1940896df","event":"probe_done","message":"normalized_outcome=ok rc=0","pid":54323,"plan_id":"frida-testing:ej-frida","probe_argv":[],"probe_id":"probe_catalog","service_bundle_id":"com.yourteam.entitlement-jail.ProbeService_fully_injectable_extensions","service_name":"ProbeService_fully_injectable_extensions","session_token":"89AC77C7-3237-4EBA-B89B-0B82679E3F78","wait_mode":"fifo","wait_path":"\/Users\/achyland\/Library\/Containers\/com.yourteam.entitlement-jail.ProbeService_fully_injectable_extensions\/Data\/tmp\/entitlement-jail-session\/wait.B40DA5F4-820E-40E2-84B8-C5EAC785EA87.fifo"},"generated_at_unix_ms":1766856873768,"kind":"xpc_session_event","result":{"exit_code":0,"normalized_outcome":"ok","ok":true,"rc":0},"schema_version":2}
{"data":{"argv":[],"correlation_id":"frida-testing:ej-frida.f4f3f252-74d1-4bf7-a10c-3ba1940896df","details":{"bundle_id":"com.yourteam.entitlement-jail.ProbeService_fully_injectable_extensions","correlation_id":"frida-testing:ej-frida.f4f3f252-74d1-4bf7-a10c-3ba1940896df","cwd":"\/Users\/achyland\/Library\/Containers\/com.yourteam.entitlement-jail.ProbeService_fully_injectable_extensions\/Data","home_dir":"\/Users\/achyland\/Library\/Containers\/com.yourteam.entitlement-jail.ProbeService_fully_injectable_extensions\/Data","pid":"54323","probe_count":"19","probe_family":"probe_catalog","probe_pid":"54323","process_name":"ProbeService_fully_injectable_extensions","service_pid":"54323","session_token":"89AC77C7-3237-4EBA-B89B-0B82679E3F78","tmp_dir":"\/Users\/achyland\/Library\/Containers\/com.yourteam.entitlement-jail.ProbeService_fully_injectable_extensions\/Data\/tmp\/"},"ended_at_iso8601":"2025-12-27T17:34:33.768Z","normalized_outcome":"ok","plan_id":"frida-testing:ej-frida","probe_id":"probe_catalog","rc":0,"schema_version":2,"service_build":"2","service_bundle_id":"com.yourteam.entitlement-jail.ProbeService_fully_injectable_extensions","service_name":"ProbeService_fully_injectable_extensions","service_version":"2.0.0","started_at_iso8601":"2025-12-27T17:34:33.766Z","stderr":"","stdout":"{\"generated_at_iso8601\":\"2025-12-27T17:34:33Z\",\"probes\":[{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"probe_catalog\"],\"notes\":[\"Outputs JSON in RunProbeResponse.stdout.\",\"Use <probe-id> --help for per-probe usage.\"],\"optional_args\":[],\"probe_id\":\"probe_catalog\",\"required_args\":[],\"summary\":\"emit a JSON catalog of available probes\",\"usage\":\"probe_catalog\"},{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"world_shape\"],\"notes\":[\"Reports HOME\\\/TMP\\\/CWD and containerization signals.\"],\"optional_args\":[],\"probe_id\":\"world_shape\",\"required_args\":[],\"summary\":\"report containerization and world shape metadata\",\"usage\":\"world_shape\"},{\"entitlement_hints\":[\"com.apple.security.network.client\"],\"examples\":[\"network_tcp_connect --host 1.1.1.1 --port 443\"],\"notes\":[],\"optional_args\":[],\"probe_id\":\"network_tcp_connect\",\"required_args\":[\"--host <ipv4>\",\"--port <1..65535>\"],\"summary\":\"attempt a TCP connect to an IPv4 host:port\",\"usage\":\"network_tcp_connect --host <ipv4> --port <1..65535>\"},{\"entitlement_hints\":[\"com.apple.security.files.downloads.read-write\"],\"examples\":[\"downloads_rw\",\"downloads_rw --name demo.txt\"],\"notes\":[\"Writes under Downloads\\\/entitlement-jail-harness.\"],\"optional_args\":[\"--name <file-name>\"],\"probe_id\":\"downloads_rw\",\"required_args\":[],\"summary\":\"read\\\/write\\\/remove a file under Downloads\\\/entitlement-jail-harness\",\"usage\":\"downloads_rw [--name <file-name>]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_op --op stat --path-class downloads\",\"fs_op --op create --path-class tmp --target run_dir\"],\"notes\":[\"Destructive direct-path ops are refused unless you use --path-class\\\/--target (or a path under *\\\/entitlement-jail-harness\\\/*) or set --allow-unsafe-path.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--name <file-name>\",\"--to <path> | --to-path <path> | --to-name <file-name>\",\"--max-entries <n>\",\"--allow-unsafe-path\"],\"probe_id\":\"fs_op\",\"required_args\":[\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\"],\"summary\":\"parameterized filesystem operations\",\"usage\":\"fs_op --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\n      (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n      [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\n      [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_op_wait --op open_read --path-class tmp --wait-fifo \\\/tmp\\\/ej-wait.fifo\",\"fs_op_wait --op stat --path \\\/tmp\\\/target --wait-exists \\\/tmp\\\/trigger --wait-timeout-ms 60000\"],\"notes\":[\"Blocks until the wait trigger is satisfied, then runs fs_op.\",\"--wait-interval-ms is only used with --wait-exists.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--name <file-name>\",\"--to <path> | --to-path <path> | --to-name <file-name>\",\"--max-entries <n>\",\"--allow-unsafe-path\",\"--wait-timeout-ms <n>\",\"--wait-interval-ms <n>\"],\"probe_id\":\"fs_op_wait\",\"required_args\":[\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\",\"--wait-fifo <path> | --wait-exists <path>\"],\"summary\":\"wait for a trigger, then run fs_op\",\"usage\":\"fs_op_wait --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\n          (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n          [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\n          [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path]\\n          (--wait-fifo <path> | --wait-exists <path>) [--wait-timeout-ms <n>] [--wait-interval-ms <n>]\"},{\"entitlement_hints\":[\"com.apple.security.network.client\"],\"examples\":[\"net_op --op getaddrinfo --host example.com\",\"net_op --op tcp_connect --host 127.0.0.1 --port 80\"],\"notes\":[\"--port is required for tcp_connect and udp_send.\"],\"optional_args\":[\"--port <1..65535>\",\"--numeric\"],\"probe_id\":\"net_op\",\"required_args\":[\"--op <getaddrinfo|tcp_connect|udp_send>\",\"--host <host>\"],\"summary\":\"parameterized network operations\",\"usage\":\"net_op --op <getaddrinfo|tcp_connect|udp_send> --host <host> [--port <1..65535>] [--numeric]\"},{\"entitlement_hints\":[\"com.apple.security.cs.disable-library-validation\",\"com.apple.security.cs.allow-dyld-environment-variables (if you rely on DYLD_*)\"],\"examples\":[\"dlopen_external --path \\\/path\\\/to\\\/testdylib.dylib\"],\"notes\":[\"Executes dylib initializers; this is not a passive probe.\",\"Use a signed dylib (see tests\\\/fixtures\\\/TestDylib).\"],\"optional_args\":[],\"probe_id\":\"dlopen_external\",\"required_args\":[\"--path <abs> (or EJ_DLOPEN_PATH)\"],\"summary\":\"dlopen a signed dylib by absolute path\",\"usage\":\"dlopen_external --path <abs> (or set EJ_DLOPEN_PATH)\"},{\"entitlement_hints\":[\"com.apple.security.cs.allow-jit\"],\"examples\":[\"jit_map_jit\",\"jit_map_jit --size 65536\"],\"notes\":[\"Reports errno on MAP_JIT failure.\"],\"optional_args\":[\"--size <bytes> (default: 16384)\"],\"probe_id\":\"jit_map_jit\",\"required_args\":[],\"summary\":\"attempt mmap with MAP_JIT\",\"usage\":\"jit_map_jit [--size <bytes>]\"},{\"entitlement_hints\":[\"com.apple.security.cs.allow-unsigned-executable-memory\"],\"examples\":[\"jit_rwx_legacy\",\"jit_rwx_legacy --size 65536\"],\"notes\":[\"Reports errno on RWX mmap failure.\"],\"optional_args\":[\"--size <bytes> (default: 16384)\"],\"probe_id\":\"jit_rwx_legacy\",\"required_args\":[],\"summary\":\"attempt mmap with RWX permissions (legacy)\",\"usage\":\"jit_rwx_legacy [--size <bytes>]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_op --bookmark-b64 <b64> --op stat\",\"bookmark_op --bookmark-path \\\/tmp\\\/token.txt --op open_read --relative file.txt\"],\"notes\":[\"Uses ScopedBookmarksAgent IPC for security-scoped bookmarks.\"],\"optional_args\":[\"--relative <rel>\",\"--op <fs_op-op> (default: stat)\",\"--allow-unsafe-path\"],\"probe_id\":\"bookmark_op\",\"required_args\":[\"--bookmark-b64 <base64> | --bookmark-path <path>\"],\"summary\":\"resolve a bookmark token and run a filesystem op against it\",\"usage\":\"bookmark_op --bookmark-b64 <base64> | --bookmark-path <path>\\n            [--relative <rel>] [--op <fs_op-op>] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_make --path \\\/Users\\\/me\\\/Downloads\",\"bookmark_make --path \\\/Users\\\/me\\\/Downloads --read-only\"],\"notes\":[\"Security-scoped bookmarks use ScopedBookmarksAgent IPC.\"],\"optional_args\":[\"--no-security-scope\",\"--read-only\",\"--allow-missing\"],\"probe_id\":\"bookmark_make\",\"required_args\":[\"--path <abs>\"],\"summary\":\"create a security-scoped bookmark token for a path\",\"usage\":\"bookmark_make --path <abs> [--no-security-scope] [--read-only] [--allow-missing]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_roundtrip --path \\\/Users\\\/me\\\/Downloads --op stat\",\"bookmark_roundtrip --path \\\/Users\\\/me\\\/Downloads --op open_read --relative file.txt\"],\"notes\":[\"Returns the bookmark token in stdout and the fs_op result in details.\"],\"optional_args\":[\"--op <fs_op-op> (default: stat)\",\"--relative <rel>\",\"--no-security-scope\",\"--read-only\",\"--allow-missing\",\"--allow-unsafe-path\"],\"probe_id\":\"bookmark_roundtrip\",\"required_args\":[\"--path <abs>\"],\"summary\":\"create a bookmark token and immediately resolve + run a filesystem op\",\"usage\":\"bookmark_roundtrip --path <abs> [--op <fs_op-op>] [--relative <rel>] [--no-security-scope] [--read-only] [--allow-missing] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"capabilities_snapshot\"],\"notes\":[\"Includes entitlement presence booleans and standard directory paths.\"],\"optional_args\":[],\"probe_id\":\"capabilities_snapshot\",\"required_args\":[],\"summary\":\"report entitlements and resolved standard directories\",\"usage\":\"capabilities_snapshot\"},{\"entitlement_hints\":[\"none (observer \\\/ instrumentation target)\"],\"examples\":[\"sandbox_check --operation file-read-data\",\"sandbox_check --operation file-read-data --path \\\/etc\\\/hosts\",\"sandbox_check --operation mach-lookup --repeat 10\"],\"notes\":[\"This does not perform the operation; it only calls sandbox_check() so attach\\\/hook tooling can observe libsystem_sandbox activity.\",\"If --path is provided, the probe passes a guessed filter type for a path argument; treat the return code as informational, not authoritative.\"],\"optional_args\":[\"--path <abs>\",\"--repeat <n> (default: 1)\"],\"probe_id\":\"sandbox_check\",\"required_args\":[\"--operation <sandbox-op>\"],\"summary\":\"call sandbox_check() in libsystem_sandbox (hook calibration)\",\"usage\":\"sandbox_check --operation <sandbox-op> [--path <abs>] [--repeat <n>]\"},{\"entitlement_hints\":[\"com.apple.security.temporary-exception.sbpl (allow file-issue-extension for extension class)\"],\"examples\":[\"sandbox_extension --op issue_file --class com.apple.app-sandbox.read --path \\\/etc\\\/hosts --allow-unsafe-path\",\"sandbox_extension --op consume --token <token>\"],\"notes\":[\"issue_file returns the token in stdout.\",\"Direct-path issuance outside *\\\/entitlement-jail-harness\\\/* is refused unless you pass --allow-unsafe-path.\"],\"optional_args\":[\"--class <extension-class> (required for issue_file)\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches> (required for issue_file)\",\"--target <base|harness_dir|run_dir|specimen_file> (default: specimen_file)\",\"--name <filename>\",\"--flags <int> (default: 0)\",\"--allow-unsafe-path\",\"--token <token> (required for consume\\\/release)\"],\"probe_id\":\"sandbox_extension\",\"required_args\":[\"--op <issue_file|consume|release>\"],\"summary\":\"issue\\\/consume\\\/release sandbox file extensions\",\"usage\":\"sandbox_extension --op issue_file --class <extension-class>\\n                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n                 [--flags <int>] [--allow-unsafe-path]\\nsandbox_extension --op consume --token <token>\\nsandbox_extension --op release --token <token>\"},{\"entitlement_hints\":[\"none (containerization evidence)\"],\"examples\":[\"userdefaults_op --op read --key example\",\"userdefaults_op --op write --key example --value 1\"],\"notes\":[\"Useful for observing containerized preferences paths.\"],\"optional_args\":[\"--op <read|write|remove|sync> (default: read)\",\"--key <k>\",\"--value <v>\",\"--suite <suite>\"],\"probe_id\":\"userdefaults_op\",\"required_args\":[],\"summary\":\"read\\\/write\\\/remove\\\/sync a UserDefaults key\",\"usage\":\"userdefaults_op --op <read|write|remove|sync> [--key <k>] [--value <v>] [--suite <suite>]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_xattr --op get --path \\\/tmp\\\/file --name com.apple.quarantine\",\"fs_xattr --op list --path \\\/tmp\\\/file\"],\"notes\":[\"xattr writes are refused outside harness paths unless --allow-write or --allow-unsafe-path is set.\"],\"optional_args\":[\"--name <xattr>\",\"--value <v>\",\"--allow-write\",\"--allow-unsafe-path\"],\"probe_id\":\"fs_xattr\",\"required_args\":[\"--op <get|list|set|remove>\",\"--path <abs>\"],\"summary\":\"get\\\/list\\\/set\\\/remove extended attributes\",\"usage\":\"fs_xattr --op <get|list|set|remove> --path <abs> [--name <xattr>] [--value <v>] [--allow-write] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_coordinated_op --op read --path-class documents\",\"fs_coordinated_op --op write --path-class tmp --target run_dir\"],\"notes\":[\"Coordinated writes to direct paths are refused unless you use --path-class\\\/--target (or a path under *\\\/entitlement-jail-harness\\\/*) or set --allow-unsafe-path.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--allow-unsafe-path\"],\"probe_id\":\"fs_coordinated_op\",\"required_args\":[\"--op <read|write>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\"],\"summary\":\"NSFileCoordinator mediated read\\\/write\",\"usage\":\"fs_coordinated_op --op <read|write> (--path <abs> | --path-class <...>) [--target <...>] [--allow-unsafe-path]\"}],\"schema_version\":2,\"trace_symbols\":[{\"probe_id\":\"fs_op\",\"symbols\":[\"ej_probe_fs_op\"]},{\"probe_id\":\"fs_op_wait\",\"symbols\":[\"ej_probe_fs_op_wait\"]},{\"probe_id\":\"net_op\",\"symbols\":[\"ej_probe_net_op\"]},{\"probe_id\":\"dlopen_external\",\"symbols\":[\"ej_probe_dlopen_external\"]},{\"probe_id\":\"jit_map_jit\",\"symbols\":[\"ej_probe_jit_map_jit\"]},{\"probe_id\":\"jit_rwx_legacy\",\"symbols\":[\"ej_probe_jit_rwx_legacy\"]},{\"probe_id\":\"sandbox_check\",\"symbols\":[\"ej_probe_sandbox_check\"]},{\"probe_id\":\"sandbox_extension\",\"symbols\":[\"ej_probe_sandbox_extension\"]}]}","thread_id":"10499"},"generated_at_unix_ms":1766856873769,"kind":"probe_response","result":{"exit_code":0,"normalized_outcome":"ok","ok":true,"rc":0,"stdout":"{\"generated_at_iso8601\":\"2025-12-27T17:34:33Z\",\"probes\":[{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"probe_catalog\"],\"notes\":[\"Outputs JSON in RunProbeResponse.stdout.\",\"Use <probe-id> --help for per-probe usage.\"],\"optional_args\":[],\"probe_id\":\"probe_catalog\",\"required_args\":[],\"summary\":\"emit a JSON catalog of available probes\",\"usage\":\"probe_catalog\"},{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"world_shape\"],\"notes\":[\"Reports HOME\\\/TMP\\\/CWD and containerization signals.\"],\"optional_args\":[],\"probe_id\":\"world_shape\",\"required_args\":[],\"summary\":\"report containerization and world shape metadata\",\"usage\":\"world_shape\"},{\"entitlement_hints\":[\"com.apple.security.network.client\"],\"examples\":[\"network_tcp_connect --host 1.1.1.1 --port 443\"],\"notes\":[],\"optional_args\":[],\"probe_id\":\"network_tcp_connect\",\"required_args\":[\"--host <ipv4>\",\"--port <1..65535>\"],\"summary\":\"attempt a TCP connect to an IPv4 host:port\",\"usage\":\"network_tcp_connect --host <ipv4> --port <1..65535>\"},{\"entitlement_hints\":[\"com.apple.security.files.downloads.read-write\"],\"examples\":[\"downloads_rw\",\"downloads_rw --name demo.txt\"],\"notes\":[\"Writes under Downloads\\\/entitlement-jail-harness.\"],\"optional_args\":[\"--name <file-name>\"],\"probe_id\":\"downloads_rw\",\"required_args\":[],\"summary\":\"read\\\/write\\\/remove a file under Downloads\\\/entitlement-jail-harness\",\"usage\":\"downloads_rw [--name <file-name>]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_op --op stat --path-class downloads\",\"fs_op --op create --path-class tmp --target run_dir\"],\"notes\":[\"Destructive direct-path ops are refused unless you use --path-class\\\/--target (or a path under *\\\/entitlement-jail-harness\\\/*) or set --allow-unsafe-path.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--name <file-name>\",\"--to <path> | --to-path <path> | --to-name <file-name>\",\"--max-entries <n>\",\"--allow-unsafe-path\"],\"probe_id\":\"fs_op\",\"required_args\":[\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\"],\"summary\":\"parameterized filesystem operations\",\"usage\":\"fs_op --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\n      (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n      [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\n      [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_op_wait --op open_read --path-class tmp --wait-fifo \\\/tmp\\\/ej-wait.fifo\",\"fs_op_wait --op stat --path \\\/tmp\\\/target --wait-exists \\\/tmp\\\/trigger --wait-timeout-ms 60000\"],\"notes\":[\"Blocks until the wait trigger is satisfied, then runs fs_op.\",\"--wait-interval-ms is only used with --wait-exists.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--name <file-name>\",\"--to <path> | --to-path <path> | --to-name <file-name>\",\"--max-entries <n>\",\"--allow-unsafe-path\",\"--wait-timeout-ms <n>\",\"--wait-interval-ms <n>\"],\"probe_id\":\"fs_op_wait\",\"required_args\":[\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\",\"--wait-fifo <path> | --wait-exists <path>\"],\"summary\":\"wait for a trigger, then run fs_op\",\"usage\":\"fs_op_wait --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\n          (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n          [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\n          [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path]\\n          (--wait-fifo <path> | --wait-exists <path>) [--wait-timeout-ms <n>] [--wait-interval-ms <n>]\"},{\"entitlement_hints\":[\"com.apple.security.network.client\"],\"examples\":[\"net_op --op getaddrinfo --host example.com\",\"net_op --op tcp_connect --host 127.0.0.1 --port 80\"],\"notes\":[\"--port is required for tcp_connect and udp_send.\"],\"optional_args\":[\"--port <1..65535>\",\"--numeric\"],\"probe_id\":\"net_op\",\"required_args\":[\"--op <getaddrinfo|tcp_connect|udp_send>\",\"--host <host>\"],\"summary\":\"parameterized network operations\",\"usage\":\"net_op --op <getaddrinfo|tcp_connect|udp_send> --host <host> [--port <1..65535>] [--numeric]\"},{\"entitlement_hints\":[\"com.apple.security.cs.disable-library-validation\",\"com.apple.security.cs.allow-dyld-environment-variables (if you rely on DYLD_*)\"],\"examples\":[\"dlopen_external --path \\\/path\\\/to\\\/testdylib.dylib\"],\"notes\":[\"Executes dylib initializers; this is not a passive probe.\",\"Use a signed dylib (see tests\\\/fixtures\\\/TestDylib).\"],\"optional_args\":[],\"probe_id\":\"dlopen_external\",\"required_args\":[\"--path <abs> (or EJ_DLOPEN_PATH)\"],\"summary\":\"dlopen a signed dylib by absolute path\",\"usage\":\"dlopen_external --path <abs> (or set EJ_DLOPEN_PATH)\"},{\"entitlement_hints\":[\"com.apple.security.cs.allow-jit\"],\"examples\":[\"jit_map_jit\",\"jit_map_jit --size 65536\"],\"notes\":[\"Reports errno on MAP_JIT failure.\"],\"optional_args\":[\"--size <bytes> (default: 16384)\"],\"probe_id\":\"jit_map_jit\",\"required_args\":[],\"summary\":\"attempt mmap with MAP_JIT\",\"usage\":\"jit_map_jit [--size <bytes>]\"},{\"entitlement_hints\":[\"com.apple.security.cs.allow-unsigned-executable-memory\"],\"examples\":[\"jit_rwx_legacy\",\"jit_rwx_legacy --size 65536\"],\"notes\":[\"Reports errno on RWX mmap failure.\"],\"optional_args\":[\"--size <bytes> (default: 16384)\"],\"probe_id\":\"jit_rwx_legacy\",\"required_args\":[],\"summary\":\"attempt mmap with RWX permissions (legacy)\",\"usage\":\"jit_rwx_legacy [--size <bytes>]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_op --bookmark-b64 <b64> --op stat\",\"bookmark_op --bookmark-path \\\/tmp\\\/token.txt --op open_read --relative file.txt\"],\"notes\":[\"Uses ScopedBookmarksAgent IPC for security-scoped bookmarks.\"],\"optional_args\":[\"--relative <rel>\",\"--op <fs_op-op> (default: stat)\",\"--allow-unsafe-path\"],\"probe_id\":\"bookmark_op\",\"required_args\":[\"--bookmark-b64 <base64> | --bookmark-path <path>\"],\"summary\":\"resolve a bookmark token and run a filesystem op against it\",\"usage\":\"bookmark_op --bookmark-b64 <base64> | --bookmark-path <path>\\n            [--relative <rel>] [--op <fs_op-op>] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_make --path \\\/Users\\\/me\\\/Downloads\",\"bookmark_make --path \\\/Users\\\/me\\\/Downloads --read-only\"],\"notes\":[\"Security-scoped bookmarks use ScopedBookmarksAgent IPC.\"],\"optional_args\":[\"--no-security-scope\",\"--read-only\",\"--allow-missing\"],\"probe_id\":\"bookmark_make\",\"required_args\":[\"--path <abs>\"],\"summary\":\"create a security-scoped bookmark token for a path\",\"usage\":\"bookmark_make --path <abs> [--no-security-scope] [--read-only] [--allow-missing]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_roundtrip --path \\\/Users\\\/me\\\/Downloads --op stat\",\"bookmark_roundtrip --path \\\/Users\\\/me\\\/Downloads --op open_read --relative file.txt\"],\"notes\":[\"Returns the bookmark token in stdout and the fs_op result in details.\"],\"optional_args\":[\"--op <fs_op-op> (default: stat)\",\"--relative <rel>\",\"--no-security-scope\",\"--read-only\",\"--allow-missing\",\"--allow-unsafe-path\"],\"probe_id\":\"bookmark_roundtrip\",\"required_args\":[\"--path <abs>\"],\"summary\":\"create a bookmark token and immediately resolve + run a filesystem op\",\"usage\":\"bookmark_roundtrip --path <abs> [--op <fs_op-op>] [--relative <rel>] [--no-security-scope] [--read-only] [--allow-missing] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"capabilities_snapshot\"],\"notes\":[\"Includes entitlement presence booleans and standard directory paths.\"],\"optional_args\":[],\"probe_id\":\"capabilities_snapshot\",\"required_args\":[],\"summary\":\"report entitlements and resolved standard directories\",\"usage\":\"capabilities_snapshot\"},{\"entitlement_hints\":[\"none (observer \\\/ instrumentation target)\"],\"examples\":[\"sandbox_check --operation file-read-data\",\"sandbox_check --operation file-read-data --path \\\/etc\\\/hosts\",\"sandbox_check --operation mach-lookup --repeat 10\"],\"notes\":[\"This does not perform the operation; it only calls sandbox_check() so attach\\\/hook tooling can observe libsystem_sandbox activity.\",\"If --path is provided, the probe passes a guessed filter type for a path argument; treat the return code as informational, not authoritative.\"],\"optional_args\":[\"--path <abs>\",\"--repeat <n> (default: 1)\"],\"probe_id\":\"sandbox_check\",\"required_args\":[\"--operation <sandbox-op>\"],\"summary\":\"call sandbox_check() in libsystem_sandbox (hook calibration)\",\"usage\":\"sandbox_check --operation <sandbox-op> [--path <abs>] [--repeat <n>]\"},{\"entitlement_hints\":[\"com.apple.security.temporary-exception.sbpl (allow file-issue-extension for extension class)\"],\"examples\":[\"sandbox_extension --op issue_file --class com.apple.app-sandbox.read --path \\\/etc\\\/hosts --allow-unsafe-path\",\"sandbox_extension --op consume --token <token>\"],\"notes\":[\"issue_file returns the token in stdout.\",\"Direct-path issuance outside *\\\/entitlement-jail-harness\\\/* is refused unless you pass --allow-unsafe-path.\"],\"optional_args\":[\"--class <extension-class> (required for issue_file)\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches> (required for issue_file)\",\"--target <base|harness_dir|run_dir|specimen_file> (default: specimen_file)\",\"--name <filename>\",\"--flags <int> (default: 0)\",\"--allow-unsafe-path\",\"--token <token> (required for consume\\\/release)\"],\"probe_id\":\"sandbox_extension\",\"required_args\":[\"--op <issue_file|consume|release>\"],\"summary\":\"issue\\\/consume\\\/release sandbox file extensions\",\"usage\":\"sandbox_extension --op issue_file --class <extension-class>\\n                 (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n                 [--target <base|harness_dir|run_dir|specimen_file>] [--name <filename>]\\n                 [--flags <int>] [--allow-unsafe-path]\\nsandbox_extension --op consume --token <token>\\nsandbox_extension --op release --token <token>\"},{\"entitlement_hints\":[\"none (containerization evidence)\"],\"examples\":[\"userdefaults_op --op read --key example\",\"userdefaults_op --op write --key example --value 1\"],\"notes\":[\"Useful for observing containerized preferences paths.\"],\"optional_args\":[\"--op <read|write|remove|sync> (default: read)\",\"--key <k>\",\"--value <v>\",\"--suite <suite>\"],\"probe_id\":\"userdefaults_op\",\"required_args\":[],\"summary\":\"read\\\/write\\\/remove\\\/sync a UserDefaults key\",\"usage\":\"userdefaults_op --op <read|write|remove|sync> [--key <k>] [--value <v>] [--suite <suite>]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_xattr --op get --path \\\/tmp\\\/file --name com.apple.quarantine\",\"fs_xattr --op list --path \\\/tmp\\\/file\"],\"notes\":[\"xattr writes are refused outside harness paths unless --allow-write or --allow-unsafe-path is set.\"],\"optional_args\":[\"--name <xattr>\",\"--value <v>\",\"--allow-write\",\"--allow-unsafe-path\"],\"probe_id\":\"fs_xattr\",\"required_args\":[\"--op <get|list|set|remove>\",\"--path <abs>\"],\"summary\":\"get\\\/list\\\/set\\\/remove extended attributes\",\"usage\":\"fs_xattr --op <get|list|set|remove> --path <abs> [--name <xattr>] [--value <v>] [--allow-write] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_coordinated_op --op read --path-class documents\",\"fs_coordinated_op --op write --path-class tmp --target run_dir\"],\"notes\":[\"Coordinated writes to direct paths are refused unless you use --path-class\\\/--target (or a path under *\\\/entitlement-jail-harness\\\/*) or set --allow-unsafe-path.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--allow-unsafe-path\"],\"probe_id\":\"fs_coordinated_op\",\"required_args\":[\"--op <read|write>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\"],\"summary\":\"NSFileCoordinator mediated read\\\/write\",\"usage\":\"fs_coordinated_op --op <read|write> (--path <abs> | --path-class <...>) [--target <...>] [--allow-unsafe-path]\"}],\"schema_version\":2,\"trace_symbols\":[{\"probe_id\":\"fs_op\",\"symbols\":[\"ej_probe_fs_op\"]},{\"probe_id\":\"fs_op_wait\",\"symbols\":[\"ej_probe_fs_op_wait\"]},{\"probe_id\":\"net_op\",\"symbols\":[\"ej_probe_net_op\"]},{\"probe_id\":\"dlopen_external\",\"symbols\":[\"ej_probe_dlopen_external\"]},{\"probe_id\":\"jit_map_jit\",\"symbols\":[\"ej_probe_jit_map_jit\"]},{\"probe_id\":\"jit_rwx_legacy\",\"symbols\":[\"ej_probe_jit_rwx_legacy\"]},{\"probe_id\":\"sandbox_check\",\"symbols\":[\"ej_probe_sandbox_check\"]},{\"probe_id\":\"sandbox_extension\",\"symbols\":[\"ej_probe_sandbox_extension\"]}]}"},"schema_version":2}
{"data":{"correlation_id":"frida-testing:ej-frida.f4f3f252-74d1-4bf7-a10c-3ba1940896df","event":"session_closed","message":"session closed","pid":54323,"plan_id":"frida-testing:ej-frida","service_bundle_id":"com.yourteam.entitlement-jail.ProbeService_fully_injectable_extensions","service_name":"ProbeService_fully_injectable_extensions","session_token":"89AC77C7-3237-4EBA-B89B-0B82679E3F78","wait_mode":"fifo","wait_path":"\/Users\/achyland\/Library\/Containers\/com.yourteam.entitlement-jail.ProbeService_fully_injectable_extensions\/Data\/tmp\/entitlement-jail-session\/wait.B40DA5F4-820E-40E2-84B8-C5EAC785EA87.fifo"},"generated_at_unix_ms":1766856893776,"kind":"xpc_session_event","result":{"exit_code":0,"normalized_outcome":"ok","ok":true,"rc":0},"schema_version":2}
