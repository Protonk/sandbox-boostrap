{
  "action_id": "downloads_direct_8e21f10540d9",
  "evidence_tier": "mapped",
  "limits": [
    "entitlements: PolicyWitness XPC run (observer-only deny evidence)",
    "sbpl: wrapper apply failures are apply-stage gates, not policy decisions",
    "none: unsandboxed baseline (no policy apply)"
  ],
  "results": {
    "entitlements": {
      "bundle": null,
      "capture_sandbox_logs": false,
      "command": [
        "book/tools/witness/PolicyWitness.app/Contents/MacOS/policy-witness",
        "xpc",
        "run",
        "--profile",
        "minimal",
        "--plan-id",
        "deny-delay-detail:compare:8e21f105-40d9-43ae-8809-6f96e3c62dad",
        "--row-id",
        "entitlements.fs_op_create_direct",
        "fs_op",
        "--op",
        "create",
        "--path",
        "/Users/achyland/Downloads/atlas_compare_8e21f10540d9.txt",
        "--allow-unsafe-path"
      ],
      "correlation_id": null,
      "duration_s": 0.023075103759765625,
      "entrypoint": "book/tools/witness/PolicyWitness.app/Contents/MacOS/policy-witness",
      "evidence_tier": "mapped",
      "exit_code": 1,
      "finished_at_unix_s": 1767244551.872107,
      "lifecycle": {
        "correlation_id": null,
        "evidence_tier": "mapped",
        "file_path": null,
        "plan_id": "deny-delay-detail:compare:8e21f105-40d9-43ae-8809-6f96e3c62dad",
        "process_name": null,
        "profile_id": "minimal",
        "row_id": "entitlements.fs_op_create_direct",
        "service_id": null,
        "service_pid": null,
        "tmp_dir": null
      },
      "log_path": "book/experiments/deny-delay-detail/out/compare/downloads_direct_8e21f10540d9/logs/downloads_direct_8e21f10540d9.entitlements.json",
      "log_write_error": null,
      "observer": {
        "skipped": "missing_pid_or_process_name"
      },
      "observer_log_path": "book/experiments/deny-delay-detail/out/compare/downloads_direct_8e21f10540d9/logs/observer/downloads_direct_8e21f10540d9.entitlements.json.observer.json",
      "observer_status": "skipped:missing_pid_or_process_name",
      "plan_id": "deny-delay-detail:compare:8e21f105-40d9-43ae-8809-6f96e3c62dad",
      "probe_args": [
        "--op",
        "create",
        "--path",
        "/Users/achyland/Downloads/atlas_compare_8e21f10540d9.txt",
        "--allow-unsafe-path"
      ],
      "probe_error": null,
      "probe_id": "fs_op",
      "probe_timeout_s": 25.0,
      "profile_id": "minimal",
      "record_write_error": null,
      "row_id": "entitlements.fs_op_create_direct",
      "runner_info": {
        "entrypoint": "policy-witness",
        "entrypoint_path": "book/tools/witness/PolicyWitness.app/Contents/MacOS/policy-witness",
        "entrypoint_sha256": "70932a56ecb32fc5e87b70ee3c144c200c3377d2bbdc288739ea385177aa4b24",
        "tool_build_id": "70932a56ecb32fc5e87b70ee3c144c200c3377d2bbdc288739ea385177aa4b24"
      },
      "service_id": null,
      "started_at_unix_s": 1767244551.849032,
      "stderr": "",
      "stdout": "{\"data\":{\"details\":{\"service_bundle_id\":\"com.yourteam.policy-witness.ProbeService_minimal\"},\"error\":\"xpc error: Error Domain=NSCocoaErrorDomain Code=4099 \\\"The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.\\\" UserInfo={NSDebugDescription=The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.}\",\"layer_attribution\":{\"other\":\"xpc:openSession_failed\"},\"normalized_outcome\":\"xpc_error\",\"rc\":1,\"schema_version\":1,\"stderr\":\"xpc error: Error Domain=NSCocoaErrorDomain Code=4099 \\\"The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.\\\" UserInfo={NSDebugDescription=The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.}\",\"stdout\":\"\"},\"generated_at_unix_ms\":1767244551866,\"kind\":\"probe_response\",\"result\":{\"error\":\"xpc error: Error Domain=NSCocoaErrorDomain Code=4099 \\\"The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.\\\" UserInfo={NSDebugDescription=The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.}\",\"exit_code\":1,\"normalized_outcome\":\"xpc_error\",\"ok\":false,\"rc\":1,\"stderr\":\"xpc error: Error Domain=NSCocoaErrorDomain Code=4099 \\\"The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.\\\" UserInfo={NSDebugDescription=The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.}\"},\"schema_version\":1}\n",
      "stdout_json": {
        "data": {
          "details": {
            "service_bundle_id": "com.yourteam.policy-witness.ProbeService_minimal"
          },
          "error": "xpc error: Error Domain=NSCocoaErrorDomain Code=4099 \"The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.\" UserInfo={NSDebugDescription=The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.}",
          "layer_attribution": {
            "other": "xpc:openSession_failed"
          },
          "normalized_outcome": "xpc_error",
          "rc": 1,
          "schema_version": 1,
          "stderr": "xpc error: Error Domain=NSCocoaErrorDomain Code=4099 \"The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.\" UserInfo={NSDebugDescription=The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.}",
          "stdout": ""
        },
        "generated_at_unix_ms": 1767244551866,
        "kind": "probe_response",
        "result": {
          "error": "xpc error: Error Domain=NSCocoaErrorDomain Code=4099 \"The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.\" UserInfo={NSDebugDescription=The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.}",
          "exit_code": 1,
          "normalized_outcome": "xpc_error",
          "ok": false,
          "rc": 1,
          "stderr": "xpc error: Error Domain=NSCocoaErrorDomain Code=4099 \"The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.\" UserInfo={NSDebugDescription=The connection to service named com.yourteam.policy-witness.ProbeService_minimal was invalidated: failed at lookup with error 159 - Sandbox restriction.}"
        },
        "schema_version": 1
      },
      "stdout_json_error": null,
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "none": {
      "command": [
        "/bin/sh",
        "-c",
        "echo test > \\\"$HOME/Downloads/atlas_compare_8e21f10540d9.txt\\\"; rm -f \\\"$HOME/Downloads/atlas_compare_8e21f10540d9.txt\\\""
      ],
      "duration_s": 0.004700183868408203,
      "error": null,
      "evidence_tier": "mapped",
      "exit_code": 0,
      "finished_at_unix_s": 1767244551.8921752,
      "preflight": null,
      "runner_info": null,
      "started_at_unix_s": 1767244551.887475,
      "stderr": "/bin/sh: \"/Users/achyland/Downloads/atlas_compare_8e21f10540d9.txt\": No such file or directory\n",
      "stdout": "",
      "tool_markers": null
    },
    "sbpl": {
      "command": [
        "book/tools/sbpl/wrapper/wrapper",
        "--preflight",
        "on",
        "--sbpl",
        "book/experiments/sbpl-graph-runtime/profiles/allow_all.sb",
        "--",
        "/bin/sh",
        "-c",
        "echo test > \\\"$HOME/Downloads/atlas_compare_8e21f10540d9.txt\\\"; rm -f \\\"$HOME/Downloads/atlas_compare_8e21f10540d9.txt\\\""
      ],
      "duration_s": 0.003731966018676758,
      "error": null,
      "evidence_tier": "mapped",
      "exit_code": 64,
      "finished_at_unix_s": 1767244551.878144,
      "preflight": {
        "apply_marker_pid": 33132,
        "apply_ok": false,
        "apply_report": {
          "api": "sandbox_init",
          "err_class": "errno_eperm",
          "err_class_source": "errno_only",
          "errbuf": "Operation not permitted",
          "errno": 1,
          "rc": -1
        },
        "command": [
          "book/api/runtime/native/sandbox_runner/sandbox_runner",
          "book/experiments/sbpl-graph-runtime/profiles/allow_all.sb",
          "--",
          "/usr/bin/true"
        ],
        "exit_code": 1,
        "failure_stage": "apply",
        "profile": "book/experiments/sbpl-graph-runtime/profiles/allow_all.sb",
        "run_id": null,
        "runner": "book/api/runtime/native/sandbox_runner/sandbox_runner",
        "sandbox_check_self": {
          "error": "libsystem_sandbox not found",
          "source": "sandbox_check"
        },
        "status": "ok",
        "stderr": "sandbox initialization failed: Operation not permitted\nsandbox_init failed: Operation not permitted\n",
        "stdout": "",
        "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
      },
      "runner_info": {
        "entrypoint": "sbpl-wrapper",
        "entrypoint_path": "book/tools/sbpl/wrapper/wrapper",
        "entrypoint_sha256": "2a4ead954fcceb103a5409d6057ab6803f206a11fc94554638c1b6a2aa065bb3",
        "tool_build_id": "2a4ead954fcceb103a5409d6057ab6803f206a11fc94554638c1b6a2aa065bb3"
      },
      "started_at_unix_s": 1767244551.874412,
      "stderr": "invalid --preflight value: on\n",
      "stdout": "",
      "tool_markers": null
    }
  },
  "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
}
