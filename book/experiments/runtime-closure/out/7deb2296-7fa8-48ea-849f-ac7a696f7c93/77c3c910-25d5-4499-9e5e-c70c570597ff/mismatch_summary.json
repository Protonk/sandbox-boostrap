{
  "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
  "generated_by": "book/api/runtime/execution/workflow.py",
  "mismatches": [
    {
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "profile_id": "runtime-closure:iokit:v13_ioaccelerator_connection",
      "expectation_id": "runtime-closure:iokit:v13_ioaccelerator_connection:iosurface_root",
      "operation": "iokit-open-service",
      "path": "IOSurfaceRoot",
      "expected": "allow",
      "actual": "deny",
      "mismatch_type": "unexpected_deny",
      "violation_summary": "EPERM",
      "notes": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.77c3c910-25d5-4499-9e5e-c70c570597ff/book/experiments/runtime-closure/out/7deb2296-7fa8-48ea-849f-ac7a696f7c93/77c3c910-25d5-4499-9e5e-c70c570597ff/runtime_profiles/v13_iokit_ioaccelerator_connection.runtime-closure_iokit_v13_ioaccelerator_connection.runtime.sb\",\"pid\":38521}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.77c3c910-25d5-4499-9e5e-c70c570597ff/book/experiments/runtime-closure/out/7deb2296-7fa8-48ea-849f-ac7a696f7c93/77c3c910-25d5-4499-9e5e-c70c570597ff/runtime_profiles/v13_iokit_ioaccelerator_connection.runtime-closure_iokit_v13_ioaccelerator_connection.runtime.sb\",\"pid\":38521}\nsandbox operation \"iokit-open\" is obsolete; replace with \"iokit-open-user-client\"\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open\",\"filter_type\":16,\"filter_type_name\":\"iokit-registry-entry-class\",\"check_type\":1073741840,\"varargs_count\":1,\"argument\":\"IOSurfaceRoot\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":1,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-service\",\"filter_type\":16,\"filter_type_name\":\"iokit-registry-entry-class\",\"check_type\":1073741840,\"varargs_count\":1,\"argument\":\"IOSurfaceRoot\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":16,\"filter_type_name\":\"iokit-registry-entry-class\",\"check_type\":1073741840,\"varargs_count\":1,\"argument\":\"IOSurfaceRootUserClient\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":76,\"filter_type_name\":\"iokit-user-client-type\",\"check_type\":1073741900,\"varargs_count\":1,\"argument\":\"IOSurfaceRootUserClient\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":-1,\"errno\":22,\"decision\":\"error\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":16,\"filter_type_name\":\"iokit-registry-entry-class\",\"check_type\":1073741840,\"varargs_count\":1,\"argument\":\"IOSurfaceRoot\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":18,\"filter_type_name\":\"iokit-connection\",\"check_type\":1073741842,\"varargs_count\":1,\"argument\":\"IOAccelerator\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":-1,\"errno\":3,\"decision\":\"error\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":76,\"filter_type_name\":\"iokit-user-client-type\",\"check_type\":1073741900,\"varargs_count\":1,\"argument\":\"0\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":-1,\"errno\":22,\"decision\":\"error\"}\nsandbox operation \"iokit-open\" is obsolete; replace with \"iokit-open-user-client\"\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open\",\"filter_type\":76,\"filter_type_name\":\"iokit-user-client-type\",\"check_type\":1073741900,\"varargs_count\":1,\"argument\":\"0\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":-1,\"errno\":22,\"decision\":\"error\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":-1,\"filter_type_name\":\"none\",\"check_type\":-1,\"varargs_count\":0,\"argument\":\"<none>\",\"no_report\":false,\"no_report_reason\":\"not_applicable\",\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":-1,\"errno\":22,\"decision\":\"error\"}\n"
    },
    {
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "profile_id": "runtime-closure:iokit:v14_iosurface_send_right",
      "expectation_id": "runtime-closure:iokit:v14_iosurface_send_right:iosurface_root",
      "operation": "iokit-open-service",
      "path": "IOSurfaceRoot",
      "expected": "allow",
      "actual": "deny",
      "mismatch_type": "unexpected_deny",
      "violation_summary": "EPERM",
      "notes": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.77c3c910-25d5-4499-9e5e-c70c570597ff/book/experiments/runtime-closure/out/7deb2296-7fa8-48ea-849f-ac7a696f7c93/77c3c910-25d5-4499-9e5e-c70c570597ff/runtime_profiles/v14_iokit_iosurface_send_right.runtime-closure_iokit_v14_iosurface_send_right.runtime.sb\",\"pid\":38522}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.77c3c910-25d5-4499-9e5e-c70c570597ff/book/experiments/runtime-closure/out/7deb2296-7fa8-48ea-849f-ac7a696f7c93/77c3c910-25d5-4499-9e5e-c70c570597ff/runtime_profiles/v14_iokit_iosurface_send_right.runtime-closure_iokit_v14_iosurface_send_right.runtime.sb\",\"pid\":38522}\nsandbox operation \"iokit-open\" is obsolete; replace with \"iokit-open-user-client\"\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open\",\"filter_type\":16,\"filter_type_name\":\"iokit-registry-entry-class\",\"check_type\":1073741840,\"varargs_count\":1,\"argument\":\"IOSurfaceRoot\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":1,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-service\",\"filter_type\":16,\"filter_type_name\":\"iokit-registry-entry-class\",\"check_type\":1073741840,\"varargs_count\":1,\"argument\":\"IOSurfaceRoot\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":16,\"filter_type_name\":\"iokit-registry-entry-class\",\"check_type\":1073741840,\"varargs_count\":1,\"argument\":\"IOSurfaceRootUserClient\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":76,\"filter_type_name\":\"iokit-user-client-type\",\"check_type\":1073741900,\"varargs_count\":1,\"argument\":\"IOSurfaceRootUserClient\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":-1,\"errno\":22,\"decision\":\"error\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":16,\"filter_type_name\":\"iokit-registry-entry-class\",\"check_type\":1073741840,\"varargs_count\":1,\"argument\":\"IOSurfaceRoot\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":18,\"filter_type_name\":\"iokit-connection\",\"check_type\":1073741842,\"varargs_count\":1,\"argument\":\"IOAccelerator\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":-1,\"errno\":3,\"decision\":\"error\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":76,\"filter_type_name\":\"iokit-user-client-type\",\"check_type\":1073741900,\"varargs_count\":1,\"argument\":\"0\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":-1,\"errno\":22,\"decision\":\"error\"}\nsandbox operation \"iokit-open\" is obsolete; replace with \"iokit-open-user-client\"\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open\",\"filter_type\":76,\"filter_type_name\":\"iokit-user-client-type\",\"check_type\":1073741900,\"varargs_count\":1,\"argument\":\"0\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":-1,\"errno\":22,\"decision\":\"error\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":-1,\"filter_type_name\":\"none\",\"check_type\":-1,\"varargs_count\":0,\"argument\":\"<none>\",\"no_report\":false,\"no_report_reason\":\"not_applicable\",\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":-1,\"errno\":22,\"decision\":\"error\"}\n"
    },
    {
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
      "profile_id": "runtime-closure:iokit:v15_ioacceleration_user_client",
      "expectation_id": "runtime-closure:iokit:v15_ioacceleration_user_client:iosurface_root",
      "operation": "iokit-open-service",
      "path": "IOSurfaceRoot",
      "expected": "allow",
      "actual": "deny",
      "mismatch_type": "unexpected_deny",
      "violation_summary": "EPERM",
      "notes": "{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"apply\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"errno\":0,\"err_class\":\"ok\",\"err_class_source\":\"none\",\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.77c3c910-25d5-4499-9e5e-c70c570597ff/book/experiments/runtime-closure/out/7deb2296-7fa8-48ea-849f-ac7a696f7c93/77c3c910-25d5-4499-9e5e-c70c570597ff/runtime_profiles/v15_iokit_ioacceleration_user_client.runtime-closure_iokit_v15_ioacceleration_user_client.runtime.sb\",\"pid\":38523}\n{\"tool\":\"sbpl-apply\",\"marker_schema_version\":1,\"stage\":\"applied\",\"mode\":\"sbpl\",\"api\":\"sandbox_init\",\"rc\":0,\"profile\":\"/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime.77c3c910-25d5-4499-9e5e-c70c570597ff/book/experiments/runtime-closure/out/7deb2296-7fa8-48ea-849f-ac7a696f7c93/77c3c910-25d5-4499-9e5e-c70c570597ff/runtime_profiles/v15_iokit_ioacceleration_user_client.runtime-closure_iokit_v15_ioacceleration_user_client.runtime.sb\",\"pid\":38523}\nsandbox operation \"iokit-open\" is obsolete; replace with \"iokit-open-user-client\"\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open\",\"filter_type\":16,\"filter_type_name\":\"iokit-registry-entry-class\",\"check_type\":1073741840,\"varargs_count\":1,\"argument\":\"IOSurfaceRoot\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":1,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-service\",\"filter_type\":16,\"filter_type_name\":\"iokit-registry-entry-class\",\"check_type\":1073741840,\"varargs_count\":1,\"argument\":\"IOSurfaceRoot\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":0,\"errno\":0,\"decision\":\"allow\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":16,\"filter_type_name\":\"iokit-registry-entry-class\",\"check_type\":1073741840,\"varargs_count\":1,\"argument\":\"IOSurfaceRootUserClient\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":76,\"filter_type_name\":\"iokit-user-client-type\",\"check_type\":1073741900,\"varargs_count\":1,\"argument\":\"IOSurfaceRootUserClient\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":-1,\"errno\":22,\"decision\":\"error\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":16,\"filter_type_name\":\"iokit-registry-entry-class\",\"check_type\":1073741840,\"varargs_count\":1,\"argument\":\"IOSurfaceRoot\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":1,\"errno\":0,\"decision\":\"deny\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":18,\"filter_type_name\":\"iokit-connection\",\"check_type\":1073741842,\"varargs_count\":1,\"argument\":\"IOAccelerator\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":-1,\"errno\":3,\"decision\":\"error\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":76,\"filter_type_name\":\"iokit-user-client-type\",\"check_type\":1073741900,\"varargs_count\":1,\"argument\":\"0\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":-1,\"errno\":22,\"decision\":\"error\"}\nsandbox operation \"iokit-open\" is obsolete; replace with \"iokit-open-user-client\"\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open\",\"filter_type\":76,\"filter_type_name\":\"iokit-user-client-type\",\"check_type\":1073741900,\"varargs_count\":1,\"argument\":\"0\",\"no_report\":true,\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":-1,\"errno\":22,\"decision\":\"error\"}\n{\"tool\":\"seatbelt-callout\",\"marker_schema_version\":2,\"stage\":\"pre_syscall\",\"api\":\"sandbox_check_by_audit_token\",\"operation\":\"iokit-open-user-client\",\"filter_type\":-1,\"filter_type_name\":\"none\",\"check_type\":-1,\"varargs_count\":0,\"argument\":\"<none>\",\"no_report\":false,\"no_report_reason\":\"not_applicable\",\"token_status\":\"ok\",\"token_mach_kr\":0,\"rc\":-1,\"errno\":22,\"decision\":\"error\"}\n"
    }
  ],
  "counts": {
    "unexpected_deny": 3
  }
}