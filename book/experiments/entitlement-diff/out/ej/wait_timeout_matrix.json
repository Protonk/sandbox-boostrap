{
  "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
  "entrypoint": "book/tools/entitlement/EntitlementJail.app/Contents/MacOS/entitlement-jail",
  "scenario": "wait_timeout_matrix",
  "tmp_dir": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/",
  "cases": [
    {
      "case_id": "t150_fast",
      "wait_timeout_ms": 150,
      "trigger_delay_s": 0.05
    },
    {
      "case_id": "t150_slow",
      "wait_timeout_ms": 150,
      "trigger_delay_s": 0.3
    },
    {
      "case_id": "t500_fast",
      "wait_timeout_ms": 500,
      "trigger_delay_s": 0.1
    },
    {
      "case_id": "t500_slow",
      "wait_timeout_ms": 500,
      "trigger_delay_s": 0.9
    }
  ],
  "runs": [
    {
      "profile_id": "minimal",
      "service_id": "com.yourteam.entitlement-jail.ProbeService_minimal",
      "probe_id": "capabilities_snapshot",
      "probe_args": [],
      "plan_id": "entitlement-diff:ej",
      "row_id": "wait_timeout.minimal.capabilities_snapshot",
      "log_path": "book/experiments/entitlement-diff/out/ej/logs/wait_timeout.minimal.capabilities_snapshot.log",
      "log_capture_source": "$HOME/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.capabilities_snapshot.log",
      "log_copy_error": "source_missing: /Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.capabilities_snapshot.log",
      "command": [
        "book/tools/entitlement/EntitlementJail.app/Contents/MacOS/entitlement-jail",
        "run-xpc",
        "--log-path-class",
        "tmp",
        "--log-name",
        "wait_timeout.minimal.capabilities_snapshot.log",
        "--plan-id",
        "entitlement-diff:ej",
        "--row-id",
        "wait_timeout.minimal.capabilities_snapshot",
        "--profile",
        "minimal",
        "capabilities_snapshot"
      ],
      "exit_code": 0,
      "stdout": "{\"data\":{\"argv\":[],\"correlation_id\":\"E215A546-E0F8-4FBF-B3A8-92EF12D8C90E\",\"details\":{\"app_support_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/Library\\/Application Support\",\"bundle_id\":\"com.yourteam.entitlement-jail.ProbeService_minimal\",\"caches_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/Library\\/Caches\",\"correlation_id\":\"E215A546-E0F8-4FBF-B3A8-92EF12D8C90E\",\"cwd\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\",\"desktop_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/Desktop\",\"documents_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/Documents\",\"downloads_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/Downloads\",\"file_path\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/Library\\/Preferences\\/com.yourteam.entitlement-jail.ProbeService_minimal.plist\",\"has_allow_dyld_env\":\"false\",\"has_allow_jit\":\"false\",\"has_allow_unsigned_exec_mem\":\"false\",\"has_app_sandbox\":\"true\",\"has_bookmarks_app_scope\":\"false\",\"has_disable_library_validation\":\"false\",\"has_downloads_rw\":\"false\",\"has_get_task_allow\":\"false\",\"has_network_client\":\"false\",\"has_user_selected_executable\":\"false\",\"has_user_selected_read_only\":\"false\",\"has_user_selected_read_write\":\"false\",\"home_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\",\"pid\":\"9601\",\"prefs_path_guess\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/Library\\/Preferences\\/com.yourteam.entitlement-jail.ProbeService_minimal.plist\",\"probe_family\":\"capabilities_snapshot\",\"probe_pid\":\"9601\",\"process_name\":\"ProbeService_minimal\",\"service_pid\":\"9601\",\"tmp_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/\"},\"ended_at_iso8601\":\"2025-12-24T23:28:24.223Z\",\"layer_attribution\":{\"world_shape_change\":\"home_containerized\"},\"log_capture_error\":\"write_failed: Error Domain=NSCocoaErrorDomain Code=513 \\\"You don\u2019t have permission to save the file \u201cwait_timeout.minimal.capabilities_snapshot.log\u201d in the folder \u201ctmp\u201d.\\\" UserInfo={NSFilePath=\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/wait_timeout.minimal.capabilities_snapshot.log, NSUnderlyingError=0x600001e90750 {Error Domain=NSPOSIXErrorDomain Code=1 \\\"Operation not permitted\\\"}}\",\"log_capture_path\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/wait_timeout.minimal.capabilities_snapshot.log\",\"log_capture_status\":\"requested_failed\",\"plan_id\":\"entitlement-diff:ej\",\"probe_id\":\"capabilities_snapshot\",\"row_id\":\"wait_timeout.minimal.capabilities_snapshot\",\"service_build\":\"1\",\"service_bundle_id\":\"com.yourteam.entitlement-jail.ProbeService_minimal\",\"service_name\":\"ProbeService_minimal\",\"service_version\":\"1.0\",\"started_at_iso8601\":\"2025-12-24T23:28:24.222Z\",\"thread_id\":\"6663\"},\"generated_at_unix_ms\":1766618904233,\"kind\":\"probe_response\",\"result\":{\"normalized_outcome\":\"ok\",\"ok\":true,\"rc\":0,\"stderr\":\"\",\"stdout\":\"\"},\"schema_version\":1}\n",
      "stderr": "failed to write log capture: Error Domain=NSCocoaErrorDomain Code=513 \"You don\u2019t have permission to save the file \u201cwait_timeout.minimal.capabilities_snapshot.log\u201d in the folder \u201ctmp\u201d.\" UserInfo={NSFilePath=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.capabilities_snapshot.log, NSUnderlyingError=0x600001e90750 {Error Domain=NSPOSIXErrorDomain Code=1 \"Operation not permitted\"}}\nhint: choose a path under /Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data or /Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/tmp/\n",
      "stdout_json": {
        "data": {
          "argv": [],
          "correlation_id": "E215A546-E0F8-4FBF-B3A8-92EF12D8C90E",
          "details": {
            "app_support_dir": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/Library/Application Support",
            "bundle_id": "com.yourteam.entitlement-jail.ProbeService_minimal",
            "caches_dir": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/Library/Caches",
            "correlation_id": "E215A546-E0F8-4FBF-B3A8-92EF12D8C90E",
            "cwd": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data",
            "desktop_dir": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/Desktop",
            "documents_dir": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/Documents",
            "downloads_dir": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/Downloads",
            "file_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/Library/Preferences/com.yourteam.entitlement-jail.ProbeService_minimal.plist",
            "has_allow_dyld_env": "false",
            "has_allow_jit": "false",
            "has_allow_unsigned_exec_mem": "false",
            "has_app_sandbox": "true",
            "has_bookmarks_app_scope": "false",
            "has_disable_library_validation": "false",
            "has_downloads_rw": "false",
            "has_get_task_allow": "false",
            "has_network_client": "false",
            "has_user_selected_executable": "false",
            "has_user_selected_read_only": "false",
            "has_user_selected_read_write": "false",
            "home_dir": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data",
            "pid": "9601",
            "prefs_path_guess": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/Library/Preferences/com.yourteam.entitlement-jail.ProbeService_minimal.plist",
            "probe_family": "capabilities_snapshot",
            "probe_pid": "9601",
            "process_name": "ProbeService_minimal",
            "service_pid": "9601",
            "tmp_dir": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/"
          },
          "ended_at_iso8601": "2025-12-24T23:28:24.223Z",
          "layer_attribution": {
            "world_shape_change": "home_containerized"
          },
          "log_capture_error": "write_failed: Error Domain=NSCocoaErrorDomain Code=513 \"You don\u2019t have permission to save the file \u201cwait_timeout.minimal.capabilities_snapshot.log\u201d in the folder \u201ctmp\u201d.\" UserInfo={NSFilePath=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.capabilities_snapshot.log, NSUnderlyingError=0x600001e90750 {Error Domain=NSPOSIXErrorDomain Code=1 \"Operation not permitted\"}}",
          "log_capture_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.capabilities_snapshot.log",
          "log_capture_status": "requested_failed",
          "plan_id": "entitlement-diff:ej",
          "probe_id": "capabilities_snapshot",
          "row_id": "wait_timeout.minimal.capabilities_snapshot",
          "service_build": "1",
          "service_bundle_id": "com.yourteam.entitlement-jail.ProbeService_minimal",
          "service_name": "ProbeService_minimal",
          "service_version": "1.0",
          "started_at_iso8601": "2025-12-24T23:28:24.222Z",
          "thread_id": "6663"
        },
        "generated_at_unix_ms": 1766618904233,
        "kind": "probe_response",
        "result": {
          "normalized_outcome": "ok",
          "ok": true,
          "rc": 0,
          "stderr": "",
          "stdout": ""
        },
        "schema_version": 1
      }
    },
    {
      "command": [
        "book/tools/entitlement/EntitlementJail.app/Contents/MacOS/entitlement-jail",
        "run-xpc",
        "--log-path-class",
        "tmp",
        "--log-name",
        "wait_timeout.minimal.t150_fast.log",
        "--plan-id",
        "entitlement-diff:ej",
        "--row-id",
        "wait_timeout.minimal.t150_fast",
        "--wait-exists",
        "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t150_fast.trigger",
        "--wait-timeout-ms",
        "150",
        "--profile",
        "minimal",
        "probe_catalog"
      ],
      "plan_id": "entitlement-diff:ej",
      "row_id": "wait_timeout.minimal.t150_fast",
      "exit_code": 0,
      "stdout": "{\"data\":{\"argv\":[],\"correlation_id\":\"9B23402D-B6AA-4ACA-83F1-BCFB96643D61\",\"details\":{\"bundle_id\":\"com.yourteam.entitlement-jail.ProbeService_minimal\",\"correlation_id\":\"9B23402D-B6AA-4ACA-83F1-BCFB96643D61\",\"cwd\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\",\"home_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\",\"pid\":\"9605\",\"probe_count\":\"17\",\"probe_family\":\"probe_catalog\",\"probe_pid\":\"9605\",\"process_name\":\"ProbeService_minimal\",\"service_pid\":\"9605\",\"tmp_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/\",\"wait_duration_ms\":\"152\",\"wait_ended_at_ns\":\"1686954051692208\",\"wait_interval_ms\":\"200\",\"wait_mode\":\"exists\",\"wait_path\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/ej_wait_timeout_t150_fast.trigger\",\"wait_started_at_ns\":\"1686953899005708\",\"wait_timeout_ms\":\"150\"},\"ended_at_iso8601\":\"2025-12-24T23:28:24.452Z\",\"log_capture_error\":\"write_failed: Error Domain=NSCocoaErrorDomain Code=513 \\\"You don\u2019t have permission to save the file \u201cwait_timeout.minimal.t150_fast.log\u201d in the folder \u201ctmp\u201d.\\\" UserInfo={NSFilePath=\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/wait_timeout.minimal.t150_fast.log, NSUnderlyingError=0x6000023b5260 {Error Domain=NSPOSIXErrorDomain Code=1 \\\"Operation not permitted\\\"}}\",\"log_capture_path\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/wait_timeout.minimal.t150_fast.log\",\"log_capture_status\":\"requested_failed\",\"plan_id\":\"entitlement-diff:ej\",\"probe_id\":\"probe_catalog\",\"row_id\":\"wait_timeout.minimal.t150_fast\",\"service_build\":\"1\",\"service_bundle_id\":\"com.yourteam.entitlement-jail.ProbeService_minimal\",\"service_name\":\"ProbeService_minimal\",\"service_version\":\"1.0\",\"started_at_iso8601\":\"2025-12-24T23:28:24.291Z\",\"thread_id\":\"6915\"},\"generated_at_unix_ms\":1766618904467,\"kind\":\"probe_response\",\"result\":{\"normalized_outcome\":\"ok\",\"ok\":true,\"rc\":0,\"stderr\":\"\",\"stdout\":\"{\\\"generated_at_iso8601\\\":\\\"2025-12-24T23:28:24Z\\\",\\\"probes\\\":[{\\\"entitlement_hints\\\":[\\\"none (observer)\\\"],\\\"examples\\\":[\\\"probe_catalog\\\"],\\\"notes\\\":[\\\"Outputs JSON in RunProbeResponse.stdout.\\\",\\\"Use <probe-id> --help for per-probe usage.\\\"],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"probe_catalog\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"emit a JSON catalog of available probes\\\",\\\"usage\\\":\\\"probe_catalog\\\"},{\\\"entitlement_hints\\\":[\\\"none (observer)\\\"],\\\"examples\\\":[\\\"world_shape\\\"],\\\"notes\\\":[\\\"Reports HOME\\\\\\/TMP\\\\\\/CWD and containerization signals.\\\"],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"world_shape\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"report containerization and world shape metadata\\\",\\\"usage\\\":\\\"world_shape\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.network.client\\\"],\\\"examples\\\":[\\\"network_tcp_connect --host 1.1.1.1 --port 443\\\"],\\\"notes\\\":[],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"network_tcp_connect\\\",\\\"required_args\\\":[\\\"--host <ipv4>\\\",\\\"--port <1..65535>\\\"],\\\"summary\\\":\\\"attempt a TCP connect to an IPv4 host:port\\\",\\\"usage\\\":\\\"network_tcp_connect --host <ipv4> --port <1..65535>\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.files.downloads.read-write\\\"],\\\"examples\\\":[\\\"downloads_rw\\\",\\\"downloads_rw --name demo.txt\\\"],\\\"notes\\\":[\\\"Writes under Downloads\\\\\\/entitlement-jail-harness.\\\"],\\\"optional_args\\\":[\\\"--name <file-name>\\\"],\\\"probe_id\\\":\\\"downloads_rw\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"read\\\\\\/write\\\\\\/remove a file under Downloads\\\\\\/entitlement-jail-harness\\\",\\\"usage\\\":\\\"downloads_rw [--name <file-name>]\\\"},{\\\"entitlement_hints\\\":[\\\"path-dependent (file access entitlements)\\\"],\\\"examples\\\":[\\\"fs_op --op stat --path-class downloads\\\",\\\"fs_op --op create --path-class tmp --target run_dir\\\"],\\\"notes\\\":[\\\"Destructive direct-path ops are refused unless you use --path-class\\\\\\/--target (or a path under *\\\\\\/entitlement-jail-harness\\\\\\/*) or set --allow-unsafe-path.\\\"],\\\"optional_args\\\":[\\\"--target <base|harness_dir|run_dir|specimen_file>\\\",\\\"--name <file-name>\\\",\\\"--to <path> | --to-path <path> | --to-name <file-name>\\\",\\\"--max-entries <n>\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"fs_op\\\",\\\"required_args\\\":[\\\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\\",\\\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\\\"],\\\"summary\\\":\\\"parameterized filesystem operations\\\",\\\"usage\\\":\\\"fs_op --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\\\n      (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n      [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\\\n      [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path]\\\"},{\\\"entitlement_hints\\\":[\\\"path-dependent (file access entitlements)\\\"],\\\"examples\\\":[\\\"fs_op_wait --op open_read --path-class tmp --wait-fifo \\\\\\/tmp\\\\\\/ej-wait.fifo\\\",\\\"fs_op_wait --op stat --path \\\\\\/tmp\\\\\\/target --wait-exists \\\\\\/tmp\\\\\\/trigger --wait-timeout-ms 60000\\\"],\\\"notes\\\":[\\\"Blocks until the wait trigger is satisfied, then runs fs_op.\\\",\\\"--wait-interval-ms is only used with --wait-exists.\\\"],\\\"optional_args\\\":[\\\"--target <base|harness_dir|run_dir|specimen_file>\\\",\\\"--name <file-name>\\\",\\\"--to <path> | --to-path <path> | --to-name <file-name>\\\",\\\"--max-entries <n>\\\",\\\"--allow-unsafe-path\\\",\\\"--wait-timeout-ms <n>\\\",\\\"--wait-interval-ms <n>\\\"],\\\"probe_id\\\":\\\"fs_op_wait\\\",\\\"required_args\\\":[\\\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\\",\\\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\\\",\\\"--wait-fifo <path> | --wait-exists <path>\\\"],\\\"summary\\\":\\\"wait for a trigger, then run fs_op\\\",\\\"usage\\\":\\\"fs_op_wait --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\\\n          (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n          [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\\\n          [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path]\\\\n          (--wait-fifo <path> | --wait-exists <path>) [--wait-timeout-ms <n>] [--wait-interval-ms <n>]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.network.client\\\"],\\\"examples\\\":[\\\"net_op --op getaddrinfo --host example.com\\\",\\\"net_op --op tcp_connect --host 127.0.0.1 --port 80\\\"],\\\"notes\\\":[\\\"--port is required for tcp_connect and udp_send.\\\"],\\\"optional_args\\\":[\\\"--port <1..65535>\\\",\\\"--numeric\\\"],\\\"probe_id\\\":\\\"net_op\\\",\\\"required_args\\\":[\\\"--op <getaddrinfo|tcp_connect|udp_send>\\\",\\\"--host <host>\\\"],\\\"summary\\\":\\\"parameterized network operations\\\",\\\"usage\\\":\\\"net_op --op <getaddrinfo|tcp_connect|udp_send> --host <host> [--port <1..65535>] [--numeric]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.cs.disable-library-validation\\\",\\\"com.apple.security.cs.allow-dyld-environment-variables (if you rely on DYLD_*)\\\"],\\\"examples\\\":[\\\"dlopen_external --path \\\\\\/path\\\\\\/to\\\\\\/testdylib.dylib\\\"],\\\"notes\\\":[\\\"Executes dylib initializers; this is not a passive probe.\\\",\\\"Use a signed dylib (see tests\\\\\\/fixtures\\\\\\/TestDylib).\\\"],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"dlopen_external\\\",\\\"required_args\\\":[\\\"--path <abs> (or EJ_DLOPEN_PATH)\\\"],\\\"summary\\\":\\\"dlopen a signed dylib by absolute path\\\",\\\"usage\\\":\\\"dlopen_external --path <abs> (or set EJ_DLOPEN_PATH)\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.cs.allow-jit\\\"],\\\"examples\\\":[\\\"jit_map_jit\\\",\\\"jit_map_jit --size 65536\\\"],\\\"notes\\\":[\\\"Reports errno on MAP_JIT failure.\\\"],\\\"optional_args\\\":[\\\"--size <bytes> (default: 16384)\\\"],\\\"probe_id\\\":\\\"jit_map_jit\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"attempt mmap with MAP_JIT\\\",\\\"usage\\\":\\\"jit_map_jit [--size <bytes>]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.cs.allow-unsigned-executable-memory\\\"],\\\"examples\\\":[\\\"jit_rwx_legacy\\\",\\\"jit_rwx_legacy --size 65536\\\"],\\\"notes\\\":[\\\"Reports errno on RWX mmap failure.\\\"],\\\"optional_args\\\":[\\\"--size <bytes> (default: 16384)\\\"],\\\"probe_id\\\":\\\"jit_rwx_legacy\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"attempt mmap with RWX permissions (legacy)\\\",\\\"usage\\\":\\\"jit_rwx_legacy [--size <bytes>]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.files.bookmarks.app-scope\\\",\\\"com.apple.security.files.user-selected.read-only\\\",\\\"com.apple.security.files.user-selected.read-write\\\"],\\\"examples\\\":[\\\"bookmark_op --bookmark-b64 <b64> --op stat\\\",\\\"bookmark_op --bookmark-path \\\\\\/tmp\\\\\\/token.txt --op open_read --relative file.txt\\\"],\\\"notes\\\":[\\\"Uses ScopedBookmarksAgent IPC for security-scoped bookmarks.\\\"],\\\"optional_args\\\":[\\\"--relative <rel>\\\",\\\"--op <fs_op-op> (default: stat)\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"bookmark_op\\\",\\\"required_args\\\":[\\\"--bookmark-b64 <base64> | --bookmark-path <path>\\\"],\\\"summary\\\":\\\"resolve a bookmark token and run a filesystem op against it\\\",\\\"usage\\\":\\\"bookmark_op --bookmark-b64 <base64> | --bookmark-path <path>\\\\n            [--relative <rel>] [--op <fs_op-op>] [--allow-unsafe-path]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.files.bookmarks.app-scope\\\",\\\"com.apple.security.files.user-selected.read-only\\\",\\\"com.apple.security.files.user-selected.read-write\\\"],\\\"examples\\\":[\\\"bookmark_make --path \\\\\\/Users\\\\\\/me\\\\\\/Downloads\\\",\\\"bookmark_make --path \\\\\\/Users\\\\\\/me\\\\\\/Downloads --read-only\\\"],\\\"notes\\\":[\\\"Security-scoped bookmarks use ScopedBookmarksAgent IPC.\\\"],\\\"optional_args\\\":[\\\"--no-security-scope\\\",\\\"--read-only\\\",\\\"--allow-missing\\\"],\\\"probe_id\\\":\\\"bookmark_make\\\",\\\"required_args\\\":[\\\"--path <abs>\\\"],\\\"summary\\\":\\\"create a security-scoped bookmark token for a path\\\",\\\"usage\\\":\\\"bookmark_make --path <abs> [--no-security-scope] [--read-only] [--allow-missing]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.files.bookmarks.app-scope\\\",\\\"com.apple.security.files.user-selected.read-only\\\",\\\"com.apple.security.files.user-selected.read-write\\\"],\\\"examples\\\":[\\\"bookmark_roundtrip --path \\\\\\/Users\\\\\\/me\\\\\\/Downloads --op stat\\\",\\\"bookmark_roundtrip --path \\\\\\/Users\\\\\\/me\\\\\\/Downloads --op open_read --relative file.txt\\\"],\\\"notes\\\":[\\\"Returns the bookmark token in stdout and the fs_op result in details.\\\"],\\\"optional_args\\\":[\\\"--op <fs_op-op> (default: stat)\\\",\\\"--relative <rel>\\\",\\\"--no-security-scope\\\",\\\"--read-only\\\",\\\"--allow-missing\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"bookmark_roundtrip\\\",\\\"required_args\\\":[\\\"--path <abs>\\\"],\\\"summary\\\":\\\"create a bookmark token and immediately resolve + run a filesystem op\\\",\\\"usage\\\":\\\"bookmark_roundtrip --path <abs> [--op <fs_op-op>] [--relative <rel>] [--no-security-scope] [--read-only] [--allow-missing] [--allow-unsafe-path]\\\"},{\\\"entitlement_hints\\\":[\\\"none (observer)\\\"],\\\"examples\\\":[\\\"capabilities_snapshot\\\"],\\\"notes\\\":[\\\"Includes entitlement presence booleans and standard directory paths.\\\"],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"capabilities_snapshot\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"report entitlements and resolved standard directories\\\",\\\"usage\\\":\\\"capabilities_snapshot\\\"},{\\\"entitlement_hints\\\":[\\\"none (containerization evidence)\\\"],\\\"examples\\\":[\\\"userdefaults_op --op read --key example\\\",\\\"userdefaults_op --op write --key example --value 1\\\"],\\\"notes\\\":[\\\"Useful for observing containerized preferences paths.\\\"],\\\"optional_args\\\":[\\\"--op <read|write|remove|sync> (default: read)\\\",\\\"--key <k>\\\",\\\"--value <v>\\\",\\\"--suite <suite>\\\"],\\\"probe_id\\\":\\\"userdefaults_op\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"read\\\\\\/write\\\\\\/remove\\\\\\/sync a UserDefaults key\\\",\\\"usage\\\":\\\"userdefaults_op --op <read|write|remove|sync> [--key <k>] [--value <v>] [--suite <suite>]\\\"},{\\\"entitlement_hints\\\":[\\\"path-dependent (file access entitlements)\\\"],\\\"examples\\\":[\\\"fs_xattr --op get --path \\\\\\/tmp\\\\\\/file --name com.apple.quarantine\\\",\\\"fs_xattr --op list --path \\\\\\/tmp\\\\\\/file\\\"],\\\"notes\\\":[\\\"xattr writes are refused outside harness paths unless --allow-write or --allow-unsafe-path is set.\\\"],\\\"optional_args\\\":[\\\"--name <xattr>\\\",\\\"--value <v>\\\",\\\"--allow-write\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"fs_xattr\\\",\\\"required_args\\\":[\\\"--op <get|list|set|remove>\\\",\\\"--path <abs>\\\"],\\\"summary\\\":\\\"get\\\\\\/list\\\\\\/set\\\\\\/remove extended attributes\\\",\\\"usage\\\":\\\"fs_xattr --op <get|list|set|remove> --path <abs> [--name <xattr>] [--value <v>] [--allow-write] [--allow-unsafe-path]\\\"},{\\\"entitlement_hints\\\":[\\\"path-dependent (file access entitlements)\\\"],\\\"examples\\\":[\\\"fs_coordinated_op --op read --path-class documents\\\",\\\"fs_coordinated_op --op write --path-class tmp --target run_dir\\\"],\\\"notes\\\":[\\\"Coordinated writes to direct paths are refused unless you use --path-class\\\\\\/--target (or a path under *\\\\\\/entitlement-jail-harness\\\\\\/*) or set --allow-unsafe-path.\\\"],\\\"optional_args\\\":[\\\"--target <base|harness_dir|run_dir|specimen_file>\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"fs_coordinated_op\\\",\\\"required_args\\\":[\\\"--op <read|write>\\\",\\\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\\\"],\\\"summary\\\":\\\"NSFileCoordinator mediated read\\\\\\/write\\\",\\\"usage\\\":\\\"fs_coordinated_op --op <read|write> (--path <abs> | --path-class <...>) [--target <...>] [--allow-unsafe-path]\\\"}],\\\"schema_version\\\":1,\\\"trace_symbols\\\":[{\\\"probe_id\\\":\\\"fs_op\\\",\\\"symbols\\\":[\\\"ej_probe_fs_op\\\"]},{\\\"probe_id\\\":\\\"fs_op_wait\\\",\\\"symbols\\\":[\\\"ej_probe_fs_op_wait\\\"]},{\\\"probe_id\\\":\\\"net_op\\\",\\\"symbols\\\":[\\\"ej_probe_net_op\\\"]},{\\\"probe_id\\\":\\\"dlopen_external\\\",\\\"symbols\\\":[\\\"ej_probe_dlopen_external\\\"]},{\\\"probe_id\\\":\\\"jit_map_jit\\\",\\\"symbols\\\":[\\\"ej_probe_jit_map_jit\\\"]},{\\\"probe_id\\\":\\\"jit_rwx_legacy\\\",\\\"symbols\\\":[\\\"ej_probe_jit_rwx_legacy\\\"]}]}\"},\"schema_version\":1}",
      "stderr": "[client] wait-ready mode=exists wait_path=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t150_fast.trigger\nfailed to write log capture: Error Domain=NSCocoaErrorDomain Code=513 \"You don\u2019t have permission to save the file \u201cwait_timeout.minimal.t150_fast.log\u201d in the folder \u201ctmp\u201d.\" UserInfo={NSFilePath=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t150_fast.log, NSUnderlyingError=0x6000023b5260 {Error Domain=NSPOSIXErrorDomain Code=1 \"Operation not permitted\"}}\nhint: choose a path under /Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data or /Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/tmp/",
      "stdout_json": {
        "data": {
          "argv": [],
          "correlation_id": "9B23402D-B6AA-4ACA-83F1-BCFB96643D61",
          "details": {
            "bundle_id": "com.yourteam.entitlement-jail.ProbeService_minimal",
            "correlation_id": "9B23402D-B6AA-4ACA-83F1-BCFB96643D61",
            "cwd": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data",
            "home_dir": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data",
            "pid": "9605",
            "probe_count": "17",
            "probe_family": "probe_catalog",
            "probe_pid": "9605",
            "process_name": "ProbeService_minimal",
            "service_pid": "9605",
            "tmp_dir": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/",
            "wait_duration_ms": "152",
            "wait_ended_at_ns": "1686954051692208",
            "wait_interval_ms": "200",
            "wait_mode": "exists",
            "wait_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t150_fast.trigger",
            "wait_started_at_ns": "1686953899005708",
            "wait_timeout_ms": "150"
          },
          "ended_at_iso8601": "2025-12-24T23:28:24.452Z",
          "log_capture_error": "write_failed: Error Domain=NSCocoaErrorDomain Code=513 \"You don\u2019t have permission to save the file \u201cwait_timeout.minimal.t150_fast.log\u201d in the folder \u201ctmp\u201d.\" UserInfo={NSFilePath=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t150_fast.log, NSUnderlyingError=0x6000023b5260 {Error Domain=NSPOSIXErrorDomain Code=1 \"Operation not permitted\"}}",
          "log_capture_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t150_fast.log",
          "log_capture_status": "requested_failed",
          "plan_id": "entitlement-diff:ej",
          "probe_id": "probe_catalog",
          "row_id": "wait_timeout.minimal.t150_fast",
          "service_build": "1",
          "service_bundle_id": "com.yourteam.entitlement-jail.ProbeService_minimal",
          "service_name": "ProbeService_minimal",
          "service_version": "1.0",
          "started_at_iso8601": "2025-12-24T23:28:24.291Z",
          "thread_id": "6915"
        },
        "generated_at_unix_ms": 1766618904467,
        "kind": "probe_response",
        "result": {
          "normalized_outcome": "ok",
          "ok": true,
          "rc": 0,
          "stderr": "",
          "stdout": "{\"generated_at_iso8601\":\"2025-12-24T23:28:24Z\",\"probes\":[{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"probe_catalog\"],\"notes\":[\"Outputs JSON in RunProbeResponse.stdout.\",\"Use <probe-id> --help for per-probe usage.\"],\"optional_args\":[],\"probe_id\":\"probe_catalog\",\"required_args\":[],\"summary\":\"emit a JSON catalog of available probes\",\"usage\":\"probe_catalog\"},{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"world_shape\"],\"notes\":[\"Reports HOME\\/TMP\\/CWD and containerization signals.\"],\"optional_args\":[],\"probe_id\":\"world_shape\",\"required_args\":[],\"summary\":\"report containerization and world shape metadata\",\"usage\":\"world_shape\"},{\"entitlement_hints\":[\"com.apple.security.network.client\"],\"examples\":[\"network_tcp_connect --host 1.1.1.1 --port 443\"],\"notes\":[],\"optional_args\":[],\"probe_id\":\"network_tcp_connect\",\"required_args\":[\"--host <ipv4>\",\"--port <1..65535>\"],\"summary\":\"attempt a TCP connect to an IPv4 host:port\",\"usage\":\"network_tcp_connect --host <ipv4> --port <1..65535>\"},{\"entitlement_hints\":[\"com.apple.security.files.downloads.read-write\"],\"examples\":[\"downloads_rw\",\"downloads_rw --name demo.txt\"],\"notes\":[\"Writes under Downloads\\/entitlement-jail-harness.\"],\"optional_args\":[\"--name <file-name>\"],\"probe_id\":\"downloads_rw\",\"required_args\":[],\"summary\":\"read\\/write\\/remove a file under Downloads\\/entitlement-jail-harness\",\"usage\":\"downloads_rw [--name <file-name>]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_op --op stat --path-class downloads\",\"fs_op --op create --path-class tmp --target run_dir\"],\"notes\":[\"Destructive direct-path ops are refused unless you use --path-class\\/--target (or a path under *\\/entitlement-jail-harness\\/*) or set --allow-unsafe-path.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--name <file-name>\",\"--to <path> | --to-path <path> | --to-name <file-name>\",\"--max-entries <n>\",\"--allow-unsafe-path\"],\"probe_id\":\"fs_op\",\"required_args\":[\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\"],\"summary\":\"parameterized filesystem operations\",\"usage\":\"fs_op --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\n      (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n      [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\n      [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_op_wait --op open_read --path-class tmp --wait-fifo \\/tmp\\/ej-wait.fifo\",\"fs_op_wait --op stat --path \\/tmp\\/target --wait-exists \\/tmp\\/trigger --wait-timeout-ms 60000\"],\"notes\":[\"Blocks until the wait trigger is satisfied, then runs fs_op.\",\"--wait-interval-ms is only used with --wait-exists.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--name <file-name>\",\"--to <path> | --to-path <path> | --to-name <file-name>\",\"--max-entries <n>\",\"--allow-unsafe-path\",\"--wait-timeout-ms <n>\",\"--wait-interval-ms <n>\"],\"probe_id\":\"fs_op_wait\",\"required_args\":[\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\",\"--wait-fifo <path> | --wait-exists <path>\"],\"summary\":\"wait for a trigger, then run fs_op\",\"usage\":\"fs_op_wait --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\n          (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n          [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\n          [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path]\\n          (--wait-fifo <path> | --wait-exists <path>) [--wait-timeout-ms <n>] [--wait-interval-ms <n>]\"},{\"entitlement_hints\":[\"com.apple.security.network.client\"],\"examples\":[\"net_op --op getaddrinfo --host example.com\",\"net_op --op tcp_connect --host 127.0.0.1 --port 80\"],\"notes\":[\"--port is required for tcp_connect and udp_send.\"],\"optional_args\":[\"--port <1..65535>\",\"--numeric\"],\"probe_id\":\"net_op\",\"required_args\":[\"--op <getaddrinfo|tcp_connect|udp_send>\",\"--host <host>\"],\"summary\":\"parameterized network operations\",\"usage\":\"net_op --op <getaddrinfo|tcp_connect|udp_send> --host <host> [--port <1..65535>] [--numeric]\"},{\"entitlement_hints\":[\"com.apple.security.cs.disable-library-validation\",\"com.apple.security.cs.allow-dyld-environment-variables (if you rely on DYLD_*)\"],\"examples\":[\"dlopen_external --path \\/path\\/to\\/testdylib.dylib\"],\"notes\":[\"Executes dylib initializers; this is not a passive probe.\",\"Use a signed dylib (see tests\\/fixtures\\/TestDylib).\"],\"optional_args\":[],\"probe_id\":\"dlopen_external\",\"required_args\":[\"--path <abs> (or EJ_DLOPEN_PATH)\"],\"summary\":\"dlopen a signed dylib by absolute path\",\"usage\":\"dlopen_external --path <abs> (or set EJ_DLOPEN_PATH)\"},{\"entitlement_hints\":[\"com.apple.security.cs.allow-jit\"],\"examples\":[\"jit_map_jit\",\"jit_map_jit --size 65536\"],\"notes\":[\"Reports errno on MAP_JIT failure.\"],\"optional_args\":[\"--size <bytes> (default: 16384)\"],\"probe_id\":\"jit_map_jit\",\"required_args\":[],\"summary\":\"attempt mmap with MAP_JIT\",\"usage\":\"jit_map_jit [--size <bytes>]\"},{\"entitlement_hints\":[\"com.apple.security.cs.allow-unsigned-executable-memory\"],\"examples\":[\"jit_rwx_legacy\",\"jit_rwx_legacy --size 65536\"],\"notes\":[\"Reports errno on RWX mmap failure.\"],\"optional_args\":[\"--size <bytes> (default: 16384)\"],\"probe_id\":\"jit_rwx_legacy\",\"required_args\":[],\"summary\":\"attempt mmap with RWX permissions (legacy)\",\"usage\":\"jit_rwx_legacy [--size <bytes>]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_op --bookmark-b64 <b64> --op stat\",\"bookmark_op --bookmark-path \\/tmp\\/token.txt --op open_read --relative file.txt\"],\"notes\":[\"Uses ScopedBookmarksAgent IPC for security-scoped bookmarks.\"],\"optional_args\":[\"--relative <rel>\",\"--op <fs_op-op> (default: stat)\",\"--allow-unsafe-path\"],\"probe_id\":\"bookmark_op\",\"required_args\":[\"--bookmark-b64 <base64> | --bookmark-path <path>\"],\"summary\":\"resolve a bookmark token and run a filesystem op against it\",\"usage\":\"bookmark_op --bookmark-b64 <base64> | --bookmark-path <path>\\n            [--relative <rel>] [--op <fs_op-op>] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_make --path \\/Users\\/me\\/Downloads\",\"bookmark_make --path \\/Users\\/me\\/Downloads --read-only\"],\"notes\":[\"Security-scoped bookmarks use ScopedBookmarksAgent IPC.\"],\"optional_args\":[\"--no-security-scope\",\"--read-only\",\"--allow-missing\"],\"probe_id\":\"bookmark_make\",\"required_args\":[\"--path <abs>\"],\"summary\":\"create a security-scoped bookmark token for a path\",\"usage\":\"bookmark_make --path <abs> [--no-security-scope] [--read-only] [--allow-missing]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_roundtrip --path \\/Users\\/me\\/Downloads --op stat\",\"bookmark_roundtrip --path \\/Users\\/me\\/Downloads --op open_read --relative file.txt\"],\"notes\":[\"Returns the bookmark token in stdout and the fs_op result in details.\"],\"optional_args\":[\"--op <fs_op-op> (default: stat)\",\"--relative <rel>\",\"--no-security-scope\",\"--read-only\",\"--allow-missing\",\"--allow-unsafe-path\"],\"probe_id\":\"bookmark_roundtrip\",\"required_args\":[\"--path <abs>\"],\"summary\":\"create a bookmark token and immediately resolve + run a filesystem op\",\"usage\":\"bookmark_roundtrip --path <abs> [--op <fs_op-op>] [--relative <rel>] [--no-security-scope] [--read-only] [--allow-missing] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"capabilities_snapshot\"],\"notes\":[\"Includes entitlement presence booleans and standard directory paths.\"],\"optional_args\":[],\"probe_id\":\"capabilities_snapshot\",\"required_args\":[],\"summary\":\"report entitlements and resolved standard directories\",\"usage\":\"capabilities_snapshot\"},{\"entitlement_hints\":[\"none (containerization evidence)\"],\"examples\":[\"userdefaults_op --op read --key example\",\"userdefaults_op --op write --key example --value 1\"],\"notes\":[\"Useful for observing containerized preferences paths.\"],\"optional_args\":[\"--op <read|write|remove|sync> (default: read)\",\"--key <k>\",\"--value <v>\",\"--suite <suite>\"],\"probe_id\":\"userdefaults_op\",\"required_args\":[],\"summary\":\"read\\/write\\/remove\\/sync a UserDefaults key\",\"usage\":\"userdefaults_op --op <read|write|remove|sync> [--key <k>] [--value <v>] [--suite <suite>]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_xattr --op get --path \\/tmp\\/file --name com.apple.quarantine\",\"fs_xattr --op list --path \\/tmp\\/file\"],\"notes\":[\"xattr writes are refused outside harness paths unless --allow-write or --allow-unsafe-path is set.\"],\"optional_args\":[\"--name <xattr>\",\"--value <v>\",\"--allow-write\",\"--allow-unsafe-path\"],\"probe_id\":\"fs_xattr\",\"required_args\":[\"--op <get|list|set|remove>\",\"--path <abs>\"],\"summary\":\"get\\/list\\/set\\/remove extended attributes\",\"usage\":\"fs_xattr --op <get|list|set|remove> --path <abs> [--name <xattr>] [--value <v>] [--allow-write] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_coordinated_op --op read --path-class documents\",\"fs_coordinated_op --op write --path-class tmp --target run_dir\"],\"notes\":[\"Coordinated writes to direct paths are refused unless you use --path-class\\/--target (or a path under *\\/entitlement-jail-harness\\/*) or set --allow-unsafe-path.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--allow-unsafe-path\"],\"probe_id\":\"fs_coordinated_op\",\"required_args\":[\"--op <read|write>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\"],\"summary\":\"NSFileCoordinator mediated read\\/write\",\"usage\":\"fs_coordinated_op --op <read|write> (--path <abs> | --path-class <...>) [--target <...>] [--allow-unsafe-path]\"}],\"schema_version\":1,\"trace_symbols\":[{\"probe_id\":\"fs_op\",\"symbols\":[\"ej_probe_fs_op\"]},{\"probe_id\":\"fs_op_wait\",\"symbols\":[\"ej_probe_fs_op_wait\"]},{\"probe_id\":\"net_op\",\"symbols\":[\"ej_probe_net_op\"]},{\"probe_id\":\"dlopen_external\",\"symbols\":[\"ej_probe_dlopen_external\"]},{\"probe_id\":\"jit_map_jit\",\"symbols\":[\"ej_probe_jit_map_jit\"]},{\"probe_id\":\"jit_rwx_legacy\",\"symbols\":[\"ej_probe_jit_rwx_legacy\"]}]}"
        },
        "schema_version": 1
      },
      "stdout_json_error": null,
      "wait_ready_line": "[client] wait-ready mode=exists wait_path=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t150_fast.trigger",
      "wait_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t150_fast.trigger",
      "wait_mode": "exists",
      "wait_ready_at_unix_s": 1766618904.274495,
      "trigger_events": [
        {
          "kind": "primary",
          "at_unix_s": 1766618904.366223,
          "error": null
        }
      ],
      "wait_info": {
        "mode": "exists",
        "wait_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t150_fast.trigger",
        "wait_ready_line": "[client] wait-ready mode=exists wait_path=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t150_fast.trigger",
        "wait_ready_at_unix_s": 1766618904.274495
      },
      "wait_timeout_ms": 150,
      "trigger_delay_s": 0.05,
      "post_trigger": false,
      "post_trigger_delay_s": null,
      "wait_ready_timeout_s": 10.0,
      "process_timeout_s": 25.0,
      "started_at_unix_s": 1766618904.255172,
      "finished_at_unix_s": 1766618904.5146,
      "duration_s": 0.2594280242919922,
      "log_path": "book/experiments/entitlement-diff/out/ej/logs/wait_timeout.minimal.t150_fast.log",
      "log_capture_source": "$HOME/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t150_fast.log",
      "log_copy_error": "source_missing: /Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t150_fast.log",
      "profile_id": "minimal",
      "service_id": "com.yourteam.entitlement-jail.ProbeService_minimal",
      "probe_id": "probe_catalog",
      "probe_args": [],
      "wait_args": [
        "--wait-exists",
        "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t150_fast.trigger",
        "--wait-timeout-ms",
        "150"
      ],
      "case_id": "t150_fast",
      "case": {
        "case_id": "t150_fast",
        "wait_timeout_ms": 150,
        "trigger_delay_s": 0.05
      }
    },
    {
      "command": [
        "book/tools/entitlement/EntitlementJail.app/Contents/MacOS/entitlement-jail",
        "run-xpc",
        "--log-path-class",
        "tmp",
        "--log-name",
        "wait_timeout.minimal.t150_slow.log",
        "--plan-id",
        "entitlement-diff:ej",
        "--row-id",
        "wait_timeout.minimal.t150_slow",
        "--wait-exists",
        "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t150_slow.trigger",
        "--wait-timeout-ms",
        "150",
        "--profile",
        "minimal",
        "probe_catalog"
      ],
      "plan_id": "entitlement-diff:ej",
      "row_id": "wait_timeout.minimal.t150_slow",
      "exit_code": 1,
      "stdout": "{\"data\":{\"argv\":[],\"correlation_id\":\"EFDAE90B-758B-4291-955B-7A823DCB1D6D\",\"details\":{\"bundle_id\":\"com.yourteam.entitlement-jail.ProbeService_minimal\",\"correlation_id\":\"EFDAE90B-758B-4291-955B-7A823DCB1D6D\",\"cwd\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\",\"home_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\",\"pid\":\"9609\",\"probe_family\":\"wait\",\"probe_pid\":\"9609\",\"process_name\":\"ProbeService_minimal\",\"service_pid\":\"9609\",\"tmp_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/\",\"wait_duration_ms\":\"155\",\"wait_ended_at_ns\":\"1686954350448250\",\"wait_interval_ms\":\"200\",\"wait_mode\":\"exists\",\"wait_path\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/ej_wait_timeout_t150_slow.trigger\",\"wait_started_at_ns\":\"1686954195152583\",\"wait_timeout_ms\":\"150\"},\"ended_at_iso8601\":\"2025-12-24T23:28:24.744Z\",\"log_capture_error\":\"write_failed: Error Domain=NSCocoaErrorDomain Code=513 \\\"You don\u2019t have permission to save the file \u201cwait_timeout.minimal.t150_slow.log\u201d in the folder \u201ctmp\u201d.\\\" UserInfo={NSFilePath=\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/wait_timeout.minimal.t150_slow.log, NSUnderlyingError=0x600001e14900 {Error Domain=NSPOSIXErrorDomain Code=1 \\\"Operation not permitted\\\"}}\",\"log_capture_path\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/wait_timeout.minimal.t150_slow.log\",\"log_capture_status\":\"requested_failed\",\"plan_id\":\"entitlement-diff:ej\",\"probe_id\":\"probe_catalog\",\"row_id\":\"wait_timeout.minimal.t150_slow\",\"service_build\":\"1\",\"service_bundle_id\":\"com.yourteam.entitlement-jail.ProbeService_minimal\",\"service_name\":\"ProbeService_minimal\",\"service_version\":\"1.0\",\"started_at_iso8601\":\"2025-12-24T23:28:24.587Z\",\"thread_id\":\"4611\"},\"generated_at_unix_ms\":1766618904769,\"kind\":\"probe_response\",\"result\":{\"error\":\"wait timeout\",\"normalized_outcome\":\"timeout\",\"ok\":false,\"rc\":1,\"stderr\":\"\",\"stdout\":\"\"},\"schema_version\":1}",
      "stderr": "[client] wait-ready mode=exists wait_path=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t150_slow.trigger\nfailed to write log capture: Error Domain=NSCocoaErrorDomain Code=513 \"You don\u2019t have permission to save the file \u201cwait_timeout.minimal.t150_slow.log\u201d in the folder \u201ctmp\u201d.\" UserInfo={NSFilePath=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t150_slow.log, NSUnderlyingError=0x600001e14900 {Error Domain=NSPOSIXErrorDomain Code=1 \"Operation not permitted\"}}\nhint: choose a path under /Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data or /Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/tmp/",
      "stdout_json": {
        "data": {
          "argv": [],
          "correlation_id": "EFDAE90B-758B-4291-955B-7A823DCB1D6D",
          "details": {
            "bundle_id": "com.yourteam.entitlement-jail.ProbeService_minimal",
            "correlation_id": "EFDAE90B-758B-4291-955B-7A823DCB1D6D",
            "cwd": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data",
            "home_dir": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data",
            "pid": "9609",
            "probe_family": "wait",
            "probe_pid": "9609",
            "process_name": "ProbeService_minimal",
            "service_pid": "9609",
            "tmp_dir": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/",
            "wait_duration_ms": "155",
            "wait_ended_at_ns": "1686954350448250",
            "wait_interval_ms": "200",
            "wait_mode": "exists",
            "wait_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t150_slow.trigger",
            "wait_started_at_ns": "1686954195152583",
            "wait_timeout_ms": "150"
          },
          "ended_at_iso8601": "2025-12-24T23:28:24.744Z",
          "log_capture_error": "write_failed: Error Domain=NSCocoaErrorDomain Code=513 \"You don\u2019t have permission to save the file \u201cwait_timeout.minimal.t150_slow.log\u201d in the folder \u201ctmp\u201d.\" UserInfo={NSFilePath=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t150_slow.log, NSUnderlyingError=0x600001e14900 {Error Domain=NSPOSIXErrorDomain Code=1 \"Operation not permitted\"}}",
          "log_capture_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t150_slow.log",
          "log_capture_status": "requested_failed",
          "plan_id": "entitlement-diff:ej",
          "probe_id": "probe_catalog",
          "row_id": "wait_timeout.minimal.t150_slow",
          "service_build": "1",
          "service_bundle_id": "com.yourteam.entitlement-jail.ProbeService_minimal",
          "service_name": "ProbeService_minimal",
          "service_version": "1.0",
          "started_at_iso8601": "2025-12-24T23:28:24.587Z",
          "thread_id": "4611"
        },
        "generated_at_unix_ms": 1766618904769,
        "kind": "probe_response",
        "result": {
          "error": "wait timeout",
          "normalized_outcome": "timeout",
          "ok": false,
          "rc": 1,
          "stderr": "",
          "stdout": ""
        },
        "schema_version": 1
      },
      "stdout_json_error": null,
      "wait_ready_line": "[client] wait-ready mode=exists wait_path=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t150_slow.trigger",
      "wait_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t150_slow.trigger",
      "wait_mode": "exists",
      "wait_ready_at_unix_s": 1766618904.5648482,
      "trigger_events": [
        {
          "kind": "primary",
          "at_unix_s": 1766618904.900386,
          "error": null
        }
      ],
      "wait_info": {
        "mode": "exists",
        "wait_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t150_slow.trigger",
        "wait_ready_line": "[client] wait-ready mode=exists wait_path=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t150_slow.trigger",
        "wait_ready_at_unix_s": 1766618904.5648482
      },
      "wait_timeout_ms": 150,
      "trigger_delay_s": 0.3,
      "post_trigger": false,
      "post_trigger_delay_s": null,
      "wait_ready_timeout_s": 10.0,
      "process_timeout_s": 25.0,
      "started_at_unix_s": 1766618904.537518,
      "finished_at_unix_s": 1766618904.917855,
      "duration_s": 0.3803369998931885,
      "log_path": "book/experiments/entitlement-diff/out/ej/logs/wait_timeout.minimal.t150_slow.log",
      "log_capture_source": "$HOME/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t150_slow.log",
      "log_copy_error": "source_missing: /Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t150_slow.log",
      "profile_id": "minimal",
      "service_id": "com.yourteam.entitlement-jail.ProbeService_minimal",
      "probe_id": "probe_catalog",
      "probe_args": [],
      "wait_args": [
        "--wait-exists",
        "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t150_slow.trigger",
        "--wait-timeout-ms",
        "150"
      ],
      "case_id": "t150_slow",
      "case": {
        "case_id": "t150_slow",
        "wait_timeout_ms": 150,
        "trigger_delay_s": 0.3
      }
    },
    {
      "command": [
        "book/tools/entitlement/EntitlementJail.app/Contents/MacOS/entitlement-jail",
        "run-xpc",
        "--log-path-class",
        "tmp",
        "--log-name",
        "wait_timeout.minimal.t500_fast.log",
        "--plan-id",
        "entitlement-diff:ej",
        "--row-id",
        "wait_timeout.minimal.t500_fast",
        "--wait-exists",
        "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t500_fast.trigger",
        "--wait-timeout-ms",
        "500",
        "--profile",
        "minimal",
        "probe_catalog"
      ],
      "plan_id": "entitlement-diff:ej",
      "row_id": "wait_timeout.minimal.t500_fast",
      "exit_code": 0,
      "stdout": "{\"data\":{\"argv\":[],\"correlation_id\":\"CD33B225-F30E-4EB2-A2F0-3C0F85F7C350\",\"details\":{\"bundle_id\":\"com.yourteam.entitlement-jail.ProbeService_minimal\",\"correlation_id\":\"CD33B225-F30E-4EB2-A2F0-3C0F85F7C350\",\"cwd\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\",\"home_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\",\"pid\":\"9613\",\"probe_count\":\"17\",\"probe_family\":\"probe_catalog\",\"probe_pid\":\"9613\",\"process_name\":\"ProbeService_minimal\",\"service_pid\":\"9613\",\"tmp_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/\",\"wait_duration_ms\":\"205\",\"wait_ended_at_ns\":\"1686954797027750\",\"wait_interval_ms\":\"200\",\"wait_mode\":\"exists\",\"wait_path\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/ej_wait_timeout_t500_fast.trigger\",\"wait_started_at_ns\":\"1686954591704541\",\"wait_timeout_ms\":\"500\"},\"ended_at_iso8601\":\"2025-12-24T23:28:25.201Z\",\"log_capture_error\":\"write_failed: Error Domain=NSCocoaErrorDomain Code=513 \\\"You don\u2019t have permission to save the file \u201cwait_timeout.minimal.t500_fast.log\u201d in the folder \u201ctmp\u201d.\\\" UserInfo={NSFilePath=\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/wait_timeout.minimal.t500_fast.log, NSUnderlyingError=0x600002c81170 {Error Domain=NSPOSIXErrorDomain Code=1 \\\"Operation not permitted\\\"}}\",\"log_capture_path\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/wait_timeout.minimal.t500_fast.log\",\"log_capture_status\":\"requested_failed\",\"plan_id\":\"entitlement-diff:ej\",\"probe_id\":\"probe_catalog\",\"row_id\":\"wait_timeout.minimal.t500_fast\",\"service_build\":\"1\",\"service_bundle_id\":\"com.yourteam.entitlement-jail.ProbeService_minimal\",\"service_name\":\"ProbeService_minimal\",\"service_version\":\"1.0\",\"started_at_iso8601\":\"2025-12-24T23:28:24.984Z\",\"thread_id\":\"3843\"},\"generated_at_unix_ms\":1766618905219,\"kind\":\"probe_response\",\"result\":{\"normalized_outcome\":\"ok\",\"ok\":true,\"rc\":0,\"stderr\":\"\",\"stdout\":\"{\\\"generated_at_iso8601\\\":\\\"2025-12-24T23:28:25Z\\\",\\\"probes\\\":[{\\\"entitlement_hints\\\":[\\\"none (observer)\\\"],\\\"examples\\\":[\\\"probe_catalog\\\"],\\\"notes\\\":[\\\"Outputs JSON in RunProbeResponse.stdout.\\\",\\\"Use <probe-id> --help for per-probe usage.\\\"],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"probe_catalog\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"emit a JSON catalog of available probes\\\",\\\"usage\\\":\\\"probe_catalog\\\"},{\\\"entitlement_hints\\\":[\\\"none (observer)\\\"],\\\"examples\\\":[\\\"world_shape\\\"],\\\"notes\\\":[\\\"Reports HOME\\\\\\/TMP\\\\\\/CWD and containerization signals.\\\"],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"world_shape\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"report containerization and world shape metadata\\\",\\\"usage\\\":\\\"world_shape\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.network.client\\\"],\\\"examples\\\":[\\\"network_tcp_connect --host 1.1.1.1 --port 443\\\"],\\\"notes\\\":[],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"network_tcp_connect\\\",\\\"required_args\\\":[\\\"--host <ipv4>\\\",\\\"--port <1..65535>\\\"],\\\"summary\\\":\\\"attempt a TCP connect to an IPv4 host:port\\\",\\\"usage\\\":\\\"network_tcp_connect --host <ipv4> --port <1..65535>\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.files.downloads.read-write\\\"],\\\"examples\\\":[\\\"downloads_rw\\\",\\\"downloads_rw --name demo.txt\\\"],\\\"notes\\\":[\\\"Writes under Downloads\\\\\\/entitlement-jail-harness.\\\"],\\\"optional_args\\\":[\\\"--name <file-name>\\\"],\\\"probe_id\\\":\\\"downloads_rw\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"read\\\\\\/write\\\\\\/remove a file under Downloads\\\\\\/entitlement-jail-harness\\\",\\\"usage\\\":\\\"downloads_rw [--name <file-name>]\\\"},{\\\"entitlement_hints\\\":[\\\"path-dependent (file access entitlements)\\\"],\\\"examples\\\":[\\\"fs_op --op stat --path-class downloads\\\",\\\"fs_op --op create --path-class tmp --target run_dir\\\"],\\\"notes\\\":[\\\"Destructive direct-path ops are refused unless you use --path-class\\\\\\/--target (or a path under *\\\\\\/entitlement-jail-harness\\\\\\/*) or set --allow-unsafe-path.\\\"],\\\"optional_args\\\":[\\\"--target <base|harness_dir|run_dir|specimen_file>\\\",\\\"--name <file-name>\\\",\\\"--to <path> | --to-path <path> | --to-name <file-name>\\\",\\\"--max-entries <n>\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"fs_op\\\",\\\"required_args\\\":[\\\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\\",\\\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\\\"],\\\"summary\\\":\\\"parameterized filesystem operations\\\",\\\"usage\\\":\\\"fs_op --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\\\n      (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n      [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\\\n      [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path]\\\"},{\\\"entitlement_hints\\\":[\\\"path-dependent (file access entitlements)\\\"],\\\"examples\\\":[\\\"fs_op_wait --op open_read --path-class tmp --wait-fifo \\\\\\/tmp\\\\\\/ej-wait.fifo\\\",\\\"fs_op_wait --op stat --path \\\\\\/tmp\\\\\\/target --wait-exists \\\\\\/tmp\\\\\\/trigger --wait-timeout-ms 60000\\\"],\\\"notes\\\":[\\\"Blocks until the wait trigger is satisfied, then runs fs_op.\\\",\\\"--wait-interval-ms is only used with --wait-exists.\\\"],\\\"optional_args\\\":[\\\"--target <base|harness_dir|run_dir|specimen_file>\\\",\\\"--name <file-name>\\\",\\\"--to <path> | --to-path <path> | --to-name <file-name>\\\",\\\"--max-entries <n>\\\",\\\"--allow-unsafe-path\\\",\\\"--wait-timeout-ms <n>\\\",\\\"--wait-interval-ms <n>\\\"],\\\"probe_id\\\":\\\"fs_op_wait\\\",\\\"required_args\\\":[\\\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\\",\\\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\\\",\\\"--wait-fifo <path> | --wait-exists <path>\\\"],\\\"summary\\\":\\\"wait for a trigger, then run fs_op\\\",\\\"usage\\\":\\\"fs_op_wait --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\\\n          (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\\\n          [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\\\n          [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path]\\\\n          (--wait-fifo <path> | --wait-exists <path>) [--wait-timeout-ms <n>] [--wait-interval-ms <n>]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.network.client\\\"],\\\"examples\\\":[\\\"net_op --op getaddrinfo --host example.com\\\",\\\"net_op --op tcp_connect --host 127.0.0.1 --port 80\\\"],\\\"notes\\\":[\\\"--port is required for tcp_connect and udp_send.\\\"],\\\"optional_args\\\":[\\\"--port <1..65535>\\\",\\\"--numeric\\\"],\\\"probe_id\\\":\\\"net_op\\\",\\\"required_args\\\":[\\\"--op <getaddrinfo|tcp_connect|udp_send>\\\",\\\"--host <host>\\\"],\\\"summary\\\":\\\"parameterized network operations\\\",\\\"usage\\\":\\\"net_op --op <getaddrinfo|tcp_connect|udp_send> --host <host> [--port <1..65535>] [--numeric]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.cs.disable-library-validation\\\",\\\"com.apple.security.cs.allow-dyld-environment-variables (if you rely on DYLD_*)\\\"],\\\"examples\\\":[\\\"dlopen_external --path \\\\\\/path\\\\\\/to\\\\\\/testdylib.dylib\\\"],\\\"notes\\\":[\\\"Executes dylib initializers; this is not a passive probe.\\\",\\\"Use a signed dylib (see tests\\\\\\/fixtures\\\\\\/TestDylib).\\\"],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"dlopen_external\\\",\\\"required_args\\\":[\\\"--path <abs> (or EJ_DLOPEN_PATH)\\\"],\\\"summary\\\":\\\"dlopen a signed dylib by absolute path\\\",\\\"usage\\\":\\\"dlopen_external --path <abs> (or set EJ_DLOPEN_PATH)\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.cs.allow-jit\\\"],\\\"examples\\\":[\\\"jit_map_jit\\\",\\\"jit_map_jit --size 65536\\\"],\\\"notes\\\":[\\\"Reports errno on MAP_JIT failure.\\\"],\\\"optional_args\\\":[\\\"--size <bytes> (default: 16384)\\\"],\\\"probe_id\\\":\\\"jit_map_jit\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"attempt mmap with MAP_JIT\\\",\\\"usage\\\":\\\"jit_map_jit [--size <bytes>]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.cs.allow-unsigned-executable-memory\\\"],\\\"examples\\\":[\\\"jit_rwx_legacy\\\",\\\"jit_rwx_legacy --size 65536\\\"],\\\"notes\\\":[\\\"Reports errno on RWX mmap failure.\\\"],\\\"optional_args\\\":[\\\"--size <bytes> (default: 16384)\\\"],\\\"probe_id\\\":\\\"jit_rwx_legacy\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"attempt mmap with RWX permissions (legacy)\\\",\\\"usage\\\":\\\"jit_rwx_legacy [--size <bytes>]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.files.bookmarks.app-scope\\\",\\\"com.apple.security.files.user-selected.read-only\\\",\\\"com.apple.security.files.user-selected.read-write\\\"],\\\"examples\\\":[\\\"bookmark_op --bookmark-b64 <b64> --op stat\\\",\\\"bookmark_op --bookmark-path \\\\\\/tmp\\\\\\/token.txt --op open_read --relative file.txt\\\"],\\\"notes\\\":[\\\"Uses ScopedBookmarksAgent IPC for security-scoped bookmarks.\\\"],\\\"optional_args\\\":[\\\"--relative <rel>\\\",\\\"--op <fs_op-op> (default: stat)\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"bookmark_op\\\",\\\"required_args\\\":[\\\"--bookmark-b64 <base64> | --bookmark-path <path>\\\"],\\\"summary\\\":\\\"resolve a bookmark token and run a filesystem op against it\\\",\\\"usage\\\":\\\"bookmark_op --bookmark-b64 <base64> | --bookmark-path <path>\\\\n            [--relative <rel>] [--op <fs_op-op>] [--allow-unsafe-path]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.files.bookmarks.app-scope\\\",\\\"com.apple.security.files.user-selected.read-only\\\",\\\"com.apple.security.files.user-selected.read-write\\\"],\\\"examples\\\":[\\\"bookmark_make --path \\\\\\/Users\\\\\\/me\\\\\\/Downloads\\\",\\\"bookmark_make --path \\\\\\/Users\\\\\\/me\\\\\\/Downloads --read-only\\\"],\\\"notes\\\":[\\\"Security-scoped bookmarks use ScopedBookmarksAgent IPC.\\\"],\\\"optional_args\\\":[\\\"--no-security-scope\\\",\\\"--read-only\\\",\\\"--allow-missing\\\"],\\\"probe_id\\\":\\\"bookmark_make\\\",\\\"required_args\\\":[\\\"--path <abs>\\\"],\\\"summary\\\":\\\"create a security-scoped bookmark token for a path\\\",\\\"usage\\\":\\\"bookmark_make --path <abs> [--no-security-scope] [--read-only] [--allow-missing]\\\"},{\\\"entitlement_hints\\\":[\\\"com.apple.security.files.bookmarks.app-scope\\\",\\\"com.apple.security.files.user-selected.read-only\\\",\\\"com.apple.security.files.user-selected.read-write\\\"],\\\"examples\\\":[\\\"bookmark_roundtrip --path \\\\\\/Users\\\\\\/me\\\\\\/Downloads --op stat\\\",\\\"bookmark_roundtrip --path \\\\\\/Users\\\\\\/me\\\\\\/Downloads --op open_read --relative file.txt\\\"],\\\"notes\\\":[\\\"Returns the bookmark token in stdout and the fs_op result in details.\\\"],\\\"optional_args\\\":[\\\"--op <fs_op-op> (default: stat)\\\",\\\"--relative <rel>\\\",\\\"--no-security-scope\\\",\\\"--read-only\\\",\\\"--allow-missing\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"bookmark_roundtrip\\\",\\\"required_args\\\":[\\\"--path <abs>\\\"],\\\"summary\\\":\\\"create a bookmark token and immediately resolve + run a filesystem op\\\",\\\"usage\\\":\\\"bookmark_roundtrip --path <abs> [--op <fs_op-op>] [--relative <rel>] [--no-security-scope] [--read-only] [--allow-missing] [--allow-unsafe-path]\\\"},{\\\"entitlement_hints\\\":[\\\"none (observer)\\\"],\\\"examples\\\":[\\\"capabilities_snapshot\\\"],\\\"notes\\\":[\\\"Includes entitlement presence booleans and standard directory paths.\\\"],\\\"optional_args\\\":[],\\\"probe_id\\\":\\\"capabilities_snapshot\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"report entitlements and resolved standard directories\\\",\\\"usage\\\":\\\"capabilities_snapshot\\\"},{\\\"entitlement_hints\\\":[\\\"none (containerization evidence)\\\"],\\\"examples\\\":[\\\"userdefaults_op --op read --key example\\\",\\\"userdefaults_op --op write --key example --value 1\\\"],\\\"notes\\\":[\\\"Useful for observing containerized preferences paths.\\\"],\\\"optional_args\\\":[\\\"--op <read|write|remove|sync> (default: read)\\\",\\\"--key <k>\\\",\\\"--value <v>\\\",\\\"--suite <suite>\\\"],\\\"probe_id\\\":\\\"userdefaults_op\\\",\\\"required_args\\\":[],\\\"summary\\\":\\\"read\\\\\\/write\\\\\\/remove\\\\\\/sync a UserDefaults key\\\",\\\"usage\\\":\\\"userdefaults_op --op <read|write|remove|sync> [--key <k>] [--value <v>] [--suite <suite>]\\\"},{\\\"entitlement_hints\\\":[\\\"path-dependent (file access entitlements)\\\"],\\\"examples\\\":[\\\"fs_xattr --op get --path \\\\\\/tmp\\\\\\/file --name com.apple.quarantine\\\",\\\"fs_xattr --op list --path \\\\\\/tmp\\\\\\/file\\\"],\\\"notes\\\":[\\\"xattr writes are refused outside harness paths unless --allow-write or --allow-unsafe-path is set.\\\"],\\\"optional_args\\\":[\\\"--name <xattr>\\\",\\\"--value <v>\\\",\\\"--allow-write\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"fs_xattr\\\",\\\"required_args\\\":[\\\"--op <get|list|set|remove>\\\",\\\"--path <abs>\\\"],\\\"summary\\\":\\\"get\\\\\\/list\\\\\\/set\\\\\\/remove extended attributes\\\",\\\"usage\\\":\\\"fs_xattr --op <get|list|set|remove> --path <abs> [--name <xattr>] [--value <v>] [--allow-write] [--allow-unsafe-path]\\\"},{\\\"entitlement_hints\\\":[\\\"path-dependent (file access entitlements)\\\"],\\\"examples\\\":[\\\"fs_coordinated_op --op read --path-class documents\\\",\\\"fs_coordinated_op --op write --path-class tmp --target run_dir\\\"],\\\"notes\\\":[\\\"Coordinated writes to direct paths are refused unless you use --path-class\\\\\\/--target (or a path under *\\\\\\/entitlement-jail-harness\\\\\\/*) or set --allow-unsafe-path.\\\"],\\\"optional_args\\\":[\\\"--target <base|harness_dir|run_dir|specimen_file>\\\",\\\"--allow-unsafe-path\\\"],\\\"probe_id\\\":\\\"fs_coordinated_op\\\",\\\"required_args\\\":[\\\"--op <read|write>\\\",\\\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\\\"],\\\"summary\\\":\\\"NSFileCoordinator mediated read\\\\\\/write\\\",\\\"usage\\\":\\\"fs_coordinated_op --op <read|write> (--path <abs> | --path-class <...>) [--target <...>] [--allow-unsafe-path]\\\"}],\\\"schema_version\\\":1,\\\"trace_symbols\\\":[{\\\"probe_id\\\":\\\"fs_op\\\",\\\"symbols\\\":[\\\"ej_probe_fs_op\\\"]},{\\\"probe_id\\\":\\\"fs_op_wait\\\",\\\"symbols\\\":[\\\"ej_probe_fs_op_wait\\\"]},{\\\"probe_id\\\":\\\"net_op\\\",\\\"symbols\\\":[\\\"ej_probe_net_op\\\"]},{\\\"probe_id\\\":\\\"dlopen_external\\\",\\\"symbols\\\":[\\\"ej_probe_dlopen_external\\\"]},{\\\"probe_id\\\":\\\"jit_map_jit\\\",\\\"symbols\\\":[\\\"ej_probe_jit_map_jit\\\"]},{\\\"probe_id\\\":\\\"jit_rwx_legacy\\\",\\\"symbols\\\":[\\\"ej_probe_jit_rwx_legacy\\\"]}]}\"},\"schema_version\":1}",
      "stderr": "[client] wait-ready mode=exists wait_path=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t500_fast.trigger\nfailed to write log capture: Error Domain=NSCocoaErrorDomain Code=513 \"You don\u2019t have permission to save the file \u201cwait_timeout.minimal.t500_fast.log\u201d in the folder \u201ctmp\u201d.\" UserInfo={NSFilePath=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t500_fast.log, NSUnderlyingError=0x600002c81170 {Error Domain=NSPOSIXErrorDomain Code=1 \"Operation not permitted\"}}\nhint: choose a path under /Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data or /Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/tmp/",
      "stdout_json": {
        "data": {
          "argv": [],
          "correlation_id": "CD33B225-F30E-4EB2-A2F0-3C0F85F7C350",
          "details": {
            "bundle_id": "com.yourteam.entitlement-jail.ProbeService_minimal",
            "correlation_id": "CD33B225-F30E-4EB2-A2F0-3C0F85F7C350",
            "cwd": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data",
            "home_dir": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data",
            "pid": "9613",
            "probe_count": "17",
            "probe_family": "probe_catalog",
            "probe_pid": "9613",
            "process_name": "ProbeService_minimal",
            "service_pid": "9613",
            "tmp_dir": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/",
            "wait_duration_ms": "205",
            "wait_ended_at_ns": "1686954797027750",
            "wait_interval_ms": "200",
            "wait_mode": "exists",
            "wait_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t500_fast.trigger",
            "wait_started_at_ns": "1686954591704541",
            "wait_timeout_ms": "500"
          },
          "ended_at_iso8601": "2025-12-24T23:28:25.201Z",
          "log_capture_error": "write_failed: Error Domain=NSCocoaErrorDomain Code=513 \"You don\u2019t have permission to save the file \u201cwait_timeout.minimal.t500_fast.log\u201d in the folder \u201ctmp\u201d.\" UserInfo={NSFilePath=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t500_fast.log, NSUnderlyingError=0x600002c81170 {Error Domain=NSPOSIXErrorDomain Code=1 \"Operation not permitted\"}}",
          "log_capture_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t500_fast.log",
          "log_capture_status": "requested_failed",
          "plan_id": "entitlement-diff:ej",
          "probe_id": "probe_catalog",
          "row_id": "wait_timeout.minimal.t500_fast",
          "service_build": "1",
          "service_bundle_id": "com.yourteam.entitlement-jail.ProbeService_minimal",
          "service_name": "ProbeService_minimal",
          "service_version": "1.0",
          "started_at_iso8601": "2025-12-24T23:28:24.984Z",
          "thread_id": "3843"
        },
        "generated_at_unix_ms": 1766618905219,
        "kind": "probe_response",
        "result": {
          "normalized_outcome": "ok",
          "ok": true,
          "rc": 0,
          "stderr": "",
          "stdout": "{\"generated_at_iso8601\":\"2025-12-24T23:28:25Z\",\"probes\":[{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"probe_catalog\"],\"notes\":[\"Outputs JSON in RunProbeResponse.stdout.\",\"Use <probe-id> --help for per-probe usage.\"],\"optional_args\":[],\"probe_id\":\"probe_catalog\",\"required_args\":[],\"summary\":\"emit a JSON catalog of available probes\",\"usage\":\"probe_catalog\"},{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"world_shape\"],\"notes\":[\"Reports HOME\\/TMP\\/CWD and containerization signals.\"],\"optional_args\":[],\"probe_id\":\"world_shape\",\"required_args\":[],\"summary\":\"report containerization and world shape metadata\",\"usage\":\"world_shape\"},{\"entitlement_hints\":[\"com.apple.security.network.client\"],\"examples\":[\"network_tcp_connect --host 1.1.1.1 --port 443\"],\"notes\":[],\"optional_args\":[],\"probe_id\":\"network_tcp_connect\",\"required_args\":[\"--host <ipv4>\",\"--port <1..65535>\"],\"summary\":\"attempt a TCP connect to an IPv4 host:port\",\"usage\":\"network_tcp_connect --host <ipv4> --port <1..65535>\"},{\"entitlement_hints\":[\"com.apple.security.files.downloads.read-write\"],\"examples\":[\"downloads_rw\",\"downloads_rw --name demo.txt\"],\"notes\":[\"Writes under Downloads\\/entitlement-jail-harness.\"],\"optional_args\":[\"--name <file-name>\"],\"probe_id\":\"downloads_rw\",\"required_args\":[],\"summary\":\"read\\/write\\/remove a file under Downloads\\/entitlement-jail-harness\",\"usage\":\"downloads_rw [--name <file-name>]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_op --op stat --path-class downloads\",\"fs_op --op create --path-class tmp --target run_dir\"],\"notes\":[\"Destructive direct-path ops are refused unless you use --path-class\\/--target (or a path under *\\/entitlement-jail-harness\\/*) or set --allow-unsafe-path.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--name <file-name>\",\"--to <path> | --to-path <path> | --to-name <file-name>\",\"--max-entries <n>\",\"--allow-unsafe-path\"],\"probe_id\":\"fs_op\",\"required_args\":[\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\"],\"summary\":\"parameterized filesystem operations\",\"usage\":\"fs_op --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\n      (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n      [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\n      [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_op_wait --op open_read --path-class tmp --wait-fifo \\/tmp\\/ej-wait.fifo\",\"fs_op_wait --op stat --path \\/tmp\\/target --wait-exists \\/tmp\\/trigger --wait-timeout-ms 60000\"],\"notes\":[\"Blocks until the wait trigger is satisfied, then runs fs_op.\",\"--wait-interval-ms is only used with --wait-exists.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--name <file-name>\",\"--to <path> | --to-path <path> | --to-name <file-name>\",\"--max-entries <n>\",\"--allow-unsafe-path\",\"--wait-timeout-ms <n>\",\"--wait-interval-ms <n>\"],\"probe_id\":\"fs_op_wait\",\"required_args\":[\"--op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\",\"--wait-fifo <path> | --wait-exists <path>\"],\"summary\":\"wait for a trigger, then run fs_op\",\"usage\":\"fs_op_wait --op <stat|open_read|open_write|create|truncate|rename|unlink|mkdir|rmdir|listdir|readlink|realpath>\\n          (--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>)\\n          [--target <base|harness_dir|run_dir|specimen_file>] [--name <file-name>]\\n          [--to <path>|--to-path <path>|--to-name <file-name>] [--max-entries <n>] [--allow-unsafe-path]\\n          (--wait-fifo <path> | --wait-exists <path>) [--wait-timeout-ms <n>] [--wait-interval-ms <n>]\"},{\"entitlement_hints\":[\"com.apple.security.network.client\"],\"examples\":[\"net_op --op getaddrinfo --host example.com\",\"net_op --op tcp_connect --host 127.0.0.1 --port 80\"],\"notes\":[\"--port is required for tcp_connect and udp_send.\"],\"optional_args\":[\"--port <1..65535>\",\"--numeric\"],\"probe_id\":\"net_op\",\"required_args\":[\"--op <getaddrinfo|tcp_connect|udp_send>\",\"--host <host>\"],\"summary\":\"parameterized network operations\",\"usage\":\"net_op --op <getaddrinfo|tcp_connect|udp_send> --host <host> [--port <1..65535>] [--numeric]\"},{\"entitlement_hints\":[\"com.apple.security.cs.disable-library-validation\",\"com.apple.security.cs.allow-dyld-environment-variables (if you rely on DYLD_*)\"],\"examples\":[\"dlopen_external --path \\/path\\/to\\/testdylib.dylib\"],\"notes\":[\"Executes dylib initializers; this is not a passive probe.\",\"Use a signed dylib (see tests\\/fixtures\\/TestDylib).\"],\"optional_args\":[],\"probe_id\":\"dlopen_external\",\"required_args\":[\"--path <abs> (or EJ_DLOPEN_PATH)\"],\"summary\":\"dlopen a signed dylib by absolute path\",\"usage\":\"dlopen_external --path <abs> (or set EJ_DLOPEN_PATH)\"},{\"entitlement_hints\":[\"com.apple.security.cs.allow-jit\"],\"examples\":[\"jit_map_jit\",\"jit_map_jit --size 65536\"],\"notes\":[\"Reports errno on MAP_JIT failure.\"],\"optional_args\":[\"--size <bytes> (default: 16384)\"],\"probe_id\":\"jit_map_jit\",\"required_args\":[],\"summary\":\"attempt mmap with MAP_JIT\",\"usage\":\"jit_map_jit [--size <bytes>]\"},{\"entitlement_hints\":[\"com.apple.security.cs.allow-unsigned-executable-memory\"],\"examples\":[\"jit_rwx_legacy\",\"jit_rwx_legacy --size 65536\"],\"notes\":[\"Reports errno on RWX mmap failure.\"],\"optional_args\":[\"--size <bytes> (default: 16384)\"],\"probe_id\":\"jit_rwx_legacy\",\"required_args\":[],\"summary\":\"attempt mmap with RWX permissions (legacy)\",\"usage\":\"jit_rwx_legacy [--size <bytes>]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_op --bookmark-b64 <b64> --op stat\",\"bookmark_op --bookmark-path \\/tmp\\/token.txt --op open_read --relative file.txt\"],\"notes\":[\"Uses ScopedBookmarksAgent IPC for security-scoped bookmarks.\"],\"optional_args\":[\"--relative <rel>\",\"--op <fs_op-op> (default: stat)\",\"--allow-unsafe-path\"],\"probe_id\":\"bookmark_op\",\"required_args\":[\"--bookmark-b64 <base64> | --bookmark-path <path>\"],\"summary\":\"resolve a bookmark token and run a filesystem op against it\",\"usage\":\"bookmark_op --bookmark-b64 <base64> | --bookmark-path <path>\\n            [--relative <rel>] [--op <fs_op-op>] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_make --path \\/Users\\/me\\/Downloads\",\"bookmark_make --path \\/Users\\/me\\/Downloads --read-only\"],\"notes\":[\"Security-scoped bookmarks use ScopedBookmarksAgent IPC.\"],\"optional_args\":[\"--no-security-scope\",\"--read-only\",\"--allow-missing\"],\"probe_id\":\"bookmark_make\",\"required_args\":[\"--path <abs>\"],\"summary\":\"create a security-scoped bookmark token for a path\",\"usage\":\"bookmark_make --path <abs> [--no-security-scope] [--read-only] [--allow-missing]\"},{\"entitlement_hints\":[\"com.apple.security.files.bookmarks.app-scope\",\"com.apple.security.files.user-selected.read-only\",\"com.apple.security.files.user-selected.read-write\"],\"examples\":[\"bookmark_roundtrip --path \\/Users\\/me\\/Downloads --op stat\",\"bookmark_roundtrip --path \\/Users\\/me\\/Downloads --op open_read --relative file.txt\"],\"notes\":[\"Returns the bookmark token in stdout and the fs_op result in details.\"],\"optional_args\":[\"--op <fs_op-op> (default: stat)\",\"--relative <rel>\",\"--no-security-scope\",\"--read-only\",\"--allow-missing\",\"--allow-unsafe-path\"],\"probe_id\":\"bookmark_roundtrip\",\"required_args\":[\"--path <abs>\"],\"summary\":\"create a bookmark token and immediately resolve + run a filesystem op\",\"usage\":\"bookmark_roundtrip --path <abs> [--op <fs_op-op>] [--relative <rel>] [--no-security-scope] [--read-only] [--allow-missing] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"none (observer)\"],\"examples\":[\"capabilities_snapshot\"],\"notes\":[\"Includes entitlement presence booleans and standard directory paths.\"],\"optional_args\":[],\"probe_id\":\"capabilities_snapshot\",\"required_args\":[],\"summary\":\"report entitlements and resolved standard directories\",\"usage\":\"capabilities_snapshot\"},{\"entitlement_hints\":[\"none (containerization evidence)\"],\"examples\":[\"userdefaults_op --op read --key example\",\"userdefaults_op --op write --key example --value 1\"],\"notes\":[\"Useful for observing containerized preferences paths.\"],\"optional_args\":[\"--op <read|write|remove|sync> (default: read)\",\"--key <k>\",\"--value <v>\",\"--suite <suite>\"],\"probe_id\":\"userdefaults_op\",\"required_args\":[],\"summary\":\"read\\/write\\/remove\\/sync a UserDefaults key\",\"usage\":\"userdefaults_op --op <read|write|remove|sync> [--key <k>] [--value <v>] [--suite <suite>]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_xattr --op get --path \\/tmp\\/file --name com.apple.quarantine\",\"fs_xattr --op list --path \\/tmp\\/file\"],\"notes\":[\"xattr writes are refused outside harness paths unless --allow-write or --allow-unsafe-path is set.\"],\"optional_args\":[\"--name <xattr>\",\"--value <v>\",\"--allow-write\",\"--allow-unsafe-path\"],\"probe_id\":\"fs_xattr\",\"required_args\":[\"--op <get|list|set|remove>\",\"--path <abs>\"],\"summary\":\"get\\/list\\/set\\/remove extended attributes\",\"usage\":\"fs_xattr --op <get|list|set|remove> --path <abs> [--name <xattr>] [--value <v>] [--allow-write] [--allow-unsafe-path]\"},{\"entitlement_hints\":[\"path-dependent (file access entitlements)\"],\"examples\":[\"fs_coordinated_op --op read --path-class documents\",\"fs_coordinated_op --op write --path-class tmp --target run_dir\"],\"notes\":[\"Coordinated writes to direct paths are refused unless you use --path-class\\/--target (or a path under *\\/entitlement-jail-harness\\/*) or set --allow-unsafe-path.\"],\"optional_args\":[\"--target <base|harness_dir|run_dir|specimen_file>\",\"--allow-unsafe-path\"],\"probe_id\":\"fs_coordinated_op\",\"required_args\":[\"--op <read|write>\",\"--path <abs> | --path-class <home|tmp|downloads|desktop|documents|app_support|caches>\"],\"summary\":\"NSFileCoordinator mediated read\\/write\",\"usage\":\"fs_coordinated_op --op <read|write> (--path <abs> | --path-class <...>) [--target <...>] [--allow-unsafe-path]\"}],\"schema_version\":1,\"trace_symbols\":[{\"probe_id\":\"fs_op\",\"symbols\":[\"ej_probe_fs_op\"]},{\"probe_id\":\"fs_op_wait\",\"symbols\":[\"ej_probe_fs_op_wait\"]},{\"probe_id\":\"net_op\",\"symbols\":[\"ej_probe_net_op\"]},{\"probe_id\":\"dlopen_external\",\"symbols\":[\"ej_probe_dlopen_external\"]},{\"probe_id\":\"jit_map_jit\",\"symbols\":[\"ej_probe_jit_map_jit\"]},{\"probe_id\":\"jit_rwx_legacy\",\"symbols\":[\"ej_probe_jit_rwx_legacy\"]}]}"
        },
        "schema_version": 1
      },
      "stdout_json_error": null,
      "wait_ready_line": "[client] wait-ready mode=exists wait_path=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t500_fast.trigger",
      "wait_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t500_fast.trigger",
      "wait_mode": "exists",
      "wait_ready_at_unix_s": 1766618904.9627678,
      "trigger_events": [
        {
          "kind": "primary",
          "at_unix_s": 1766618905.0944982,
          "error": null
        }
      ],
      "wait_info": {
        "mode": "exists",
        "wait_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t500_fast.trigger",
        "wait_ready_line": "[client] wait-ready mode=exists wait_path=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t500_fast.trigger",
        "wait_ready_at_unix_s": 1766618904.9627678
      },
      "wait_timeout_ms": 500,
      "trigger_delay_s": 0.1,
      "post_trigger": false,
      "post_trigger_delay_s": null,
      "wait_ready_timeout_s": 10.0,
      "process_timeout_s": 25.0,
      "started_at_unix_s": 1766618904.934703,
      "finished_at_unix_s": 1766618905.2351239,
      "duration_s": 0.30042076110839844,
      "log_path": "book/experiments/entitlement-diff/out/ej/logs/wait_timeout.minimal.t500_fast.log",
      "log_capture_source": "$HOME/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t500_fast.log",
      "log_copy_error": "source_missing: /Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t500_fast.log",
      "profile_id": "minimal",
      "service_id": "com.yourteam.entitlement-jail.ProbeService_minimal",
      "probe_id": "probe_catalog",
      "probe_args": [],
      "wait_args": [
        "--wait-exists",
        "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t500_fast.trigger",
        "--wait-timeout-ms",
        "500"
      ],
      "case_id": "t500_fast",
      "case": {
        "case_id": "t500_fast",
        "wait_timeout_ms": 500,
        "trigger_delay_s": 0.1
      }
    },
    {
      "command": [
        "book/tools/entitlement/EntitlementJail.app/Contents/MacOS/entitlement-jail",
        "run-xpc",
        "--log-path-class",
        "tmp",
        "--log-name",
        "wait_timeout.minimal.t500_slow.log",
        "--plan-id",
        "entitlement-diff:ej",
        "--row-id",
        "wait_timeout.minimal.t500_slow",
        "--wait-exists",
        "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t500_slow.trigger",
        "--wait-timeout-ms",
        "500",
        "--profile",
        "minimal",
        "probe_catalog"
      ],
      "plan_id": "entitlement-diff:ej",
      "row_id": "wait_timeout.minimal.t500_slow",
      "exit_code": 1,
      "stdout": "{\"data\":{\"argv\":[],\"correlation_id\":\"71EF0A66-7D9A-45B4-908B-3EA70C7D0498\",\"details\":{\"bundle_id\":\"com.yourteam.entitlement-jail.ProbeService_minimal\",\"correlation_id\":\"71EF0A66-7D9A-45B4-908B-3EA70C7D0498\",\"cwd\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\",\"home_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\",\"pid\":\"9617\",\"probe_family\":\"wait\",\"probe_pid\":\"9617\",\"process_name\":\"ProbeService_minimal\",\"service_pid\":\"9617\",\"tmp_dir\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/\",\"wait_duration_ms\":\"503\",\"wait_ended_at_ns\":\"1686955417931583\",\"wait_interval_ms\":\"200\",\"wait_mode\":\"exists\",\"wait_path\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/ej_wait_timeout_t500_slow.trigger\",\"wait_started_at_ns\":\"1686954913974625\",\"wait_timeout_ms\":\"500\"},\"ended_at_iso8601\":\"2025-12-24T23:28:25.813Z\",\"log_capture_error\":\"write_failed: Error Domain=NSCocoaErrorDomain Code=513 \\\"You don\u2019t have permission to save the file \u201cwait_timeout.minimal.t500_slow.log\u201d in the folder \u201ctmp\u201d.\\\" UserInfo={NSFilePath=\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/wait_timeout.minimal.t500_slow.log, NSUnderlyingError=0x6000038ec210 {Error Domain=NSPOSIXErrorDomain Code=1 \\\"Operation not permitted\\\"}}\",\"log_capture_path\":\"\\/Users\\/achyland\\/Library\\/Containers\\/com.yourteam.entitlement-jail.ProbeService_minimal\\/Data\\/tmp\\/wait_timeout.minimal.t500_slow.log\",\"log_capture_status\":\"requested_failed\",\"plan_id\":\"entitlement-diff:ej\",\"probe_id\":\"probe_catalog\",\"row_id\":\"wait_timeout.minimal.t500_slow\",\"service_build\":\"1\",\"service_bundle_id\":\"com.yourteam.entitlement-jail.ProbeService_minimal\",\"service_name\":\"ProbeService_minimal\",\"service_version\":\"1.0\",\"started_at_iso8601\":\"2025-12-24T23:28:25.306Z\",\"thread_id\":\"5891\"},\"generated_at_unix_ms\":1766618905839,\"kind\":\"probe_response\",\"result\":{\"error\":\"wait timeout\",\"normalized_outcome\":\"timeout\",\"ok\":false,\"rc\":1,\"stderr\":\"\",\"stdout\":\"\"},\"schema_version\":1}",
      "stderr": "[client] wait-ready mode=exists wait_path=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t500_slow.trigger\nfailed to write log capture: Error Domain=NSCocoaErrorDomain Code=513 \"You don\u2019t have permission to save the file \u201cwait_timeout.minimal.t500_slow.log\u201d in the folder \u201ctmp\u201d.\" UserInfo={NSFilePath=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t500_slow.log, NSUnderlyingError=0x6000038ec210 {Error Domain=NSPOSIXErrorDomain Code=1 \"Operation not permitted\"}}\nhint: choose a path under /Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data or /Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/tmp/",
      "stdout_json": {
        "data": {
          "argv": [],
          "correlation_id": "71EF0A66-7D9A-45B4-908B-3EA70C7D0498",
          "details": {
            "bundle_id": "com.yourteam.entitlement-jail.ProbeService_minimal",
            "correlation_id": "71EF0A66-7D9A-45B4-908B-3EA70C7D0498",
            "cwd": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data",
            "home_dir": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data",
            "pid": "9617",
            "probe_family": "wait",
            "probe_pid": "9617",
            "process_name": "ProbeService_minimal",
            "service_pid": "9617",
            "tmp_dir": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/",
            "wait_duration_ms": "503",
            "wait_ended_at_ns": "1686955417931583",
            "wait_interval_ms": "200",
            "wait_mode": "exists",
            "wait_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t500_slow.trigger",
            "wait_started_at_ns": "1686954913974625",
            "wait_timeout_ms": "500"
          },
          "ended_at_iso8601": "2025-12-24T23:28:25.813Z",
          "log_capture_error": "write_failed: Error Domain=NSCocoaErrorDomain Code=513 \"You don\u2019t have permission to save the file \u201cwait_timeout.minimal.t500_slow.log\u201d in the folder \u201ctmp\u201d.\" UserInfo={NSFilePath=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t500_slow.log, NSUnderlyingError=0x6000038ec210 {Error Domain=NSPOSIXErrorDomain Code=1 \"Operation not permitted\"}}",
          "log_capture_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t500_slow.log",
          "log_capture_status": "requested_failed",
          "plan_id": "entitlement-diff:ej",
          "probe_id": "probe_catalog",
          "row_id": "wait_timeout.minimal.t500_slow",
          "service_build": "1",
          "service_bundle_id": "com.yourteam.entitlement-jail.ProbeService_minimal",
          "service_name": "ProbeService_minimal",
          "service_version": "1.0",
          "started_at_iso8601": "2025-12-24T23:28:25.306Z",
          "thread_id": "5891"
        },
        "generated_at_unix_ms": 1766618905839,
        "kind": "probe_response",
        "result": {
          "error": "wait timeout",
          "normalized_outcome": "timeout",
          "ok": false,
          "rc": 1,
          "stderr": "",
          "stdout": ""
        },
        "schema_version": 1
      },
      "stdout_json_error": null,
      "wait_ready_line": "[client] wait-ready mode=exists wait_path=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t500_slow.trigger",
      "wait_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t500_slow.trigger",
      "wait_mode": "exists",
      "wait_ready_at_unix_s": 1766618905.282897,
      "trigger_events": [
        {
          "kind": "primary",
          "at_unix_s": 1766618906.217213,
          "error": null
        }
      ],
      "wait_info": {
        "mode": "exists",
        "wait_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t500_slow.trigger",
        "wait_ready_line": "[client] wait-ready mode=exists wait_path=/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t500_slow.trigger",
        "wait_ready_at_unix_s": 1766618905.282897
      },
      "wait_timeout_ms": 500,
      "trigger_delay_s": 0.9,
      "post_trigger": false,
      "post_trigger_delay_s": null,
      "wait_ready_timeout_s": 10.0,
      "process_timeout_s": 25.0,
      "started_at_unix_s": 1766618905.254268,
      "finished_at_unix_s": 1766618906.2398021,
      "duration_s": 0.9855341911315918,
      "log_path": "book/experiments/entitlement-diff/out/ej/logs/wait_timeout.minimal.t500_slow.log",
      "log_capture_source": "$HOME/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t500_slow.log",
      "log_copy_error": "source_missing: /Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/wait_timeout.minimal.t500_slow.log",
      "profile_id": "minimal",
      "service_id": "com.yourteam.entitlement-jail.ProbeService_minimal",
      "probe_id": "probe_catalog",
      "probe_args": [],
      "wait_args": [
        "--wait-exists",
        "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail.ProbeService_minimal/Data/tmp/ej_wait_timeout_t500_slow.trigger",
        "--wait-timeout-ms",
        "500"
      ],
      "case_id": "t500_slow",
      "case": {
        "case_id": "t500_slow",
        "wait_timeout_ms": 500,
        "trigger_delay_s": 0.9
      }
    }
  ]
}
