[
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "unknown",
      "err_class_source": "errbuf_present",
      "errbuf": "mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n",
      "errno": 0,
      "rc": -1
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/anchor-filter-map/out/a9b8e112-51ea-4746-8eab-53de3ad61d64/runtime_profiles/mach_lookup_deny_default.anchor-filter-map_cfprefsd_S0_allow_any.runtime.sb",
      "--",
      "book/experiments/runtime-checks/mach_probe",
      "com.apple.cfprefsd.agent"
    ],
    "errno": 0,
    "expectation_id": "anchor-filter-map:cfprefsd:S0_allow_any",
    "expected": "allow",
    "failure_kind": "sandbox_init_failed",
    "failure_stage": "apply",
    "match": false,
    "operation": "mach-lookup",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/anchor-filter-map/out/a9b8e112-51ea-4746-8eab-53de3ad61d64/runtime_profiles/mach_lookup_deny_default.anchor-filter-map_cfprefsd_S0_allow_any.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "S0_allow_any",
    "profile_id": "anchor-filter-map:cfprefsd:S0_allow_any",
    "run_id": "a9b8e112-51ea-4746-8eab-53de3ad61d64",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "anchor-filter-map:cfprefsd:S0_allow_any",
    "stderr": "sandbox initialization failed: mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n\nsandbox_init failed: mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n\n",
    "stdout": "",
    "target": "com.apple.cfprefsd.agent",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "unknown",
      "err_class_source": "errbuf_present",
      "errbuf": "mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n",
      "errno": 0,
      "rc": -1
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/anchor-filter-map/out/a9b8e112-51ea-4746-8eab-53de3ad61d64/runtime_profiles/mach_lookup_deny_default.anchor-filter-map_cfprefsd_S1_allow_global.runtime.sb",
      "--",
      "book/experiments/runtime-checks/mach_probe",
      "com.apple.cfprefsd.agent"
    ],
    "errno": 0,
    "expectation_id": "anchor-filter-map:cfprefsd:S1_allow_global",
    "expected": "allow",
    "failure_kind": "sandbox_init_failed",
    "failure_stage": "apply",
    "match": false,
    "operation": "mach-lookup",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/anchor-filter-map/out/a9b8e112-51ea-4746-8eab-53de3ad61d64/runtime_profiles/mach_lookup_deny_default.anchor-filter-map_cfprefsd_S1_allow_global.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "S1_allow_global",
    "profile_id": "anchor-filter-map:cfprefsd:S1_allow_global",
    "run_id": "a9b8e112-51ea-4746-8eab-53de3ad61d64",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "anchor-filter-map:cfprefsd:S1_allow_global",
    "stderr": "sandbox initialization failed: mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n\nsandbox_init failed: mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n\n",
    "stdout": "",
    "target": "com.apple.cfprefsd.agent",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "unknown",
      "err_class_source": "errbuf_present",
      "errbuf": "mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n",
      "errno": 0,
      "rc": -1
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/anchor-filter-map/out/a9b8e112-51ea-4746-8eab-53de3ad61d64/runtime_profiles/mach_lookup_deny_default.anchor-filter-map_cfprefsd_S2_allow_local.runtime.sb",
      "--",
      "book/experiments/runtime-checks/mach_probe",
      "com.apple.cfprefsd.agent"
    ],
    "errno": 0,
    "expectation_id": "anchor-filter-map:cfprefsd:S2_allow_local",
    "expected": "allow",
    "failure_kind": "sandbox_init_failed",
    "failure_stage": "apply",
    "match": false,
    "operation": "mach-lookup",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/anchor-filter-map/out/a9b8e112-51ea-4746-8eab-53de3ad61d64/runtime_profiles/mach_lookup_deny_default.anchor-filter-map_cfprefsd_S2_allow_local.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "S2_allow_local",
    "profile_id": "anchor-filter-map:cfprefsd:S2_allow_local",
    "run_id": "a9b8e112-51ea-4746-8eab-53de3ad61d64",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "anchor-filter-map:cfprefsd:S2_allow_local",
    "stderr": "sandbox initialization failed: mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n\nsandbox_init failed: mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n\n",
    "stdout": "",
    "target": "com.apple.cfprefsd.agent",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "unknown",
      "err_class_source": "errbuf_present",
      "errbuf": "mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n",
      "errno": 0,
      "rc": -1
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/anchor-filter-map/out/a9b8e112-51ea-4746-8eab-53de3ad61d64/runtime_profiles/mach_lookup_deny_default.anchor-filter-map_cfprefsd_S3_allow_both.runtime.sb",
      "--",
      "book/experiments/runtime-checks/mach_probe",
      "com.apple.cfprefsd.agent"
    ],
    "errno": 0,
    "expectation_id": "anchor-filter-map:cfprefsd:S3_allow_both",
    "expected": "allow",
    "failure_kind": "sandbox_init_failed",
    "failure_stage": "apply",
    "match": false,
    "operation": "mach-lookup",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/anchor-filter-map/out/a9b8e112-51ea-4746-8eab-53de3ad61d64/runtime_profiles/mach_lookup_deny_default.anchor-filter-map_cfprefsd_S3_allow_both.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "S3_allow_both",
    "profile_id": "anchor-filter-map:cfprefsd:S3_allow_both",
    "run_id": "a9b8e112-51ea-4746-8eab-53de3ad61d64",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "anchor-filter-map:cfprefsd:S3_allow_both",
    "stderr": "sandbox initialization failed: mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n\nsandbox_init failed: mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n\n",
    "stdout": "",
    "target": "com.apple.cfprefsd.agent",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "unknown",
      "err_class_source": "errbuf_present",
      "errbuf": "mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n",
      "errno": 0,
      "rc": -1
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/anchor-filter-map/out/a9b8e112-51ea-4746-8eab-53de3ad61d64/runtime_profiles/mach_lookup_deny_default.anchor-filter-map_cfprefsd_N1_deny_default.runtime.sb",
      "--",
      "book/experiments/runtime-checks/mach_probe",
      "com.apple.cfprefsd.agent"
    ],
    "errno": 0,
    "expectation_id": "anchor-filter-map:cfprefsd:N1_deny_default",
    "expected": "deny",
    "failure_kind": "sandbox_init_failed",
    "failure_stage": "apply",
    "match": true,
    "operation": "mach-lookup",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/anchor-filter-map/out/a9b8e112-51ea-4746-8eab-53de3ad61d64/runtime_profiles/mach_lookup_deny_default.anchor-filter-map_cfprefsd_N1_deny_default.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "N1_deny_default",
    "profile_id": "anchor-filter-map:cfprefsd:N1_deny_default",
    "run_id": "a9b8e112-51ea-4746-8eab-53de3ad61d64",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "anchor-filter-map:cfprefsd:N1_deny_default",
    "stderr": "sandbox initialization failed: mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n\nsandbox_init failed: mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n\n",
    "stdout": "",
    "target": "com.apple.cfprefsd.agent",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "unknown",
      "err_class_source": "errbuf_present",
      "errbuf": "mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n",
      "errno": 0,
      "rc": -1
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/anchor-filter-map/out/a9b8e112-51ea-4746-8eab-53de3ad61d64/runtime_profiles/mach_lookup_deny_default.anchor-filter-map_cfprefsd_N1_deny_default.runtime.sb",
      "--",
      "book/experiments/runtime-checks/mach_probe",
      "com.apple.sandbox-lore.anchor-filter-map.bogus"
    ],
    "errno": 0,
    "expectation_id": "anchor-filter-map:cfprefsd:bogus_baseline",
    "expected": "deny",
    "failure_kind": "sandbox_init_failed",
    "failure_stage": "apply",
    "match": true,
    "operation": "mach-lookup",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/anchor-filter-map/out/a9b8e112-51ea-4746-8eab-53de3ad61d64/runtime_profiles/mach_lookup_deny_default.anchor-filter-map_cfprefsd_N1_deny_default.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "bogus_baseline",
    "profile_id": "anchor-filter-map:cfprefsd:N1_deny_default",
    "run_id": "a9b8e112-51ea-4746-8eab-53de3ad61d64",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "anchor-filter-map:cfprefsd:bogus_baseline",
    "stderr": "sandbox initialization failed: mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n\nsandbox_init failed: mach-message-send operation not applicable in this context\n\nBacktrace: \n<input string>:15:2:\n\t(allow mach-message-send)\n\n",
    "stdout": "",
    "target": "com.apple.sandbox-lore.anchor-filter-map.bogus",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "ok",
      "err_class_source": "none",
      "errbuf": null,
      "errno": 0,
      "rc": 0
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/anchor-filter-map/out/a9b8e112-51ea-4746-8eab-53de3ad61d64/runtime_profiles/mach_lookup_allow_default.anchor-filter-map_cfprefsd_C1_deny_global.runtime.sb",
      "--",
      "book/experiments/runtime-checks/mach_probe",
      "com.apple.cfprefsd.agent"
    ],
    "errno": 1,
    "expectation_id": "anchor-filter-map:cfprefsd:C1_deny_global",
    "expected": "deny",
    "failure_kind": "probe_nonzero_exit",
    "failure_stage": "probe",
    "match": true,
    "operation": "mach-lookup",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/anchor-filter-map/out/a9b8e112-51ea-4746-8eab-53de3ad61d64/runtime_profiles/mach_lookup_allow_default.anchor-filter-map_cfprefsd_C1_deny_global.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "C1_deny_global",
    "profile_id": "anchor-filter-map:cfprefsd:C1_deny_global",
    "run_id": "a9b8e112-51ea-4746-8eab-53de3ad61d64",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "anchor-filter-map:cfprefsd:C1_deny_global",
    "stderr": "",
    "stdout": "{\"kr\":1100}\n",
    "target": "com.apple.cfprefsd.agent",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "allow",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "ok",
      "err_class_source": "none",
      "errbuf": null,
      "errno": 0,
      "rc": 0
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/anchor-filter-map/out/a9b8e112-51ea-4746-8eab-53de3ad61d64/runtime_profiles/mach_lookup_allow_default.anchor-filter-map_cfprefsd_C2_deny_local.runtime.sb",
      "--",
      "book/experiments/runtime-checks/mach_probe",
      "com.apple.cfprefsd.agent"
    ],
    "expectation_id": "anchor-filter-map:cfprefsd:C2_deny_local",
    "expected": "deny",
    "match": false,
    "operation": "mach-lookup",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/anchor-filter-map/out/a9b8e112-51ea-4746-8eab-53de3ad61d64/runtime_profiles/mach_lookup_allow_default.anchor-filter-map_cfprefsd_C2_deny_local.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "C2_deny_local",
    "profile_id": "anchor-filter-map:cfprefsd:C2_deny_local",
    "run_id": "a9b8e112-51ea-4746-8eab-53de3ad61d64",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "success",
    "scenario_id": "anchor-filter-map:cfprefsd:C2_deny_local",
    "stderr": "",
    "stdout": "{\"kr\":0}\n",
    "target": "com.apple.cfprefsd.agent",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  }
]