# Notes â€” Field2 Atlas

- Initial scaffold created with seeds `0` (path), `5` (global-name), `7` (local); world fixed to `sonoma-14.4.1-23E224-arm64-dyld-2c0602c5`.
- Static/runtime/atlas outputs are currently placeholders keyed to existing mappings and golden traces; replace with regenerated data once `atlas_static.py` and `atlas_runtime.py` run.
- Keep runtime attempts, including `EPERM` / apply gates, recorded here with the command, profile, and seed field2 they target.
- Rebuilt atlas via `PYTHONPATH=. python book/experiments/field2-atlas/atlas_build.py --packet <promotion_packet.json> --out-root book/experiments/field2-atlas/out/derived` after refreshing `field2_inventory.json`/`unknown_nodes.json` (new UDP network variant + fcntl/right-name sweeps). Outputs remain stable (`runtime_backed` slice unchanged) but are aligned to the current anchor map/tag layouts.
- Added seed `2560` for flow-divert triple-only token (tag0/u16_role=filter_vocab_id, literal `com.apple.flow-divert`, target op `network-outbound`); regenerated static/runtime/atlas outputs to include it (static ok, runtime marked `no_runtime_candidate`).
- Refreshed static join with `PYTHONPATH=$PWD python3 book/experiments/field2-atlas/atlas_static.py`.
- Ran runtime harness refreshes via the unified runtime CLI and regenerated the adversarial promotion packet.
- Regenerated runtime signatures via `PYTHONPATH=$PWD python3 book/graph/mappings/runtime/generate_runtime_signatures.py`.
- Rebuilt runtime/atlas outputs via packet-only flow (promotion packet in, derived outputs out).
- Logging-channel hypothesis check: log stream capture exists in entitlement-diff and shrink-trace outputs, but runtime harness does not currently ingest log stream artifacts; treat this as a candidate measurement channel to validate separately before using it for atlas status changes.
- Added runtime-adversarial probes for path aliasing (`adv:path_alias`) and flow-divert require-all TCP (`adv:flow_divert_require_all_tcp`); clean-channel runs surfaced apply-gated probes (`sandbox_init` EPERM), so seeds now record `runtime_attempted_blocked` with explicit failure_stage.
- Promoted runtime mappings from the promotion packet and regenerated `runtime_story`, `runtime_coverage`, and `expectations`.
- `book/graph/mappings/runtime/generate_runtime_signatures.py` initially failed without `PYTHONPATH`, reran with `PYTHONPATH=$PWD` to refresh `runtime_signatures.json`.
- Rebuilt atlas runtime/summary outputs; field2=0 now carries requested/observed/normalized path observations plus a `path_canonicalization_witness` from `adv:path_alias`, and field2 1/2560 now have explicit attempted (blocked) runtime candidates.
- Added historical runtime witness carry-forward in `atlas_runtime.py` so apply-gated runs can still report last-known-good results as `runtime_backed_historical` when available.
- Decoupled observed-path collection from sandbox apply by using unsandboxed F_GETPATH; path normalization evidence now survives apply-gated runs.
- Refreshed via launchd clean channel; field2=1 mismatch is captured in packet-exported mismatch packets, and field2=2560 carries a partial-triple control + baseline witness in derived runtime results.
- Field2 atlas builders now accept only promotion packets and emit derived outputs under `out/derived/<run_id>/` with a stamped consumption receipt.
- Added xattr runtime candidate swap (`adv:xattr:allow-foo-read`) after a clean-channel run (`out/7fb35590-c5c0-4187-8949-f534fbd43045/`); field2=2 is now runtime-backed and the atlas reflects the updated candidate.
- Added file-mode seed + runtime candidate (`adv:file_mode:allow-private`) and refreshed the clean-channel run (`out/ec3df76c-6559-421b-8203-c32709667ffc/`); field2=3 is now runtime-backed.
- Latest clean-channel packet refresh (`out/738fc3d0-1d12-4608-9a97-90addfbc8d4c/`) leaves the entire seed slice runtime-backed with no mapping delta proposals; further progress is blocked until the seed set in `field2_seeds.json` is expanded.
- Expanded `field2_seeds.json` with a userland-backed tranche (`ipc-posix-name`, `local-name`, `right-name`, `preference-domain`, `notification-name`, `sysctl-name`, `xpc-service-name`) and added runtime candidates for local-name, notification-name, and sysctl-name; derived atlas outputs need a packet refresh to reflect the new seed slice.
- `atlas_static.py` now merges seed-manifest anchors into `anchor_hits` when the anchor map lacks coverage; sysctl-name and xpc-service-name seeds carry seed-manifest anchors to keep static records non-empty.
