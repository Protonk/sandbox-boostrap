{
  "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
  "source": "libsandbox.1.dylib::_sandbox_apply@0x183d0985c",
  "status": "partial",
  "observed_variant": "handle[0]==0 (branch used by init_params_probe)",
  "handle_fields": [
    {
      "offset": 0,
      "role": "qword0 checked first; when non-zero copied into arg block passed to __sandbox_ms (likely sb_buffer*)",
      "evidence": "ldr x8, [x0]; cbz -> fallback; stp x8,x1 to sp when non-zero"
    },
    {
      "offset": 8,
      "role": "qword1 used with qword2 when qword0==0; copied via ldp [x0,#0x8] into arg block",
      "evidence": "ldp x8,x9, [x0,#0x8] on fallback branch"
    },
    {
      "offset": 16,
      "role": "qword2 paired with qword1 in fallback branch; stored into arg block before container fields",
      "evidence": "ldp x8,x9, [x0,#0x8]; stp x8,x9, [sp]"
    }
  ],
  "container_fields": [
    {
      "arg_register": "x1",
      "role": "container path pointer (nullable)",
      "usage": "stored into arg block; strlen used when non-null to compute length"
    },
    {
      "arg_block_offsets": {
        "sp+0x0": "handle qword (either handle[0] or handle[1])",
        "sp+0x8": "second qword (container ptr in main branch or handle[2] in fallback)",
        "sp+0x10": "container length when main branch container!=NULL; container ptr when fallback path executes",
        "sp+0x18": "container length in fallback branch when container!=NULL; zero otherwise"
      }
    }
  ],
  "observed_values": {
    "init_params_probe": {
      "handle_words": [0, "0x146809600", 416],
      "arg_block": {"q0": "0x146809600", "q1": 416, "q2": 0},
      "container_len": 0
    },
    "init_params_probe_container": {
      "handle_words": [0, "0x152009200", 416],
      "arg_block": {"q0": "0x152009200", "q1": 416, "q2": 0},
      "container_len": 26
    }
  }
}
