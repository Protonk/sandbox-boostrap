### 2.1 What TextEdit is allowed to do

TextEdit is a useful “reference app” for seeing what the macOS App Sandbox actually gives a GUI process. It is small and familiar, but its sandbox is rich enough to touch most of the standard mechanisms: containers, user-selected files, printing, iCloud, and a wide array of system services. This section treats TextEdit’s effective sandbox profile as a statement of what the system believes the app is allowed to do.

At the top level, the entitlements plist and the specialized SBPL profile agree on a simple story:

* TextEdit is an App Sandbox process (`com.apple.security.app-sandbox = true`).
* It can operate on **user-selected files**, with both read/write and executable access.
* It can **print** documents via the standard print pipeline.
* It has a dedicated **ubiquity/iCloud container** (`"com.apple.TextEdit"`).
* It carries at least one **private HID entitlement** for input/event dispatch.
* Its own **container filesystem** is fully read/write; most of the rest of the system is effectively read-only.
* There are **generic network rules** in the base profile, but **no network client or server entitlements**, so network use is constrained to what the App Sandbox template allows without those capabilities.
* It can talk to a large set of system services via **mach-lookup** (dozens of global/local names), even though it is otherwise tightly boxed.

From this, we can derive more concrete “allowed behaviours” along three main axes: documents, cloud/printing, and system interaction.

#### 2.1.1 Documents and the filesystem

TextEdit’s starting point is its own container, rooted under `~/Library/Containers/com.apple.TextEdit/Data`. The SBPL container macros give it broad read/write access here: it can create, modify, and delete files in its container, and the profile issues the corresponding sandbox extensions so that kernel checks succeed. Within this region TextEdit can maintain autosave data, internal state, default documents, caches, and preferences without asking for anything special.

Outside the container, the picture changes:

* System directories such as `/System` and the core parts of `/usr/bin` and `/usr/sbin` are readable but not writable. The SBPL allows file-read and process-exec in these areas, but write operations are denied. TextEdit can load system binaries and resources (fonts, dictionaries, frameworks) but cannot change them.
* `/Library` is mostly treated as read-only, with explicit carve-outs: there are broad allows for reading preferences and various Library subtrees (color pickers, fonts, sounds, etc.), and explicit denies for areas like caches, logs, and managed preferences. This means TextEdit can inspect the system environment and user preferences to behave correctly, but cannot dump arbitrary data or alter system-managed configuration outside its sandbox.
* The **Downloads folder** is not granted special treatment in entitlements: there are no `com.apple.security.files.downloads.*` keys, and the specialized profile has no downloads-focused read/write macros active. TextEdit can still open and save in Downloads, but only by going through the user-selected file path (open/save panel, scoped bookmarks). It does not get blanket traversal or execution rights there.

The key capability boost comes from the **user-selected files entitlements**. Because both read/write and executable variants are present, and the profile includes the machinery to talk to the scoped bookmarks agent, TextEdit can:

* Open and modify files located anywhere the user can navigate to via the open panel (including external volumes, network shares, and the home directory).
* Execute user-selected binaries or scripts if a workflow requires it, subject to the usual execution rules and the rest of the sandbox.

In effect, the sandbox says:

* “You own your container; you may treat it as your home.”
* “You may touch arbitrary user files—but only when the user has explicitly selected them, and only by carrying extensions that record that decision.”

Autosave and “recent documents” flow naturally from this. Once a file has been opened via user selection, TextEdit keeps the extension for that path and can continue to read and write it in the background. The sandbox rules do not carry any explicit “recent files” concept; instead, they permit ongoing access for paths that already have valid extensions.

#### 2.1.2 Cloud storage and printing

Two prominent capabilities sit on top of this file story: **iCloud** and **printing**.

The `com.apple.developer.ubiquity-container-identifiers` entitlement lists `["com.apple.TextEdit"]`, and the specialized SBPL has been concretely instantiated for that value: it allows `file-link` and read/write access under the `ubiquity-filter` for that container. That is, there is an explicit set of rules that say:

* “Paths that belong to the TextEdit ubiquity container are writable.”
* “The app may issue sandbox extensions for those paths so that kernel checks pass when syncing or moving files.”

In practical terms, this means TextEdit is allowed to:

* Create and modify documents under its iCloud container.
* Rely on the system to sync those documents across devices, while remaining sandboxed.

Nothing in the profile gives it arbitrary access to other apps’ iCloud containers; the rules are scoped to the identifiers actually present in the entitlements.

For **printing**, the situation is similar. The `com.apple.security.print` entitlement is set, and the application profile includes the `printing` macro when that entitlement is present. That macro, in turn, expands to a set of rules that:

* Permit mach-lookup to the printing daemons and helper processes.
* Allow the necessary file and IPC operations to hand a document to the print system.
* Enforce some negative rules around CUPS sockets when print entitlement is absent; in TextEdit’s case, those negative rules are not activated.

The net effect is that TextEdit can always send a document to the system print pipeline, even though it lacks general network entitlements. The sandbox distinguishes “printing to a local or configured printer through trusted daemons” from “arbitrary network client behaviour”.

#### 2.1.3 Network and system services

From the entitlements alone, TextEdit looks “non-networked”: there are no `com.apple.security.network.client` or `.server` keys. The specialized SBPL confirms this: the macros that would expand for those entitlements are inactive. What remain are the baseline `network*` rules baked into the generic template—enough to talk to essential local services (DNS resolvers, logging, certain control sockets under `/private/var/run`), but not a general license to open arbitrary outbound connections.

Some of those rules are explicitly limiting, for example:

* Denies on the usbmuxd socket, blocking direct access to iOS device tunnelling.
* Denies on the default CUPS port when printing is not allowed; for TextEdit, the printing entitlement changes how that restriction applies.
* Restrictions that require network access to go through specific daemons rather than raw sockets in many cases.

At the same time, TextEdit is allowed to speak to a surprisingly large set of **Mach services**. The profile contains dozens of `mach-lookup` rules granting access to:

* Core system configuration services (configd, SystemConfiguration helpers).
* Privacy and security daemons (tccd, securityd, TrustEvaluationAgent).
* UI and UX infrastructure (windowserver, Dock, quicklook helpers, pasteboard services).
* Sync, logging, and indexing services (mds, revisiond, logd fragments).

From a capability perspective, this means that even a tightly sandboxed app is “allowed” to participate fully in the desktop environment: it can put up windows, query fonts and dictionaries, use Quick Look, access the clipboard, and consult the system for identity and trust decisions. Many of these abilities are not obvious from the simple entitlements view; they only emerge when you look at the SA profile’s service allowlist.

#### 2.1.4 Input, preferences, and personal data

Finally, the entitlements and SBPL give TextEdit a particular posture around input and user data:

* The **private HID entitlement** (`com.apple.private.hid.client.event-dispatch.internal`) pairs with rules that allow relevant IOKit clients and event dispatch mechanisms. This ensures that TextEdit can receive and process keyboard and mouse events with low latency, participate in text services, and handle shortcuts, even though it is sandboxed.
* The SBPL grants read and sometimes write access to a wide range of **preferences domains**, including those for input methods, text services, accessibility, and shared Apple frameworks. TextEdit can read system and user preferences that affect text rendering, input, speech, and services menus; it can write to limited domains such as its own favourites and services configuration.
* Keychain access is notably permissive for a sandboxed app: the profile allows read/write on keychain paths under `~/Library/Keychains/`, with a carve-out for a placeholder UUID path. That means TextEdit can work with stored credentials or certificates in ways that are consistent with other user apps, constrained mainly by keychain’s own prompting and ACLs rather than by the sandbox.

From a user’s standpoint, this all supports the intuition that “TextEdit behaves like a normal Mac app” in how it sees input, system preferences, and saved credentials, even though the underlying filesystem and network access are tightly constrained.

#### 2.1.5 Summary

Taken together, the entitlements and specialized profile say:

* TextEdit is **fully sandboxed**, owning its container and reading most of the system but not modifying it.
* It can operate on **any document the user chooses**, and keep working on that document in the background, but cannot silently roam the filesystem.
* It can **print** and **sync** via its **iCloud container**, but not act as a general network client.
* It can participate in the broader macOS experience—windows, clipboard, spellchecking, quicklook, logging, keychains—via a broad allowlist of services, without needing explicit entitlements for each of those capabilities.

This is the baseline “allowed to do” story we will refine in later sections when we trace concrete operations through the sandbox and compare TextEdit’s privileges to those of other sandboxed processes.
